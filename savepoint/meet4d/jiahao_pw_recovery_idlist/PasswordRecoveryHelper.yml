PasswordRecoveryHelper:
  title: "PasswordRecoveryHelper"
  init:
    - .SignInCheck 
    - actionType: evalObject
      object:
        .Global._nonce@:
          =.builtIn.math.random: ""
    - ..userData.get
  dataObject: ""      
  refuse:
    edge:
      .Edge: ""
      type: .EdgeType.Accept
      bvid: .Global.currentUser.vertex.id
      name: ""
    edgeAPI: 
      store:
        api: ce
        dataIn: refuse.edge
  emailList: 
    email: 
      edge:
    get: 
      .EdgeAPT.get: ""
      api: re
      dataKey: emailList.email
      id: 
        - ..PasswordRecoveryHelper.dataObject.id
        - .Global.currentUser.vertex.id
      xfname: "evid,bvid|bvid,evid"
      type: .EdgeType.Email
      _nonce: =.Global._nonce
      sCondition: "subtype=8"          
  userData:
    userVertex:
      vertex:
    get:
      .VertexAPI.get : ""
      api: rv
      dataKey: userData.userVertex
      ids: 
        - .Global.currentUser.vertex.id
      ObjType: 4
      type: 1
      sCondition: "E.type=10002 AND E.tage=0 AND E.subtype=8 AND length(V.uid) >0"
      xfname : "(E.bvid|E.evid)&!(V.id)"
      obfname : "mtime" 
      maxcount : "20"
      _nonce: =.Global._nonce
  inviteHelper:
    response: ""
    edge:
      .Edge: ""
      type: 1053
      refid: ""
      subtype: 8 # invite special people
      bvid: .Global.currentUser.vertex.id
      name:
        phoneNumber: ""
        inviterName: .Global.currentUser.vertex.name.firstName
    edgeAPI:
      .EdgeAPI: ""
      store:
        api: ce
        dataIn: inviteHelper.edge
        dataOut: inviteHelper.response
  save:
    - ..inviteHelper.edgeAPI.store             
  components:
    - .BaseCheckView: ""
      message: "Please add one friend"
      viewTag: NoPhoneNum
    - .BaseCheckView: ""
      message: "Incorrect Phone Number"
      viewTag: wrongPhoneNum   
    - .BaseHeader1:  
    - .HeaderLeftButton1:
    - .HeaderRightImg1:
      path: help.png
      onClick:
        - goto: Help
    - type: scrollView
      style:
        top: "0.1"
        left: "0"
        width: "1"
        height: "0.9"
        overflow: scroll
      children:
        - type: view
          style:
            marginTop: "0"
            left: "0"
            width: "1"
            height: "auto"
          children:
            - .PasswordRecoveryHelperTitleView:
              style: 
                marginTop: "0"
                left: "0"
              children: 
                - .PasswordRecoveryHelperTitle: 
                  text1: "Add/Invite/remove PR helpers"
                  style:
                    # top: "0"
                    height: "0.04"
            - type: view
              viewTag: phoneNumber
              style: 
                left: "0"
                # top: "0.246"
                marginTop: "0"
                width: "1"
                height: "0.24"
                border: 
                  style: "2"
                borderWidth: "1"
                borderColor: "0xdededf"
              children:
                - type: label
                  text: Country
                  style:
                    left: "0.08"
                    top: "0.031"
                    width: "0.3"
                    height: "0.028"
                    fontSize: "12"
                    fontWeight: "450"
                    textAlign:
                      x: left
                - type: select
                  #contentType: countryCode
                  contentType: countryCode
                  placeholder: ..formData.countryCode
                  dataKey: formData.countryCode # formData.countryCode : inputValue
                  options:
                    # - "+1"
                    # - "+52"
                    # - "+86"
                    # - "+965"
                    .CountryCode
                  required: "true"
                  style:
                    left: "0.08"
                    top: "0.06"
                    width: "0.2"
                    height: "0.04"
                    border:
                      style: "3"
                    borderColor: "0xefefef"
                    borderWidth: "1"
                    fontSize: "15"
                    # zIndex: "10"
                - type: label
                  textBoard: 
                    - text: Phone Number
                    - text: "*"
                      color: "0xff0000"
                  style:
                    left: "0.35"
                    top: "0.031"
                    width: "0.30"
                    height: "0.03"
                    fontSize: "12"
                    fontWeight: "450"
                    textAlign:
                      x: left
                - type: textField
                  placeholder: "000-000-0000"
                  dataKey: inviteHelper.edge.name.phoneNumber
                  style:
                    left: "0.35"
                    top: "0.06"
                    width: "0.40"
                    height: "0.04"
                    border: 
                      style: "3"
                    borderColor: "0xdededf" 
                    borderWidth: "0.1px"
                    textIndent: "10px"
                    fontSize: "15"
                - type: button
                  text: Add
                  style: 
                    left: "0.78"
                    top: "0.06"
                    width: "0.15"
                    height: "0.045"
                    color: "0xffffff"
                    backgroundColor: "0x388eccff"
                    fontSize: "12"
                    border:
                      style: "3"
                    borderWidth: "1.5"
                    borderRadius: "5"
                    borderColor: "0xffffff"
                    textAlign:
                      x: center
                      y: center
                  onClick:
                    - actionType: evalObject
                      object: 
                        - if:
                          - =..inviteHelper.edge.name.phoneNumber
                          - continue
                          - actionType: popUp
                            popUpView: NoPhoneNum
                            wait: true
                    - actionType: evalObject
                      object: 
                        - =.builtIn.typeCheck.phoneNumber:
                            dataIn:
                              phoneNumber: =..inviteHelper.edge.name.phoneNumber
                              countryCode: =..formData.countryCode
                            dataOut: ForgetPasswordIn.formData.checkOk
                        - if:
                          - ..formData.checkOk
                          - continue
                          - actionType: popUp
                            popUpView: WrongPhoneNum
                            wait: true
                    - actionType: popUp
                      popUpView: confirmView 
                - type: button
                  text: Select from Contact
                  onClick:
                    goto:
                  style:
                    left: "0.08"
                    top: "0.15"
                    width: "0.84"
                    height: "0.05"
                    fontSize: "15"
                    fontWeight: "600"
                    color: "0x5ea6ec"
                    border: 
                      style: "3"
                    borderColor: "0x2988e6"
                    borderWidth: "1"
                    backgroundColor: "0xffffff"
                    textAlign:
                      x: center
        - type: view
          style:
            marginTop: "0"
            left: "0"
            width: "1"
          children:
            - .PasswordRecoveryHelperTitleView:
              style: 
                marginTop: "0"
                left: "0"
              children: 
                - .PasswordRecoveryHelperTitle: 
                  text1: "PR helper list"
                  style:
                    # top: "0"
                    height: "0.04"
            - type: list
              contentType: listObject
              listObject: ..userData.userVertex.vertex
              iteratorVar: itemObject
              style:
                width: '1'
                margin: '0'
                left: '0'
              children:
                - type: listItem
                  viewTag: helpList
                  itemObject: 
                  style:
                    border: 
                      style: "2"
                    borderWidth: "1"
                    borderColor: "0xf0f0f0"
                    width: '1'
                    height: '0.09'
                    left: '0'
                    marginTop: ''
                  children:
                    - type: image
                      path: accompany.png
                      style:
                        left: '0.05'
                        width: '0.1'
                        top: '0.01'
                    - type: label
                      dataKey: itemObject.name.firstName
                      style:
                        left: '0.23'
                        width: '0.4'
                        top: '0.02'
                        height: '0.03'
                    - type: label
                      dataKey: itemObject.name.phoneNumber
                      style:
                        left: '0.22'
                        width: '0.4'
                        top: '0.05'
                        height: '0.03'
                    - type: image
                      path: shanchu.png
                      onClick:
                        - actionType: updateObject # updateObject(dataKey, dataObject, dataObjectKey)
                          dataKey: PasswordRecoveryHelper.dataObject
                          dataObject: itemObject
                        - actionType: evalObject        #modify
                          object: 
                            - .Global.inboxContact.id@: =..PasswordRecoveryHelper.dataObject.id
                        - actionType: evalObject        #modify
                          object:                             
                            - .Global._nonce@: 
                                =.builtIn.math.random: ""                        
                            - =..emailList.get: ""
                        - actionType: popUp
                          popUpView: confirm
                      style:
                        left: '0.82'
                        top: '0.03'
    - type: popUp
      onClick:
        - actionType: popUpDismiss
          popUpView: finalView
        - actionType: refresh   
        # - actionType: builtIn
        #   funcName: redraw
        #   viewTag: helpList                 
      viewTag: finalView
      style:
        left: "0"
        top: "0"
        width: "1"
        height: "1"
        backgroundColor: "0x00000033"
        zIndex: "1000"
      children:
        - type: view
          style:
            left: "0.25"
            top: "0.25"
            width: "0.5"
            height: "0.225"
            backgroundColor: "0xefefef"
            borderRadius: "10"
          children:
            - type: image
              path: successMark.png
              style:
                top: "0.04"
                width: "0.2"
                left: "0.15"
            - type: label
              text: Success!
              style:
                left: "0"
                top: "0.15"
                width: "0.5"
                fontSize: "26"
                fontWeight: "700"
                textAlign:
                  x: center  
    - type: popUp
      viewTag: warning
      style:
        left: "0"
        top: "0"
        width: "1"
        height: "1"
        backgroundColor: "0x00000033"
        zIndex: "1000"
      children:
        - type: view
          style:
            left: "0.15"
            top: "0.3"
            width: "0.7"
            height: "0.25"
            backgroundColor: "0xefefef"
            borderRadius: "10"
          children:
            - type: label
              text: WARNING
              style:
                left: "0"
                marginTop: "0.04"
                width: "0.7"
                height: "0.02" 
                fontSize: "18"
                fontWeight: "500"
                textAlign: 
                  x: center
            - type: label
              text: Your PR helper doesn’t sign up in 24 hours, now your account has been suspended. Please contact your PR or add other new PRs.
              style:
                marginTop: "0.01"
                width: "0.6"
                left: "0.05"
                height: "0.08" 
                fontSize: "13"
                fontWeight: "500"
                textAlign: 
                  x: center
            - type: view
              style:
                left: "0"
                marginTop: "0.04"
                width: "0.7"
                height: "0.0002"
                backgroundColor: "0xbebebf"
            - type: button
              text: OK
              onClick:
                - actionType: popUpDismiss
                  popUpView: warning
                - goto:
              style:
                left: "0"
                top: "0.195"
                width: "0.7"
                height: "0.05"
                borderRadius: "10"
                borderWidth: "0"
                fontSize: "17"
                fontWeight: "500"
                color: "0x3a96f9"
                textAlign: 
                  x: center    
    - type: popUp
      viewTag: confirm
      style:
        left: "0"
        top: "0"
        width: "1"
        height: "1"
        backgroundColor: "0x00000033"
        zIndex: "1000"
      children:
        - type: view
          style:
            left: "0.15"
            top: "0.3"
            width: "0.7"
            height: "0.25"
            backgroundColor: "0xefefef"
            borderRadius: "10"
          children:
            - type: label
              text: Do you want to remove this PR helper?
              style:
                left: "0.1"
                marginTop: "0.07"
                width: "0.5"
                height: "0.03" 
                fontSize: "14"
                fontWeight: "500"
                textAlign: 
                  x: center
            - type: view
              style:
                left: "0"
                top: "0.19"
                width: "0.7"
                height: "0.0002"
                backgroundColor: "0xbebebf"
            - type: divider
              style:
                left: "0.348"
                top: "0.18"
                width: "0.001"
                height: "0.057"
                backgroundColor: "0xbebebf"
            - type: button
              text: Cancel
              onClick: 
                - actionType: popUpDismiss
                  popUpView: confirm
              style:
                left: "0"
                top: "0.195"
                width: "0.348"
                height: "0.05"
                borderRadius: "10"
                borderWidth: "0"
                fontSize: "17"
                fontWeight: "500"
                color: "0x3a96f9"
                textAlign: 
                  x: center
            - type: button
              text: OK
              onClick:
                - actionType: popUpDismiss
                  popUpView: confirm      
                - actionType: evalObject
                  object:
                      - ..refuse.edge.evid@: =..dataObject.id
                      # - ..refuse.edge.name@: $var.name
                      - ..refuse.edge.refid@: =..emailList.email.edge.0.id
                      - =..refuse.edgeAPI.store: ""
                - actionType: evalObject
                  object:
                    .Global._nonce@:
                      =.builtIn.math.random: ""
                # - actionType: refresh      
                # - actionType: builtIn
                #   funcName: redraw
                #   viewTag: helpList
                # - actionType: evalObject
                #   object:
                #     - =.builtIn.goto:
                #         dataIn:
                #           destination: 'NewConnections'
                #           pageReload: true
                    # - if:
                    #   - =..invite.inviteList.edge.0
                    #   - continue
                    #   - =.builtIn.checkField:
                    #       dataIn:
                    #         contentType: messageHidden
                    #         wait: 100                   
              style:
                left: "0.352"
                top: "0.195"
                width: "0.348"
                height: "0.05"
                borderRadius: "10"
                borderWidth: "0"
                fontSize: "17"
                fontWeight: "500"
                color: "0x3a96f9"
                textAlign: 
                  x: center 
    - type: popUp # view
      viewTag: confirmView
      style:
        left: "0"
        top: "0"
        width: "1"
        height: "1" 
        backgroundColor: "0x00000066" 
      children:
        - type: view
          style:
            left: "0.05"
            top: "0.15"
            width: "0.89333"
            height: "0.35"
            backgroundColor: "0xeeeeeeff"
            border:
              style: "5"
            borderRadius: "15"
          children:
            - type: label
              text: "Send Invite Link"
              style:
                .LabelStyle:
                  left: "0"
                  top: "0.04"
                  width: "0.89333"
                  height: "0.04"
                  color: "0x00000088"
                  fontSize: "20"
                  fontStyle: bold
                  display: inline
                  textAlign:
                    x: center
                    y: center
            - type: label
              text: "Send invite link to"
              style:
                .LabelStyle:
                  left: "0"
                  top: "0.1"
                  width: "0.89333"
                  height: "0.04"
                  color: "0x00000088"
                  fontSize: "14"
                  display: inline
                  textAlign:
                    x: center
                    y: center 
            - type: label
              #text: "+1 7148397253"
              dataKey: inviteHelper.edge.name.phoneNumber
              style:
                .LabelStyle:
                  left: "0"
                  top: "0.20"
                  width: "0.89333"
                  height: "0.027247"
                  color: "0x00000088"
                  fontSize: "14"
                  display: inline
                  textAlign:
                    x: center
                    y: center 
            - type: divider
              style:
                .DividerStyle:
                  left: "0"
                  top: "0.25436"
                  width: "0.89333"
                  height: "0.001"
                  backgroundColor: "0x00000088"
            - type: button
              onClick: 
                - actionType: popUpDismiss
                  popUpView: confirmView
              text: Cancel
              style:
                .LabelStyle:
                  left: "0"
                  top: "0.275"
                  width: "0.42"
                  height: "0.06812"
                  color: "0x007affff"
                  fontSize: "17"
                  display: inline
                  textAlign:
                    x: center
                    y: center 
                  border:
                    style: "5"
                  borderRadius: "15"
            - type: button
              onClick: 
                - actionType: saveObject
                  object: ..save
                - actionType: evalObject
                  object: 
                    .Global._nonce@: 
                      =.builtIn.math.random: ""     
                - actionType: popUpDismiss
                  popUpView: confirmView
                - actionType: popUp
                  popUpView: finalView                   
              text: Confirm
              style:
                .LabelStyle:
                  left: "0.45"
                  top: "0.275"
                  width: "0.42"
                  height: "0.06812"
                  color: "0x007affff"
                  fontSize: "17"
                  display: inline
                  textAlign:
                    x: center
                    y: center 
                  border:
                    style: "5"
                  borderRadius: "15"
            - type: divider
              style:
                .DividerStyle:
                  left: "0.45"
                  top: "0.26"
                  width: "0.001"
                  height: "0.07"
                  backgroundColor: "0x00000088"