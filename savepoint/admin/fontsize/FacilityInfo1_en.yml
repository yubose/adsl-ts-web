FacilityInfo1: #xd page number: 62
  pageNumber: "360"
  viewPort: top
  title: "FacilityInfo1"
  init:
    - .SignInCheck
    - actionType: evalObject
      object:
        .Global._nonce@:
          =.builtIn.math.random: ""
    - .Global.jwt.edge.bvid@: =.Global.currentFacility.id
    - =.Global.jwt.edgeAPI.store: ""
    - =..facilityAll.vertexAPI.get: ""
    - .Global.jwt.edge.bvid@: =.Global.currentFacility.id
    - =.Global.jwt.edgeAPI.store: ""
    - if: 
      - ..facilityAll.vertexResp.vertex.0
      - ..facilityAll.vertexResp.vertex.0.backgroundColor@: "0x003d68"
      - continue
    - if: 
      - ..facilityAll.vertexResp.vertex.0
      - ..facilityAll.vertexResp.vertex.0.fontColor@: "0xffffff"
      - continue
    - .Global.formData.locationId@: =.Global.currentFacility.id
    - ..BusinessLogo.docIn.id@: =.Global.fac_rootNotebook
    - ..Profile.docIn.id@: =.Global.fac_rootNotebook
    - =..BusinessLogo.docAPI.get: ""
    - =..Profile.docAPI.get: ""
    - if: 
      - =..BusinessLogo.resp.doc.0
      - actionType: evalObject
        object:
          - =.builtIn.utils.prepareDoc:
              dataIn:
                doc: =..BusinessLogo.resp.doc.0
              dataOut: FacilityInfo1.BusinessLogo.resp
          - ..BusinessLogo.url@: =..BusinessLogo.resp.name.data
      - continue
    - if: 
      - =..Profile.resp.doc.0
      - actionType: evalObject
        object:
          - =.builtIn.utils.prepareDoc:
              dataIn:
                doc: =..Profile.resp.doc.0
              dataOut: FacilityInfo1.Profile.resp
          - ..Profile.url@: =..Profile.resp.name.data
      - continue
    - ..facility.documentReq.id@: .Global.fac_rootNotebook
    - =..facility.docAPI.get: ""
    - =..facilityInfomation.docAPI.get: ""
    # - if:
    #   - =..facility.response.doc.0
    - ..facility.document@: =..facility.response.doc.0
    # - ..facilityInfomation@: =..facility.document.name.data.basicInfo
      # - ..facility.document.name.data.basicInfo@: =.Global.currentFacility.name.basicInfo
  # facilityList: ""
  facilityInfomation: 
    response: ""
    documentReq:
      id: .Global.fac_rootNotebook
      xfname: eid
      type: .DocType.FacilityProfile
      _nonce: .Global._nonce
      obfname: ctime
      maxcount: "1"
    docAPI:
      get:
        api: rd
        dataIn: FacilityInfo1.facilityInfomation.documentReq
        dataOut: FacilityInfo1.facilityInfomation.response
  facilityAll:  # 包括所有的facility和location
    vertex: 
      ObjType: "4"
      ids: 
        - .Global.currentFacility.id
      xfname: "E.bvid"
      sCondition: "E.type=1100 AND V.type!=1"
      maxcount: "100"
      obfname: "ctime"
      asc: true
      _nonce: =.Global._nonce
    vertexResp: ""
    vertexAPI:
      get: 
        api: rv
        dataIn: FacilityInfo1.facilityAll.vertex
        dataOut: FacilityInfo1.facilityAll.vertexResp
  facility:
    response: ""
    documentReq:
      id: ""
      xfname: eid
      type: .DocType.FacilityProfile
      _nonce: .Global._nonce
      obfname: ctime
      maxcount: "1"
    docAPI:
      get:
        api: rd
        dataIn: FacilityInfo1.facility.documentReq
        dataOut: FacilityInfo1.facility.response
  fac_RootNotebook:
    edgeReq:
      id: ""
      xfname: bvid
      type: .EdgeType.RootNotebook
    edge: ""
    edgeAPI:
      get:
        api: re
        dataIn: FacilityInfo1.fac_RootNotebook.edgeReq
        dataOut: FacilityInfo1.fac_RootNotebook.edge
  flag: ""
  flag1: ""
  BusinessLogo:
    url: BusinessLogo.png
    resp: ""
    docIn: 
      id: 
      xfname: eid
      type: .DocType.BusinessLogoPicture
      maxcount: "1"
      obfname: "ctime"
      _nonce: =.Global._nonce
    docAPI: 
      get:
        .DocAPI.get: "" 
        dataIn: BusinessLogo.docIn
        dataOut: FacilityInfo1.BusinessLogo.resp
  Profile:
    url: ProfilePicture.png
    docIn: 
      id: 
      xfname: eid
      type: .DocType.ProfilePicture
      maxcount: "1"
      obfname: "ctime"
      _nonce: =.Global._nonce
    docAPI: 
      get:
        .DocAPI.get: "" 
        dataIn: Profile.docIn
        dataOut: FacilityInfo1.Profile.resp

  components:
    - .BaseCheckView: ""
      message: "You don't have the authority to edit"
      viewTag: mFIAuthEdit
      style: 
        zIndex: "100000"
    - .SideMenuBar:
      children:
        - .aitLogo:
        - .MenuBar:
    - .TopBar:
    - .BodyView:
      children:
        - type: view
          style:  
            left: "0.03"
            top: "0.01"
            width: "0.78"
            height: "0.06"
          children: 
            - type: label
              dataKey: Global.currentFacility.name.basicInfo.medicalFacilityName
              style: 
                width: '0.1'
                height: '0.055'
                left: '0'
                top: "0.017"
                border: 
                  style: "1"
                borderRadius: "11"
                color: "0xffffff"
                backgroundColor: "0x003d68"
                textAlign: 
                  x: center
                  y: center
            - type: list
              contentType: listObject
              listObject: ..facilityAll.vertexResp.vertex
              iteratorVar: itemObject
              viewTag: facilityNameView
              style:
                width: '0.65'
                margin: '0'
                top: "0.017"
                left: '0'
                height: "0.055"
                axis: horizontal
                zIndex: "5"
              children:
                - type: listItem
                  itemObject: ""
                  onClick:
                    - actionType: evalObject
                      object: 
                        .Global._nonce@: 
                          =.builtIn.math.random: ""
                    - emit:
                        dataKey:
                          var: itemObject
                        actions:
                          - =.builtIn.array.addColor:
                              dataIn:
                                messages: =..facilityAll.vertexResp.vertex
                                id: $var.id
                                currentBackgroundColor: "0x003d68"
                                backgroundColor: "0xefefef"
                                fontColor: "0x517086"
                                currentFontColor: "0xffffff"
                          - .Global.formData.locationId@: $var.id
                          - ..fac_RootNotebook.edgeReq.id@: $var.id
                          - =..fac_RootNotebook.edgeAPI.get: ""
                          - ..facility.documentReq.id@: =..fac_RootNotebook.edge.edge.0.id
                          - ..BusinessLogo.docIn.id@: =..fac_RootNotebook.edge.edge.0.id
                          - ..Profile.docIn.id@: =..fac_RootNotebook.edge.edge.0.id
                          - =..facility.docAPI.get: ""
                          - =..BusinessLogo.docAPI.get: ""
                          - =..Profile.docAPI.get: ""

                    #       # - .Global.jwt.edge.bvid@: $var.id
                    #       # - =.Global.jwt.edgeAPI.store: ""
                    - actionType: evalObject
                      object: 
                        - ..facility.document@: =..facility.response.doc.0
                        - if: 
                          - =..BusinessLogo.resp.doc.0
                          - actionType: evalObject
                            object:
                              - =.builtIn.utils.prepareDoc:
                                  dataIn:
                                    doc: =..BusinessLogo.resp.doc.0
                                  dataOut: FacilityInfo1.BusinessLogo.resp
                              - ..BusinessLogo.url@: =..BusinessLogo.resp.name.data
                          - continue
                        - if: 
                          - =..Profile.resp.doc.0
                          - actionType: evalObject
                            object:
                              - =.builtIn.utils.prepareDoc:
                                  dataIn:
                                    doc: =..Profile.resp.doc.0
                                  dataOut: FacilityInfo1.Profile.resp
                              - ..Profile.url@: =..Profile.resp.name.data
                          - continue

                    - actionType: builtIn
                      funcName: redraw
                      viewTag: facilityNameView
                    - actionType: builtIn
                      funcName: redraw
                      viewTag: facilityProfileView
                  style:
                    width: '0.1'
                    height: '0.055'
                    left: '0'
                    border: 
                      style: "1"
                    borderRadius: "5"
                    backgroundColor: itemObject.backgroundColor
                  children:
                    - type: label
                      dataKey: itemObject.name.basicInfo.medicalFacilityName
                      style: 
                        left: "0"
                        width: "0.1"
                        height: "0.055"
                        color: itemObject.fontColor
                        textAlign: 
                          x: center
                          y: center
            # - .ProviderButton: 
            #   text: Add Facility
            #   # onClick: 
            #   #   - goto: AddLocation
            #   style:
            #     left: "0.5"
            #     fontSize: "15"
            #     backgroundColor: "#003D68"
            #     color: "0xffffff"
            #     textDecoration: underline
            # - .Edimage:
            #   path: "!.png"
            #   style:
            #     width: "0.005"
            #     left: "0.66"
            #     top: "0.012"
            - .EdLabel:
              text: Add Location
              onClick: 
                - goto: AddLocation
              style:
                height: "0.055"
                width: "0.08"
                fontSize: "1.8vh"
                top: "0.024"
                left: "0.7"
                textDecoration: underline
                color: "0x005795"
                # backgroundColor: "0xcdcdcd"
                textAlign: 
                  x: center
    - .ContentView:
      viewTag: facilityProfileView
      style: 
        height: "0.82"
        left: "0.19"
        top: "0.145"
        zIndex: "10"
      children:
        - type: label
          text: "Basic Info"
          style:
            fontSize: "25"
            left: "0.015"
            top: "0.02"
            color: "#517086"
        - type: label
          text: "Business Logo"
          style:
            fontSize: "15"
            left: "0.03"
            top: "0.07"
        - type: image
          path: 
            emit: 
              actions: 
                - if: 
                  - =..BusinessLogo.resp.name.data
                  - ..BusinessLogo.url
                  - BusinessLogo.png
          contentType: file
          style:
            height: "0.08"
            top: '0.135'
            left: '0.03'
        - type: label
          text: "Profile Picture"
          style:
            fontSize: "15"
            left: "0.23"
            top: "0.07"
        - type: image
          path: 
            emit: 
              actions: 
                - if: 
                  - =..Profile.resp.name.data
                  - ..Profile.url
                  - Profile.png
          style:
            height: "0.12"
            top: '0.11'
            left: '0.23'
        # - type: image
        #   path: profile.png
        #   style:
        #     height: "0.12"
        #     top: '0.11'
        #     left: '0.28'
        # - type: image
        #   path: profile.png
        #   style:
        #     height: "0.12"
        #     top: '0.11'
        #     left: '0.33'
        - .BottomButton:
          text: "Edit Profile"
          onClick:
            # - actionType: evalObject
            #   object: 
            #     - =.builtIn.string.concat:
            #         dataIn:
            #           - "5353 Balboa Blvd #104"
            #           - ","
            #           - =..facility.document.name.data.basicInfo.city
            #           - " "
            #           - =..facility.document.name.data.basicInfo.zipCode   
            #         dataOut: FacilityInfo1.flag
            #     - =.builtIn.search.transformGeo:
            #         dataIn: 
            #           query: =.FacilityInfo1.flag
            #         dataOut: FacilityInfo1.flag1
            - actionType: evalObject
              object:
                
                - if: 
                  - =.builtIn.string.equal:
                      dataIn: 
                        string1: =.Global.auth.MFI.edit
                        string2: true 
                  - goto: EditFacilityInfo
                  - actionType: popUp
                    popUpView: mFIAuthEdit
            
          style:
            left: "0.65"
            top: "0.04"
            fontFamily: sans-serif
            fontSize: "1.7vh"
            color: "0xffffff"
            backgroundColor: "#005795"
            width: "0.11"
        - type: view
          style:
            borderRadius: "5"
            border: 
              style: "3"
            borderColor: "0xeaeaea"
            borderWidth: "1"
            width: "0.72"
            left: '0.03'
            height: "0.09"
            top: "0.27"
          children:
            - type: view
              style: 
                width: "0.72"
                height: "0.04"
                top: "0"
                left: "0"
                backgroundColor: "#EAEAEA"
              children: 
                - .FacilityInfoTitle:
                  text: Medical Facility Name
                - .FacilityInfoTitle:
                  style: 
                    left: "0.2"
                  text: Office Phone Number
                - .FacilityInfoTitle:
                  style: 
                    left: "0.33"
                  text: Specialty
                - .FacilityInfoTitle:
                  style: 
                    left: "0.45"
                  text: NPI 
                - .FacilityInfoTitle:
                  style: 
                    left: "0.58"
                  text: Tax ID 
            - .FacilityInfoText:   
              dataKey: facility.document.name.data.basicInfo.medicalFacilityName  
            - .Eddivider:
            - .FacilityInfoText:  
              style: 
                left: "0.2" 
              dataKey: facility.document.name.data.basicInfo.phoneNumber  
            - .Eddivider:
              style:
                left: "0.33"
            - .FacilityInfoText:  
              style: 
                left: "0.33" 
              dataKey: facility.document.name.data.basicInfo.specialty   
            - .Eddivider:
              style:
                left: "0.45"    
            - .FacilityInfoText:  
              style: 
                left: "0.45" 
              dataKey: facility.document.name.data.basicInfo.NPI  
            - .Eddivider:
              style:
                left: "0.58"   
            - .FacilityInfoText:  
              style: 
                left: "0.58" 
              dataKey: facility.document.name.data.basicInfo.taxId 
        - type: view
          style:
            borderRadius: "5"
            border: 
              style: "3"
            borderColor: "0xeaeaea"
            borderWidth: "1"
            width: "0.72"
            left: '0.03'
            height: "0.09"
            top: "0.4"
          children:
            - type: view
              style: 
                width: "0.72"
                height: "0.04"
                top: "0"
                left: "0"
                backgroundColor: "#EAEAEA"
              children: 
                - .FacilityInfoTitle:
                  text: Address
                - .FacilityInfoTitle:
                  style: 
                    left: "0.2"
                  text: City
                - .FacilityInfoTitle:
                  style: 
                    left: "0.33"
                  text: State
                - .FacilityInfoTitle:
                  style: 
                    left: "0.45"
                  text: Zipcode 
                # - .FacilityInfoTitle:
                #   style: 
                #     left: "0.58"
                #   text: Tax ID 
            - .FacilityInfoText:   
              dataKey: facility.document.name.data.basicInfo.address 
            - .Eddivider:
            - .FacilityInfoText:  
              style: 
                left: "0.2" 
              dataKey: facility.document.name.data.basicInfo.city  
            - .Eddivider:
              style:
                left: "0.33"
            - .FacilityInfoText:  
              style: 
                left: "0.33" 
              dataKey: facility.document.name.data.basicInfo.state   
            - .Eddivider:
              style:
                left: "0.45"    
            - .FacilityInfoText:  
              style: 
                left: "0.45" 
              dataKey: facility.document.name.data.basicInfo.zipCode  
            # - .Eddivider:
            #   style:
            #     left: "0.58"   
            # - .FacilityInfoText:  
            #   style: 
            #     left: "0.58" 
            #   dataKey: facility.document.name.data.basicInfo.taxId 
        - type: view
          style:
            borderRadius: "5"
            border: 
              style: "3"
            borderColor: "0xeaeaea"
            borderWidth: "1"
            width: "0.72"
            left: '0.03'
            height: "0.19"
            top: "0.54"
          children:
            - type: view
              style: 
                width: "0.72"
                height: "0.04"
                top: "0"
                left: "0"
                backgroundColor: "#EAEAEA"
              children: 
                - .FacilityInfoTitle:
                  text: Introduction
            - .FacilityInfoText:  
                  style: 
                    width: "0.72"
                    top: "0.05"
                    height: "0.15"
                    textAlign: 
                      y: top
              dataKey: facility.document.name.data.basicInfo.introduction 

              
