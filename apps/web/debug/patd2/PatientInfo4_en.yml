PatientInfo4:
  title: 'Patient Info 4'
  init: 
    - .SignInCheck

    # 判断是否有签名的存在
    - actionType: evalObject
      object:
        - if:
          - =.Global.formData.cov19Test.name.data.signaturePatientInfo4
          - ..temporarySignature@: =.Global.formData.cov19Test.name.data.signaturePatientInfo4
          - continue
    # 判断显示签名的id是否为空
    - if:
        - =.builtIn.string.equal:
            dataIn:
              string1: =..temporarySignature
              string2: ""
        - continue
        # 非空修改显示的标识,刷新签名区域
        - actionType: evalObject
          object:
            - ..flag@: block
            - actionType: builtIn
              funcName: redraw
              viewTag: signatureShowTag
  # 获取暂存的签名的id
  temporarySignature: ""
  # 签名的显示,默认为none
  flag: "none"

  informedConsent:
    - num: a. 
      text: I understand that I may be infected with the virus causing COVID-19 and that I meet criteria for isolation.
    - num: b. 
      text: I agree that while I wait for my COVID-19 test results, I will remain in self-isolation.
    - num: c. 
      text: I agree that if my COVID-19 test results are positive, I will remain isolated for 7 days from this day of testing OR until at least 72 hours after my symptoms have resolved, whichever is longer.
    - num: d. 
      text: I agree that if my COVID-19 test results are negative, I will remain isolated until at least 72 hours after my symptoms have resolved.
    - num: e. 
      text: I understand that if I am not isolated while ill, I could pose a substantial threat to the health of other persons.
    - num: f. 
      text: I agree that I will not come into contact with any other person who is not isolated or ill due to potential COVID- 19 infection.
    - num: g. 
      text: I understand that if I test positive for IgM antibody, I may need to take a COVID-19 swab test for active virus confirmation. 
    - num: h. 
      text: I understand that testing positive for antibody does not mean immunity to COVID-19
  newSign:
    docRes: ""
    document: #DOC
      .Document: ""
      type: .DocType.Signature1
      name:
        title: ""
        type: ..newSign.document.subtype.mediaType
        data: "" 
      # eid: .Global.formData.cov19Test.id
      eid: .Global.rootNotebookID
      reid: .Global.formData.cov19Test.id
      subtype:
        mediaType: "" # mediaType : "image/jpeg"        
    docAPI: # DOCAPI   
      store:
        api: cd
        dataIn: newSign.document 
        # dataOut: Global.formData.signature1
        dataOut: PatientInfo4.newSign.docRes 
  components:
    - .BaseHeader:
    - .HeaderLeftButton:
      style:
        backgroundColor: "0x2988e6"  
    - type: scrollView 
      style: 
        height: "0.82"
        width: "1"
        top: "0.1"
        left: "0"
      children:
        - type: image
          path: patientInfo5_4.svg
          style:
            left: '0.07'
            marginTop: "0.02"
            height: "auto"
            width: "0.86"
        - type: label
          text: AGREEMENT FOR SELF-ISOLATION
          style:
            width: "0.86"
            left: "0.07"
            fontWeight: "650"
            marginTop: "0.02"
            fontSize: "18"
            height: "0.04"
            border:
              style: "2"
            borderColor: "#DEDEDF"
            borderWidth: "1"
        - type: label
          text: The local health jurisdiction has determined that if you are under suspicion for having COVID-19 due to symptoms and testing request, that it is necessary to be placed in isolation in order to prevent the transmission of this infection. It is important for you to comply with this Isolation Agreement in order to protect the public’s health. Thank you for agreeing to cooperate.
          style:
            width: "0.86"
            left: '0.07'
            marginTop: '0.02'
            fontSize: "14"
        - type: label
          text: "Please carefully read the following informed consent:"
          style:
            width: '0.86'
            left: "0.07"
            marginTop: "0.02"
            fontSize: '14'
            fontWeight: "600"
        - type: view
          style:
            width: "0.86"
            left: "0.07"
            marginTop: "0.01"
            height: "1.1"
          children:
            - type: list
              contentType: listObject
              listObject: ..informedConsent
              iteratorVar: itemObject
              style:
                width: '0.86'
                margin: '0'
                left: '0'
                height: "auto"
                marginTop: "0"
              children:
                - type: listItem
                  itemObject: 
                  style:
                    width: '0.86'
                    left: '0'
                    marginTop: '0.01'
                    height: "0.12"
                  children:
                    - type: label
                      dataKey: itemObject.num 
                      style:
                        width: "0.04"
                        height: "0.03"
                        top: "0"
                        left: "0"
                        fontWeight: "600"
                    - type: label
                      dataKey: itemObject.text
                      style:      
                        width: "0.8"
                        left: "0.06"
                        fontSize: "14"
                        height: "auto"
                        top: "0"
        - type: label
          text: "I the undersigned, have been informed about the test purpose, procedures, possible benefits and risks, and I have received a copy of this Informed consent. I have been given the opportunity to ask questions before I sign, and I have been told that I can ask other questions at any time. I voluntarily agree to testing for COVID-19 and to self-isolation.  If A&C Urgent Care does not accept my insurance I consent to being financially responsible for the testing. If my insurance denies covering the cost of the testing I consent to being financially responsible for the testing."
          style:
            marginTop: "0.02"
            left: "0.06"
            width: "0.84"
            fontSize: "12"
            color: "#707070"
        - type: label
          text: "clear"
          onClick:
            - actionType: removeSignature
              dataObject: BLOB
              dataKey: PatientInfo4.newSign.document.name.data   
              viewTag: signatureTag 
            # 显示签名区域隐藏
            - actionType: builtIn
              funcName: hide
              viewTag: signatureShowTag
            - actionType: builtIn
              funcName: show
              viewTag: signatureTag  
          style:
            left: "0.78"
            marginTop: "0.05"
            width: "0.12"
            fontSize: "14"
            height: '0.03'
            color: "0xffffff"
            border: 'none'
            borderRadius: "2"
            backgroundColor: '0xD53C42'
            zIndex: "100000"
            textAlign:
              y: center
              x: center     
        - type: view
          style: 
            left: "0.085"
            marginTop: "0.07"
            width: "0.8"
            height: "0.15"
            border:
              style: "4"
              width: "1.5"
              color: "0xacacac"
          children:
            # 签名区域
            - type: canvas
              dataKey: PatientInfo4.newSign.document.name.data 
              viewTag: signatureTag   
              style: 
                left: "0"
                width: "0.8"
                top: "0"
                height: "0.15"
                overflow: scroll  
                zIndex: "1000"
            # 显示暂存的签名
            - type: image
              viewTag: signatureShowTag
              path=func: .builtIn.utils.prepareDocToPath
              # 传入签名文档的id
              dataKey: PatientInfo4.temporarySignature
              style:
                # 控制显示
                display: ..flag
                left: "0"
                width: "0.8"
                top: "0"
                height: "0.15"
                overflow: scroll  
                zIndex: "1000"
        - type: view
          style:
            marginTop: "0.03"
            left: "0"
            height: "0.1"
            width: "1"
          children:        
            - type: label
              text: "Patient Name:"
              style:
                width: "0.4"
                left: "0.07"
                top: "0"
                color: "#707070"
                fontStyle: bold
            - type: label
              dataKey: Global.Profile.name.data.basicInfo.fullName
              style:
                width: "0.4"
                left: "0.4"
                top: "0"
        - type: view
          style:
            marginTop: "0.02"
            left: "0"
            with: "0"
            height: "0.05"
          children:
            - type: button
              text: Next
              onClick:
                - actionType: saveSignature
                  dataObject: BLOB
                  dataKey: PatientInfo4.newSign.document.name.data  
                - actionType: evalObject
                  object:
                    - if:
                      - =.builtIn.string.equal:
                          dataIn:
                            string1: =..newSign.document.name.data.size
                            string2: 980
                      - continue
                      - =..newSign.docAPI.store: ""   
                    # 存放签名的id
                    - if: 
                      - =..newSign.docRes.doc.id
                      - .Global.formData.cov19Test.name.data.signaturePatientInfo4@: =..newSign.docRes.doc.id
                      - continue                    
                - goto: BillingInfo
              style:
                height: "0.05"
                width: "0.76"
                left: "0.11"
                border: "none"
                fontSize: "14"
                top: "0"
                backgroundColor: "0x2988e6"
                color: "0xffffff"
                borderRadius: "5px"        
                textAlign:
                  x: center

