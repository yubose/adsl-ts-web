CreateAppointment1:
  title: "Create Appointment"
  pageNumber: "1960"
  init:
    - .SignInCheck
    - .Global.formData.patientChartLocal@: ""
    - .Global.formData.patientChartMeeting@: ""
    - ..visitQuestionnaire.docAPI.get
    - .Global.formData.patientChartShare@: false
    - actionType: evalObject
      object:
        .CreateAppointment1.visitQuestionnaireObject.document@: =..docResponse.doc.0
    - ..newAppointment.edge.name.duration@: =.Global.formData.appointment.duration
    - actionType: evalObject
      object:
        - =.builtIn.array.getListLength:
            dataIn:
              object: =.Global.formData.appointment.docu
            dataOut: CreateAppointment1.localDocuLength
    - actionType: evalObject
      object:
        - =.builtIn.array.getListLength:
            dataIn:
              object: =.Global.vaccine
            dataOut: CreateAppointment1.globalDocuLength
    - actionType: evalObject
      object:
        - =.builtIn.string.equal:
            dataIn:
              string1: =..localDocuLength
              string2: =..globalDocuLength
            dataOut: CreateAppointment1.otherFormRead
    - if:
        - =.builtIn.string.equal:
            dataIn:
              string1: =..localDocuLength
              string2: "0"
        - ..otherFormHid@: "true"
        - ..otherFormHid@: "false"
    - ..selectDate@: =.Global.formData.appointment.selectDate
    - =.builtIn.string.concat:
        dataIn:
          - =..selectDate
          - " at "
          - =.Global.clock.showTime
        dataOut: CreateAppointment1.selectDate
    - if:
        - =.builtIn.string.equal:
            dataIn:
              string1: =.Global.formData.appointment.visitType
              string2: "Telemedicine"
        - ..newAppointment.edge.name.fontColor@: "#30b354"
        - ..newAppointment.edge.name.fontColor@: "#ffc02d"
    - if:
        - =.builtIn.string.equal:
            dataIn:
              string1: =.Global.formData.appointment.visitType
              string2: "Telemedicine"
        - ..newAppointment.edge.name.blockColor@: "#e4f5e9"
        - ..newAppointment.edge.name.blockColor@: "#fff7e3"
    - actionType: evalObject
      object:
        - .Global.flag.isMeetingPatientchart@: false
        - .Global.formData.selectCategory@: CreateAppointment1
    - =.builtIn.array.transformArray:
        dataIn:
          array: =.Global.formData.appointment.docu
        dataOut: CreateAppointment1.formData.formList
    - =.builtIn.array.transformPage:
        dataIn:
          array: =..formData.formList
          type: "Edit"
          dataKey: "key"
        dataOut: CreateAppointment1.formData.docList
  formData:
    formList: []
    docList: [] # List 打印的表格
    cov19Test: ""
    doc: ""
    vaccineNum: 0
    vaccineDocNum: 0
    pifzerBioNTech: ""
    moderna: ""
    goto: ""
  selectDate: ""
  patient: .Global.middleInformation.PatientVisitInfo
  localDocuLength: ""
  globalDocuLength: ""
  otherFormRead: ""
  otherForm: ""
  otherFormHid: "false"
  data:
    purpose: ""
    anythingElse: ""
    isPrescribed: ""
    isProblems: ""
    problems: ""
    isToEmergency: ""
    toEmergency: ""
    isFamilyHistoryChanges: ""
    familyHistoryChanges: ""
    isNewDrug: ""
    newDrug: ""
    notes: ""
  visitQuestionnaireObject:
    document:
      type: .DocType.VisitQuestionnaire
      eid: .Global.rootNotebookID
      name:
        type: "application/json"
        data:
          purpose: ""
          anythingElse: ""
          isPrescribed: ""
          isProblems: ""
          problems: ""
          isToEmergency: ""
          toEmergency: ""
          isFamilyHistoryChanges: ""
          familyHistoryChanges: ""
          isNewDrug: ""
          newDrug: ""
          notes: ""
    docAPI:
      .DocAPI: ""
      store:
        api: cd
        dataKey: visitQuestionnaireObject.document
        subtype:
          mediaType: "application/json"
  visitQuestionnaire:
    # document:
    docAPI:
      .DocAPI: ""
      get:
        dataKey: docResponse
        id: .Global.rootNotebookID
        xfname: "eid"
        type: .DocType.VisitQuestionnaire
        _nonce: =.Global._nonce
  # subvisitQuestionnaire:

  docResponse:
    doc:
      - type: .DocType.VisitQuestionnaire # - type: "257" # private profile
        eid: .Global.rootNotebookID
        name: ""
    error: ""
    jwt: ""
  inviteInfo:
    edge:
      .Edge: ""
      type: .EdgeType.InviteInfo
      refid: ""
      bvid: .Global.currentUser.vertex.id
      # evid: "NzczFCtoRgYkcD3yEvGhRA=="
      name:
        phoneNumber: ""
        firstName: ""
        lastName: ""
        name: ""
        hostName: =.Global.Profile.name.data.basicInfo.fullName
        roomName: ""
        date: ""
    edgeAPI:
      # .EdgeAPI: ""
      store:
        api: ce
        dataKey: inviteInfo.edge
  flag: "" # to judge whether the PatientChart and VisitQuestionnaire have been both filled in.
  newAppointment:
    response: ""
    edge:
      .Edge: ""
      # evid: .Global.currentUser.vertex.id
      evid: .Global.ActiveProvider.bsig
      bvid: .Global.currentUser.vertex.id
      id: ""
      refid: "" #the_selected_time_slot_edge.id
      subtype: .Global.E2Subtype
      type: 40000
      name:
        patientName: =.Global.Profile.name.data.basicInfo.fullName
        patientPhoneNumber: .Global.currentUser.vertex.uid
        providerName: .Global.ActiveProvider.name.data.fullName
        patientAvatarId: .Global.Profile.name.data.avatar
        visitType: ""
        visitTypeShow: ""
        visitReason: ""
        Reason: "Cold"
        blockColor: ""
        fontColor: ""
        duration: ""
        date: ""
        facilityId: .Global.clock.bvid
        # document
    edgeAPI:
      .EdgeAPI: ""
      store:
        api: ce
        dataIn: newAppointment.edge
        dataOut: newAppointment.response
  save:
    - =.CreateAppointment1.newAppointment.edgeAPI.store: ""
    - .CreateAppointment1.apiRequest.approveAppointment.edge.refid@: =.CreateAppointment1.newAppointment.response.edge.id
    - .CreateAppointment1.apiRequest.approveAppointment.edge.evid@: =.CreateAppointment1.newAppointment.response.edge.evid
    - =.CreateAppointment1.apiRequest.approveAppointment.edgeAPI.store: ""
    - .CreateAppointment1.apiRequest.inviteFacility.edge.refid@: =.CreateAppointment1.newAppointment.response.edge.id
    - =.CreateAppointment1.apiRequest.inviteFacility.edgeAPI.store: ""
  apiRequest: #Input data request here
    approveAppointment:
      response: ""
      edge:
        bvid: .Global.currentUser.vertex.id
        refid: ""
        type: 40000
        subtype: 5
      edgeAPI:
        .EdgeAPI: ""
        store:
          api: ce
          dataIn: apiRequest.approveAppointment.edge
          dataOut: apiRequest.approveAppointment.response
    inviteFacility:
      response: ""
      edge:
        bvid: .Global.currentUser.vertex.id
        evid: .Global.clock.bvid
        refid: ""
        type: 40000
        subtype: 10
      edgeAPI:
        .EdgeAPI: ""
        store:
          api: ce
          dataIn: apiRequest.inviteFacility.edge
          dataOut: apiRequest.inviteFacility.response
    isContact: # 判断是否为好友
      response: ""
      edge:
        id: []
        xfname: bvid,evid
        type: 10002
        _nonce: =.Global._nonce
      docIn:
        type: 10002
        subtype: 65536
        tage: 1
        bvid: .Global.currentUser.vertex.id
        evid: ""
        name: ""
        refid: ""
      docOut: ""
      edgeAPI:
        store:
          api: ce
          dataIn: CreateAppointment1.apiRequest.isContact.docIn
          dataOut: CreateAppointment1.apiRequest.isContact.docOut
        get:
          api: re
          dataIn: CreateAppointment1.apiRequest.isContact.edge
          dataOut: CreateAppointment1.apiRequest.isContact.response
    getPatientProfile:
      response: ""
      docIn:
        type: 102401
        id: .Global.currentUser.vertex.id
        xfname: ovid
        obfname: "ctime"
        maxcount: "1"
      docOut: ""
      docAPI:
        get:
          api: rd
          dataIn: CreateAppointment1.apiRequest.getPatientProfile.docIn
          dataOut: CreateAppointment1.apiRequest.getPatientProfile.docOut
  components:
    - .ProgressCheckView: ""
      message: "loading ..."
      viewTag: uploading
    - .BaseHeader:
    - .HeaderLeftButton:
      onClick:
        - actionType: builtIn
          funcName: goBack
    - type: view
      style:
        width: "1"
        height: "0.4"
        left: "0"
        backgroundColor: "0x2988e6"
        top: "0.1"
      children:
        - .CA1label:
          text: "Date & Time Selected:"
          style:
            top: "0"
            width: "0.485"
            height: "0.035"
            fontSize: .Nfont.h2
            border:
              style: "2"
            borderWidth: "2"
            borderColor: "0xffffff99"
        - .CA1label:
          dataKey: selectDate
          # text: February 12,2021 at 9:45 AM
          style:
            fontSize: "4vw"
            width: "0.88"
            top: "0.05"
            fontWeight: "600"
        - .CA1label:
          text: "Type"
          style:
            top: "0.1"
            width: "0.38"
            height: "0.035"
            border:
              style: "2"
            borderWidth: "2"
            borderColor: "0xffffff99"
        - .CA1label:
          dataKey: Global.formData.appointment.visitType
          # text: Office Visits
          style:
            top: "0.14"
            fontSize: "19"
        - .CA1label:
          text: "Duration"
          style:
            top: "0.1"
            left: "0.6"
            width: "0.18"
            height: "0.035"
            border:
              style: "2"
            borderWidth: "2"
            borderColor: "0xffffff99"
        - .CA1label:
          dataKey: newAppointment.edge.name.duration
          style:
            top: "0.14"
            fontSize: "19"
            left: "0.6"
        - .CA1label:
          text: "Reason for Visit"
          style:
            top: "0.19"
            width: "0.38"
            height: "0.035"
            border:
              style: "2"
            borderWidth: "2"
            borderColor: "0xffffff99"
        - .CA1label:
          dataKey: Global.formData.appointment.reason
          # text: "Follow-UP"
          style:
            top: "0.23"
            fontSize: "19"
        - .CA1label:
          text: Provider
          style:
            top: "0.19"
            width: "0.38"
            left: "0.6"
            height: "0.035"
            border:
              style: "2"
            borderWidth: "2"
            borderColor: "0xffffff99"
        - .CA1label:
          dataKey: Global.ActiveProvider.name.data.fullName
          # text: Aomas Mueller
          style:
            top: "0.23"
            fontSize: "19"
            left: "0.6"
        - type: button
          text: "Change details"
          onClick:
            - actionType: builtIn
              funcName: goBack
          style:
            width: "0.5"
            height: "0.05"
            top: "0.3"
            left: "0.25"
            borderRadius: "50"
            color: "0xff0000"
            backgroundColor: "0xffffff"
            border:
              style: "3"
              width: "1"
              color: "0xff0000"
            borderColor: "0xff0000"
            fontSize: "18"
            fontFamily: "Arial"
            textAlign:
              x: center

    - type: scrollView
      style:
        top: "0.5"
        height: "0.42"
        width: "1"
        left: "0"
      children:
        - type: view
          style:
            marginTop: "0"
            width: "1"
            left: "0"
            height: "auto"
          children:
            - type: label
              text: Please complete visit questionnaire
              style:
                left: "0.1"
                marginTop: "0.04"
                height: "auto"
                width: "0.9"
                color: "0x2988e6"
                fontSize: "18"
            - type: view
              onClick:
                - goto: VisitQuestionnaire
              style:
                left: "0"
                width: "1"
                marginTop: "0.01"
                height: "0.04"
              children:
                - type: image
                  path:
                    emit:
                      actions:
                        - if:
                            - =.builtIn.string.equal:
                                dataIn:
                                  string1: =.Global.visitQuestionnaireDoc
                                  string2: "true"
                            - selectBlueOn.svg
                            - selectOff.svg
                  style:
                    left: "0.1"
                    top: "0.0025"
                    height: "0.03"
                - type: label
                  text: Visit Questionnaire
                  style:
                    left: "0.2"
                    top: "0"
                    width: "0.6"
                    height: "0.035"
                    fontSize: "16"
                    color: "0x2988e6"
                    textAlign:
                      y: center
            - type: list
              scrollable: false
              contentType: listObject
              listObject: ..formData.docList
              iteratorVar: itemObject
              style:
                margin: "0"
                marginTop: "0.01"
                left: "0"
                width: "1"
                height: "auto"
              children:
                - type: listItem
                  itemObject: ""
                  style:
                    left: "0"
                    marginTop: "0"
                    width: "1"
                    height: "0.05"
                  onClick:
                    - emit:
                        dataKey:
                          var: itemObject
                        actions:
                          - if:
                              - true
                              - goto: $var.pageName
                              - goto: $var.pageName
                          - .Global.formData.front_IDCard@: ""
                          - .Global.formData.front_InsuranceCard@: ""
                          - .Global.formData.back_InsuranceCard@: ""
                  children:
                    - type: image
                      path:
                        emit:
                          dataKey:
                            var: itemObject
                          actions:
                            - if:
                                - =.builtIn.array.has:
                                    dataIn:
                                      object: =.Global.vaccine
                                      value: $var.key
                                - selectBlueOn.svg
                                - selectOff.svg
                      style:
                        left: "0.1"
                        top: "0.0025"
                        height: "0.03"
                    - type: label
                      dataKey: itemObject.key
                      style:
                        top: "0"
                        color: "0x2988e6"
                        fontSize: "16"
                        width: "0.8"
                        left: "0.2"
                        height: "0.035"
                        textAlign:
                          x: left
                          y: center
        - type: view
          style:
            marginTop: "0"
            width: "1"
            left: "0"
            height: "auto"
          children:
            - type: label
              text: Optional Forms
              style:
                left: "0.1"
                marginTop: "0"
                height: "atuo"
                width: "0.9"
                color: "0x2988e6"
                fontSize: "18"
            - type: view
              onClick:
                - goto: PatientChart
              style:
                left: "0"
                width: "1"
                top: "0.05"
                height: "0.035"
              children:
                - type: image
                  path:
                    emit:
                      actions:
                        - if:
                            - =.builtIn.string.equal:
                                dataIn:
                                  string1: =.Global.patientChartDoc
                                  string2: "true"
                            - selectBlueOn.svg
                            - selectOff.svg
                  style:
                    left: "0.1"
                    top: "0.0025"
                    height: "0.03"
                - type: label
                  text: Patient Chart
                  style:
                    left: "0.2"
                    top: "0"
                    width: "0.4"
                    height: "0.035"
                    fontSize: "16"
                    color: "0x2988e6"
                    textAlign:
                      y: center
            - type: view
              onClick:
                - goto: GeneralInfo
              style:
                left: "0"
                width: "1"
                top: "0.095"
                height: "0.035"
              children:
                - type: image
                  path:
                    emit:
                      actions:
                        - if:
                            - =.builtIn.string.equal:
                                dataIn:
                                  string1: =.Global.generalInfoDoc
                                  string2: "true"
                            - selectBlueOn.svg
                            - selectOff.svg
                  style:
                    left: "0.1"
                    top: "0.0025"
                    height: "0.03"
                - type: label
                  text: General Information
                  style:
                    left: "0.2"
                    top: "0"
                    width: "0.5"
                    height: "0.035"
                    fontSize: "16"
                    color: "0x2988e6"
                    textAlign:
                      y: center
    - type: button
      text: "Create Appointment"
      onClick:
        - actionType: evalObject
          object:
            - ..newAppointment.edge.stime@: ""
            - ..newAppointment.edge.etime@: ""
            - ..newAppointment.edge.refid@: ""
            - ..newAppointment.edge.name.Reason@: ""
            - ..newAppointment.edge.stime@: =.Global.clock.stime
            - ..newAppointment.edge.etime@: =.Global.clock.etime
            - ..newAppointment.edge.refid@: =.Global.clock.refid
            - ..newAppointment.edge.name.Reason@: =.Global.formData.appointment.reason
            - ..newAppointment.edge.name.document@: =.Global.formData.appointment.docu
            - if:
                - =.builtIn.string.equal:
                    dataIn:
                      string1: =.Global.formData.appointment.visitType
                      string2: "Telemedicine"
                - ..newAppointment.edge.name.fontColor@: "0x30b354"
                - continue
            - if:
                - =.builtIn.string.equal:
                    dataIn:
                      string1: =.Global.formData.appointment.visitType
                      string2: "Office Visits"
                - ..newAppointment.edge.name.fontColor@: "0xff8c00"
                - continue
            - if:
                - =.builtIn.string.equal:
                    dataIn:
                      string1: =.Global.formData.appointment.visitType
                      string2: "Telemedicine"
                - ..newAppointment.edge.name.blockColor@: "0xe4f5e9"
                - continue
            - if:
                - =.builtIn.string.equal:
                    dataIn:
                      string1: =.Global.formData.appointment.visitType
                      string2: "Office Visits"
                - ..newAppointment.edge.name.blockColor@: "0xfff7e3"
                - continue
        - actionType: evalObject
          object:
            - =.builtIn.string.concat:
                dataIn:
                  - =.Global.formData.appointment.reason
                dataOut: CreateAppointment1.newAppointment.edge.name.visitReason
            - ..newAppointment.edge.name.visitType@: =.Global.formData.appointment.visitType
            - ..newAppointment.edge.name.visitTypeShow@: =.Global.formData.appointment.visitType
        - actionType: evalObject
          object:
            - =.builtIn.array.getListLength:
                dataIn:
                  object: =.Global.formData.appointment.docu
                dataOut: CreateAppointment1.formData.vaccineNum
            - =.builtIn.array.getListLength:
                dataIn:
                  object: =.Global.vaccine
                dataOut: CreateAppointment1.formData.vaccineDocNum
            - if:
                - =.builtIn.string.equal:
                    dataIn:
                      string1: =..formData.vaccineNum
                      string2: =..formData.vaccineDocNum
                - continue
                - actionType: popUp
                  popUpView: judgeOtherForm
                  wait: true
            - if:
                - =.builtIn.string.equal:
                    dataIn:
                      string1: =.Global.visitQuestionnaireDoc
                      string2: "true"
                - continue
                - actionType: popUp
                  popUpView: judgeVisitQuestionnaire
        - actionType: popUp
          popUpView: uploading
        - actionType: evalObject
          object:
            - if:
                - =.builtIn.string.equal:
                    dataIn:
                      string1: =.Global.visitQuestionnaireDoc
                      string2: "true"
                - actionType: evalObject
                  object: ..save
                - continue
            - if:
                - =.builtIn.string.equal:
                    dataIn:
                      string1: =.Global.visitQuestionnaireDoc
                      string2: "true"
                - =.builtIn.ecos.shareDoc:
                    dataIn:
                      sourceDoc: =.Global.formData.visitQuestionnaireDoc.doc
                      targetEdgeID: =..newAppointment.response.edge.id
                - continue
            - if:
                - =.builtIn.string.equal:
                    dataIn:
                      string1: =.Global.patientChartDoc
                      string2: "true"
                - =.builtIn.ecos.shareDoc:
                    dataIn:
                      sourceDoc: =.PatientChart.PatientChartObject
                      # targetEdgeID: =.Global.rootRoomInfo.edge.id
                      targetEdgeID: =..newAppointment.response.edge.id
                - continue
            - if:
                - =.builtIn.string.equal:
                    dataIn:
                      string1: =.Global.generalInfoDoc
                      string2: "true"
                - =.builtIn.ecos.shareDoc:
                    dataIn:
                      sourceDoc: =.GeneralInfo.generalInfo.document
                      # targetEdgeID: =.Global.rootRoomInfo.edge.id
                      targetEdgeID: =..newAppointment.response.edge.id
                - continue
            - if:
                - =.builtIn.array.has:
                    dataIn:
                      object: =.Global.vaccine
                      value: "PifzerBioNTech"
                - =.builtIn.ecos.shareDoc:
                    dataIn:
                      sourceDoc: =.Global.formData.pifzerBioNTech
                      targetEdgeID: =..newAppointment.response.edge.id
                    dataOut: CreateAppointment1.formData.pifzerBioNTech
                - continue
            # - if:
            #   - =.Global.formData.signature_pifzerBioNTech.doc
            #   - =.builtIn.ecos.shareDoc:
            #       dataIn:
            #         sourceDoc: =.Global.formData.signature_pifzerBioNTech.doc
            #         targetEdgeID: =..newAppointment.response.edge.id
            #         targetRoomName: "meetingRoom"
            #         targetFileID: =.CreateAppointment1.formData.pifzerBioNTech.doc.id
            #   - continue
            - if:
                - =.builtIn.array.has:
                    dataIn:
                      object: =.Global.vaccine
                      value: "Moderna"
                - =.builtIn.ecos.shareDoc:
                    dataIn:
                      sourceDoc: =.Global.formData.moderna
                      targetEdgeID: =..newAppointment.response.edge.id
                    dataOut: CreateAppointment1.formData.moderna
                - continue
        # shareDoc newPatientForm文档
        - actionType: evalObject
          object:
            - if:
                - =.Global.formData.newPatientForm.id
                - =.builtIn.ecos.shareDoc:
                    dataIn:
                      sourceDoc: =.Global.formData.newPatientForm
                      targetEdgeID: =..newAppointment.response.edge.id
                      targetRoomName: "meetingRoom"
                    dataOut: CreateAppointment1.formData.newPatientForm
                - continue
            # shareDoc pifzerVaccineFirDoseForm文档
            - if:
                - =.Global.formData.pifzerVaccineFirDoseForm.id
                - =.builtIn.ecos.shareDoc:
                    dataIn:
                      sourceDoc: =.Global.formData.pifzerVaccineFirDoseForm
                      targetEdgeID: =..newAppointment.response.edge.id
                      targetRoomName: "meetingRoom"
                    dataOut: CreateAppointment1.formData.pifzerVaccineFirDoseForm
                - continue
            # pifzerVaccineSecDoseForm
            - if:
                - =.Global.formData.pifzerVaccineSecDoseForm.id
                - =.builtIn.ecos.shareDoc:
                    dataIn:
                      sourceDoc: =.Global.formData.pifzerVaccineSecDoseForm
                      targetEdgeID: =..newAppointment.response.edge.id
                      targetRoomName: "meetingRoom"
                    dataOut: CreateAppointment1.formData.pifzerVaccineSecDoseForm
                - continue
            - if:
                - =.Global.formData.cov19TestNewPatForm.id
                - =.builtIn.ecos.shareDoc:
                    dataIn:
                      sourceDoc: =.Global.formData.cov19TestNewPatForm
                      targetEdgeID: =..newAppointment.response.edge.id
                      targetRoomName: "meetingRoom"
                    dataOut: CreateAppointment1.formData.cov19TestNewPatForm
                - continue
            - if:
                - =.Global.formData.cov19TestForm.id
                - =.builtIn.ecos.shareDoc:
                    dataIn:
                      sourceDoc: =.Global.formData.cov19TestForm
                      targetEdgeID: =..newAppointment.response.edge.id
                      targetRoomName: "meetingRoom"
                    dataOut: CreateAppointment1.formData.cov19TestForm
                - continue
            - if:
                - =.Global.formData.modernaVaccineFirDoseForm.id
                - =.builtIn.ecos.shareDoc:
                    dataIn:
                      sourceDoc: =.Global.formData.modernaVaccineFirDoseForm
                      targetEdgeID: =..newAppointment.response.edge.id
                      targetRoomName: "meetingRoom"
                    dataOut: CreateAppointment1.formData.modernaVaccineFirDoseForm
                - continue
            - if:
                - =.Global.formData.modernaVaccineSecDoseForm.id
                - =.builtIn.ecos.shareDoc:
                    dataIn:
                      sourceDoc: =.Global.formData.modernaVaccineSecDoseForm
                      targetEdgeID: =..newAppointment.response.edge.id
                      targetRoomName: "meetingRoom"
                    dataOut: CreateAppointment1.formData.modernaVaccineSecDoseForm
                - continue

        - actionType: evalObject
          object:
            - if:
                - =.Global.formData.cov19Test.doc
                - =.builtIn.ecos.shareDoc:
                    dataIn:
                      sourceDoc: =.Global.formData.cov19Test.doc
                      targetEdgeID: =..newAppointment.response.edge.id
                      targetRoomName: "meetingRoom"
                    dataOut: CreateAppointment1.formData.cov19Test
                - continue
        - actionType: evalObject
          object:
            - if:
                - =.Global.formData.signature0.doc
                - =.builtIn.ecos.shareDoc:
                    dataIn:
                      sourceDoc: =.Global.formData.signature0.doc
                      targetEdgeID: =..newAppointment.response.edge.id
                      targetRoomName: "meetingRoom"
                      targetFileID: =.CreateAppointment1.formData.cov19Test.doc.id
                - continue
            - if:
                - =.Global.formData.signature1.doc
                - =.builtIn.ecos.shareDoc:
                    dataIn:
                      sourceDoc: =.Global.formData.signature1.doc
                      targetEdgeID: =..newAppointment.response.edge.id
                      targetRoomName: "meetingRoom"
                      targetFileID: =.CreateAppointment1.formData.cov19Test.doc.id
                - continue
            - if:
                - =.Global.formData.front_IDCard.doc
                - =.builtIn.ecos.shareDoc:
                    dataIn:
                      sourceDoc: =.Global.formData.front_IDCard.doc
                      targetEdgeID: =..newAppointment.response.edge.id
                      targetRoomName: "meetingRoom"
                      # targetFileID: =.CreateAppointment1.formData.cov19Test.doc.id
                - continue
            - if:
                - =.Global.formData.front_InsuranceCard.doc
                - =.builtIn.ecos.shareDoc:
                    dataIn:
                      sourceDoc: =.Global.formData.front_InsuranceCard.doc
                      targetEdgeID: =..newAppointment.response.edge.id
                      targetRoomName: "meetingRoom"
                      # targetFileID: =.CreateAppointment1.formData.cov19Test.doc.id
                - continue
            - if:
                - =.Global.formData.front_InsuranceCard.doc
                - =.builtIn.ecos.shareDoc:
                    dataIn:
                      sourceDoc: =.Global.formData.back_InsuranceCard.doc
                      targetEdgeID: =..newAppointment.response.edge.id
                      targetRoomName: "meetingRoom"
                      # targetFileID: =.CreateAppointment1.formData.cov19Test.doc.id
                - continue
            - =.builtIn.ecos.shareDoc:
                dataIn:
                  sourceDoc: =.Global.Profile
                  targetEdgeID: =..newAppointment.response.edge.id
        - actionType: evalObject
          object:
            - if:
                - =.builtIn.string.equal:
                    dataIn:
                      string1: =.Global.visitQuestionnaireDoc
                      string2: "true"
                - actionType: evalObject
                  object:
                    - ..visitQuestionnaireObject.document.name.data@: =..data
                    - =.CreateAppointment1.visitQuestionnaireObject.docAPI.store: ""

                - continue
        - actionType: evalObject
          object:
            - if:
                - =..apiRequest.isContact.response.edge.0.id
                - continue
                - actionType: evalObject
                  object:
                    # get patient profile
                    - =..apiRequest.getPatientProfile.docAPI.get: ""
                    - ..apiRequest.isContact.docIn.evid@: =.Global.ActiveProvider.bsig
                    - =..apiRequest.isContact.edgeAPI.store: ""
                    - =.builtIn.ecos.shareDoc:
                        dataIn:
                          sourceDoc: =..apiRequest.getPatientProfile.docOut.doc.0
                          targetEdgeID: =..apiRequest.isContact.docOut.edge.id
        - actionType: popUpDismiss
          popUpView: uploading
        - actionType: popUp
          popUpView: createSuccessView
      style:
        width: "0.7"
        left: "0.15"
        height: "0.05"
        top: "0.93"
        fontSize: "18"
        color: "0xffffff"
        backgroundColor: "0x2988e6"
        borderRadius: "3"
        fontFamily: "Arial"
        textAlign:
          x: center
    - .BaseCheckView: ""
      message: "You have not filled in the Patient Chart"
      viewTag: judgePatientChart
      colorChange: "0x2988e6"
      imgPath: aboutBlue.svg
      children:
        - type: view
          style:
            width: "0.8"
            height: "0.3"
            top: "0.3"
            left: "0.1"
            zIndex: "100"
            backgroundColor: "0xffffff"
            borderRadius: "7"
            border:
              style: "3"
            borderColor: "#f4f8fa"
            borderWidth: "3"
          children:
            - .BaseCheckViewImg:
            - .BaseCheckViewLabel:
            - .BaseCheckViewButton:
              onClick:
                - actionType: popUpDismiss
                  popUpView: judgePatientChart
    - .TipsMultiLine:
      viewTag: judgeVisitQuestionnaire
      message: "You have not filled in the Visit Questionnaire"                  
    # - .BaseCheckView: ""
    #   message: "You have not filled in the Visit Questionnaire"
    #   viewTag: judgeVisitQuestionnaire
    #   colorChange: "0x2988e6"
    #   imgPath: aboutBlue.svg
    #   children:
    #     - type: view
    #       style:
    #         width: "0.8"
    #         height: "0.3"
    #         top: "0.3"
    #         left: "0.1"
    #         zIndex: "100"
    #         backgroundColor: "0xffffff"
    #         borderRadius: "7"
    #         border:
    #           style: "3"
    #         borderColor: "#f4f8fa"
    #         borderWidth: "3"
    #       children:
    #         - .BaseCheckViewImg:
    #         - .BaseCheckViewLabel:
    #         - .BaseCheckViewButton:
    #           onClick:
    #             - actionType: popUpDismiss
    #               popUpView: judgeVisitQuestionnaire
    - .BaseCheckView: ""
      message: "You have not filled in the other forms"
      viewTag: judgeOtherForm
      colorChange: "0x2988e6"
      imgPath: aboutBlue.svg
      children:
        - type: view
          style:
            width: "0.8"
            height: "0.3"
            top: "0.3"
            left: "0.1"
            zIndex: "100"
            backgroundColor: "0xffffff"
            borderRadius: "7"
            border:
              style: "3"
            borderColor: "#f4f8fa"
            borderWidth: "3"
          children:
            - .BaseCheckViewImg:
            - .BaseCheckViewLabel:
            - .BaseCheckViewButton:
              onClick:
                - actionType: popUpDismiss
                  popUpView: judgeOtherForm
    - type: popUp
      viewTag: createSuccessView
      style:
        width: "0.88"
        height: "0.3"
        top: "0.3"
        left: "0.06"
        borderRadius: "20"
        zIndex: "100"
        backgroundColor: "0xeaeaea"
      children:
        - type: label
          text: You have created an appointment successfully
          style:
            .LabelStyle:
              left: "0"
              top: "0.08"
              width: "0.89333"
              height: "0.05"
              color: "0x000000"
              fontSize: "19"
              display: inline
              # fontStyle: "bold"
              fontFamily: "sans-serif"
              textAlign:
                x: center
                y: center
        - type: button
          text: ok
          style:
            width: "0.6"
            left: "0.14"
            height: "0.05"
            top: "0.2"
            fontSize: "20"
            color: "0x000000"
            textAlign:
              x: center
            border:
              style: "1"
              color: "0x000000"
          onClick:
            - goto: PatientDashboard
