Cov19Test:
  title: "Patient Info 1"
  init:
    - .SignInCheck

    - actionType: evalObject #android use calendar init
      object:
        - .BaseComponents.calendarDate.year@: ""
        - .BaseComponents.calendarDate.month@: ""
        - .BaseComponents.calendarDate.day@: ""
        - .BaseComponents.calendarDate.monthName@: ""
        - .BaseComponents.calendarDate.todayDate@: ""
        - .BaseComponents.calendarDate.flag@: ""
        - .BaseComponents.calendarDate.dayLable@: []
        - .BaseComponents.year@: []
        - .BaseComponents.flag: ""
        #生成年份
        - =.builtIn.date.generateYear:
            dataIn:
              last: 121
              next: 10
            dataOut: BaseComponents.year
        - =.builtIn.date.getYear:
            dataIn:
            dataOut: Cov19Test.calendarDate.year
    - actionType: evalObject #android use calendar init
      object: .BaseComponents.getDate
    - actionType: evalObject #android use calendar init
      object: .BaseComponents.getShow
    - actionType: evalObject
      object:
        - ..calendarDate@: =.BaseComponents.calendarDate
    - actionType: evalObject #IOS use calendar init
      object:
        - =.builtIn.date.getMonth:
            dataIn:
            dataOut: Cov19Test.calendarDate.month
        - =.builtIn.date.getYear:
            dataIn:
            dataOut: Cov19Test.calendarDate.year
        - =.builtIn.date.getDate:
            dataIn:
            dataOut: Cov19Test.calendarDate.day
    - actionType: evalObject #IOS use calendar init
      object:
        - =.builtIn.date.calendarArray:
            dataIn:
              year: =.Cov19Test.calendarDate.year
              month: =.Cov19Test.calendarDate.month
              today: =.Cov19Test.calendarDate.day
            dataOut: Cov19Test.calendarDate.dayLable
        - =.builtIn.date.transformMonth:
            dataIn:
              month: =.Cov19Test.calendarDate.month
            dataOut: Cov19Test.calendarDate.monthName
        - =.builtIn.date.ShowDateByNumber:
            dataIn:
              year: =.Cov19Test.calendarDate.year
              month: =.Cov19Test.calendarDate.month
              day: =.Cov19Test.calendarDate.day
              formatType: "Y-M-D"
            dataOut: Cov19Test.calendarDate.todayDate
    - if:
        - =.Global.formData.cov19Test.id
        - ..patientInfo@: =.Global.formData.cov19Test.name.data.patientInfo
        - continue
    - actionType: evalObject
      object:
        - .BaseComponents.calendarDate@: =.Cov19Test.calendarDate
        - ..formData.gender@: =.Global.formData.cov19Test.doc.name.data.patientInfo.gender
        - ..formData.state@: =.Global.formData.cov19Test.doc.name.data.patientInfo.state
        - ..formData.patientInfo.dateOfBirth@: =.Global.formData.cov19Test.doc.name.data.patientInfo.dateOfBirth
    - if:
        - =.Global.formData.firstToCov19Test
        - actionType: evalObject
          object:
            - ..cov19Chart.docReq.name.data@: =.Cov19TestDM.patientChart
            - ..patientInfo@: =.Cov19TestDM.patientChart.patientInfo
            - =..cov19Chart.docAPI.store: ""
            - ..patientInfo.address@: =.Global.Profile.name.data.address
            - ..formData.patientInfo.dateOfBirth@: =.Global.Profile.name.data.birth
            - ..patientInfo.email@: =.Global.Profile.name.data.email
            - ..patientInfo.firstName@: =.Global.Profile.name.data.firstName
            - ..patientInfo.lastName@: =.Global.Profile.name.data.lastName
            - ..patientInfo.mainContact@: =.Global.Profile.name.data.phone
            - ..patientInfo.middleName@: =.Global.Profile.name.data.middleName
            - if:
                - =.Global.Profile.name.data.Address.city
                - ..patientInfo.city@: =.Global.Profile.name.data.Address.city
                - continue
            - if:
                - =.Global.Profile.name.data.Address.state
                - ..formData.state@: =.Global.Profile.name.data.Address.state
                - continue
            - if:
                - =.Global.Profile.name.data.Address.zip
                - ..patientInfo.zipCode@: =.Global.Profile.name.data.Address.zip
                - continue
        - continue
  patientInfo: ""
  cov19Chart:
    docResp: ""
    docReq:
      id: ""
      eid: .Global.rootNotebookID
      type: .DocType.Cov19Chart
      name:
        data: ""
        title: "Cov19 Test"
        user: .Global.Profile.name.data.basicInfo.fullName
    docAPI:
      store:
        api: cd
        dataIn: Cov19Test.cov19Chart.docReq
        # dataOut: Global.formData.cov19Test
        dataOut: Cov19Test.cov19Chart.docResp
  patientInfoTemp:
    name:
      - key: firstName
        value: FirstName
      - key: middleName
        value: Middle Name
      - key: lastName
        value: Last Name
    address:
      - key: address
        value: address
    city:
      - key: city
        value: City
    zipCode:
      - key: zipCode
        value: Zip code
    other:
      - key: residence
        value: Patient county of residence
      - key: mainContact
        value: Phone number (Main Contact)
      - key: alternativePhone
        value: Alternative phone number
      - key: email
        value: Email
      - key: employer
        value: Employer
      - key: occupation
        value: Occupation
    emergencyContact:
      - key: name
        value: Name
      - key: relation
        value: Relation
      - key: phoneNumber
        value: Phone number
  formData:
    patientInfo:
      dateOfBirth: " "
    gender: " "
    state: " "
  calendarDate:
    year: ""
    month: ""
    day: ""
    monthName: ""
    todayDate: ""
    dayLable: []
  components:
    - .BaseHeader:
    - .HeaderLeftButton:
    - type: scrollView
      style:
        left: "0"
        width: "1"
        height: "0.9"
        top: "0.1"
        overflow: scroll
      children:
        - type: image
          path: patientInfo5_1.svg
          style:
            top: "0"
            height: "0.05"
            width: "0.9"
            left: "0.05"
        - type: view
          style:
            top: "0.06"
            left: "0"
            height: "1.4"
            width: "1"
          children:
            - type: label
              text: Patient Info
              style:
                fontFamily: "Poppins"
                left: "0.08"
                marginTop: "0"
                width: "0.9"
                fontStyle: bold
                height: "0.05"
                fontSize: "20"
            - type: view
              style:
                width: "0.84"
                left: "0.08"
                height: "0.001"
                marginTop: "0"
                border:
                  style: "5"
                backgroundColor: "#dededf"
            - type: view
              style:
                width: "1"
                height: "0.08"
                marginTop: "0.02"
                left: "0"
              children:
                - type: list
                  contentType: listObject
                  listObject: ..patientInfoTemp.name
                  iteratorVar: itemObject
                  style:
                    axis: horizontal
                    width: "0.92"
                    height: "0.065"
                    marginTop: "0.02"
                    left: "0.08"
                    margin: "0"
                  children:
                    - type: listItem
                      itemObject:
                      style:
                        width: "0.3"
                        height: "0.065"
                        left: "0"
                        marginTop: "0"
                      children:
                        - type: label
                          style:
                            fontFamily: "Arial"
                            fontSize: "13"
                            left: "0"
                            height: "0.02"
                            width: "0.25"
                            top: "0"
                          dataKey: itemObject.value
                        - type: textField
                          style:
                            top: "0.03"
                            left: "0"
                            height: "0.03"
                            width: "0.25"
                            border:
                              style: "3"
                              color: "#dededf"
                            borderWidth: "1"
                            borderRadius: "3"
                          placeholder:
                            emit:
                              dataKey:
                                var: itemObject
                              actions:
                                - =.builtIn.object.get:
                                    dataIn:
                                      object: =..patientInfo
                                      key: $var.key
                          dataValue:
                            emit:
                              dataKey:
                                var: itemObject
                              actions:
                                - =.builtIn.object.get:
                                    dataIn:
                                      object: =..patientInfo
                                      key: $var.key
                          dataKey: itemObject.dataValue
                          onChange:
                            emit:
                              dataKey:
                                var: itemObject # itemObject.value to the input field
                              actions:
                                - =.builtIn.object.set:
                                    dataIn:
                                      object: =..patientInfo
                                      key: $var.key
                                      value: $var.dataValue
            - type: view
              style:
                marginTop: "0.02"
                left: "0"
                width: "1"
                height: "0.065"
              children:
                - type: view
                  style:
                    top: "0"
                    left: "0.08"
                    width: "0.4"
                    height: "0.065"
                  children:
                    - type: label
                      style:
                        fontFamily: "Arial"
                        fontSize: "13"
                        left: "0"
                        height: "0.02"
                        width: "0.4"
                        top: "0"
                      text: Date of Birth
                    - .patientInfo1_TextField:
                      viewTag: birthTag
                      placeholder:
                        emit:
                          dataKey:
                            var: itemObject
                          actions:
                            - =.builtIn.object.get:
                                dataIn:
                                  object: =..formData.patientInfo
                                  key: dateOfBirth
                      dataKey: formData.patientInfo.dateOfBirth
                      onClick:
                        - actionType: popUp
                          popUpView: birthDay
                      style:
                        width: "0.4"
                - type: view
                  style:
                    top: "0"
                    left: "0.55"
                    width: "0.4"
                    height: "0.065"
                  children:
                    - type: label
                      style:
                        fontFamily: "Arial"
                        fontSize: "13"
                        left: "0"
                        height: "0.02"
                        width: "0.25"
                        top: "0"
                      text: Gender
                    - type: select
                      dataKey: formData.gender
                      options:
                        - Please select
                        - Male
                        - Female
                      style:
                        width: "0.3"
                        height: "0.035"
                        left: "0"
                        top: "0.03"
                        border:
                          style: "3"
                          color: "#dededf"
            - type: view
              style:
                marginTop: "0.02"
                width: "1"
                height: "0.065"
                left: "0"
              children:
                - type: list
                  contentType: listObject
                  listObject: ..patientInfoTemp.address
                  iteratorVar: itemObject
                  style:
                    top: "0"
                    width: "1"
                    height: "0.065"
                    left: "0"
                    margin: "0"
                  children:
                    - type: listItem
                      itemObject:
                      style:
                        width: "0.92"
                        left: "0.08"
                      children:
                        - type: label
                          style:
                            fontFamily: "Arial"
                            fontSize: "13"
                            left: "0"
                            height: "0.02"
                            width: "0.6"
                            top: "0"
                          text: Patient's address
                        - type: textField
                          style:
                            top: "0.03"
                            left: "0"
                            height: "0.03"
                            width: "0.82"
                            border:
                              style: "3"
                              color: "#dededf"
                            borderWidth: "1"
                            borderRadius: "3"
                          placeholder:
                            emit:
                              dataKey:
                                var: itemObject
                              actions:
                                - =.builtIn.object.get:
                                    dataIn:
                                      object: =..patientInfo
                                      key: $var.key
                          dataValue:
                            emit:
                              dataKey:
                                var: itemObject
                              actions:
                                - =.builtIn.object.get:
                                    dataIn:
                                      object: =..patientInfo
                                      key: $var.key
                          dataKey: itemObject.dataValue
                          onChange:
                            emit:
                              dataKey:
                                var: itemObject # itemObject.value to the input field
                              actions:
                                - =.builtIn.object.set:
                                    dataIn:
                                      object: =..patientInfo
                                      key: $var.key
                                      value: $var.dataValue
            - type: view
              style:
                marginTop: "0.02"
                width: "1"
                height: "0.065"
                left: "0"
              children:
                - type: view
                  style:
                    top: "0"
                    width: "1"
                    height: "0.065"
                    left: "0"
                  children:
                    - type: list
                      contentType: listObject
                      listObject: ..patientInfoTemp.city
                      iteratorVar: itemObject
                      style:
                        width: "1"
                        height: "0.065"
                        left: "0"
                        top: "0"
                        margin: "0"
                      children:
                        - type: listItem
                          itemObject:
                          style:
                            width: "0.92"
                            left: "0.08"
                          children:
                            - type: label
                              style:
                                fontFamily: "Arial"
                                fontSize: "13"
                                left: "0"
                                height: "0.02"
                                width: "0.25"
                                top: "0"
                              text: City
                            - .patientInfo1_TextField:
                              placeholder:
                                emit:
                                  dataKey:
                                    var: itemObject
                                  actions:
                                    - =.builtIn.object.get:
                                        dataIn:
                                          object: =..patientInfo
                                          key: $var.key
                              dataValue:
                                emit:
                                  dataKey:
                                    var: itemObject
                                  actions:
                                    - =.builtIn.object.get:
                                        dataIn:
                                          object: =..patientInfo
                                          key: $var.key
                              dataKey: itemObject.dataValue
                              onChange:
                                emit:
                                  dataKey:
                                    var: itemObject # itemObject.value to the input field
                                  actions:
                                    - =.builtIn.object.set:
                                        dataIn:
                                          object: =..patientInfo
                                          key: $var.key
                                          value: $var.dataValue
                              style:
                                width: "0.4"
                - type: view
                  style:
                    top: "0"
                    left: "0.55"
                    width: "0.2"
                    height: "0.065"
                  children:
                    - .patientInfo1_Label:
                      text: State
                    - type: select
                      dataKey: formData.state
                      options: .SelectINformationDM.state
                      style:
                        width: "0.15"
                        height: "0.035"
                        left: "0"
                        top: "0.03"
                        border:
                          style: "3"
                          color: "#dededf"
                - type: view
                  style:
                    width: "0.25"
                    height: "0.065"
                    left: "0.75"
                    top: "0"
                  children:
                    - type: list
                      contentType: listObject
                      listObject: ..patientInfoTemp.zipCode
                      iteratorVar: itemObject
                      style:
                        left: "0"
                        width: "0.25"
                        margin: "0"
                        height: "0.065"
                        top: "0"
                      children:
                        - type: listItem
                          itemObject:
                          style:
                            width: "0.25"
                            height: "0.065"
                            left: "0"
                            marginTop: "0"
                          children:
                            - .patientInfo1_Label:
                              text: Zip code
                            - .patientInfo1_TextField:
                              placeholder:
                                emit:
                                  dataKey:
                                    var: itemObject
                                  actions:
                                    - =.builtIn.object.get:
                                        dataIn:
                                          object: =..patientInfo
                                          key: $var.key
                              dataValue:
                                emit:
                                  dataKey:
                                    var: itemObject
                                  actions:
                                    - =.builtIn.object.get:
                                        dataIn:
                                          object: =..patientInfo
                                          key: $var.key
                              dataKey: itemObject.dataValue
                              onChange:
                                emit:
                                  dataKey:
                                    var: itemObject # itemObject.value to the input field
                                  actions:
                                    - =.builtIn.object.set:
                                        dataIn:
                                          object: =..patientInfo
                                          key: $var.key
                                          value: $var.dataValue
                              style:
                                width: "0.15"
            - type: view
              style:
                width: "1"
                left: "0"
                height: "0.48"
                marginTop: "0.02"
              children:
                - type: list
                  contentType: listObject
                  listObject: ..patientInfoTemp.other
                  iteratorVar: itemObject
                  style:
                    width: "1"
                    margin: "0"
                    height: auto
                    top: "0"
                  children:
                    - type: listItem
                      itemObject:
                      style:
                        width: "0.92"
                        height: "0.08"
                        left: "0.08"
                      children:
                        - .patientInfo1_Label:
                          dataKey: itemObject.value
                          style:
                            width: "0.8"
                        - .patientInfo1_TextField:
                          placeholder:
                            emit:
                              dataKey:
                                var: itemObject
                              actions:
                                - =.builtIn.object.get:
                                    dataIn:
                                      object: =..patientInfo
                                      key: $var.key
                          dataValue:
                            emit:
                              dataKey:
                                var: itemObject
                              actions:
                                - =.builtIn.object.get:
                                    dataIn:
                                      object: =..patientInfo
                                      key: $var.key
                          dataKey: itemObject.dataValue
                          onChange:
                            emit:
                              dataKey:
                                var: itemObject # itemObject.value to the input field
                              actions:
                                - =.builtIn.object.set:
                                    dataIn:
                                      object: =..patientInfo
                                      key: $var.key
                                      value: $var.dataValue
                          style:
                            width: "0.82"
            - type: label
              text: Emergency Contact
              style:
                fontFamily: "Poppins"
                left: "0.08"
                marginTop: "0.02"
                width: "0.9"
                fontStyle: bold
                height: "0.05"
                fontSize: "16"
            - type: view
              style:
                width: "1"
                margin: "0"
                height: "0.24"
                left: "0"
                marginTop: "0.02"
              children:
                - type: list
                  contentType: listObject
                  listObject: ..patientInfoTemp.emergencyContact
                  iteratorVar: itemObject
                  style:
                    width: "1"
                    margin: "0"
                    height: "0.24"
                    left: "0"
                    top: "0"
                  children:
                    - type: listItem
                      itemObject:
                      style:
                        width: "0.92"
                        height: "0.08"
                        left: "0.08"
                        marginTop: ""
                      children:
                        - .patientInfo1_Label:
                          dataKey: itemObject.value
                        - .patientInfo1_TextField:
                          placeholder:
                            emit:
                              dataKey:
                                var: itemObject
                              actions:
                                - =.builtIn.object.get:
                                    dataIn:
                                      object: =..patientInfo
                                      key: $var.key
                          dataValue:
                            emit:
                              dataKey:
                                var: itemObject
                              actions:
                                - =.builtIn.object.get:
                                    dataIn:
                                      object: =..patientInfo
                                      key: $var.key
                          dataKey: itemObject.dataValue
                          onChange:
                            emit:
                              dataKey:
                                var: itemObject # itemObject.value to the input field
                              actions:
                                - =.builtIn.object.set:
                                    dataIn:
                                      object: =..patientInfo
                                      key: $var.key
                                      value: $var.dataValue
                          style:
                            width: "0.82"
        - type: button
          text: "Next"
          onClick:
            - actionType: evalObject
              object:
                - if:
                    - =.builtIn.string.equal:
                        dataIn:
                          string1: =..formData.patientInfo.dateOfBirth
                          string2: " "
                    - continue
                    - =.builtIn.object.set:
                        dataIn:
                          object: =..patientInfo
                          key: dateOfBirth
                          value: =..formData.patientInfo.dateOfBirth
                - if:
                    - =.builtIn.string.equal:
                        dataIn:
                          string1: =..formData.gender
                          string2: " "
                    - continue
                    - =.builtIn.object.set:
                        dataIn:
                          object: =..patientInfo
                          key: gender
                          value: =..formData.gender
                - if:
                    - =.builtIn.string.equal:
                        dataIn:
                          string1: =..formData.state
                          string2: " "
                    - continue
                    - =.builtIn.object.set:
                        dataIn:
                          object: =..patientInfo
                          key: state
                          value: =..formData.state
            - actionType: evalObject
              object:
                - .Global.formData.cov19Test@: =..cov19Chart.docResp.doc
                - .Global.formData.cov19Test.name.data.patientInfo@: =..patientInfo
                - .Global.formData.firstToCov19Test@: false
            - goto: PatientInfo2
            # - goto: HippaConsent
          style:
            left: "0.11"
            width: "0.76"
            top: "1.3"
            height: "0.05"
            color: "0xffffff"
            border:
              style: "3"
            borderColor: "0x2988e6"
            backgroundColor: "0x2988e6"
            borderRadius: "3"
            textAlign:
              x: center
              y: center
    - type: popUp
      viewTag: birthDay
      style:
        left: "0"
        top: "0"
        width: "1"
        height: "1"
        backgroundColor: "0x00000066"
      children:
        - .BaseComponents.calendar:
          children:
            - .BaseComponents.calendarHeader:
              children:
                - type: view
                  style:
                    marginTop: "0.024"
                    left: "0"
                    height: "0.035"
                    width: "0.9"
                  children:
                    - .BaseComponents.newMonthView:
                    - .BaseComponents.newYearView:
                - .BaseComponents.newdevider:
                - .BaseComponents.weekView:
            - .BaseComponents.dayView:
            - .BaseComponents.addButton:
              text: "Select"
              onClick:
                - actionType: evalObject
                  object:
                    - =.builtIn.object.set:
                        dataIn:
                          object: =..formData.patientInfo
                          key: dateOfBirth
                          value: =.BaseComponents.calendarDate.todayDate
                - actionType: builtIn
                  funcName: redraw
                  viewTag: birthTag
                - actionType: popUpDismiss
                  popUpView: birthDay
