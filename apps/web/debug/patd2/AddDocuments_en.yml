AddDocuments: 
  pageNumber: "430 440"  # xd page 34 popup-440
  title: "Upload Documents"
  init: 
    - .SignInCheck    
  medicalRecord:
    docRes: ""
    document:
      .Document: ""
      type: .DocType.UploadFile
      name:
        title: ""
        # type: ..medicalRecord.docAPI.store.subtype.mediaType
        data: binFile  
      eid: .Global.rootNotebookID
      reid: .Global.currentUser.vertex.id
    docAPI:   
      store:
        api: cd
        dataIn: AddDocuments.medicalRecord.document  
        dataOut: AddDocuments.medicalRecord.docRes
        # subtype:
        #   mediaType: "" 
  formData:
    fileSize: ""
    flag: false
  components: 
    - .ProgressCheckView: ""
      message: "Uploading in progress ..."
      viewTag: uploading
    - .BaseHeader:
    - .HeaderLeftButton:
    - type: view
      style: 
        left: "0"
        top: "0.12"
        width: "1"
        height: "0.85"
      children:
        - type: label
          text: "Fill out required fields*"
          style:
            top: "0.015"
            width: "1"
            height: "0.03"
            fontSize: .Nfont.h3
            color: "0xD53C42"
            textAlign:
              x: center 
        - type: label
          text: "Create document name"
          style:
            left: "0.133"
            top: "0.06"
            width: "0.6"
            height: "0.04"
            color: "#707070"
            fontSize: .Nfont.h2
        - type: label
          text: "*"
          style:
            left: "0.585"
            top: "0.06"
            color: "0xD53C42"
            fontSize: .Nfont.h2
        - type: textField
          placeholder: "Enter name"
          dataKey: medicalRecord.document.name.title
          style: 
            left: "0.133"
            top: "0.1"
            width: "0.72"
            height: "0.03"
            fontSize: .Nfont.h2
            border: 
              style: "2"
            borderWidth: "1"
        - type: label
          text: "Upload your document"
          style:
            left: "0.135"
            top: "0.16"
            width: "0.5"
            height: "0.04"
            color: "#707070"
            fontSize: .Nfont.h2
        - type: label
          text: "*"
          style:
            left: "0.58"
            top: "0.16"
            color: "0xD53C42"
            fontSize: .Nfont.h2
        - .UploadModule:
          onClick: 
            - actionType: popUp
              popUpView: selectView
          style: 
            left: "0.133"
            top: "0.215"
        - type: label
          contentType: messageHidden
          text: "Successfully selected"
          style:
            left: "0.133"
            top: "0.65"
            width: "0.72"
            height: "0.04"
            color: "#2fb355"
            fontSize: .Nfont.h3
            isHidden: "true"
            textAlign: 
              x: center
        - type: label
          textBoard: 
            - text: "Only the following file types are supported: "
            - br:
            - br:
            - text: ".jpeg, .png, .pdf, .xls, .pptx, .ppt, .docx, .doc, "
            - br:
            - br:
            - text: ".numbers, .pages, .htm"
            - br:
            - br:
            - br:
            - text: "File size must be no larger than BLANK"  
          style: 
            left: "0.133"
            top: "0.37"
            width: "0.8"
            height: "0.2"
            color: "0x00000088"
            fontSize: '14'
            textAlign:  
              x: left
        - type: button
          text: Upload
          onClick: 
            - actionType: popUp
              popUpView: uploading             
            - actionType: evalObject
              object:
                - =.AddDocuments.medicalRecord.docAPI.store: "" 
            - actionType: evalObject
              object: 
                .Global._nonce@: 
                  =.builtIn.math.random: ""
            - actionType: builtIn
              funcName: goBack
              reload: true
          style: 
            left: "0.12"
            top: "0.78"
            width: "0.76"
            height: "0.055"
            fontSize: .Nfont.h2
            fontWeight: "bold"
            backgroundColor: "0x2988e6ff"
            color: "0xffffffff"
            border:
              style: "3"
            borderColor: "0x2988e6"
            borderRadius: "3"
            textAlign:
              x: center
    - type: popUp
      viewTag: selectView
      style: 
        left: "0"
        width: "1"
        top: "0"
        height: "1"
        backgroundColor: "0xa9a9a9cc"
      children: 
        - type: view
          style: 
            top: "0.59"
            width: "0.9"
            height: "0.275"
            left: "0.05"
            border: 
              style: "1"
            borderRadius: "10"
            backgroundColor: "0xe9e9e9"
            zIndex: 1000
          children: 
            - type: label
              textBoard: 
                - text: Medical Records
                  color: "0x00000099"
                - br: 
                - text: Upload an image or document
                  color: "0x00000066"
              style: 
                top: "0.02"
                width: "0.9"
                height: "0.06"
                fontSize: .Nfont.h2
                color: "0x"
                textAlign: 
                  x: center
                border:
                  style: "2"
                borderWidth: "1"
                borderColor: "0x00000066"
            - type: button
              text: Camera
              contentType: file
              onClick:
                - actionType: openCamera
                  dataObject: BLOB
                  dataKey: AddDocuments.medicalRecord.document.name.data

                # - actionType: evalObject
                #   object:
                #     - if:
                #       - =.builtIn.math.lessthanSize:
                #           dataIn:
                #             object: =..medicalRecord.document.name.data # object
                #             key: 2  #mb
                #       - ..formData.flag@: false
                #       - actionType: evalObject
                #         object:
                #           - =.builtIn.utils.getFileSize:
                #               dataIn:
                #                 object: =..medicalRecord.document.name.data
                #                 units: mb
                #               dataOut: AddDocuments.formData.fileSize 
                #           - =.builtIn.string.concat:
                #               dataIn:
                #                 - "Your file size:"
                #                 - =..formData.fileSize
                #                 - "Mb"
                #               dataOut: Global.formData.fileSize 
                #           - ..formData.flag@: true
                # - actionType: builtIn
                #   funcName: redraw
                #   viewTag: overSize
                # - actionType: evalObject
                #   object:
                #     - if:
                #       - =..formData.flag
                #       - actionType: popUp
                #         popUpView: overSize
                #         wait: true
                #       - continue
      
                - actionType: popUpDismiss
                  popUpView: selectView
                - actionType: builtIn
                  funcName: checkField
                  contentType: messageHidden
              style: 
                top: "0.085"
                width: "0.9"
                height: "0.06"
                fontSize: .Nfont.h3
                color: "0x1d88fc"
                backgroundColor: "0xe9e9e9"
                textAlign: 
                  x: center
                border:
                  style: "2"
                borderWidth: "1"
                borderColor: "0x00000066"
            - type: button
              text: Photo Library
              contentType: file
              onClick:
                - actionType: openPhotoLibrary
                  dataObject: BLOB
                  dataKey: AddDocuments.medicalRecord.document.name.data
                - actionType: evalObject
                  object:
                    - if:
                      - =.builtIn.math.lessthanSize:
                          dataIn:
                            object: =..medicalRecord.document.name.data # object
                            key: 2  #mb
                      - ..formData.flag@: false
                      - actionType: evalObject
                        object:
                          - =.builtIn.utils.getFileSize:
                              dataIn:
                                object: =..medicalRecord.document.name.data
                                units: mb
                              dataOut: AddDocuments.formData.fileSize 
                          - =.builtIn.string.concat:
                              dataIn:
                                - "Your file size:"
                                - =..formData.fileSize
                                - "Mb"
                              dataOut: Global.formData.fileSize 
                          - ..formData.flag@: true
                - actionType: builtIn
                  funcName: redraw
                  viewTag: overSize
                - actionType: evalObject
                  object:
                    - if:
                      - =..formData.flag
                      - actionType: popUp
                        popUpView: overSize
                        wait: true
                      - continue
                - actionType: popUpDismiss
                  popUpView: selectView
                - actionType: builtIn
                  funcName: checkField
                  contentType: messageHidden
              style: 
                top: "0.146"
                width: "0.9"
                height: "0.06"
                fontSize: .Nfont.h3
                color: "0x1d88fc"
                backgroundColor: "0xe9e9e9"
                textAlign: 
                  x: center
                border:
                  style: "2"
                borderWidth: "1"
                borderColor: "0x00000066"
            - type: button
              text: Document Manager
              contentType: file
              onClick:
                - actionType: openDocumentManager
                  dataObject: BLOB
                  dataKey: AddDocuments.medicalRecord.document.name.data

                - actionType: evalObject
                  object:
                    - if:
                      - =.builtIn.math.lessthanSize:
                          dataIn:
                            object: =..medicalRecord.document.name.data # object
                            key: 2  #mb
                      - ..formData.flag@: false
                      - actionType: evalObject
                        object:
                          - =.builtIn.utils.getFileSize:
                              dataIn:
                                object: =..medicalRecord.document.name.data
                                units: mb
                              dataOut: AddDocuments.formData.fileSize 
                          - =.builtIn.string.concat:
                              dataIn:
                                - "Your file size:"
                                - =..formData.fileSize
                                - "Mb"
                              dataOut: Global.formData.fileSize 
                          - ..formData.flag@: true
                - actionType: builtIn
                  funcName: redraw
                  viewTag: overSize
                - actionType: evalObject
                  object:
                    - if:
                      - =..formData.flag
                      - actionType: popUp
                        popUpView: overSize
                        wait: true
                      - continue
      
                - actionType: popUpDismiss
                  popUpView: selectView
                - actionType: builtIn
                  funcName: checkField
                  contentType: messageHidden
              style: 
                top: "0.206"
                width: "0.9"
                height: "0.06"
                fontSize: .Nfont.h3
                color: "0x1d88fc"
                backgroundColor: "0xe9e9e9"
                textAlign: 
                  x: center
                border:
                  style: 1
        - type: button
          text: Cancel
          style: 
            top: "0.9"
            left: "0.05"
            width: "0.9"
            height: "0.06"
            fontSize: .Nfont.h3
            color: "0x1d88fc"
            backgroundColor: "0xe9e9e9"
            textAlign: 
              x: center
            borderRadius: "10"
            border:
              style: 1
          onClick:
            - actionType: popUpDismiss
              popUpView: selectView
              
    - .BaseoverSize: