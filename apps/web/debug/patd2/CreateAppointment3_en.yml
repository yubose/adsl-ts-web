CreateAppointment3:
  title: "Create Appointment"
  pageNumber: "1960"
  init:
    - .SignInCheck
    - .Global.formData.patientChartLocal@: ""
    - .Global.formData.patientChartMeeting@: ""
    - ..visitQuestionnaire.docAPI.get
    - .Global.formData.patientChartShare@: false
    - actionType: evalObject
      object:
        .CreateAppointment3.visitQuestionnaireObject.document@: =..docResponse.doc.0
    - ..newAppointment.edge.name.duration@: =.Global.formData.appointment.duration
    - actionType: evalObject
      object:
        - =.builtIn.array.getListLength:
            dataIn:
              object: =.Global.formData.appointment.docu
            dataOut: CreateAppointment3.localDocuLength
    - actionType: evalObject
      object:
        - =.builtIn.array.getListLength:
            dataIn:
              object: =.Global.vaccine
            dataOut: CreateAppointment3.globalDocuLength
    - actionType: evalObject
      object:
        - =.builtIn.string.equal:
            dataIn:
              string1: =..localDocuLength
              string2: =..globalDocuLength
            dataOut: CreateAppointment3.otherFormRead
    - if:
        - =.builtIn.string.equal:
            dataIn:
              string1: =..localDocuLength
              string2: "0"
        - ..otherFormHid@: "true"
        - continue
    - =.builtIn.string.concat:
        dataIn:
          - =..selectDate
          - " at "
          - =.Global.clock.showTime
        dataOut: CreateAppointment3.selectDate
    - actionType: evalObject
      object:
        - .Global.flag.isMeetingPatientchart@: false
        - .Global.formData.selectCategory@: CreateAppointment3
    - =.builtIn.array.transformArray:
        dataIn:
          array: =.Global.formData.appointment.docu
        dataOut: CreateAppointment3.formData.formList
    - =.builtIn.array.transformPage:
        dataIn:
          array: =..formData.formList
          type: "Edit"
          dataKey: "key"
        dataOut: CreateAppointment3.formData.docList
  formData:
    docList: []
    formList: []
    cov19Test: ""
    vaccineNum: 0
    vaccineDocNum: 0
    pifzerBioNTech: ""
    moderna: ""
    signature_moderna: ""
    gotoPage: ""
    cov19TestNewPatForm: ""
    cov19TestForm: ""
    fluVaccinationConsentFormEnglish: ""
  selectDate: .Global.formData.appointment.selectDate
  patient: .Global.middleInformation.PatientVisitInfo
  localDocuLength: ""
  globalDocuLength: ""
  otherFormRead: ""
  otherForm: ""
  otherFormHid: "false"
  data:
    purpose: ""
    anythingElse: ""
    isPrescribed: ""
    isProblems: ""
    problems: ""
    isToEmergency: ""
    toEmergency: ""
    isFamilyHistoryChanges: ""
    familyHistoryChanges: ""
    isNewDrug: ""
    newDrug: ""
    notes: ""
  visitQuestionnaireObject:
    document:
      type: .DocType.VisitQuestionnaire
      eid: .Global.rootNotebookID
      name:
        type: "application/json"
        data:
          purpose: ""
          anythingElse: ""
          isPrescribed: ""
          isProblems: ""
          problems: ""
          isToEmergency: ""
          toEmergency: ""
          isFamilyHistoryChanges: ""
          familyHistoryChanges: ""
          isNewDrug: ""
          newDrug: ""
          notes: ""
    docAPI:
      .DocAPI: ""
      store:
        api: cd
        dataKey: visitQuestionnaireObject.document
        subtype:
          mediaType: "application/json"
  visitQuestionnaire:
    docAPI:
      .DocAPI: ""
      get:
        dataKey: docResponse
        id: .Global.rootNotebookID
        xfname: "eid"
        type: .DocType.VisitQuestionnaire
        _nonce: =.Global._nonce
  docResponse:
    doc:
      - type: .DocType.VisitQuestionnaire # - type: "257" # private profile
        eid: .Global.rootNotebookID
        name: ""
    error: ""
    jwt: ""
  inviteInfo:
    edge:
      .Edge: ""
      type: .EdgeType.InviteInfo
      refid: ""
      bvid: .Global.currentUser.vertex.id
      name:
        phoneNumber: ""
        firstName: ""
        lastName: ""
        name: ""
        hostName: =.Global.Profile.name.data.basicInfo.fullName
        roomName: ""
        date: ""
    edgeAPI:
      store:
        api: ce
        dataKey: inviteInfo.edge
  flag: "" # to judge whether the PatientChart and VisitQuestionnaire have been both filled in.
  newAppointment:
    response: ""
    edge:
      .Edge: ""
      evid: .Global.formData.activeRoom.bsig
      bvid: .Global.currentUser.vertex.id
      id: ""
      refid: "" #the_selected_time_slot_edge.id
      subtype: .Global.E2Subtype
      type: 40000
      tage: 3
      name:
        patientName: .Global.Profile.name.data.basicInfo.fullName
        patientPhoneNumber: .Global.Profile.name.data.phone
        providerName: .Global.ActiveProvider.name.data.fullName
        patientAvatarId: .Global.Profile.name.data.avatar
        visitType: ""
        visitTypeShow: ""
        visitReason: ""
        Reason: "Cold"
        blockColor: ""
        fontColor: ""
        duration: ""
        date: ""
        location: .Global.ActiveLocation.name.data.basicInfo.location
        facilityId: .Global.clock.bvid
    edgeAPI:
      .EdgeAPI: ""
      store:
        api: ce
        dataIn: newAppointment.edge
        dataOut: newAppointment.response
  save:
    - =.CreateAppointment3.newAppointment.edgeAPI.store: ""
    - .CreateAppointment3.apiRequest.approveAppointment.edge.refid@: =.CreateAppointment3.newAppointment.response.edge.id
    - .CreateAppointment3.apiRequest.approveAppointment.edge.evid@: =.CreateAppointment3.newAppointment.response.edge.evid
    - =.CreateAppointment3.apiRequest.approveAppointment.edgeAPI.store: ""
    - .CreateAppointment3.apiRequest.inviteFacility.edge.refid@: =.CreateAppointment3.newAppointment.response.edge.id
    - =.CreateAppointment3.apiRequest.inviteFacility.edgeAPI.store: ""
  apiRequest: #Input data request here
    approveAppointment:
      response: ""
      edge:
        bvid: .Global.currentUser.vertex.id
        refid: ""
        type: 40000
        subtype: 5
      edgeAPI:
        .EdgeAPI: ""
        store:
          api: ce
          dataIn: apiRequest.approveAppointment.edge
          dataOut: apiRequest.approveAppointment.response
    inviteFacility:
      response: ""
      edge:
        bvid: .Global.currentUser.vertex.id
        evid: .Global.clock.bvid
        refid: ""
        type: 40000
        subtype: 10
      edgeAPI:
        .EdgeAPI: ""
        store:
          api: ce
          dataIn: apiRequest.inviteFacility.edge
          dataOut: apiRequest.inviteFacility.response
    isContact: # 判断是否为好友
      response: ""
      edge:
        id: []
        xfname: bvid,evid
        type: 10002
        _nonce: =.Global._nonce
      docIn:
        type: 10002
        subtype: 65536
        tage: 1
        bvid: .Global.currentUser.vertex.id
        evid: ""
        name: ""
        refid: ""
      docOut: ""
      edgeAPI:
        store:
          api: ce
          dataIn: CreateAppointment3.apiRequest.isContact.docIn
          dataOut: CreateAppointment3.apiRequest.isContact.docOut
        get:
          api: re
          dataIn: CreateAppointment3.apiRequest.isContact.edge
          dataOut: CreateAppointment3.apiRequest.isContact.response
    getPatientProfile:
      response: ""
      docIn:
        type: 102401
        id: .Global.currentUser.vertex.id
        xfname: ovid
        obfname: "ctime"
        maxcount: "1"
      docOut: ""
      docAPI:
        get:
          api: rd
          dataIn: CreateAppointment3.apiRequest.getPatientProfile.docIn
          dataOut: CreateAppointment3.apiRequest.getPatientProfile.docOut

  components:
    - .ProgressCheckView: ""
      message: "loading ..."
      viewTag: uploading
    - .BaseHeader:
    - .HeaderLeftButton:
      onClick:
        - actionType: builtIn
          funcName: goBack
    - type: view
      style:
        width: "1"
        height: "0.4"
        left: "0"
        backgroundColor: "0x2988e6"
        top: "0.1"
      children:
        - .CA1label:
          text: "Date & Time selected:"
          style:
            top: "0"
            width: "0.6"
            height: "0.035"
            border:
              style: "2"
            borderWidth: "2"
            borderColor: "0xffffff99"
            fontSize: .Nfont.h3
        - .CA1label:
          dataKey: selectDate
          style:
            fontSize: .Nfont.h2
            top: "0.05"
            fontWeight: "600"
        - .CA1label:
          text: "Type"
          style:
            top: "0.115"
            width: "0.38"
            height: "0.035"
            border:
              style: "2"
            borderWidth: "2"
            borderColor: "0xffffff99"
            fontSize: .Nfont.h3
        - .CA1label:
          dataKey: Global.formData.appointment.visitType
          style:
            top: "0.16"
            fontSize: .Nfont.h3
        - .CA1label:
          text: "Duration"
          style:
            top: "0.115"
            left: "0.6"
            width: "0.18"
            height: "0.035"
            border:
              style: "2"
            borderWidth: "2"
            borderColor: "0xffffff99"
            fontSize: .Nfont.h3
        - .CA1label:
          dataKey: newAppointment.edge.name.duration
          style:
            top: "0.16"
            fontSize: .Nfont.h3
            left: "0.6"
        - .CA1label:
          text: "Reason for Visit"
          style:
            top: "0.21"
            width: "0.4"
            height: "0.035"
            border:
              style: "2"
            borderWidth: "2"
            borderColor: "0xffffff99"
            fontSize: .Nfont.h3
        - .CA1label:
          dataKey: Global.formData.appointment.reason
          style:
            top: "0.25"
            fontSize: .Nfont.h3
        - .CA1label:
          text: Facility
          style:
            top: "0.21"
            width: "0.38"
            left: "0.6"
            height: "0.035"
            border:
              style: "2"
            borderWidth: "2"
            borderColor: "0xffffff99"
            fontSize: .Nfont.h3
        - .CA1label:
          dataKey: Global.ActiveLocation.name.data.basicInfo.medicalFacilityName
          style:
            top: "0.25"
            fontSize: .Nfont.h3
            left: "0.6"
        - type: button
          text: "Change details"
          onClick:
            - actionType: builtIn
              funcName: goBack
          style:
            width: "0.5"
            height: "0.05"
            top: "0.3"
            left: "0.25"
            borderRadius: "50"
            color: "0xff0000"
            backgroundColor: "0xffffff"
            border:
              style: "3"
              width: "1"
              color: "0xff0000"
            borderColor: "0xff0000"
            fontSize: .Nfont.h3
            fontFamily: "Arial"
            textAlign:
              x: center
    - type: scrollView
      style:
        top: "0.5"
        height: "0.4"
        width: "1"
        left: "0"
      children:
        - type: view
          style:
            marginTop: "0"
            width: "1"
            left: "0"
            height: "auto"
          children:
            - type: label
              text: Please complete visit questionnaire
              style:
                left: "0.1"
                marginTop: "0.04"
                height: "auto"
                width: "0.9"
                color: "0x2988e6"
                fontSize: .Nfont.h3
            - type: view
              onClick:
                - goto: VisitQuestionnaire
              style:
                left: "0"
                width: "1"
                marginTop: "0.01"
                height: "0.04"
              children:
                - type: image
                  path:
                    emit:
                      actions:
                        - if:
                            - =.builtIn.string.equal:
                                dataIn:
                                  string1: =.Global.visitQuestionnaireDoc
                                  string2: "true"
                            - selectBlueOn.svg
                            - selectOff.svg
                  style:
                    marginLeft: "0.1"
                    display: "inline-block"
                    height: "0.03"
                - type: label
                  text: Visit Questionnaire
                  style:
                    marginLeft: "0.03"
                    display: "inline-block"
                    color: "0x2988e6"
                    fontSize: .Nfont.h2
                    width: "0.65"
                    height: "auto"
                    wordBreak: break-word
                    textAlign:
                      x: left
            - type: list
              contentType: listObject
              listObject: ..formData.docList
              iteratorVar: itemObject
              style:
                margin: "0"
                marginTop: "0.01"
                left: "0"
                width: "1"
                height: "auto"
              children:
                - type: listItem
                  itemObject: ""
                  style:
                    marginTop: "0.01"
                    width: "1"
                    height: "auto"
                  onClick:
                    - emit:
                        dataKey:
                          var: itemObject
                        actions:
                          - if:
                              - true
                              - goto: $var.pageName
                              - goto: $var.pageName
                          - .Global.formData.front_IDCard@: ""
                          - .Global.formData.front_InsuranceCard@: ""
                          - .Global.formData.back_InsuranceCard@: ""
                  children:
                    - type: image
                      path:
                        emit:
                          dataKey:
                            var: itemObject
                          actions:
                            - if:
                                - =.builtIn.array.has:
                                    dataIn:
                                      object: =.Global.vaccine
                                      value: $var.key
                                - selectBlueOn.svg
                                - selectOff.svg
                      style:
                        marginLeft: "0.1"
                        display: "inline-block"
                        height: "0.03"
                        # width: "0.065"
                    - type: label
                      dataKey: itemObject.key
                      style:
                        marginLeft: "0.03"
                        display: "inline-block"
                        color: "0x2988e6"
                        fontSize: .Nfont.h2
                        width: "0.65"
                        height: "auto"
                        wordBreak: break-word
                        textAlign:
                          x: left
        - type: view
          style:
            marginTop: "0.01"
            width: "1"
            left: "0"
            height: "auto"
          children:
            - type: label
              text: Optional Forms
              style:
                left: "0.1"
                top: "0"
                height: "0.06"
                width: "0.9"
                color: "0x2988e6"
                fontSize: .Nfont.h3
            - type: view
              onClick:
                - goto: PatientChart
              style:
                left: "0"
                width: "1"
                top: "0.045"
                height: "0.035"
              children:
                - type: image
                  path:
                    emit:
                      actions:
                        - if:
                            - =.builtIn.string.equal:
                                dataIn:
                                  string1: =.Global.patientChartDoc
                                  string2: "true"
                            - selectBlueOn.svg
                            - selectOff.svg
                  style:
                    left: "0.1"
                    top: "0.0025"
                    height: "0.03"
                - type: label
                  text: Patient Chart
                  style:
                    left: "0.2"
                    top: "0"
                    width: "0.4"
                    height: "0.035"
                    fontSize: .Nfont.h2
                    color: "0x2988e6"
                    textAlign:
                      y: center
            - type: view
              onClick:
                - goto: GeneralInfo
              style:
                left: "0"
                width: "1"
                top: "0.095"
                height: "0.035"
              children:
                - type: image
                  path:
                    emit:
                      actions:
                        - if:
                            - =.builtIn.string.equal:
                                dataIn:
                                  string1: =.Global.generalInfoDoc
                                  string2: "true"
                            - selectBlueOn.svg
                            - selectOff.svg
                  style:
                    left: "0.1"
                    top: "0.0025"
                    height: "0.03"
                - type: label
                  text: General Information
                  style:
                    left: "0.2"
                    top: "0"
                    width: "0.5"
                    height: "0.035"
                    fontSize: .Nfont.h2
                    color: "0x2988e6"
                    textAlign:
                      y: center
    - type: button
      text: "Create Appointment"
      onClick:
        - actionType: evalObject
          object:
            - ..newAppointment.edge.stime@: ""
            - ..newAppointment.edge.etime@: ""
            - ..newAppointment.edge.refid@: ""
            - ..newAppointment.edge.name.Reason@: ""
            - ..newAppointment.edge.name.providerName@: ""
            - ..newAppointment.edge.stime@: =.Global.clock.stime
            - ..newAppointment.edge.etime@: =.Global.clock.etime
            - ..newAppointment.edge.refid@: =.Global.clock.refid
            - ..newAppointment.edge.name.Reason@: =.Global.formData.appointment.reason
            - ..newAppointment.edge.name.document@: =.Global.formData.appointment.docu
            - if:
                - =.builtIn.string.equal:
                    dataIn:
                      string1: =.Global.formData.appointment.visitType
                      string2: "Covid19Test"
                - actionType: evalObject
                  object:
                    - ..newAppointment.edge.name.fontColor@: "0x388ecc"
                    - ..newAppointment.edge.name.blockColor@: "0xdfecf7"
                - continue
            - if:
                - =.builtIn.string.equal:
                    dataIn:
                      string1: =.Global.formData.appointment.visitType
                      string2: "Covid19Vaccine"
                - actionType: evalObject
                  object:
                    - ..newAppointment.edge.name.fontColor@: "0xd81e06"
                    - ..newAppointment.edge.name.blockColor@: "0xf8dbd7"
                - continue
            - if:
                - =.builtIn.string.equal:
                    dataIn:
                      string1: =.Global.formData.appointment.visitType
                      string2: "Office Visits"
                - actionType: evalObject
                  object:
                    - ..newAppointment.edge.name.fontColor@: "0xffc02d"
                    - ..newAppointment.edge.name.blockColor@: "0xfff7e3"
                - continue
            - if:
                - =.builtIn.string.equal:
                    dataIn:
                      string1: =.Global.formData.appointment.visitType
                      string2: "Telemedicine"
                - actionType: evalObject
                  object:
                    - ..newAppointment.edge.name.fontColor@: "0x30b354"
                    - ..newAppointment.edge.name.blockColor@: "0xe4f5e9"
                - continue
        - actionType: evalObject
          object:
            - =.builtIn.string.concat:
                dataIn:
                  - =.Global.formData.appointment.reason
                dataOut: CreateAppointment3.newAppointment.edge.name.visitReason
            - ..newAppointment.edge.name.visitType@: =.Global.formData.appointment.visitType
            - ..newAppointment.edge.name.visitTypeShow@: =.Global.formData.appointment.visitType
        - actionType: evalObject
          object:
            - =.builtIn.array.getListLength:
                dataIn:
                  object: =.Global.formData.appointment.docu
                dataOut: CreateAppointment3.formData.vaccineNum
            - =.builtIn.array.getListLength:
                dataIn:
                  object: =.Global.vaccine
                dataOut: CreateAppointment3.formData.vaccineDocNum
            - if:
                - =.builtIn.string.equal:
                    dataIn:
                      string1: =..formData.vaccineNum
                      string2: =..formData.vaccineDocNum
                - continue
                - actionType: popUp
                  popUpView: judgeOtherForm
                  wait: true
            - if:
                - =.builtIn.string.equal:
                    dataIn:
                      string1: =.Global.visitQuestionnaireDoc
                      string2: "true"
                - continue
                - actionType: popUp
                  popUpView: judgeVisitQuestionnaire
                  wait: true
            - if:
                - =.builtIn.string.equal:
                    dataIn:
                      string1: =.Global.visitQuestionnaireDoc
                      string2: "true"
                - continue
                - actionType: popUp
                  popUpView: judgeVisitQuestionnaire
                  wait: true
        - actionType: popUp
          popUpView: uploading
        - actionType: evalObject
          object:
            - if:
                - =.builtIn.string.equal:
                    dataIn:
                      string1: =.Global.visitQuestionnaireDoc
                      string2: "true"
                - actionType: evalObject
                  object: ..save
                - continue
            - if:
                - =.builtIn.string.equal:
                    dataIn:
                      string1: =.Global.visitQuestionnaireDoc
                      string2: "true"
                - =.builtIn.ecos.shareDoc:
                    dataIn:
                      sourceDoc: =.Global.formData.visitQuestionnaireDoc.doc
                      targetEdgeID: =..newAppointment.response.edge.id
                - continue
            - if:
                - =.builtIn.string.equal:
                    dataIn:
                      string1: =.Global.patientChartDoc
                      string2: "true"
                - =.builtIn.ecos.shareDoc:
                    dataIn:
                      sourceDoc: =.PatientChart.PatientChartObject
                      targetEdgeID: =..newAppointment.response.edge.id
                - continue
            - if:
                - =.builtIn.string.equal:
                    dataIn:
                      string1: =.Global.generalInfoDoc
                      string2: "true"
                - =.builtIn.ecos.shareDoc:
                    dataIn:
                      sourceDoc: =.GeneralInfo.generalInfo.document
                      targetEdgeID: =..newAppointment.response.edge.id
                - continue
        # shareDoc newPatientForm文档
        - actionType: evalObject
          object:
            - if:
                - =.Global.formData.newPatientForm.id
                - =.builtIn.ecos.shareDoc:
                    dataIn:
                      sourceDoc: =.Global.formData.newPatientForm
                      targetEdgeID: =..newAppointment.response.edge.id
                      targetRoomName: "meetingRoom"
                    dataOut: CreateAppointment3.formData.newPatientForm
                - continue
        # shareDoc fluVaccinationConsentFormEnglish文档
        - actionType: evalObject
          object:
            - if:
                - =.Global.formData.patientDoc.fluVaccinationConsentFormEnglish.doc.id
                - =.builtIn.ecos.shareDoc:
                    dataIn:
                      sourceDoc: =.Global.formData.patientDoc.fluVaccinationConsentFormEnglish.doc
                      targetEdgeID: =..newAppointment.response.edge.id
                      targetRoomName: "meetingRoom"
                    dataOut: CreateAppointment3.formData.fluVaccinationConsentFormEnglish
                - continue
            # shareDoc pifzerVaccineFirDoseForm文档
            - if:
                - =.Global.formData.pifzerVaccineFirDoseForm.id
                - =.builtIn.ecos.shareDoc:
                    dataIn:
                      sourceDoc: =.Global.formData.pifzerVaccineFirDoseForm
                      targetEdgeID: =..newAppointment.response.edge.id
                      targetRoomName: "meetingRoom"
                    dataOut: CreateAppointment3.formData.pifzerVaccineFirDoseForm
                - continue
            # pifzerVaccineSecDoseForm
            - if:
                - =.Global.formData.pifzerVaccineSecDoseForm.id
                - =.builtIn.ecos.shareDoc:
                    dataIn:
                      sourceDoc: =.Global.formData.pifzerVaccineSecDoseForm
                      targetEdgeID: =..newAppointment.response.edge.id
                      targetRoomName: "meetingRoom"
                    dataOut: CreateAppointment3.formData.pifzerVaccineSecDoseForm
                - continue
            - if:
                - =.Global.formData.cov19TestNewPatForm.id
                - =.builtIn.ecos.shareDoc:
                    dataIn:
                      sourceDoc: =.Global.formData.cov19TestNewPatForm
                      targetEdgeID: =..newAppointment.response.edge.id
                      targetRoomName: "meetingRoom"
                    dataOut: CreateAppointment3.formData.cov19TestNewPatForm
                - continue
            - if:
                - =.Global.formData.cov19TestForm.id
                - =.builtIn.ecos.shareDoc:
                    dataIn:
                      sourceDoc: =.Global.formData.cov19TestForm
                      targetEdgeID: =..newAppointment.response.edge.id
                      targetRoomName: "meetingRoom"
                    dataOut: CreateAppointment3.formData.cov19TestForm
                - continue
            - if:
                - =.Global.formData.modernaVaccineFirDoseForm.id
                - =.builtIn.ecos.shareDoc:
                    dataIn:
                      sourceDoc: =.Global.formData.modernaVaccineFirDoseForm
                      targetEdgeID: =..newAppointment.response.edge.id
                      targetRoomName: "meetingRoom"
                    dataOut: CreateAppointment3.formData.modernaVaccineFirDoseForm
                - continue
            - if:
                - =.Global.formData.modernaVaccineSecDoseForm.id
                - =.builtIn.ecos.shareDoc:
                    dataIn:
                      sourceDoc: =.Global.formData.modernaVaccineSecDoseForm
                      targetEdgeID: =..newAppointment.response.edge.id
                      targetRoomName: "meetingRoom"
                    dataOut: CreateAppointment3.formData.modernaVaccineSecDoseForm
                - continue
            - =.builtIn.ecos.shareDoc:
                dataIn:
                  sourceDoc: =.Global.Profile
                  targetEdgeID: =..newAppointment.response.edge.id
        - actionType: evalObject
          object:
            - if:
                - =.builtIn.string.equal:
                    dataIn:
                      string1: =.Global.visitQuestionnaireDoc
                      string2: "true"
                - actionType: evalObject
                  object:
                    - ..visitQuestionnaireObject.document.name.data@: =..data
                    - =.CreateAppointment3.visitQuestionnaireObject.docAPI.store: ""
                - continue
        - actionType: evalObject
          object:
            - ..apiRequest.isContact.edge.id@: []
            - ..apiRequest.isContact.edge.response@: "" #clear old data
            - =.builtIn.array.add:
                dataIn:
                  object: =..apiRequest.isContact.edge.id
                  value: =.Global.currentUser.vertex.id #patient id
            - =.builtIn.array.add:
                dataIn:
                  object: =..apiRequest.isContact.edge.id
                  value: =.Global.clock.bvid #facility id
        - actionType: evalObject
          object:
            - =..apiRequest.isContact.edgeAPI.get: ""
        - actionType: evalObject
          object:
            .Global._nonce@:
              =.builtIn.math.random: ""
        - actionType: evalObject
          object:
            - if:
                - =..apiRequest.isContact.response.edge.0.id
                - continue
                - actionType: evalObject
                  object:
                    # get patient profile
                    - =..apiRequest.getPatientProfile.docAPI.get: ""
                    - ..apiRequest.isContact.docIn.evid@: =.Global.clock.bvid
                    - =..apiRequest.isContact.edgeAPI.store: ""
                    - =.builtIn.ecos.shareDoc:
                        dataIn:
                          sourceDoc: =..apiRequest.getPatientProfile.docOut.doc.0
                          targetEdgeID: =..apiRequest.isContact.docOut.edge.id
        - actionType: popUpDismiss
          popUpView: uploading
        - actionType: popUp
          popUpView: createSuccessView
      style:
        width: "0.7"
        left: "0.15"
        height: "0.05"
        top: "0.93"
        fontSize: .Nfont.h3
        color: "0xffffff"
        backgroundColor: "0x2988e6"
        borderRadius: "3"
        fontFamily: "Arial"
        textAlign:
          x: center
    - .BaseCheckView: ""
      message: "You have not filled in the Patient Chart"
      viewTag: judgePatientChart
      colorChange: "0x2988e6"
      imgPath: aboutBlue.svg
      children:
        - type: view
          style:
            width: "0.8"
            height: "0.3"
            top: "0.3"
            left: "0.1"
            zIndex: "100"
            backgroundColor: "0xffffff"
            borderRadius: "7"
            border:
              style: "3"
            borderColor: "#f4f8fa"
            borderWidth: "3"
          children:
            - .BaseCheckViewImg:
            - .BaseCheckViewLabel:
            - .BaseCheckViewButton:
              onClick:
                - actionType: popUpDismiss
                  popUpView: ____.viewTag
    - .TipsMultiLine:
      viewTag: judgeVisitQuestionnaire
      message: "You have not filled in the Visit Questionnaire"                  
    # - .BaseCheckView: ""
    #   message: "You have not filled in the Visit Questionnaire"
    #   viewTag: judgeVisitQuestionnaire
    #   colorChange: "0x2988e6"
    #   imgPath: aboutBlue.svg
    #   children:
    #     - type: view
    #       style:
    #         width: "0.8"
    #         height: "0.3"
    #         top: "0.3"
    #         left: "0.1"
    #         zIndex: "100"
    #         backgroundColor: "0xffffff"
    #         borderRadius: "7"
    #         border:
    #           style: "3"
    #         borderColor: "#f4f8fa"
    #         borderWidth: "3"
    #       children:
    #         - .BaseCheckViewImg:
    #         - .BaseCheckViewLabel:
    #         - .BaseCheckViewButton:
    #           onClick:
    #             - actionType: popUpDismiss
    #               popUpView: ____.viewTag
    - .BaseCheckView: ""
      message: "You have not filled in the other forms"
      viewTag: judgeOtherForm
      colorChange: "0x2988e6"
      imgPath: aboutBlue.svg
      children:
        - type: view
          style:
            width: "0.8"
            height: "0.3"
            top: "0.3"
            left: "0.1"
            zIndex: "100"
            backgroundColor: "0xffffff"
            borderRadius: "7"
            border:
              style: "3"
            borderColor: "#f4f8fa"
            borderWidth: "3"
          children:
            - .BaseCheckViewImg:
            - .BaseCheckViewLabel:
            - .BaseCheckViewButton:
              onClick:
                - actionType: popUpDismiss
                  popUpView: ____.viewTag
    # - type: popUp
    #   viewTag: createSuccessView
    #   style:
    #     width: "0.88"
    #     height: "0.3"
    #     top: "0.3"
    #     left: "0.06"
    #     borderRadius: "20"
    #     zIndex: "100"
    #     backgroundColor: "0xeaeaea"
    #   children:
    #     - type: label
    #       text: You have created an appointment successfully
    #       style:
    #         .LabelStyle:
    #           left: "0"
    #           top: "0.08"
    #           width: "0.8333"
    #           height: "0.05"
    #           color: "0x000000"
    #           fontSize: .Nfont.h3
    #           display: inline
    #           fontFamily: "sans-serif"
    #           textAlign:
    #             x: center
    #             y: center
    #     - type: button
    #       text: ok
    #       style:
    #         width: "0.6"
    #         left: "0.14"
    #         height: "0.05"
    #         top: "0.2"
    #         fontSize: "20"
    #         color: "0x000000"
    #         textAlign:
    #           x: center
    #         border:
    #           style: "1"
    #           color: "0x000000"
    #       onClick:
    #         - goto: PatientDashboard

    - .BaseCheckView:
      viewTag: createSuccessView
      message: "You have created an appointment successfully"
      colorChange: "0x2988e6"
      imgPath: popUpSuccess.svg
      children:
        - type: view
          style:
            width: "0.8"
            height: "0.3"
            top: "0.3"
            left: "0.1"
            zIndex: "100"
            backgroundColor: "0xffffff"
            borderRadius: "7"
            border:
              style: "3"
            borderColor: "#f4f8fa"
            borderWidth: "3"
          children:
            - .BaseCheckViewImg:
            - .BaseCheckViewLabel:
            - .BaseCheckViewButton:
                onClick:
                  - goto: PatientDashboard
                  - actionType: popUpDismiss
                    popUpView: createSuccessView
