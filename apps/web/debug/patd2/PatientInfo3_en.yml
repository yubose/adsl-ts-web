PatientInfo3:
  title: "Patient Info 3"
  init:
    - .SignInCheck

    # 判断是否有签名的存在
    - actionType: evalObject
      object:
        - if:
          - =.Global.formData.cov19Test.name.data.signaturePatientInfo3
          - ..temporarySignature@: =.Global.formData.cov19Test.name.data.signaturePatientInfo3
          - continue
    # 判断显示签名的id是否为空
    - if:
        - =.builtIn.string.equal:
            dataIn:
              string1: =..temporarySignature
              string2: ""
        - continue
        # 非空修改显示的标识,刷新签名区域
        - actionType: evalObject
          object:
            - ..flag@: block
            - actionType: builtIn
              funcName: redraw
              viewTag: signatureShowTag
  newSign:
    docRes: ""
    docReq:
      type: .DocType.DocumentSignature
      id: .Global.rootNotebookID
      xfname: eid
    document: #DOC
      type: .DocType.DocumentSignature
      name:
        title: ""
        type: ..newSign.document.subtype.mediaType
        data: "" 
      # eid: .Global.formData.cov19Test.id
      eid: .Global.rootNotebookID
      reid: .Global.formData.cov19Test.id
      subtype:
        mediaType: "" # mediaType : "image/jpeg"        
    docAPI: # DOCAPI 
      store:
        api: cd
        dataIn: newSign.document 
        # dataOut: Global.formData.signature0
        dataOut: PatientInfo3.newSign.docRes

  # 获取暂存的签名的id
  temporarySignature: ""
  # 签名的显示,默认为none
  flag: "none"

  components:
    - .BaseHeader:
    - .HeaderLeftButton:
    - type: scrollView
      style:
        left: "0"
        width: "1"
        height: "0.9"
        top: "0.1"
        overflow: "scroll"
      children:
        - type: image
          path: patientInfo5_3.svg
          style:
            top: "0"
            height: "0.05"
            width: "0.9"
            left: "0.05"
        - type: view
          style:
            top: "0.05"
            left: "0"
            height: "2.0"
            width: "1"
          children:
            - type: label
              textBoard: 
                - text: INFORMED CONSENT FOR
                  color: "0x000000"
                - text: CORONAVIRUS (COVID-19) TESTING
                  color: "0x000000"
              style:
                fontFamily: "Poppins"
                left: "0.07"
                marginTop: "0"
                width: "0.9"
                fontStyle: bold
                height: "0.08"
                fontSize: "18"
            - type: view
              style:
                width: "0.84"
                left: "0.08"
                height: "0.001"
                marginTop: "0.02"
                border:
                  style: "5"
                backgroundColor: "#dededf"
            - type: view
              style:
                marginTop: "0"
                left: "0.08"
                width: "0.9"
                height: "auto"
              children:
                - type: label
                  text: "Please carefully read the following informed consent:"
                  style:
                    fontFamily: "Poppins"
                    left: "0"
                    marginTop: "0"
                    width: "0.92"
                    fontStyle: bold
                    height: "0.08"
                    fontSize: "14"
                - type: view
                  style:
                    marginTop: "0.02"
                    left: "0"
                    width: "0.84"
                    height: "0.1"
                  children:
                    - .patientInfo3_label:
                      text: a. 
                    - .patientInfo3_paragraph:
                      text: I authorize A&C Urgent Care to conduct collection of blood specimen to be screened for antibodies for COVID-19. 
                - type: view
                  style:
                    marginTop: "0.02"
                    left: "0"
                    width: "0.84"
                    height: "0.17"
                  children:
                    - .patientInfo3_label:
                      text: b. 
                    - .patientInfo3_paragraph:
                      text: I authorize A&C Urgent Care to utilizing a rapid test kit which is used for the qualitative detection of the nucleocapsid protein antigen from SARS-CoV-2 in nasopharyngeal swab specimens directly collected from individuals suspected of COVID-19 as ordered by an authorized medical provider or public health official.
                - type: view
                  style:
                    marginTop: "0.02"
                    left: "0"
                    width: "0.84"
                    height: "0.1"
                  children:
                    - .patientInfo3_label:
                      text: c. 
                    - .patientInfo3_paragraph:
                      text: I authorize A&C Urgent Care to conduct collection through a nasopharyngeal swab, as ordered by an authorized medical provider or public health official.
                - type: view
                  style:
                    marginTop: "0.02"
                    left: "0"
                    width: "0.84"
                    height: "0.1"
                  children:
                    - .patientInfo3_label:
                      text: d. 
                    - .patientInfo3_paragraph:
                      text: I authorize my test results to be disclosed to the county, state, or to any other governmental entity as may be required by law.
                - type: view
                  style:
                    marginTop: "0.02"
                    left: "0"
                    width: "0.84"
                    height: "0.1"
                  children:
                    - .patientInfo3_label:
                      text: e. 
                    - .patientInfo3_paragraph:
                      text: I acknowledge that a positive test result is an indication that I must continue to self-isolate in an effort to avoid infecting others (for nasal tests only).
                - type: view
                  style:
                    marginTop: "0.02"
                    left: "0"
                    width: "0.84"
                    height: "0.1"
                  children:
                    - .patientInfo3_label:
                      text: f. 
                    - .patientInfo3_paragraph:
                      text: I understand that I am not creating a patient relationship with A&C Urgent Care by participating in testing/screening. 
                - type: view
                  style:
                    marginTop: "0.02"
                    left: "0"
                    width: "0.84"
                    height: "0.1"
                  children:
                    - .patientInfo3_label:
                      text: g. 
                    - .patientInfo3_paragraph:
                      text: I understand this testing facility is not acting as my medical provider and I assume complete and full responsibility to take appropriate action with regards to my test results
                - type: view
                  style:
                    marginTop: "0.02"
                    left: "0"
                    width: "0.84"
                    height: "0.1"
                  children:
                    - .patientInfo3_label:
                      text: h. 
                    - .patientInfo3_paragraph:
                      text: I understand that, as with any medical test, there is the potential for false positive or false negative test results can occur. A&C Urgent Care carries no responsibilities/liabilities for false test. 
                - type: view
                  style:
                    marginTop: "0.02"
                    left: "0"
                    width: "0.84"
                    height: "0.1"
                  children:
                    - .patientInfo3_label:
                      text: i. 
                    - .patientInfo3_paragraph:
                      text: I understand that if this screening test is at the request of my employer, they will receive the results.
            - type: view
              style:
                left: "0.08"
                width: "0.84"
                marginTop: "0.02"
                height: "0.15"
              children:
                - .patientInfo3_paragraph:
                  text: I the undersigned, have been informed about the test purpose, procedures, possible benefits and risks, and I have received a copy of this Informed consent. I have been given the opportunity to ask questions before I sign, and I have been told that I can ask other questions at any time. I voluntarily agree to antibody screening and/or testing for COVID-19.
                  style:
                    color: "#999999"
                    left: "0"
                    width: "0.84"
                    marginTop: "0"
            - type: view
              style:
                marginTop: "0.02"
                left: "0"
                width: "1"
                height: "0.3"
              children:
                - type: label
                  text: "clear"
                  onClick:
                    #  清空签名
                    - actionType: removeSignature
                      dataObject: BLOB
                      dataKey: PatientInfo3.newSign.document.name.data 
                      viewTag: signatureTag  
                    # 显示签名区域隐藏
                    - actionType: builtIn
                      funcName: hide
                      viewTag: signatureShowTag
                    - actionType: builtIn
                      funcName: show
                      viewTag: signatureTag
                  style:
                    left: "0.78"
                    top: "0" 
                    width: "0.12"
                    fontSize: "14"
                    height: '0.03'
                    color: "0xffffff"
                    border: 'none'
                    borderRadius: "2"
                    backgroundColor: '0xD53C42'
                    zIndex: "100000"
                    textAlign:
                      y: center
                      x: center     
                - type: view
                  style:
                    top: "0.06"  
                    left: "0.085"
                    width: "0.8"
                    height: "0.15"
                    border:
                      style: "4"
                      width: "1.5"
                      color: "0xacacac"
                  children:
                    # 签名区域
                    - type: canvas
                      dataKey: PatientInfo3.newSign.document.name.data 
                      viewTag: signatureTag  
                      style: 
                        left: "0"
                        width: "0.8"
                        top: "0"
                        height: "0.15"
                        overflow: scroll  
                        zIndex: "1000"
                    # 显示暂存的签名
                    - type: image
                      viewTag: signatureShowTag
                      path=func: .builtIn.utils.prepareDocToPath
                      # 传入签名文档的id
                      dataKey: PatientInfo3.temporarySignature
                      style:
                        # 控制显示
                        display: ..flag
                        left: "0"
                        width: "0.8"
                        top: "0"
                        height: "0.15"
                        overflow: scroll  
                        zIndex: "1000"                
                - type: label
                  text: "Patient Name:"
                  style:
                    left: "0.08"
                    height: "0.03"
                    top: "0.23"
                    width: "0.3"
                    color: "#707070"
                    fontStyle: bold
                - type: label
                  dataKey: Global.Profile.name.data.basicInfo.fullName
                  style:
                    left: "0.38"
                    height: "0.03"
                    top: "0.23"
                    width: "0.5"
                    fontStyle: bold
            - type: view
              style:
                left: "0"
                width: "1"
                marginTop: "0"
                height: "0.05"
              children:
                - type: button
                  text: "Next"
                  onClick:
                    - actionType: saveSignature
                      dataObject: BLOB
                      dataKey: PatientInfo3.newSign.document.name.data  
                    - actionType: evalObject
                      object:
                        - if:
                          - =.builtIn.string.equal:
                              dataIn:
                                string1: =..newSign.document.name.data.size
                                string2: 980
                          - continue
                          - =..newSign.docAPI.store: "" 
                        # 存放签名的id
                        - if: 
                          - =..newSign.docRes.doc.id
                          - actionType: evalObject
                            object:
                              - .Global.formData.cov19Test.name.data.signaturePatientInfo3@: =..newSign.docRes.doc.id
                          - continue   
                    - goto: PatientInfo4
                  style:
                    left: "0.11"
                    width: "0.76"
                    height: "0.05"
                    color: "0xffffff"
                    border:
                      style: "3"
                    borderColor: "0x2988e6"
                    backgroundColor: "0x2988e6"
                    borderRadius: "3"
                    textAlign:
                      x: center