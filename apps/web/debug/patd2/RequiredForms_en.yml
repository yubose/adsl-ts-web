RequiredForms:
  title: "Required Forms"
  pageNumber:
  init:
    - .SignInCheck
    - actionType: updateObject
      dataKey: Global.vaccineDoc
      dataObject: []
    - actionType: updateObject
      dataKey: Global.formData.pageName
      dataObject: .EmptyObj
    - actionType: updateObject
      dataKey: Global.formData.appointment.visitType
      dataObject: ""
    - actionType: updateObject
      dataKey: Global.formData.appointment.docu
      dataObject: []
    - =..apiRequest.appointment.edgeAPI.get: ""
    - .Global.formData.firstToCov19Test@: true
    - .Global.formData.firstToCov19TestForm@: true
    - .Global.formData.firstToCov19TestNewPatForm@: true
    # 重置firstToNewPatientForm状态
    - .Global.formData.firstToNewPatientForm@: true
    # 重置firstToNewPatientForm状态
    - .Global.formData.firstToPfizerVaccineFirDoseForm@: true
    - .Global.formData.firstToPfizerVaccineSecDose@: true
    # 重置firstToModernaVaccineSecDoseForm状态
    - .Global.formData.firstToModernaVaccineFirDoseForm@: true
    - .Global.formData.firstToModernaVaccineSecDoseForm@: true
    - .Global.formData.firstFluVaccinationConsentForm@: true
    - .Global.formData.selectCategory@: RequiredForms
    - .Global.formData.appointment.docu@: =.Global.roomInfo.edge.name.document
    - =.builtIn.array.elementUnique:
        dataIn:
          arr: =.Global.roomInfo.edge.name.finishDoc
        dataOut: Global.roomInfo.edge.name.finishDoc
    - =.builtIn.array.elementUnique:
        dataIn:
          arr: =.Global.optionalForms
        dataOut: Global.optionalForms
    - .Global.vaccine@: =.Global.roomInfo.edge.name.finishDoc
    - =.builtIn.array.getListLength:
        dataIn:
          object: =.Global.formData.appointment.docu
        dataOut: RequiredForms.formDataTemp.localDocuLength
    - =.builtIn.number.addition:
        dataIn:
          num: =..formDataTemp.localDocuLength
          step: 2
        dataOut: RequiredForms.formDataTemp.localDocuLength
    - =.builtIn.array.getListLength:
        dataIn:
          object: =.Global.vaccine
        dataOut: RequiredForms.formDataTemp.globalDocuLength
    - =.builtIn.string.retainNumber:
        dataIn:
          value: =..formDataTemp.globalDocuLength
        dataOut: RequiredForms.formDataTemp.globalDocuLength

    - =.builtIn.array.getListLength:
        dataIn:
          object: =.Global.optionalForms
        dataOut: RequiredForms.formDataTemp.optionalLength

    - =.builtIn.string.retainNumber:
        dataIn:
          value: =..formDataTemp.optionalLength
        dataOut: RequiredForms.formDataTemp.optionalLength

    - =.builtIn.array.transformArray:
        dataIn:
          array: =.Global.formData.appointment.docu
        dataOut: RequiredForms.formDataTemp.formList

    - .Global.formData.appointment.visitType@: =..apiRequest.appointment.edgeQueryResp.edge.0.name.visitType
    - if:
        - =.builtIn.string.equal:
            dataIn:
              string1: =..formDataTemp.localDocuLength
              string2: =..formDataTemp.globalDocuLength
        - actionType: evalObject
          object:
            - ..formData.shareColor@: "#2887e5"
            - ..formData.isOnClick@: ""
        - continue
    - if:
        - =.builtIn.array.has:
            dataIn:
              object: =.Global.roomInfo.edge.name.finishDoc
              value: "Visit Questionnaire"
        - actionType: evalObject
          object:
            - =..apiRequest.visitQuestionnaire.docAPI.get: ""
            - .Global.formData.visitQuestionnaireDoc.doc@: =..apiRequest.visitQuestionnaire.docQueryResp.doc.0
            - .Global.visitQuestionnaireDoc@: true
        - continue
    - if:
        - =.builtIn.array.has:
            dataIn:
              object: =.Global.roomInfo.edge.name.finishDoc
              value: "Financial Responsibility Form"
        - actionType: evalObject
          object:
            - =..apiRequest.financialForm.docAPI.get: ""
            - .Global.formData.patientDoc.financialForm@: =..apiRequest.financialForm.docQueryResp.doc.0
        - continue
    # newPatientForm
    - if:
        - =.builtIn.array.has:
            dataIn:
              object: =.Global.roomInfo.edge.name.finishDoc
              value: "New Patient Forms"
        - actionType: evalObject
          object:
            - =..apiRequest.newPatientForm.docAPI.get: ""
            - .Global.formData.newPatientForm@: =..apiRequest.newPatientForm.docQueryResp.doc.0
            - .Global.formData.firstToNewPatientForm@: false
        - continue

    - if:
        - =.builtIn.array.has:
            dataIn:
              object: =.Global.roomInfo.edge.name.optionalForms
              value: "Patient Chart"
        - .Global.optionalForms@: =.Global.roomInfo.edge.name.optionalForms
        - continue

    # cov19NewPatientForm
    - if:
        - =.builtIn.array.has:
            dataIn:
              object: =.Global.roomInfo.edge.name.finishDoc
              value: "COVID-19 Testing Consent - New Patient"
        - actionType: evalObject
          object:
            - =..apiRequest.cov19NewPatientForm.docAPI.get: ""
            - .Global.formData.cov19TestNewPatForm@: =..apiRequest.cov19NewPatientForm.docQueryResp.doc.0
            - .Global.formData.firstToCov19TestNewPatForm@: false
        - continue

    # cov19TestForm
    - if:
        - =.builtIn.array.has:
            dataIn:
              object: =.Global.roomInfo.edge.name.finishDoc
              value: "COVID-19 Testing Consent Form"
        - actionType: evalObject
          object:
            - =..apiRequest.cov19TestForm.docAPI.get: ""
            - .Global.formData.cov19TestForm@: =..apiRequest.cov19TestForm.docQueryResp.doc.0
            - .Global.formData.firstToCov19TestForm@: false
        - continue

    # pifzerVaccineFirDoseForm
    - if:
        - =.builtIn.array.has:
            dataIn:
              object: =.Global.roomInfo.edge.name.finishDoc
              value: "Pfizer-BioNTech Vaccine - First Dose"
        - actionType: evalObject
          object:
            - =..apiRequest.pifzerVaccineFirDoseForm.docAPI.get: ""
            - .Global.formData.pifzerVaccineFirDoseForm@: =..apiRequest.pifzerVaccineFirDoseForm.docQueryResp.doc.0
            - .Global.formData.firstToPfizerVaccineFirDoseForm@: false
        - actionType: evalObject
          object:
            - if:
                - =.builtIn.array.has:
                    dataIn:
                      object: =.Global.formData.appointment.docu
                      value: "Pifzer-BioNTech Vaccine - First Dose"
                - actionType: evalObject
                  object:
                    - =..apiRequest.pifzerVaccineFirDoseForm.docAPI.get: ""
                    - .Global.formData.pifzerVaccineFirDoseForm@: =..apiRequest.pifzerVaccineFirDoseForm.docQueryResp.doc.0
                    - .Global.formData.firstToPfizerVaccineFirDoseForm@: false
                - continue
    # pifzerVaccineSecDoseForm
    - if:
        - =.builtIn.array.has:
            dataIn:
              object: =.Global.roomInfo.edge.name.finishDoc
              value: "Pfizer-BioNTech Vaccine - Second Dose"
        - actionType: evalObject
          object:
            - =..apiRequest.pifzerVaccineSecDoseForm.docAPI.get: ""
            - .Global.formData.pifzerVaccineSecDoseForm@: =..apiRequest.pifzerVaccineSecDoseForm.docQueryResp.doc.0
            - .Global.formData.firstToPfizerVaccineSecDose@: false
        # - continue
        - actionType: evalObject
          object:
            - if:
                - =.builtIn.array.has:
                    dataIn:
                      object: =.Global.roomInfo.edge.name.finishDoc
                      value: "Pifzer-BioNTech Vaccine - Second Dose"
                - actionType: evalObject
                  object:
                    - =..apiRequest.pifzerVaccineSecDoseForm.docAPI.get: ""
                    - .Global.formData.pifzerVaccineSecDoseForm@: =..apiRequest.pifzerVaccineSecDoseForm.docQueryResp.doc.0
                    - .Global.formData.firstToPfizerVaccineSecDose@: false
                - continue

    # modernaVaccineFirDoseForm
    - if:
        - =.builtIn.array.has:
            dataIn:
              object: =.Global.roomInfo.edge.name.finishDoc
              value: "Moderna Vaccine Form - First Dose"
        - actionType: evalObject
          object:
            - =..apiRequest.modernaVaccineFirDoseForm.docAPI.get: ""
            - .Global.formData.modernaVaccineFirDoseForm@: =..apiRequest.modernaVaccineFirDoseForm.docQueryResp.doc.0
            - .Global.formData.firstToModernaVaccineFirDoseForm@: false
        - continue

    # modernaVaccineSecDoseForm
    - if:
        - =.builtIn.array.has:
            dataIn:
              object: =.Global.roomInfo.edge.name.finishDoc
              value: "Moderna Vaccine Form - Second Dose"
        - actionType: evalObject
          object:
            - =..apiRequest.modernaVaccineSecDoseForm.docAPI.get: ""
            - .Global.formData.modernaVaccineSecDoseForm@: =..apiRequest.modernaVaccineSecDoseForm.docQueryResp.doc.0
            - .Global.formData.firstToModernaVaccineSecDoseForm@: false
        - continue

    # fluVaccinationConsentForm
    # - if:
    #     - =.builtIn.array.has:
    #         dataIn:
    #           object: =.Global.roomInfo.edge.name.finishDoc
    #           value: "Flu Vaccination Consent Form 2020-2021(English)"
    #     - actionType: evalObject
    #       object:
    #         - =..apiRequest.fluVaccinationConsentForm.docAPI.get: ""
    #         - .Global.formData.patientDoc.fluVaccinationConsentForm.cov19TestNewPatForm@: =..apiRequest.fluVaccinationConsentForm.docQueryResp.doc.0
    #         # - .Global.formData.firstFluEnglish@: false
    #     - continue

    # fluVaccinationConsentForm
    - if:
        - =.builtIn.array.has:
            dataIn:
              object: =.Global.roomInfo.edge.name.finishDoc
              value: "Flu Vaccination Consent Form"
        - actionType: evalObject
          object:
            - =..apiRequest.fluVaccinationConsentForm.docAPI.get: ""
            - .Global.formData.fluVaccinationConsentForm@: =..apiRequest.fluVaccinationConsentForm.docQueryResp.doc.0
            - .Global.formData.firstFluVaccinationConsentForm@: false
        - continue

    # 判断会议是否结束
    - if:
        - =.builtIn.number.typeIsValid:
            dataIn:
              docType: =..apiRequest.appointment.edgeQueryResp.edge.0.tage
              localArr: [9]
              binaryArr: [1]
        - actionType: evalObject
          object:
            - ..formData.flag@: "none"
            - .Global.formData.pageName@: =.RequiredForms.formData.pageName
            - ..formData.VisitQuestion@: VisitQuestionnaireShow
            - ..formData.goto_financialForm@: FinancialFormReviewPage1
            - =.builtIn.array.transformPage:
                dataIn:
                  array: =..formDataTemp.formList
                  type: "Review"
                  dataKey: "key"
                dataOut: RequiredForms.formDataTemp.orderList
        - actionType: evalObject
          object:
            - ..formData.VisitQuestion@: VisitQuestionnaire
            - ..formData.goto_financialForm@: FinancialFormEditPage1
            - =.builtIn.array.transformPage:
                dataIn:
                  array: =..formDataTemp.formList
                  type: "Edit"
                  dataKey: "key"
                dataOut: RequiredForms.formDataTemp.orderList
            - =..apiRequest.insurance.docAPI.get: ""
            - =.builtIn.array.getListLength:
                dataIn:
                  object: =..formDataTemp.orderList
                dataOut: RequiredForms.formData.orderLength
            - =.builtIn.string.retainNumber:
                dataIn:
                  value: =..formData.orderLength
                dataOut: RequiredForms.formData.orderLength
            - =.builtIn.number.addition:
                dataIn:
                  num: =..formData.orderLength
                  step: 2
                dataOut: RequiredForms.formData.orderLength
            - =..apiRequest.profileFromAdmin.docAPI.get: ""
  formData: #Input data here
    profile: ""
    orderLength: ""
    orderSelect: []
    formSelect: []
    shareColor: "0xcecfd0"
    isOnClick: none
    VisitQuestion: ""
    pageName: "RequiredForms"
    flag: "block"
  formDataTemp: #Input data temp here, datatemp should not mix with formData
    formList: []
    # 获取的doc list
    orderList: []
    # Optional Forms
    optFormsList:
      - key: Patient Chart
        value: "Patient Chart"
    # 当前doc长度
    localDocuLength: ""
    # 本地获取doc长度
    globalDocuLength: ""

    optionalLength: ""

  apiRequest: #Input data request here
    profileFromAdmin:
      docQueryResp: ""
      docQueryReq:
        id: .Global.roomInfo.edge.id
        xfname: reid
        type: .DocType.PatientProfile
        obfname: mtime
        maxcount: 1
        _nonce: .Global._nonce
      docAPI:
        get:
          api: rd
          dataIn: RequiredForms.apiRequest.profileFromAdmin.docQueryReq
          dataOut: RequiredForms.apiRequest.profileFromAdmin.docQueryResp
    financialForm:
      docQueryResp: ""
      docQueryReq:
        id: .Global.roomInfo.edge.id
        xfname: eid
        type: .DocType.FinancialForm
        obfname: mtime
        maxcount: 1
      docAPI:
        get:
          api: rd
          dataIn: RequiredForms.apiRequest.financialForm.docQueryReq
          dataOut: RequiredForms.apiRequest.financialForm.docQueryResp
    insurance:
      docQueryResp: ""
      docQueryReq:
        id:
          - .Global.rootNotebookID
          - .Global.Profile.id
        xfname: eid,fid
        type: .DocType.InsuranceCard
        _nonce: =.Global._nonce
      docAPI:
        get:
          api: rd
          dataIn: RequiredForms.apiRequest.insurance.docQueryReq
          dataOut: RequiredForms.apiRequest.insurance.docQueryResp
    patientChart:
      docQueryResp: ""
      docQueryReq:
        type: .DocType.PatientChart
        id: .Global.roomInfo.edge.id
        xfname: reid
        maxcount: "1"
        obfname: "ctime"
      docAPI:
        get:
          api: rd
          dataIn: RequiredForms.apiRequest.patientChart.docQueryReq
          dataOut: RequiredForms.apiRequest.patientChart.docQueryResp
    #get data if patient fill the visit questionnaire
    visitQuestionnaire:
      docQueryResp: ""
      docQueryReq:
        type: .DocType.VisitQuestionnaire
        id: .Global.roomInfo.edge.id
        xfname: reid
        maxcount: "1"
        obfname: "ctime"
      docAPI:
        get:
          api: rd
          dataIn: RequiredForms.apiRequest.visitQuestionnaire.docQueryReq
          dataOut: RequiredForms.apiRequest.visitQuestionnaire.docQueryResp
    newPatientForm:
      docQueryResp: ""
      docQueryReq:
        type: .DocType.PatientForm
        id: .Global.roomInfo.edge.id
        xfname: reid
        maxcount: "1"
        obfname: "ctime"
      docAPI:
        get:
          api: rd
          dataIn: RequiredForms.apiRequest.newPatientForm.docQueryReq
          dataOut: RequiredForms.apiRequest.newPatientForm.docQueryResp
    cov19NewPatientForm:
      docQueryResp: ""
      docQueryReq:
        type: .DocType.Cov19TestNewPatForm
        id: .Global.roomInfo.edge.id
        xfname: reid
        maxcount: "1"
        obfname: "ctime"
      docAPI:
        get:
          api: rd
          dataIn: RequiredForms.apiRequest.cov19NewPatientForm.docQueryReq
          dataOut: RequiredForms.apiRequest.cov19NewPatientForm.docQueryResp
    cov19TestForm:
      docQueryResp: ""
      docQueryReq:
        type: .DocType.Cov19TestForm
        id: .Global.roomInfo.edge.id
        xfname: reid
        maxcount: "1"
        obfname: "ctime"
      docAPI:
        get:
          api: rd
          dataIn: RequiredForms.apiRequest.cov19TestForm.docQueryReq
          dataOut: RequiredForms.apiRequest.cov19TestForm.docQueryResp
    pifzerVaccineFirDoseForm:
      docQueryResp: ""
      docQueryReq:
        type: .DocType.PfizerVaccineFirDoseForm
        id: .Global.roomInfo.edge.id
        xfname: reid
        maxcount: "1"
        obfname: "ctime"
      docAPI:
        get:
          api: rd
          dataIn: RequiredForms.apiRequest.pifzerVaccineFirDoseForm.docQueryReq
          dataOut: RequiredForms.apiRequest.pifzerVaccineFirDoseForm.docQueryResp
    pifzerVaccineSecDoseForm:
      docQueryResp: ""
      docQueryReq:
        type: .DocType.PfizerVaccineSecDoseForm
        id: .Global.roomInfo.edge.id
        xfname: reid
        maxcount: "1"
        obfname: "ctime"
      docAPI:
        get:
          api: rd
          dataIn: RequiredForms.apiRequest.pifzerVaccineSecDoseForm.docQueryReq
          dataOut: RequiredForms.apiRequest.pifzerVaccineSecDoseForm.docQueryResp
    modernaVaccineFirDoseForm:
      docQueryResp: ""
      docQueryReq:
        type: .DocType.ModernaVaccineFirDoseForm
        id: .Global.roomInfo.edge.id
        xfname: reid
        maxcount: "1"
        obfname: "ctime"
      docAPI:
        get:
          api: rd
          dataIn: RequiredForms.apiRequest.modernaVaccineFirDoseForm.docQueryReq
          dataOut: RequiredForms.apiRequest.modernaVaccineFirDoseForm.docQueryResp
    modernaVaccineSecDoseForm:
      docQueryResp: ""
      docQueryReq:
        type: .DocType.ModernaVaccineSecDoseForm
        id: .Global.roomInfo.edge.id
        xfname: reid
        maxcount: "1"
        obfname: "ctime"
      docAPI:
        get:
          api: rd
          dataIn: RequiredForms.apiRequest.modernaVaccineSecDoseForm.docQueryReq
          dataOut: RequiredForms.apiRequest.modernaVaccineSecDoseForm.docQueryResp
    fluVaccinationConsentForm:
      docQueryResp: ""
      docQueryReq:
        type: .DocType.FluVaccinationConsent
        id: .Global.roomInfo.edge.id
        xfname: reid
        maxcount: "1"
        obfname: "ctime"
      docAPI:
        get:
          api: rd
          dataIn: RequiredForms.apiRequest.fluVaccinationConsentForm.docQueryReq
          dataOut: RequiredForms.apiRequest.fluVaccinationConsentForm.docQueryResp
    # fluVaccinationConsentFormEnglish:
    #   docQueryResp: ""
    #   docQueryReq:
    #     type: .DocType.FluVaccinationConsentFormEnglish
    #     id: .Global.roomInfo.edge.id
    #     xfname: reid
    #     maxcount: "1"
    #     obfname: "ctime"
    #   docAPI:
    #     get:
    #       api: rd
    #       dataIn: RequiredForms.apiRequest.fluVaccinationConsentFormEnglish.docQueryReq
    #       dataOut: RequiredForms.apiRequest.fluVaccinationConsentFormEnglish.docQueryResp
    appointmentTag:
      docCreateResp: ""
      docCreateReq:
        eid: .Global.currentRoom.edge.id
        reid: .Global.currentRoom.edge.id
        type: .DocType.GroupBitOrTage
        tage: 3
        name:
          data: ""
      docAPI:
        store:
          api: cd
          dataIn: RequiredForms.apiRequest.appointmentTag.docCreateReq
          dataOut: RequiredForms.apiRequest.appointmentTag.docCreateResp
    appointment:
      edgeQueryResp: ""
      edgeQueryReq:
        id: .Global.roomInfo.edge.id
        _nonce: =.Global._nonce
      edgeCreateReq: .Global.roomInfo.edge
      edgeCreateResp: ""
      edgeAPI:
        store:
          api: ce
          dataIn: RequiredForms.apiRequest.appointment.edgeCreateReq
          dataOut: RequiredForms.apiRequest.appointment.edgeCreateResp
        get:
          api: re
          dataIn: RequiredForms.apiRequest.appointment.edgeQueryReq
          dataOut: RequiredForms.apiRequest.appointment.edgeQueryResp
  style: #Input style fragment here
  components:
    - .TipsMultiLine:
      viewTag: judgeVisitQuestionnaire
      message: "You have not filled in the Visit Questionnaire"
    # - .BaseCheckView: ""
    #   message: "You have not filled in the Visit Questionnaire"
    #   viewTag: judgeVisitQuestionnaire
    #   colorChange: "0x2988e6"
    #   imgPath: aboutBlue.svg
    #   children:
    #     - type: view
    #       style:
    #         width: "0.8"
    #         height: "0.3"
    #         top: "0.3"
    #         left: "0.1"
    #         zIndex: "100"
    #         backgroundColor: "0xffffff"
    #         borderRadius: "7"
    #         border:
    #           style: "3"
    #         borderColor: "#f4f8fa"
    #         borderWidth: "3"
    #       children:
    #         - .BaseCheckViewImg:
    #         - .BaseCheckViewLabel:
    #         - .BaseCheckViewButton:
    #           onClick:
    #             - actionType: popUpDismiss
    #               popUpView: ____.viewTag
    # - .BaseHeader:
    # - .HeaderLeftBack:
    - .BasePublicHeader:
      children:
        - .BasePublicHeaderLeft:
        - .BasePublicHeaderTitle:
    - type: scrollView
      style:
        width: "1"
        height: "0.835"
        overflow: scroll
      children:
        - type: view
          style:
            marginLeft: "0.05"
            width: "0.9"
            height: "auto"
            overflow: hidden
          children:
            - type: label
              text: Please complete required forms in order
              style:
                marginTop: "0.04"
                fontSize: .Nfont.h2

            - type: view
              viewTag: visitSelectTag
              onClick:
                - goto: =..formData.VisitQuestion
              style:
                width: "0.9"
                height: "auto"
                marginLeft: "0"
                marginTop: "0.015"
              children:
                - type: image
                  style:
                    display: "inline-block"
                    verticalAlign: middle
                    height: "0.025"
                  path:
                    emit:
                      actions:
                        - if:
                            - =.builtIn.array.has:
                                dataIn:
                                  object: =.Global.vaccine
                                  value: "Visit Questionnaire"
                            - selectOnBlack.svg
                            - selectOffBlack.svg
                - type: label
                  text: Visit Questionnaire
                  style:
                    marginLeft: "0.05"
                    display: "inline-block"
                    verticalAlign: middle

                    fontSize: .Nfont.h15
                    height: "auto"
                    width: "0.75"
                    textDecoration: underline
                    wordWrap: break-word
            - type: view
              viewTag: visitSelectTag
              onClick:
                - goto: =..formData.goto_financialForm
              style:
                width: "0.9"
                height: "auto"
                marginLeft: "0"
                marginTop: "0.015"
              children:
                - type: image
                  style:
                    display: "inline-block"
                    verticalAlign: middle
                    height: "0.025"
                  path:
                    emit:
                      actions:
                        - if:
                            - =.builtIn.array.has:
                                dataIn:
                                  object: =.Global.vaccine
                                  value: "Financial Responsibility Form"
                            - selectOnBlack.svg
                            - selectOffBlack.svg
                - type: label
                  text: Financial Responsibility Form
                  style:
                    marginLeft: "0.05"
                    display: "inline-block"
                    verticalAlign: middle

                    fontSize: .Nfont.h15
                    height: "auto"
                    width: "0.75"
                    textDecoration: underline
                    wordWrap: break-word
            - type: list
              viewTag: SelectTag
              contentType: listObject
              listObject: ..formDataTemp.orderList
              iteratorVar: itemObject
              style:
                margin: "0"
                marginTop: "0"
                width: "0.9"
                left: "0"
                height: "auto"
              children:
                - type: listItem
                  itemObject:
                  style:
                    width: "0.9"
                    height: "auto"
                    left: "0"
                    marginTop: "0.015"
                  onClick:
                    - emit:
                        dataKey:
                          var: itemObject
                        actions:
                          - if:
                              - =.Global.visitQuestionnaireDoc
                              - goto: $var.pageName
                              - continue
                    - actionType: popUp
                      popUpView: judgeVisitQuestionnaire
                      wait: true
                  children:
                    - type: view
                      style:
                        marginTop: "0"
                        height: "auto"
                        width: "0.9"
                      children:
                        - type: image
                          style:
                            display: "inline-block"
                            verticalAlign: middle
                            height: "0.025"
                          path:
                            emit:
                              dataKey:
                                var: itemObject
                              actions:
                                - if:
                                    - =.builtIn.array.has:
                                        dataIn:
                                          object: =.Global.vaccine
                                          value: $var.key
                                    - selectOnBlack.svg
                                    - selectOffBlack.svg
                        - type: label
                          dataKey: itemObject.key
                          style:
                            marginLeft: "0.05"
                            display: "inline-block"
                            verticalAlign: middle

                            fontSize: .Nfont.h15
                            height: "auto"
                            width: "0.75"
                            textDecoration: underline
                            wordWrap: break-word
        - type: view
          style:
            marginLeft: "0.05"
            width: "0.9"
            height: "auto"
            overflow: hidden
          children:
            - type: label
              text: Optional Forms
              style:
                marginTop: "0.04"
                fontSize: .Nfont.h2

            - type: list
              viewTag: formSelectTag
              contentType: listObject
              listObject: ..formDataTemp.optFormsList
              iteratorVar: itemObject
              style:
                margin: "0"
                marginTop: "0.02"
                width: "0.9"
                left: "0"
                height: "auto"
              children:
                - type: listItem
                  itemObject:
                  style:
                    width: "0.9"
                    height: "0.038"
                    left: "0"
                    marginTop: "0.01"
                  children:
                    - type: view
                      style:
                        width: "0.9"
                        height: "auto"
                        marginTop: "0"
                      children:
                        - type: image
                          style:
                            display: "inline-block"
                            verticalAlign: middle
                            height: "0.025"
                          path:
                            emit:
                              dataKey:
                                var: itemObject
                              actions:
                                - if:
                                    - =.builtIn.array.has:
                                        dataIn:
                                          object: =.Global.optionalForms
                                          value: $var.key
                                    - selectOnBlack.svg
                                    - selectOffBlack.svg
                          onClick:
                            - emit:
                                dataKey:
                                  var: itemObject
                                actions:
                                  - if:
                                      - =.builtIn.array.has:
                                          dataIn:
                                            object: =..formData.formSelect
                                            value: $var.key
                                      - =.builtIn.array.removeByValue:
                                          dataIn:
                                            object: =..formData.formSelect
                                            value: $var.key
                                      - =.builtIn.array.add:
                                          dataIn:
                                            object: =..formData.formSelect
                                            value: $var.key
                            - actionType: builtIn
                              funcName: redraw
                              viewTag: formSelectTag
                        - type: label
                          dataKey: itemObject.value
                          style:
                            marginLeft: "0.05"
                            display: "inline-block"
                            verticalAlign: middle

                            fontSize: .Nfont.h15
                            height: "auto"
                            width: "0.6"
                            textDecoration: underline
                          onClick:
                            - emit:
                                dataKey:
                                  var: itemObject
                                actions:
                                  - if:
                                      - =.builtIn.string.equal:
                                          dataIn:
                                            string1: $var.key
                                            string2: "Patient Chart"
                                      - .Global.isShare@: true
                                      - continue
                                  - if:
                                      - =.builtIn.string.equal:
                                          dataIn:
                                            string1: $var.key
                                            string2: "Patient Chart"
                                      - goto: PatientChart
                                      - continue

    - .NextButtonView:
      style:
        boxShadow: "0px 1px 10px #dbdfe3"
        backgroundColor: "0xffffff"
        overflow: hidden
        display: ..formData.flag
      children:
        - type: button
          viewTag: shareButton
          text: Done
          style:
            marginTop: "0.025"
            marginLeft: "0.2"
            width: "0.6"
            height: "0.04"
            backgroundColor: ..formData.shareColor
            border:
              style: 3
            borderColor: ..formData.shareColor
            borderRadius: "2"
            borderWidth: "1"

            fontSize: .Nfont.h2
            color: "0xffffff"
            textAlign:
              x: center
          onClick:
            - actionType: evalObject
              object:
                - if:
                    - =.builtIn.string.equal:
                        dataIn:
                          string1: =..formDataTemp.globalDocuLength
                          string2: =..formData.orderLength
                    - continue
                    - actionType: popUp
                      popUpView: warningView
                      wait: true
                      popUpDismiss: 2000
                - .RequiredForms.apiRequest.appointment.edgeCreateReq.name.optionalForms@: =.Global.optionalForms
                # share doc
                - =.builtIn.array.add:
                    dataIn:
                      object: =.Global.vaccineDoc
                      value: =.Global.formData.visitQuestionnaireDoc.doc
                - =.builtIn.array.add:
                    dataIn:
                      object: =.Global.vaccineDoc
                      value: =.Global.formData.patientDoc.financialForm
                - if:
                    - =.Global.formData.patientDoc.status.sharePatientChart
                    - =.builtIn.array.add:
                        dataIn:
                          object: =.Global.vaccineDoc
                          value: =.PatientChart.PatientChartObject
                    - continue
                - if:
                    - =.Global.formData.newPatientForm.id
                    - =.builtIn.array.add:
                        dataIn:
                          object: =.Global.vaccineDoc
                          value: =.Global.formData.newPatientForm
                    - continue
                - if:
                    - =.Global.formData.pifzerVaccineFirDoseForm.id
                    - =.builtIn.array.add:
                        dataIn:
                          object: =.Global.vaccineDoc
                          value: =.Global.formData.pifzerVaccineFirDoseForm
                    - continue
                - if:
                    - =.Global.formData.pifzerVaccineSecDoseForm.id
                    - =.builtIn.array.add:
                        dataIn:
                          object: =.Global.vaccineDoc
                          value: =.Global.formData.pifzerVaccineSecDoseForm
                    - continue
                - if:
                    - =.Global.formData.cov19TestNewPatForm.id
                    - =.builtIn.array.add:
                        dataIn:
                          object: =.Global.vaccineDoc
                          value: =.Global.formData.cov19TestNewPatForm
                    - continue
                - if:
                    - =.Global.formData.cov19TestForm.id
                    - =.builtIn.array.add:
                        dataIn:
                          object: =.Global.vaccineDoc
                          value: =.Global.formData.cov19TestForm
                    - continue
                - if:
                    - =.Global.formData.modernaVaccineFirDoseForm.id
                    - =.builtIn.array.add:
                        dataIn:
                          object: =.Global.vaccineDoc
                          value: =.Global.formData.modernaVaccineFirDoseForm
                    - continue
                - if:
                    - =.Global.formData.modernaVaccineSecDoseForm.id
                    - =.builtIn.array.add:
                        dataIn:
                          object: =.Global.vaccineDoc
                          value: =.Global.formData.modernaVaccineSecDoseForm
                    - continue
                # - if:
                #     - =.Global.formData.patientDoc.fluVaccinationConsentForm.doc.id
                #     - =.builtIn.array.add:
                #         dataIn:
                #           object: =.Global.vaccineDoc
                #           value: =.Global.formData.patientDoc.fluVaccinationConsentForm.doc
                #     - continue
                - if:
                    - =.Global.formData.fluVaccinationConsentForm.id
                    - =.builtIn.array.add:
                        dataIn:
                          object: =.Global.vaccineDoc
                          value: =.Global.formData.fluVaccinationConsentForm
                    - continue
                - if:
                    - =.builtIn.number.typeIsValid:
                        dataIn:
                          docType: =.Global.roomInfo.edge.tage
                          localArr: [2]
                          binaryArr: [1]
                    - =.builtIn.ecos.updateDocList:
                        dataIn:
                          sourceDocList: =.Global.vaccineDoc
                    - =.builtIn.ecos.shareDocList:
                        dataIn:
                          sourceDocList: =.Global.vaccineDoc
                          targetEdgeID: =.Global.roomInfo.edge.id
                          reid: =.Global.roomInfo.edge.id
                - if:
                    - =.builtIn.array.judgeListLength:
                        dataIn:
                          array: =..apiRequest.profileFromAdmin.docQueryResp.doc
                          len: 0
                    - actionType: evalObject
                      object:
                        - =.builtIn.ecos.shareDoc:
                            dataIn:
                              sourceDoc: =.Global.Profile
                              targetEdgeID: =.Global.roomInfo.edge.id
                              reid: =.Global.roomInfo.edge.id
                            dataOut: RequiredForms.formData.profile
                        - if:
                            - =.Global.formData.hashTag.id
                            - =.builtIn.ecos.shareDoc:
                                dataIn:
                                  sourceDoc: =.Global.formData.hashTag
                                  targetEdgeID: =.Global.roomInfo.edge.id
                                  reid: =..formData.profile.doc.id
                            - continue
                    - continue
                - =.builtIn.ecos.shareDocList:
                    dataIn:
                      sourceDocList: =..apiRequest.insurance.docQueryResp.doc
                      targetEdgeID: =.Global.roomInfo.edge.id
                      reid: =..formData.profile.doc.id
                - =..apiRequest.appointment.edgeAPI.store: ""
                # create meeting tag
                - =..apiRequest.appointmentTag.docAPI.store: ""
            - actionType: evalObject
              object:
                .Global._nonce@:
                  =.builtIn.math.random: ""
            - actionType: evalObject
              object:
                - =..apiRequest.appointment.edgeAPI.get: ""
                - .Global.roomInfo.edge@: =..apiRequest.appointment.edgeQueryResp.edge.0
                - if:
                    - =.builtIn.number.typeIsValid:
                        dataIn:
                          docType: =.Global.roomInfo.edge.subtype
                          localArr: [17]
                          binaryArr: [1]
                    - goto: AppointmentLobby
                    - goto: AppointmentLobbyOfficeVisit
    - .TipsMultiLine:
      viewTag: warningView
      message: "Please complete required forms in order"
    # - .BackgroundColorGray:
    #   viewTag: warningView
    #   children:
    #     - type: view
    #       style:
    #         width: "0.4"
    #         height: "auto"
    #         backgroundColor: "0xe5e5e5"
    #         borderRadius: "12"
    #         top: "0.43"
    #         left: "0.3"
    #         textAlign:
    #           x: center
    #       children:
    #         - type: image
    #           path: aboutRed.svg
    #           style:
    #             width: "0.105"
    #             marginTop: "0.025"
    #         - type: label
    #           text: "Please complete required forms in order"
    #           dataKey:
    #           style:
    #             color: "0x555555"
    #             fontSize: .Nfont.h0
    #
    #             word-break: break-word
    #             width: "0.35"
    #             marginLeft: "0.025"
    #             marginTop: "0.009"
    #             # textAlign:
    #             #   x: center
    #         - type: view
    #           style:
    #             width: "0.01"
    #             height: "0.02"
