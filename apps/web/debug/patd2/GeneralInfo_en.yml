GeneralInfo:
  pageNumber: "170"
  title: "General Information"
  init:
    - .SignInCheck
    - actionType: evalObject
      object: 
        .Global._nonce@: 
          =.builtIn.math.random: ""
    - ..generalInfo.get
    - actionType: evalObject
      object:
        - ..generalInfo.document@: =..generalInfo.response.doc.0
  generalInfo:
    response:
    document:
    get:
      .DocAPI.get: "" 
      api: rd
      id: .Global.rootNotebookID
      xfname: eid
      type: .DocType.PatientGeneralInfo #  type: "257"
      obfname: "ctime"
      maxcount: "1"
      dataKey: generalInfo.response
      _nonce: =.Global._nonce  
  docResponse: 
    doc:
      - type: .DocType.PatientChart # - type: "257" # private profile
        eid: .Global.rootNotebookID
        name: ""
    error: ""
    jwt: ""
  shareDocuments:
    document: ""
    docAPI:
      store:
        api: cd
        dataKey: shareDocuments.document
        subtype:
          mediaType: "application/json" 
  sharedDoc: ""
  selectedDoc: "" 
  components:
    - .BaseHeader:
    - .HeaderLeftButton:  
    - type: scrollView
      style:
        top: "0.1"
        left: "0"
        width: "1"
        height: "0.9"
        overflow: scroll
      children:
        - type: view
          style:
            top: "0"
            left: "0"
            width: "1"
            # height: "7.2"
          children:
            - type: view
              style:
                width: "1"
                height: "0.47"
                left: "0"
                marginTop: "0"

              children:
                - .PatientChartTitleView:
                  style: 
                      marginTop: "0"
                      left: "0"
                  children: 
                    - .PatientChartTitle: 
                      text1: "General Information"
                      style:
                        # top: "0"
                        height: "0.04"
                - type: view
                  style:
                    top: "0.05"
                    width: "0.9"
                    height: "0.41"
                    left: "0.05"
                    # border:
                    #   style: "2"
                    # borderWidth: "2"
                    # borderColor: "#bfbfbf"
                  children:
                    - .PatientChartShowLine:
                      children:
                        - .PatientChartShowTitle:
                          text: First name
                        - .PatientChartShowData:
                          style: 
                            top: "0.002"
                          dataKey: generalInfo.document.name.data.firstName
                    - .PatientChartShowLine:
                      style:
                        top: "0.04"
                      children:
                        - .PatientChartShowTitle:
                          text: Middle name or initial
                        - .PatientChartShowData:
                          style: 
                            top: "0.002"
                          text: ""
                          dataKey: generalInfo.document.name.data.middleNameAndInitial
                    - .PatientChartShowLine:
                      style:
                        top: "0.08"
                      children:
                        - .PatientChartShowTitle:
                          text: Last name
                        - .PatientChartShowData:
                          style: 
                            top: "0.002"
                          dataKey: generalInfo.document.name.data.lastName
                    - .PatientChartShowLine:
                      style:
                        top: "0.12"
                      children:
                        - .PatientChartShowTitle:
                          text: Preferred name
                        - .PatientChartShowData:
                          style: 
                            top: "0.002"
                          dataKey: generalInfo.document.name.data.preferredName
                    - .PatientChartShowLine:
                      style:
                        top: "0.16"
                      children:
                        - .PatientChartShowTitle:
                          text: Date of birth
                        - .PatientChartShowData:
                          style: 
                            top: "0.002"
                          dataKey: generalInfo.document.name.data.dateOfBirth
            
        - type: button
          text: Share
          onClick: 
            # - actionType: evalObject 
            #   object:
            #     .PatientChart.selectedDoc@: =.PatientChart.PatientChartObject
            - actionType: evalObject     # to download the selected document and using target edge id 
              object:                  # to encrypt new document with the same content
                - if:
                  - =.Global.isShare
                  # - actionType: evalObject
                  #   object:
                  - =.builtIn.ecos.shareDoc: 
                      dataIn:                
                        sourceDoc: =.GeneralInfo.generalInfo.document
                        targetEdgeID: =.Global.roomInfo.edge.id
                        # targetEdgeID: =.Global.rootNotebookID
                      dataOut: =.GeneralInfo.sharedDoc
                  - continue
                - .Global.isShare@: false
            # - actionType: evalObject    
            #   object:     
            #     - ..shareDocuments.document@: =.PatientChart.PatientChartObject
            #     # - ..shareDocuments.document.id@: "" 
            #     - ..shareDocuments.document.eid@: =.Global.waitingRoom.edge.id    
            # - actionType: evalObject    
            #   object: ..save  
            # - goto: AppointmentDetail
            - actionType: evalObject
              object: 
                - .Global.generalInfoDoc@: "true"
                - =.builtIn.array.add:
                    dataIn:
                      object: =.Global.optionalForms
                      value: GeneralInfo
            - actionType: builtIn
              funcName: goBack
          style:
            width: "0.6"
            left: "0.2"
            fontSize: "16"
            top: "0.8"
            height: "0.05"
            color: "0xffffff"
            backgroundColor: "0x2988e6"
            border: 
              style: "3"
            borderColor: "0x2988e6"
            textAlign: 
              x: center
