ScheduleSettingsDisplay:
  #xd page number: 65
  title: "Availability"
  pageNumber: "380"
  init:
    - .SignInCheck
    - .BaseData.calendarDate.todayDate@: ""
    - actionType: evalObject
      object: .BaseDate.getDate
    #生成年份
    - =.builtIn.date.generateYear:
        dataIn:
          last: 40
          next: 10
        dataOut: BaseDate.year
    - =..getVertexType.vertexAPI.get: ""
    - actionType: evalObject
      object:
        - =.builtIn.date.LoopToGenerate:
            dataIn:
              span: =..newAppointment.edge.name.setting.bookingTimeSpan
            dataOut: ScheduleSettingsDisplay.scheduleSettingsTemp.TimeSpan

    - actionType: evalObject
      object:
        - if:
            - =.Global.currentSchedule.id
            - ..newAppointment.edge@: =.Global.currentSchedule
            - ..newAppointment.edge@: =..newBackup
        - if:
            - =.Global.currentSchedule.id
            - =.builtIn.array.transformNull:
                dataIn:
                  dayObject: =..newAppointment.edge.name.setting.day
            - continue
        - ..newAppointment.edge.id@: ""
        - if:
            - =.Global.currentSchedule.id
            - =.builtIn.array.formaDuration:
                dataIn:
                  arr: =.Global.currentSchedule.name.setting.day
                  indexParam: "index"
                  keyParam: "key"
                  strParam: "duration"
                dataOut: ScheduleSettingsDisplay.addWeek
            - continue
        # - if:
        #   - =.Global.currentSchedule.id
        #   - =.builtIn.date.transformSelectWeek:
        #       dataIn:
        #         object: =.Global.currentSchedule.name.setting.day
        #       dataOut: ScheduleSettingsDisplay.formData.res
        #   - continue
        # - if:
        #   - =.ScheduleSettingsDisplay.formData.res.addWeek.0
        #   - ..addWeek@: =.ScheduleSettingsDisplay.formData.res.addWeek
        #   - continue
        - if:
            - =.ScheduleSettingsDisplay.formData.res.selectWeek.0
            - ..scheduleSettingsTemp.weekDaySelect@: =.ScheduleSettingsDisplay.formData.res.selectWeek
            - continue
    - ..newAppointment.edge.name.visitType@: =.Global.formData.scheduleType
    - ..newAppointment.edge.name.setting.Address@: =.Global.formData.scheduleAddress
    - if:
        # 判断是什么类型，并根据类型决定预约的edge的bvid
        - =.builtIn.string.equal:
            dataIn:
              string1: =..newAppointment.edge.name.visitType
              string2: "Telemedicine"
        - ..newAppointment.edge.bvid@: =.Global.currentFacility.id
        - ..newAppointment.edge.bvid@: =.Global.formData.scheduleLocationId
    - if:
        # 判断是什么类型，并根据类型决定预约的edge的bvid
        - =.builtIn.string.equal:
            dataIn:
              string1: =..getVertexType.vertexResp.vertex.0.type
              string2: 1
        - continue
        - ..newAppointment.edge.bvid@: =.Global.formData.scheduleLocationId
    - actionType: evalObject
      object:
        .BaseDate.calendarDate.year@:
          =.builtIn.date.getYear: ""
    - actionType: evalObject
      object:
        .BaseDate.calendarDate.month@:
          =.builtIn.date.getMonth: ""
    - actionType: evalObject
      object:
        .BaseDate.calendarDate.day@:
          =.builtIn.date.getDate: ""
    # - =.builtIn.date.getDate: 
    #     dataIn: 
    #     dataOut: BaseDate.calendarDate.day
    # - =.builtIn.date.getMonth: 
    #     dataIn: 
    #     dataOut: BaseDate.calendarDate.month
    - =.builtIn.date.ShowDateByNumber:
        dataIn:
          year: =.BaseDate.calendarDate.year
          month: =.BaseDate.calendarDate.month
          day: =.BaseDate.calendarDate.day
          formatType: "Y-M-D"
        dataOut: BaseDate.calendarDate.todayDate
    - ..newAppointment.edge.name.setting.startDate@: =.BaseDate.calendarDate.todayDate
    - if:
        # 判断是什么类型，并根据类型决定是否可编辑地址
        - =.builtIn.string.equal:
            dataIn:
              string1: =..newAppointment.edge.name.visitType
              string2: "Telemedicine"
        - continue
        - =.builtIn.checkField:
            dataIn:
              contentType: messageHidden
              wait: 100
    - if:
        # 判断是什么类型，并根据类型决定预约的edge的bvid
        - =.builtIn.string.equal:
            dataIn:
              string1: =..getVertexType.vertexResp.vertex.0.type
              string2: 1
        - continue
        - =.builtIn.checkField:
            dataIn:
              contentType: messageHidden
              wait: 100
    # 显示信息（provider的名字或者roomName)
    - if:
        - .Global.acceptInfo.name.data.roomName
        - ..formData.appointmentName@: =.Global.acceptInfo.name.data.roomName
        - ..formData.appointmentName@: =.Global.acceptInfo.name.data.fullName
    - actionType: evalObject
      object:
        .ScheduleSettingsDisplay.newAppointment.edge.name.setting.timezoneOffsetInMinute@:
          =.builtIn.date.getTimezoneOffset: ""
  viewPort: top
  # WeekData: 
  formData:
    judgeTimeOverlap: true
    start: ""
    end: ""
    flag: ""
    appointmentName: ""
  getVertexType:
    # judge the type of newAppointment's evid  
    vertexResp: ""
    vertex:
      id: .Global.acceptInfo.bsig
    vertexAPI:
      get:
        api: rv
        dataIn: getVertexType.vertex
        dataOut: ScheduleSettingsDisplay.getVertexType.vertexResp
  newAppointment:
    response:
    edge:
      .Edge: ""
      id: ""
      subtype: .Global.setSchedule.scheduleTypeNumber #   0x10003 3<<16 + 1  3*65536 +1  0x30000|1 196609   online ,  +2 in office  0x20000|1    2<<16 + 1  131073,  0x10000|1 1<<16+1 65537
      type: 40000
      # bvid: .Global.currentFacility.id 
      bvid: ""
      evid: .Global.acceptInfo.bsig
      name:
        roomName: ""
        visitType: ""
        setting:
          day:
            - 
            - 
            - 
            - 
            - 
            - 
            - 
          forwardRepeatWeeks: '10'
          blockDays: []
          governmentHolidays: ''
          businessHolidays: ''
          # advanceBookingLimit: '1'
          bookingTimeSpan: '30'
          timeSlotBackColor: "#ffffff"
          timeSlotColor: "#000000"
          timezoneOffsetInMinute: ""
          startDate: ""
          endDate: ""
          Address: ""
    edgeAPI:
      .EdgeAPI: ""
      store:
        api: ce
        dataIn: newAppointment.edge
        dataOut: newAppointment.response

  AvailableTime:
    timeStart: ""
    timeEnd: "00:00AM"
    timeResult: ""
  addWeek: []

  scheduleSettingsTemp:
    weekdayTemp:
      - key: Sunday
        index: 0
        AvailableTime:
          timeStart: "00:00AM"
          timeEnd: "00:00AM"
      - key: Monday
        index: 1
        AvailableTime:
          timeStart: "00:00AM"
          timeEnd: "00:00AM"
      - key: Tuesday
        index: 2
        AvailableTime:
          timeStart: "00:00AM"
          timeEnd: "00:00AM"
      - key: Wednesday
        index: 3
        AvailableTime:
          timeStart: "00:00AM"
          timeEnd: "00:00AM"
      - key: Thursday
        index: 4
        AvailableTime:
          timeStart: "00:00AM"
          timeEnd: "00:00AM"
      - key: Friday
        index: 5
        AvailableTime:
          timeStart: "00:00AM"
          timeEnd: "00:00AM"
      - key: Saturday
        index: 6
        AvailableTime:
          timeStart: "00:00AM"
          timeEnd: "00:00AM"
    weekDaySelect:
      - key: M
        index: 1
      - key: T
        index: 2
      - key: W
        index: 3
    TimeSpan:
      - 00:00
      - 12:00
  date:
    - day: Sunday
    - day: Monday
    - day: Tuesday
    - day: Wednesday
    - day: Thursday
    - day: Friday
    - day: Saturday
  components:
    - .TotalView:
      children:
        - .SideMenuBar:
          children:
            - .aitLogo:
            - .MenuBar:
        - .TopBar:
        - .InnerBodyView:
          children:
            - .PageTitleLabel:
            - .GotoBack:
              style:
                top: "0.05"
              onClick:
                - actionType: popUp
                  popUpView: SaveChangeView
                # - actionType: builtIn
                #   funcName: goBack
                #   reload: true
            - .ContentBar:
              children:
                - type: view
                  style:
                    width: "0.75"
                    left: "0.026"
                    height: "0.02"
                    marginTop: "0.03"
                  children:
                    - type: label
                      text: Schedule Availability
                      style:
                        fontWeight: "600"
                        fontSize: .Nfont.n5
                    - type: view
                      style:
                        marginTop: "0.02"
                        display: inline-block
                        marginLeft: "0"
                      children:
                        - type: label
                          text: Start Date
                          style:
                            top: "0"
                            width: "0.163"
                            fontSize: "15"
                            display: inline-block
                            fontWeight: "500"
                        - type: view
                          viewTag: startDateTimeTag
                          onClick:
                            - actionType: popUp
                              popUpView: startDateTag
                          style:
                            marginTop: "0.03"
                            width: "0.163"
                            height: "0.045"
                            border:
                              style: "3"
                            borderWidth: "1"
                            borderRadius: "3"
                            borderColor: "#eaeaea"
                            display: flex
                          children:
                            - type: label
                              placeholder: YYYY-MM-DD
                              dataKey: newAppointment.edge.name.setting.startDate
                              style:
                                marginLeft: "0.01"
                                textAlign:
                                  y: center
                                fontSize: .Nfont.n6_1_1
                                height: "0.045"
                            - type: image
                              path: startTime.svg
                              style:
                                width: "0.01"
                                marginLeft: "0.09"

                    - type: view
                      style:
                        marginTop: "0.02"
                        display: inline-block
                        marginLeft: "0.01"
                      children:
                        - type: label
                          text: Repeat weeks
                          style:
                            # top: "0"
                            width: "0.07"
                            fontSize: "15"
                            top: "0"
                            display: inline-block
                            fontWeight: "500"
                        - type: textField
                          dataKey: newAppointment.edge.name.setting.forwardRepeatWeeks
                          style:
                            marginTop: "0.03"
                            width: "0.07"
                            height: "0.045"
                            fontSize: "15"
                            border:
                              style: "3"
                            borderWidth: "1"
                            borderRadius: "3"
                            borderColor: "#eaeaea"

                - type: view
                  style:
                    width: "0.82"
                    height: "0.64"
                    top: "0.18"
                    left: "0"
                    # backgroundColor: "0x003d6833"
                  children:
                    - type: view
                      viewTag: AvailableTimeTag
                      style:
                        left: "0.026"
                        width: "0.358"
                        height: "0.5478"
                        border:
                          style: "1"
                      children:
                        - type: view
                          style:
                            top: "0"
                            left: "0"
                            width: "0.358"
                            height: "0.04"
                            backgroundColor: "#eff0f2"
                            border:
                              style: "3"
                            borderColor: "#d0d9df"
                          children:
                            - type: label
                              text: Availability  Setting
                              style:
                                top: "0"
                                left: "0.02"
                                height: "0.04"
                                textAlign:
                                  y: center
                                fontFamily: Poppins
                                fontSize: "16"

                        - .BaseList:
                          listObject: ..scheduleSettingsTemp.weekdayTemp
                          style:
                            top: "0.04"
                            width: "0.358"
                            margin: "0"
                          children:
                            - .BaseListItem:
                              style:
                                width: "0.358"
                                height: "0.07"
                                borderLeft: "1px solid #d0d9df"
                                borderRight: "1px solid #d0d9df"
                                borderBottom: "1px solid #d0d9df"
                              children:
                                - type: label
                                  dataKey: itemObject.key
                                  style:
                                    top: "0.025"
                                    left: "0.02"
                                    fontFamily: Poppins
                                    fontSize: "14"
                                    fontWeight: "550"
                                - type: select
                                  dataKey: AvailableTime.timeStart
                                  options: ..scheduleSettingsTemp.TimeSpan
                                  style:
                                    top: "0.025"
                                    width: "0.08"
                                    height: "0.03"
                                    fontSize: "15"
                                    left: "0.09"
                                    boxSizing: border-box
                                    borderColor: "#d0d9df"

                                - type: view
                                  style:
                                    backgroundColor: "#c1c1c1"
                                    left: "0.175"
                                    height: "0.0015"
                                    width: "0.00625"
                                    top: "0.038"
                                - type: select
                                  dataKey: AvailableTime.timeEnd
                                  options: ..scheduleSettingsTemp.TimeSpan
                                  style:
                                    top: "0.025"
                                    width: "0.08"
                                    height: "0.03"
                                    left: "0.185"
                                    fontSize: "15"
                                    boxSizing: border-box
                                    borderColor: "#d0d9df"
                                - type: view
                                  style:
                                    top: "0.03"
                                    width: "0.05"
                                    height: "0.02"
                                    left: "0.28"
                                  children:
                                    - type: image
                                      path: addTime.svg
                                      style:
                                        width: "0.01"
                                        fontSize: "2.8vh"
                                        color: "0x004779"
                                        display: inline-block
                                    - type: label
                                      text: Add New
                                      style:
                                        fontSize: .Nfont.n6_1
                                        marginLeft: "0.005"
                                        display: inline-block
                                        color: "#005795"
                                  onClick:
                                    - actionType: evalObject
                                      object:
                                        .ScheduleSettingsDisplay.WeekData@: ""
                                    - emit:
                                        dataKey:
                                          var: itemObject
                                        actions:
                                          - ..formData.start@: $var.AvailableTime.timeStart
                                          - ..formData.end@: $var.AvailableTime.timeEnd
                                          - if:
                                              - =.builtIn.date.compareDate:
                                                  dataIn:
                                                    comTime: $var
                                                    pareTime: =..addWeek
                                                    timeStart: "AvailableTime.timeStart"
                                                    timeEnd: "AvailableTime.timeEnd"
                                              - ..formData.judgeTimeOverlap@: true
                                              - ..formData.judgeTimeOverlap@: false
                                    - actionType: evalObject
                                      object:
                                        - =.builtIn.date.DateCompare:
                                            dataIn:
                                              startTime: =..formData.start
                                              endTime: =..formData.end
                                            dataOut: ScheduleSettingsDisplay.formData.flag
                                    - actionType: evalObject
                                      object:
                                        - if:
                                            - =.builtIn.date.DateCompare:
                                                dataIn:
                                                  startTime: =..formData.start
                                                  endTime: =..formData.end
                                            - continue
                                            - actionType: popUp
                                              popUpView: timeErrorView
                                              wait: true
                                        - if:
                                            - =..formData.judgeTimeOverlap
                                            - continue
                                            - actionType: popUp
                                              popUpView: timeOverlapView
                                              wait: true
                                        - ..formData.start@: ""
                                        - ..formData.end@: ""
                                        - ..formData.judgeTimeOverlap@: true
                                    - emit:
                                        dataKey:
                                          var: itemObject
                                        actions:
                                          - if:
                                              - ..formData.flag
                                              - =.builtIn.string.concat:
                                                  dataIn:
                                                    - $var.AvailableTime.timeStart
                                                    - "-"
                                                    - $var.AvailableTime.timeEnd
                                                  dataOut: ScheduleSettingsDisplay.AvailableTime.timeResult
                                              - continue

                                          - if:
                                              - ..formData.flag
                                              - =.builtIn.array.addByIndex:
                                                  dataIn:
                                                    object: =..newAppointment.edge.name.setting.day
                                                    value: =..AvailableTime.timeResult
                                                    index: $var.index
                                              - continue
                                          - if:
                                              - ..formData.flag
                                              - =.builtIn.array.addWeekDuration:
                                                  dataIn:
                                                    objArr: =..addWeek
                                                    strPath: =.ScheduleSettingsDisplay.AvailableTime.timeResult
                                                    # location: ""
                                                    index: $var.index
                                                    key: $var.key
                                              - continue
                                    # - actionType: evalObject
                                    #   object: 
                                    #     - if:
                                    #       - ..formData.flag
                                    #       - actionType: evalObject
                                    #         object:     
                                    #           - =.builtIn.date.TransformWeekDate:
                                    #               dataIn:
                                    #                 object: =..addWeek
                                    #               dataOut: ScheduleSettingsDisplay.WeekData
                                    #           - =.builtIn.array.SortBy:
                                    #               dataIn:
                                    #                 object: =..addWeek 
                                    #                 iterate: "index"
                                    #                 orders: "asc"
                                    #               dataOut: ScheduleSettingsDisplay.addWeek
                                    #       - continue
                                    - actionType: evalObject
                                      object:
                                        - actionType: builtIn
                                          funcName: redraw
                                          viewTag: timeSlot

                    - type: view
                      # viewTag: AvailableTimeTag
                      style:
                        top: "0"
                        left: "0.435"
                        width: "0.358"
                        height: "auto"
                        border:
                          style: "1"
                        # borderColor: "#d0d9df"
                      children:
                        - type: view
                          style:
                            top: "0"
                            left: "0"
                            width: "0.358"
                            height: "0.04"
                            backgroundColor: "#eff0f2"
                            border:
                              style: "3"
                            borderColor: "#d0d9df"
                            boxSizing: border-box
                          children:
                            - type: label
                              text: Availability
                              style:
                                top: "0"
                                left: "0.02"
                                fontFamily: Poppins
                                fontSize: "16"
                                height: "0.04"
                                textAlign:
                                  y: center
                        - type: scrollView
                          style:
                            top: "0.04"
                            width: "0.358"
                            height: "0.5078"
                            left: "0"
                            overflow: scroll
                          children:
                            - type: list
                              contentType: listObject
                              listObject: ..addWeek
                              iteratorVar: itemObject
                              viewTag: timeSlot
                              style:
                                top: "0"
                                width: "0.358"
                                height: "auto"
                                left: "0"
                                margin: "0"

                                boxSizing: border-box
                              children:
                                - type: listItem
                                  itemObject: ""
                                  onClick:
                                    - emit:
                                        dataKey:
                                          var: itemObject
                                        actions:
                                          - ..formData.index@: $var.index
                                  #       actions: 
                                  #         - ..formData.
                                  style:
                                    # height: "0.07"
                                    width: "0.358"
                                    left: "0"
                                    boxSizing: border-box
                                    borderLeft: "1px solid #d0d9df"
                                    borderRight: "1px solid #d0d9df"
                                    borderBottom: "1px solid #d0d9df"
                                    display: flex
                                    justifyContent: space-between
                                    alignItems: center
                                  # viewTag: selectWeek
                                  children:
                                    - type: label
                                      dataKey: itemObject.key
                                      style:
                                        width: "0.05"
                                        marginLeft: "0.02"
                                        fontSize: .Nfont.n6_1
                                        height: "0.07"
                                        textAlign:
                                          y: center
                                        fontWeight: "550"
                                    - type: list
                                      contentType: listObject
                                      listObject: itemObject.duration
                                      iteratorVar: itemObject
                                      style:
                                        width: '0.28'
                                        margin: '0'
                                        height: auto
                                      children:
                                        - type: listItem
                                          itemObject:
                                          style:
                                            width: '0.08'
                                            height: '0.05'
                                            left: '0'
                                            marginRight: "0.01"
                                            marginTop: ''
                                            display: inline-block
                                            float: left
                                          children:
                                            - type: view
                                              style:
                                                backgroundColor: "#eaf1f6"
                                                width: "0.085"
                                                top: "0.01"
                                                height: "0.03"
                                                textAlign:
                                                  y: center
                                              children:
                                                - type: label
                                                  dataKey: itemObject
                                                  style:
                                                    fontSize: .Nfont.nf2
                                                    textAlign:
                                                      y: center
                                                    color: "#005795"
                                                    height: "0.03"
                                                    width: "0.07"
                                                    left: "0.002"
                                                - type: image
                                                  onClick:
                                                    - emit:
                                                        dataKey:
                                                          var: itemObject
                                                        actions:
                                                          - =.builtIn.array.removeValueInDoubleList:
                                                              dataIn:
                                                                objArr: =..addWeek
                                                                objArr1: =..newAppointment.edge.name.setting.day
                                                                key: "duration"
                                                                value: $var
                                                    - actionType: builtIn
                                                      funcName: redraw
                                                      viewTag: timeSlot
                                                  path: deleteTime.svg
                                                  style:
                                                    left: "0.076"
                                                    height: "0.01"
                                                    top: "0.0088"
                                                    display: "inline-block"

                    - .AddButton:
                      text: Confirm
                      onClick:
                        - actionType: evalObject
                          object:
                            - if:
                                # 判断是什么类型，并根据类型决定预约的edge的bvid
                                - =.builtIn.string.equal:
                                    dataIn:
                                      string1: =..newAppointment.edge.name.visitType
                                      string2: "Telemedicine"
                                - .Global.jwt.edge.bvid@: =.Global.currentFacility.id
                                - .Global.jwt.edge.bvid@: =.Global.formData.scheduleLocationId
                            - if:
                                # 判断是什么类型，并根据类型决定预约的edge的bvid
                                - =.builtIn.string.equal:
                                    dataIn:
                                      string1: =..getVertexType.vertexResp.vertex.0.type
                                      string2: 1
                                - continue
                                - .Global.jwt.edge.bvid@: =.Global.formData.scheduleLocationId
                            - =.Global.jwt.edgeAPI.store: ""
                            - =.ScheduleSettingsDisplay.newAppointment.edgeAPI.store: ""
                            - if:
                                # 判断是什么类型，并根据类型决定预约的edge的bvid
                                - =.builtIn.string.equal:
                                    dataIn:
                                      string1: =..getVertexType.vertexResp.vertex.0.type
                                      string2: 1
                                - =.builtIn.search.updateEsData:
                                    dataIn:
                                      id: =..newAppointment.edge.evid
                                      type: '40000'
                                      bvid: =..newAppointment.edge.bvid
                                    dataOut: ScheduleSettingsDisplay.res
                                - =.builtIn.search.updateEsData:
                                    dataIn:
                                      id: =..newAppointment.edge.evid
                                      type: '655363'
                                    dataOut: ScheduleSettingsDisplay.res
                            # - .Global.jwt.edge.bvid@: =.Global.currentUser.vertex.id
                            # - =.Global.jwt.edgeAPI.store: ""
                        - actionType: popUp
                          popUpView: setting
                        # - goto: ScheduleSettingRoomTime
                        - actionType: builtIn
                          funcName: goBack
                          reload: true
                      style:
                        top: "0.57"
                        left: "0.723"
                        width: "0.07"
                        height: "0.042"
                        fontSize: .Nfont.nf2
                        border:
                          style: "3"
                        borderWidth: "1"
                        borderColor: "#004779"
                        borderRadius: "5"
        - .BaseJudgeView:
          viewTag: SaveChangeView
          msg: Are you sure you want to save your changes?
          style:
            left: "0"
            width: "1"
            top: "0"
            height: "1"
            backgroundColor: "0x00000033"
            zIndex: "10"
          children:
            - .BaseJudgeInnerView:
              children:
                - .BaseJudgeCancelImg:
                - .BaseJudgeTxt:
                - .BaseJudgeButtonView:
                  children:
                    - .BaseJudgeButtonNo:
                      text: Cancel
                      onClick:
                        - actionType: builtIn
                          funcName: goBack
                          reload: true
                    - .BaseJudgeButtonYes:
                      text: Confirm
                      onClick:
                        - actionType: evalObject
                          object:
                            - if:
                                # 判断是什么类型，并根据类型决定预约的edge的bvid
                                - =.builtIn.string.equal:
                                    dataIn:
                                      string1: =..newAppointment.edge.name.visitType
                                      string2: "Telemedicine"
                                - .Global.jwt.edge.bvid@: =.Global.currentFacility.id
                                - .Global.jwt.edge.bvid@: =.Global.formData.scheduleLocationId
                            - if:
                                # 判断是什么类型，并根据类型决定预约的edge的bvid
                                - =.builtIn.string.equal:
                                    dataIn:
                                      string1: =..getVertexType.vertexResp.vertex.0.type
                                      string2: 1
                                - continue
                                - .Global.jwt.edge.bvid@: =.Global.formData.scheduleLocationId
                            - =.Global.jwt.edgeAPI.store: ""
                            - =.ScheduleSettingsDisplay.newAppointment.edgeAPI.store: ""
                            - if:
                                # 判断是什么类型，并根据类型决定预约的edge的bvid
                                - =.builtIn.string.equal:
                                    dataIn:
                                      string1: =..getVertexType.vertexResp.vertex.0.type
                                      string2: 1
                                - =.builtIn.search.updateEsData:
                                    dataIn:
                                      id: =..newAppointment.edge.evid
                                      type: '40000'
                                      bvid: =..newAppointment.edge.bvid
                                    dataOut: ScheduleSettingsDisplay.res
                                - =.builtIn.search.updateEsData:
                                    dataIn:
                                      id: =..newAppointment.edge.evid
                                      type: '655363'
                                    dataOut: ScheduleSettingsDisplay.res
                            # - .Global.jwt.edge.bvid@: =.Global.currentUser.vertex.id
                            # - =.Global.jwt.edgeAPI.store: ""
                        - actionType: popUp
                          popUpView: setting
                        # - goto: ScheduleSettingRoomTime
                        - actionType: builtIn
                          funcName: goBack
                          reload: true
        - .BaseWarningView:
          viewTag: timeErrorView
          msg2: Please select or change appropriate start & end time
        - .BaseWarningView:
          viewTag: timeOverlapView
          msg2: The selected time overlaps,please select again
        - .BaseSuccessfulView:
          viewTag: setting
          msg: "setting successfully"
        - type: popUp
          viewTag: startDateTag
          style:
            left: "0"
            top: "0"
            width: "1"
            height: "1"
            backgroundColor: "0x00000033"
            zIndex: "1000000"
          children:
            - .BaseDate.calendar:
              children:
                - .BaseDate.calendarTitle:
                - .BaseDate.calendarCancel:
                - .BaseDate.calendarHeader:
                  children:
                    - .BaseDate.newMonthView:
                    - .BaseDate.newYearView:
                - .BaseDate.weekView:
                - .BaseDate.dayView:
                - .BaseDate.addButton:
                  onClick:
                    - actionType: evalObject
                      object:
                        - ..newAppointment.edge.name.setting.startDate@: =.BaseDate.calendarDate.todayDate
                    # - actionType: builtIn
                    #   funcName: redraw
                    #   viewTag: selectStartAndEndTag
                    - actionType: builtIn
                      funcName: redraw
                      viewTag: startDateTimeTag
                    - actionType: popUpDismiss
                      popUpView: startDateTag
                - .BaseDate.cancelButton:
                  onClick:
                    - actionType: popUpDismiss
                      popUpView: startDateTag
        - .BaseWarningView:
          viewTag: updateFailTag
          msg2: Please update availability again.
