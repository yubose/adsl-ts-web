AppointmentOverview:
  title:  Appointment History
  pageNumber: 
  init: #Page initialization
    - actionType: evalObject
      object: 
        .Global._nonce@: 
          =.builtIn.math.random: ""
    - actionType: evalObject
      object: .BaseDate.getDate
    #生成年份
    - =.builtIn.date.generateYear:
        dataIn:
          last: 40
          next: 10
        dataOut: BaseDate.year
    - =.builtIn.array.selectOneToArr:                    
        dataIn:
          arr: =.Global.locationAll
          key: "id"
        dataOut: AppointmentOverview.formData.allLocationId     # location id
    - =..apiRequest.providerList.docAPI.get: ""
    - =.builtIn.object.extract:
        dataIn:
          array: =..apiRequest.providerList.docResp.doc
          field: name.data.fullName
        dataOut: AppointmentOverview.formData.providerList
    - =.builtIn.array.push:
        dataIn:
          messages: =..formData.providerList
          newMessage: "Select"
    - =.builtIn.array.selectOneToArr:                   
        dataIn:
          arr: =..apiRequest.providerList.docResp.doc
          key: "bsig"
        dataOut: AppointmentOverview.formData.allProviderId   # provider id
    - =.builtIn.array.add:
        dataIn:
          object: =..formData.allId
          value: =.Global.currentFacility.id
    - =.builtIn.array.concat:
        dataIn:
          array1: =..formData.allId
          array2: =..formData.allLocationId
        dataOut: AppointmentOverview.formData.allId 
    - =.builtIn.array.concat:
        dataIn:
          array1: =..formData.allId
          array2: =..formData.allProviderId
        dataOut: AppointmentOverview.formData.allId   

    - ..apiRequest.appOverview.edgeIn.id@: =..formData.allId
    - =..apiRequest.appOverview.edgeAPI.get: ""
    # 表格分页
    - =.builtIn.array.setMeetingStatus: 
        dataIn: 
          object: =..apiRequest.appOverview.edgeResp.edge
        dataOut: AppointmentOverview.formData.appointmentHistory
    - =.builtIn.array.splitTableList: 
        dataIn: 
          arrObj: =..formData.appointmentHistory
          numX: "12"
          numY: "1"
        dataOut: AppointmentOverview.formData.tableData
    - ..formData.tableList@: =..formData.tableData.0
    - =.builtIn.string.concat:
        dataIn:
          - =..formData.tablePageNum # page num
          - " / "
          - =..formData.tableData.1 # total page
        dataOut: AppointmentOverview.formData.tableCurrentPage # current page                           
    - =.builtIn.number.addition: # get totalPage+1 to verify legitimacy of gotoPageNum
        dataIn:
          num: =..formData.tableData.1
          step: "1"
        dataOut: AppointmentOverview.formData.totalPageMore # update page num  
    - =.builtIn.array.setPropertyInterlacedChange:
        dataIn:
          arrIn: =..apiRequest.appOverview.edgeResp.edge
          arr: ["backgroundColor"]
          valueArr: ["0xf5f5f5"]
          errorArr: ["0xffffff"]

  formData: #Input data calendarHeader
    tabsText:
      - name: "All"
        color: "0x005795"
        fontWeight: "700"
        borderColor: "#005795"
      - name: "Receive"
        color: "0x000000"
        fontWeight: ""
        borderColor: "#ececec"
      - name: "Sent"
        color: "0x000000"
        fontWeight: ""
        borderColor: "#ececec"
    updateCondition: 
      patientName: ""
      beginDate: ""
      endDate: ""
      statusSelected:
        list: []
      providerName: ""
      typeSelected:
        list: []
    statusHiddenOrShow: "0"
    appointmentHistory: []
    tableData: [] # sdk 返回的数组,包括当前显示第几页的数据list 和 被切分成总共多少页面
    tableList: [] # sdk 返回的数组的第一项，list真正打印的数据
    tablePageNum: "1" # previous和next 中间的文本显示的数据
    tableCurrentPage: "1" # 当前显示的当前页面/总页面
    gotoPageNum: "" # goto 后面的文本显示
    totalPageMore: "" # totalPage(tableData.1) + 1  
    allId: []
    allLocationId: []
    allProviderId: []
    providerList: []
    currentAppointment: ""

  formDataTemp: #Input data temp here, datatemp should not mix with formData
    statusList:
      - name: "Paid"
      - name: "Unpaid"
      - name: "Refund"
      - name: "Refund fail"
      - name: "Cancelled"

  apiRequest: #Input data request here
    appOverview: 
      edgeIn: 
        ObjType: 20
        id: []
        xfname: E2.Bvid,E2.Evid
        sCondition: "E2.type=40000 AND E2.subtype&0xff in (1,9) AND E.type=40000 AND E.subtype&0xff in (6,11,100)"
        obfname: "stime"
        _nonce: =.Global._nonce
        maxcount: "10000"
      edgeResp: ""
      edgeAPI:
        get:
          api: re
          dataIn: AppointmentOverview.apiRequest.appOverview.edgeIn
          dataOut: AppointmentOverview.apiRequest.appOverview.edgeResp
    providerList:
      docIn:
        id: .Global.currentFacility.id
        type: .DocType.DoctorProfile
        ObjType: 12
        xfname: E.bvid|E.evid
        sCondition: E.type=10002 AND E.tage=1 AND E.subtype&0xf0000=0x30000
        maxcount: "10000"
        _nonce: =.Global._nonce
      docResp: ""
      docAPI:
        get: 
          api: rd
          dataIn: AppointmentOverview.apiRequest.providerList.docIn
          dataOut: AppointmentOverview.apiRequest.providerList.docResp
    cancelAppointment: 
      docReq:
        type: .DocType.CancelMeeting
        id: ""
        xfname: reid
        _nonce: =.Global._nonce
      docResp: ""
      docAPI: 
        get: 
          api: rd 
          dataIn: AppointmentOverview.apiRequest.cancelAppointment.docReq
          dataOut: AppointmentOverview.apiRequest.cancelAppointment.docResp

  style: #Input style fragment here

  components:
    - .TotalView: 
      children: 
        - .SideMenuBar: 
          children:
            - .aitLogo:
            - .MenuBar:        
        - .TopBar: 
        - .InnerBodyView:
          children:
            - type: view
              style:
                display: flex
                justifyContent: space-between
                alignItems: center
              children:
                - .PageTitleLabel:
                  style:
                    width: "0.4"
                - type: view
                  style:
                    width: "0.15"
                    height: "0.06"
                    display: flex
                    justifyContent: space-between
                    alignItems: flex-end
                    marginRight: "0.05"
                  children: 
                    - type: view
                      style:
                        display: flex
                        justifyContent: space-between
                        alignItems: center
                        width: "0.034"
                      children: 
                        - type: image
                          path: fly.svg
                          style:
                            width: "0.01"
                            marginTop: "0.003"
                        - type: label
                          text: Send
                          dataKey: 
                          style:
                    - type: view
                      style:
                        display: flex
                        justifyContent: space-between
                        alignItems: center
                        width: "0.054"
                      children: 
                        - type: image
                          path: downLoadBlue.svg
                          style:
                            width: "0.01"
                        - type: label
                          text: Download
                          dataKey: 
                          style:
                    - type: view
                      style:
                        display: flex
                        justifyContent: space-between
                        alignItems: center
                        width: "0.032"
                      children: 
                        - type: image
                          path: backArrow.svg
                          style:
                            width: "0.01"
                            marginTop: "0.005"
                        - type: label
                          text: Back
                          dataKey: 
                          style: 
                
            - .ContentBar:
              children:
                - type: view
                  style:
                    width: "0.763"
                    height: "0.07"
                    marginTop: "0.008"
                    left: "0.027"
                  children:
                    # search patient
                    - type: view
                      style:
                        width: "0.262"
                        height: "auto"
                        display: inline-block
                        marginTop: "0.02"
                        border: 
                          style: "3"
                        borderRadius: "3"
                        boxSizing: border-box
                        borderColor: "0xd0d0d0"
                        textAlign :
                          y: center
                      children:
                        - type: image
                          path: searchGray.svg
                          style:
                            marginLeft: "0.01"
                            width: "0.01"
                            marginTop: "0.008"
                            display: inline-block
                        - .TransactionsTextFieldNewUI: ""
                          dataKey: formData.updateCondition.name              
                          style:
                            width: "0.226"
                            display: inline-block
                            border: 
                              style: "1"

                    # From - Today
                    - type: view
                      viewTag: selectStartAndEndTag
                      style:
                        width: "0.215"
                        height: "auto"
                        marginTop: "0.02"
                        display: inline-block
                        marginLeft: "0.012"
                      children:
                        - type: label
                          text: Date
                          dataKey: 
                          style:
                            fontSize: .Nfont.n5_2
                            display: inline-block
                            marginTop: "0.005"
                            textAlign:
                              y: center
                        - type: view
                          style:
                            width: "0.08"
                            display: inline-block
                            marginLeft: "0.008"
                          onClick:
                            - actionType: popUp
                              popUpView: startDateTag
                          children:
                            - type: image
                              path: calendarPoint.svg
                              style:
                                top: "0.009"
                                left: "0.07"
                                zIndex: "5"
                            - .TransactionsTextFieldNewUI: ""
                              placeholder: Start Date
                              isEditable: false
                              dataKey: formData.updateCondition.beginDate
                              style:
                                width: "0.08"
                                backgroundColor: "0xffffff"

                        - type: label
                          text: "—"
                          dataKey: 
                          style:
                            fontWeight: "800"
                            top: "0.008"
                            marginTop: "0"
                            left: "0.119"
                            color: "0xc1c1c1"
                            fontSize: .Nfont.nf0
                        - type: view
                          style:
                            width: "0.08"
                            display: inline-block
                            left: "0.018"
                          onClick:
                            - actionType: popUp
                              popUpView: endDateTag
                          children:
                            - type: image
                              path: calendarPoint.svg
                              style:
                                top: "0.009"
                                left: "0.07"
                                zIndex: "5"
                            - .TransactionsTextFieldNewUI: ""
                              placeholder: End Date
                              isEditable: false
                              dataKey: formData.updateCondition.endDate
                              style:
                                width: "0.08"
                                backgroundColor: "0xffffff"
                    # Status
                    - type: view
                      style:
                        width: "auto"
                        marginLeft: "0.012"
                        display: inline-block
                        marginTop: "0.02"
                      children:
                        - type: label
                          text: Status
                          dataKey: 
                          style:
                            fontSize: .Nfont.n6
                            display: inline-block
                            marginTop: "0.005"
                            marginRight: "0.006"
                            textAlign:
                              y: center
                        - type: view
                          style:
                            width: "0.215"
                            display: inline-block
                          onClick:  
                            - actionType: popUp
                              popUpView: statusTag
                            - actionType: evalObject
                              object: 
                                - if:
                                  - =.builtIn.string.equal:
                                      dataIn:
                                        string1: =..formData.statusHiddenOrShow
                                        string2: "0"
                                  - ..formData.statusHiddenOrShow@: "1"
                                  - ..formData.statusHiddenOrShow@: "0"
                                - if: 
                                  - =.builtIn.string.equal:
                                      dataIn: 
                                        string1: =..formData.statusHiddenOrShow
                                        string2: "0"
                                  - actionType: popUpDismiss
                                    popUpView:  statusTag
                                  - actionType: popUp
                                    popUpView:  statusTag
                            - actionType: builtIn
                              funcName: redraw
                              viewTag: statusBlackArrowTag
                          children: 
                            - .TransactionsTextFieldNewUI: ""
                              viewTag: statusTextFiledTag
                              placeholder: Select
                              isEditable: false
                              dataKey: formData.updateCondition.statusSelected.list
                              style:
                                width: "0.215"
                                fontSize: .Nfont.nf2
                                backgroundColor: "0xffffff"
                                paddingRight: "0.8em"
                            - type: image
                              viewTag: statusBlackArrowTag
                              path: downArrowDeepGray.svg
                              style:
                                width: "0.01"
                                top: "0.011"
                                left: "0.21"
                   
                - type: view
                  style:
                    width: "0.763"
                    height: "0.07"
                    marginTop: "0.008"
                    left: "0.027"
                  children:
                    - type: view
                      style:
                        height: auto
                        display: inline-block
                      children: 
                        - type: label
                          text: Provider
                          dataKey: 
                          style:
                            fontSize: .Nfont.nf5
                            display: inline-block
                            height: "0.035"
                            lineHeight: "3.5vh"
                        - type: view
                          style:
                            height: "auto"
                            display: inline-block
                            border: 
                              style: "3"
                            borderRadius: "3"
                            boxSizing: border-box
                            borderColor: "0xd0d0d0"
                            marginLeft: "0.004"
                            textAlign :
                              y: center
                          children:
                            - type: select
                              dataKey:  
                              placeholder: Select 
                              options:
                                ..formData.providerList
                              style:
                                width: "0.215"
                                height: "0.035"
                                display: inline-block
                                backgroundColor: "0xffffff"
                                border: 
                                  style: "1"
                                
                    - type: view
                      style:
                        height: auto
                        display: inline-block
                        marginLeft: "0.012"
                      children: 
                        - type: label
                          text: Type
                          dataKey: 
                          style:
                            fontSize: .Nfont.nf5
                            display: inline-block
                            height: "0.035"
                            lineHeight: "3.5vh"
                        - type: view
                          style:
                            height: "auto"
                            display: inline-block
                            border: 
                              style: "3"
                            borderRadius: "3"
                            boxSizing: border-box
                            borderColor: "0xd0d0d0"
                            marginLeft: "0.008"
                            textAlign :
                              y: center
                          children:
                            - type: select
                              dataKey:  
                              placeholder: Select 
                              options:
                                - Select
                                - Telemedicine
                                - Office Visit
                              style:
                                width: "0.178"
                                display: inline-block
                                height: "0.035"
                                border: 
                                  style: "1"

                    # Update 按钮
                    - type: button
                      text: Update
                      style:
                        width: "0.06"
                        height: "0.036"
                        display: inline-block                        
                        backgroundColor: "0x0063a8"
                        color: "0xffffff"
                        fontWeight: "500"
                        borderRadius: "3"
                        left: "0.014"
                        fontSize: .Nfont.n6_1_1
                        border: 
                          style: "1"
                        textAlign:
                          x: center
                          y: center
                      onClick:
                        - actionType: evalObject
                          object:
                    - type: label
                      text: Revise
                      dataKey: 
                      style:
                        textDecoration: underline
                        display: inline-block     
                        color: "0x0063a8"
                        marginTop: "0.005"
                        left: "0.025"
                      onClick:
                        - actionType: evalObject
                          object:


                - type: view
                  viewTag: tabView
                  style:
                    width: "0.765"
                    border:
                      style: "2"
                    borderColor: "0xececec"
                    display: flex
                    boxSizing: border-box
                    left: "0.028"
                  children: 
                    - type: list
                      contentType: listObject
                      listObject: ..formData.tabsText
                      iteratorVar: itemObject
                      style:
                        margin: '0'
                        height: auto
                        display: flex
                        axis: horizontal
                      children:
                        - type: listItem
                          itemObject: 
                          style:
                            width: "0.06"
                            height: "0.05"
                            display: inline-block
                          children:
                            - type: label
                              text: 
                              dataKey: itemObject.name
                              style:
                                width: "0.06"
                                height: "0.05"
                                fontSize: .Nfont.nf4
                                textAlign:
                                  x: center
                                lineHeight: "5vh"
                                border:
                                  style: "2"
                                borderWidth: "2"
                                fontWeight: itemObject.fontWeight
                                color: itemObject.color
                                borderColor: itemObject.borderColor
                              onClick:
                                - emit: 
                                    dataKey: 
                                      var: itemObject
                                    actions: 
                                      - =.builtIn.object.setProperty: 
                                          dataIn: 
                                            obj: =..formData.tabsText
                                            label: "name"
                                            text: $var.name
                                            arr: ["color","fontWeight","borderColor"]
                                            valueArr: ["0x005795","700","0x005795"]
                                            errorArr: ["0x000000","","#ececec"] 
                                - actionType: builtIn
                                  funcName: redraw
                                  viewTag: tabView
                                - actionType: builtIn
                                  funcName: redraw
                                  viewTag: tableView
                # 表格
                - type: view
                  viewTag: tableView
                  style:
                    width: "0.765"
                    height: auto
                    marginTop: "0.03"
                    left: "0.028"
                    borderRadius: "5"
                    boxSizing: border-box
                    border: 
                      style: "2"
                  children: 
                    - .FormMeterBlueNewUI: ""
                      children:
                        - .FormTemplateNewUI: ""
                          style:
                            paddingLeft: "16px"
                            width: "0.106"
                        - .FormTemplateNewUI: ""
                          text: "Date & Time"
                          style: 
                            width: "0.12" 
                        - .FormTemplateNewUI: ""
                          text: "Reason For Visit"
                          style: 
                            width: "0.115"
                            paddingLeft: "12px"
                        - .FormTemplateNewUI: "" 
                          text: "Location"
                          style: 
                            width: "0.142"
                        - .FormTemplateNewUI: "" 
                          text: "Provider Name"
                          style: 
                            width: "0.087"
                        - .FormTemplateNewUI: "" 
                          text: "Appointment Type"
                          style: 
                            width: "0.095"
                            boxSizing: border-box
                        - .FormTemplateNewUI: "" 
                          text: "Status"
                          style: 
                            width: "0.0575"
                        - .FormTemplateNewUI: "" 
                          text: "Details"
                          style: 
                            width: "0.03"

                    - type: list
                      contentType: listObject
                      listObject: ..formData.tableList
                      iteratorVar: itemObject
                      viewTag: appointmentTag
                      style:
                        width: '0.765'
                        margin: '0'
                        height: auto
                        borderLeft: "1px solid #dbdbdb"
                        borderTop: "1px solid #dbdbdb"
                        borderRight: "1px solid #dbdbdb"
                        boxSizing: border-box
                      children:
                        - type: listItem
                          itemObject: ""
                          style:
                            width: '0.764'
                            height: '0.038'
                            left: '0'
                            marginTop: ''
                            backgroundColor: itemObject.backgroundColor
                            borderBottom: "1px solid #dbdbdb"
                            boxSizing: border-box
                          children:
                            - type: label
                              dataKey: itemObject.name.patientName
                              style:
                                width: "0.106"
                                .FormMainLabelStyleNew: ""
                                paddingLeft: "16px"
                                color: itemObject.color
                            - type: label
                              text=func: .builtIn.string.formatUnixtime_en
                              dataKey: itemObject.stime
                              style:
                                width: "0.12"
                                .FormMainLabelStyleNew: ""
                            - type: label
                              dataKey: itemObject.name.Reason
                              style:
                                width: "0.115"
                                .FormMainLabelStyleNew: ""
                                word-break: break-word
                                paddingLeft: "12px"
                            - type: label
                              dataKey: itemObject.name.location
                              style:
                                width: "0.142"
                                .FormMainLabelStyleNew: ""
                            - type: label
                              dataKey: itemObject.name.providerName
                              style:
                                width: "0.087"
                                .FormMainLabelStyleNew: ""
                                textIndent: 0.5em
                            - type: label
                              dataKey: itemObject.name.visitType
                              style:
                                width: "0.095"
                                .FormMainLabelStyleNew: ""
                            - type: label
                              dataKey: itemObject.status
                              style:
                                width: "0.0575"
                                .FormMainLabelStyleNew: ""
                                color: itemObject.fontColor
                                textDecoration: itemObject.textDeco
                              onClick:
                                - emit: 
                                    dataKey: 
                                      var: itemObject
                                    actions: 
                                      - ..formData.currentAppointment@: $var
                                      - ..apiRequest.cancelAppointment.docReq.id@: =..formData.currentAppointment.id
                                      - =..apiRequest.cancelAppointment.docAPI.get: ""
                                - actionType: builtIn
                                  funcName: redraw
                                  viewTag: canceledTag
                                - actionType: evalObject
                                  object: 
                                    - if:
                                      - =.builtIn.string.equal: 
                                          dataIn:
                                            string1: =..formData.currentAppointment.status
                                            string2: "Canceled"
                                      - actionType: popUp
                                        popUpView: canceledTag
                                      - continue

                            - type: label
                              dataKey: 
                              text: View
                              style:
                                width: "0.03"
                                .FormMainLabelStyleNew: ""
                                color: "0x0063a8"
                                textDecoration: underline
                                fontSize: .Nfont.nf2
                                fontWeight: "500"    
                              onClick: 
                                - emit:
                                    dataKey: 
                                      var: itemObject
                                    actions:
                                      - ..formData.currentAppointment@: $var
                                      - ..apiRequest.cancelAppointment.docReq.id@: =..formData.currentAppointment.id
                                      - =..apiRequest.cancelAppointment.docAPI.get: ""
                                - actionType: evalObject
                                  object: 
                                    - if:
                                      - =.builtIn.string.equal: 
                                          dataIn:
                                            string1: =..formData.currentAppointment.status
                                            string2: "Canceled"
                                      - actionType: evalObject
                                        object: 
                                          - .Global.formData.patientHistoryInfo.id@: =..formData.currentAppointment.id
                                          - .Global.formData.cancelAppointment@: =..apiRequest.cancelAppointment.docResp.doc.0
                                          - if:
                                            - =.Global.formData.patientHistoryInfo.id
                                            - goto: PatientSummary
                                            - continue
                                      - continue


            # TableFooter
            - type: view
              viewTag: tableFooter
              style:
                .TableFooterView:
                top: "0.857"
                left: "0.565"
              children:   
                - type: view
                  style:
                    top: "0.005"
                    width: "0.08"
                    height: "0.0155"
                  children:
                    - type: label
                      text: "Current page:"
                      style:
                        display: inline-block
                        fontSize: .Nfont.nf0
                        color: "0x333333"
                        textAlign:
                          x: "center"
                          y: "center"
                    - type: label
                      dataKey: formData.tableCurrentPage
                      style:
                        marginLeft: "0.005"
                        display: inline-block
                        fontSize: .Nfont.nf0
                        color: "0x333333"
                        textAlign:
                          x: "center"
                          y: "center"
                # Previous & Next
                - type: view
                  style:
                    top: "0"
                    left: "0.076"
                    width: "0.05168"
                    height: "0.02576"
                  children:
                    - type: image
                      path: tableLeft.svg
                      onClick:
                        - actionType: evalObject
                          object:
                            - if: 
                              - =.builtIn.number.less: 
                                  dataIn: 
                                    num1: =..formData.tablePageNum
                                    num2: 2
                              - continue
                              - actionType: evalObject
                                object:
                                  # num - step
                                  - =.builtIn.number.Subtraction: 
                                      dataIn:
                                        num: =..formData.tablePageNum
                                        step: "1"
                                      dataOut: AppointmentOverview.formData.tablePageNum
                                  - =.builtIn.array.splitTableList: 
                                      dataIn: 
                                        arrObj: =..apiRequest.appOverview.edgeResp.edge
                                        numX: "12"
                                        numY: =..formData.tablePageNum
                                      dataOut: AppointmentOverview.formData.tableData
                                  - ..formData.tableList@: =..formData.tableData.0
                                  - =.builtIn.array.setPropertyInterlacedChange:
                                      dataIn:
                                        arrIn: =..formData.tableList
                                        arr: ["backgroundColor"]
                                        valueArr: ["0xf5f5f5"]
                                        errorArr: ["0xffffff"]  
                                  - =.builtIn.string.concat: # re-concat
                                      dataIn:
                                        - =..formData.tablePageNum # page num
                                        - " / "
                                        - =..formData.tableData.1 # total page
                                      dataOut: AppointmentOverview.formData.tableCurrentPage # current page   
                              
                        - actionType: builtIn
                          funcName: redraw
                          viewTag: appointmentTag
                        - actionType: builtIn 
                          funcName: redraw
                          viewTag: tableFooter                               
                      style:
                        top: "0"
                        width: "0.01456"
                        height: "0.02576"
                    - type: label
                      viewTag: pageNumView
                      dataKey: formData.tablePageNum
                      style:
                        top: "0"
                        left: "0.01856"
                        width: "0.01446"
                        height: "0.02576"
                        fontSize: .Nfont.nf0
                        fontWeight: "500"
                        color: "0xffffff"
                        backgroundColor: "0x005795"
                        borderRadius: "3"
                        textAlign:
                          x: center
                          y: center
                    - type: image
                      path: tableRight.svg
                      onClick:
                        - actionType: evalObject
                          object:
                            .Global._nonce@:
                              =.builtIn.math.random: "" 
                        - actionType: evalObject
                          object:
                            - if: 
                              - =.builtIn.number.less: 
                                  dataIn: 
                                    num1: =..formData.tablePageNum
                                    num2: =..formData.tableData.1
                              - actionType: evalObject
                                object:
                                  - =.builtIn.number.addition: 
                                      dataIn:
                                        num: =..formData.tablePageNum
                                        step: "1"
                                      dataOut: AppointmentOverview.formData.tablePageNum # update page num
                                  - =.builtIn.array.splitTableList: 
                                      dataIn: 
                                        arrObj: =..apiRequest.appOverview.edgeResp.edge
                                        numX: "12"
                                        numY: =..formData.tablePageNum
                                      dataOut: AppointmentOverview.formData.tableData
                                  - ..formData.tableList@: =..formData.tableData.0
                                  - =.builtIn.array.setPropertyInterlacedChange:
                                      dataIn:
                                        arrIn: =..formData.tableList
                                        arr: ["backgroundColor"]
                                        valueArr: ["0xf5f5f5"]
                                        errorArr: ["0xffffff"]  
                                  - =.builtIn.string.concat: # re-concat
                                      dataIn:
                                        - =..formData.tablePageNum # page num
                                        - " / "
                                        - =..formData.tableData.1 # total page
                                      dataOut: AppointmentOverview.formData.tableCurrentPage # current page 
                              - continue      
         
                        - actionType: builtIn
                          funcName: redraw
                          viewTag: tableView  
                        - actionType: builtIn 
                          funcName: redraw
                          viewTag: tableFooter
                      style:
                        top: "0"
                        left: "0.03712"
                        height: "0.02576"
                        width: "0.01456"
                # Go to
                - type: view
                  style:
                    top: "0"
                    left: "0.14"
                    width: "0.05"
                    height: "0.02496"
                  children:
                    - type: textField
                      viewTag: gotoView
                      dataKey: formData.gotoPageNum
                      style:
                        width: "0.02496"
                        top: "0"
                        height: "0.02576"
                        borderRadius: "3"
                        borderWidth: "1"
                        border:
                          style: "3"
                        boxSizing: border-box
                        borderColor: "0xd8d8d8"
                        fontSize: .Nfont.nf0
                        fontWeight: "500"
                        color: "0x333333"
                        textAlign: 
                          x: center 
                          y: center 
                    - type: button
                      text: "Go to"
                      style:
                        textDecoration: underline
                        left: "0.029"
                        top: "0"
                        height: "0.02576"
                        border:
                          style: "1"
                        fontSize: .Nfont.nf0
                        color: "0x333333"
                        backgroundColor: "0xffffff00"
                      onClick:
                        - actionType: evalObject
                          object:
                            .Global._nonce@:
                              =.builtIn.math.random: ""                           
                        - actionType: evalObject
                          object:
                            # gotoPageNum ?> 1
                            - if:
                              - =.builtIn.number.less: 
                                  dataIn: 
                                    num1: =..formData.gotoPageNum
                                    num2: 1
                              - continue
                              - actionType: evalObject
                                object:
                                  # gotoPageNum ?< totalPage+1
                                  - if: 
                                    - =.builtIn.number.less: 
                                        dataIn: 
                                          num1: =..formData.gotoPageNum
                                          num2: =..formData.totalPageMore
                                    - actionType: evalObject
                                      object:
                                        - =.builtIn.array.splitTableList: 
                                            dataIn: 
                                              arrObj: =..apiRequest.appOverview.edgeResp.edge
                                              numX: "12"
                                              numY: =..formData.gotoPageNum
                                            dataOut: AppointmentOverview.formData.tableData
                                        - ..formData.tableList@: =..formData.tableData.0
                                        - =.builtIn.string.concat: # re-concat
                                            dataIn:
                                              - =..formData.gotoPageNum # page num
                                              - " / "
                                              - =..formData.tableData.1 # total page
                                            dataOut: AppointmentOverview.formData.tableCurrentPage # current page
                                        - ..formData.tablePageNum@: =..formData.gotoPageNum
                                        - ..formData.gotoPageNum@: ""
                                    - continue                        
                        - actionType: builtIn
                          funcName: redraw
                          viewTag: tableView 
                        - actionType: builtIn 
                          funcName: redraw
                          viewTag: tableFooter                          
        # status 弹窗            
        - type: popUp
          viewTag: statusTag
          style:
            width: "0.22"
            height: "auto"
            top: "0.22"
            left: "0.735"
            zIndex: "101" 
            borderRadius: "8"
            backgroundColor: "0xffffff"
            boxShadow: "1px 1px 4px 2px #cccccc"
          children:
            - type: list
              viewTag: payeeListTag
              contentType: listObject
              listObject: ..formDataTemp.statusList
              iteratorVar: itemObject
              style:
                width: '0.083'
                margin: '0'
                height: auto
              children:
                - type: listItem
                  itemObject: 
                  style:
                    width: '0.083'
                    height: '0.04'
                    left: '0'
                    marginTop: ''
                  children:
                    - type: image
                      path: # selectBlue.svg
                        emit:
                          dataKey:
                            var: itemObject
                          actions:  
                            - if:
                              - =.builtIn.array.has:
                                  dataIn:
                                    object: =..formData.updateCondition.statusSelected.list
                                    value: $var.name
                              - selectBlue.svg 
                              - selectGray.svg
                      onClick:
                        - emit:
                            dataKey:
                              var: itemObject
                            actions: 
                              - if:
                                - =.builtIn.array.has:
                                    dataIn:
                                      object: =..formData.updateCondition.statusSelected.list
                                      value: $var.name
                                - =.builtIn.array.removeByValue:
                                    dataIn:
                                      object: =..formData.updateCondition.statusSelected.list
                                      value: $var.name
                                - =.builtIn.array.add:
                                    dataIn:
                                      object: =..formData.updateCondition.statusSelected.list
                                      value: $var.name
                        - actionType: builtIn
                          funcName: redraw
                          viewTag: payeeListTag
                        - actionType: builtIn
                          funcName: redraw
                          viewTag: statusTextFiledTag
                      style:
                        width: "0.012"
                        left: "0.01"
                        marginTop: "0.01"
                    - type: label
                      text: 
                      dataKey: itemObject.name
                      style:
                        display: inline-block
                        left: "0.015"
                        marginTop: "0.011"
                        fontSize: .Nfont.n6_1_2

        # 日历 start
        - type: popUp
          viewTag: startDateTag
          style:
            left: "0"
            top: "0"
            width: "1"
            height: "1" 
            backgroundColor: "0x00000033"
            zIndex: "100"
          children:
            - .BaseDate.calendar:
              children:
                - .BaseDate.calendarTitle:
                - .BaseDate.calendarCancel:
                - .BaseDate.calendarHeader:
                  children:
                    - .BaseDate.newMonthView:
                    - .BaseDate.newYearView:
                - .BaseDate.weekView:
                - .BaseDate.dayView:
                - .BaseDate.addButton:
                  onClick:
                    - actionType: evalObject
                      object:
                        - ..formData.updateCondition.beginDate@: =.BaseDate.calendarDate.todayDate
                    - actionType: builtIn
                      funcName: redraw
                      viewTag: selectStartAndEndTag
                    - actionType: popUpDismiss
                      popUpView: startDateTag
        # 日历 end
        - type: popUp
          viewTag: endDateTag
          style:
            left: "0"
            top: "0"
            width: "1"
            height: "1" 
            backgroundColor: "0x00000033"
            zIndex: "100"
          children:
            - .BaseDate.calendar:
              children:
                - .BaseDate.calendarTitle:
                - .BaseDate.calendarCancel:
                - .BaseDate.calendarHeader:
                  children:
                    - .BaseDate.newMonthView:
                    - .BaseDate.newYearView:
                - .BaseDate.weekView:
                - .BaseDate.dayView:
                - .BaseDate.addButton:
                  onClick:
                    - actionType: evalObject
                      object:
                        - ..formData.updateCondition.endDate@: =.BaseDate.calendarDate.todayDate
                    - actionType: builtIn
                      funcName: redraw
                      viewTag: selectStartAndEndTag
                    - actionType: popUpDismiss
                      popUpView: endDateTag

        - type: popUp 
          viewTag: canceledTag
          onClick: 
            - actionType: popUpDismiss
              popUpView: canceledTag
          style: 
            left: "0"
            width: "1"
            top: "0"
            height: "1"
            backgroundColor: "0x00000033"
            zIndex: "10"
          children: 
            - type: view
              style:
                width: "0.315"
                height: "0.16"
                borderRadius: "8"
                backgroundColor: "0xffffff"
                top: "0.435"
                left: "0.425"
              children:
                - type: view
                  style:
                    width: "0.23"
                    height: "0.03"
                    marginTop: "0.035"
                    left: "0.058"
                  children: 
                    - type: label
                      text: The appointment has been
                      dataKey: 
                      style:
                        display: inline-block
                        fontSize: .Nfont.nf4
                        fontFamily: Proxima Nova
                    - type: label
                      text: "canceled"
                      dataKey: 
                      style:
                        display: inline-block
                        color: "0xff3200"
                        fontSize: .Nfont.nf4
                        fontFamily: Proxima Nova
                        width: "0.045"
                        textAlign:
                          x: center
                    - type: label
                      text: "by"
                      dataKey: 
                      style:
                        display: inline-block
                        fontSize: .Nfont.nf4
                        fontFamily: Proxima Nova
                        width: "0.015"
                        textAlign:
                          x: start
                    - type: label
                      dataKey: apiRequest.cancelAppointment.docResp.doc.0.name.data.role
                      style:
                        display: inline-block
                        fontSize: .Nfont.nf4
                        fontFamily: Proxima Nova
                - type: label
                  text: "Reason for cancelation:"
                  style:
                    width: "0.2"
                    height: "0.03"
                    fontFamily: Proxima Nova
                    left: "0.058"
                    fontWeight: "500"
                    fontSize: .Nfont.nf5
                - type: scrollView
                  style:
                    width: "0.21"
                    height: "0.063"
                    left: "0.058"
                  children:
                    - type: label
                      dataKey: apiRequest.cancelAppointment.docResp.doc.0.name.data.reason
                      style:
                        width: "0.21"
                        height: "0.063"
                        fontSize: .Nfont.nf3
                        word-break: break-word
                        fontFamily: Proxima Nova



