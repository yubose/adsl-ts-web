AddMedicalDocument:
  title: 
  pageNumber: 
  init: #Page initialization
    - .SignInCheck
  formData: #Input data here
    imageId: ""
    imageData: ""
  formDataTemp: #Input data temp here, datatemp should not mix with formData
    privateTag: 
      display: "block"
      backgroundColor: "0xececee"
      fontColor: "0x4c5264"
      name: "Private"    
    publicTag: 
      display: "block"
      backgroundColor: "0xdfedfc"
      fontColor: "0x2988e6"
      name: "Released"
  apiRequest: #Input data request here
    uploadImg: 
      deleteIn: 
        id: ""
      docResp: ""
      docReq:
        subtype:
          isEncrypted: "0"
          isOnServer: "0"      
        type: .DocType.UploadFile
        name:
          title: ""
          type: ..apiRequest.uploadImg.docAPI.store.subtype.mediaType
          data: binFile   
          user: .Global.currentFacility.name.basicInfo.medicalFacilityName
        eid: .Global.fac_rootNotebook
      docAPI: 
        .DocAPI: ""    
        store:
          api: cd
          dataIn: apiRequest.uploadImg.docReq  
          dataOut: apiRequest.uploadImg.docResp
          subtype:
            mediaType: "" 
        delete: 
          api: dx
          dataIn: apiRequest.uploadImg.deleteIn  
    meetingDocument: 
      docResp: ""
      docReq:
        subtype:
          isEncrypted: "0"
          isOnServer: "0"      
        type: .DocType.AdminMedicalUpload
        name:
          title: ""
          type: "text/plain"
          data:
            fileId: ""
            classTag:
              name: Admin
              fontColor: "0x005795"
              backgroundColor: "0xe9f2fc"
              display: block
            statusTag:          
          user: .Global.currentFacility.name.basicInfo.medicalFacilityName
          uploadUserName: .Global.currentFacility.name.basicInfo.medicalFacilityName
        eid: .Global.formData.meetingDocEid
        reid: .Global.formData.meetingDocReid
      docAPI: 
        .DocAPI: ""    
        store:
          api: cd
          dataIn: apiRequest.meetingDocument.docReq  
          dataOut: apiRequest.meetingDocument.docResp
  style: #Input style fragment here

  components:
    - type: view
      style:
        width: '1'
        height: '1'
        margin: auto
      children:
        - .SideMenuBar:
          children:
            - .aitLogo:
            - .MenuBar:
        - .TopBar:
        - .BodyView:
          style: 
            height: "0.93"
          children:
            - .AppointmentLobby:
            - type: view
              style:
                width: "0.04"
                height: "0.03"
                top: "0.06"
                left: "0.77"
                display: flex
                align-items: center
                justify-content: space-evenly
              children:
                - type: image
                  path: backArrow.svg
                  style:
                    width: "0.01"
                    height: "0.02"
                - type: label
                  text: Back
                  style:
                    height: "0.03"
                    fontSize: .Nfont.nf4
                    fontWeight: "Roboto"
                    color: "0x005795"
                    textAlign:
                      y: top
              onClick:
                - actionType: builtIn
                  funcName: goBack
                  reload: true         
            - type: view
              style:
                left: "0.008"
                width: "0.824"
                height: "0.815"
                top: "0.1"
                backgroundColor: "0xffffff"
              children:
                - type: view
                  style: 
                    marginTop: "0.1"
                    left: "0.245"
                    width: "0.334"
                    height: "0.54"
                    # backgroundColor: "0xff0000"
                  children: 
                    - type: view
                      style:
                        marginTop: "0"
                        width: "0.334"
                        height: "0.08"
                      children: 
                        - type: label
                          textBoard: 
                            - text: Create Document Name
                            - text: "*"
                              color: "0xff0000"                        
                          style:
                            fontSize: .Nfont.nf4
                            fontFamily: "Roboto"
                            width: "0.334"
                        - type: textField
                          placeholder: Enter here
                          dataKey: apiRequest.meetingDocument.docReq.name.title
                          style:
                            marginTop: "0.01"
                            width: "0.334"
                            height: "0.04"
                            boxSizing: border-box
                            border: 
                              style: "3"
                            borderWidth: "1"
                            borderColor: "0xdedede"
                            borderRadius: "3"
                            fontFamily: "Roboto"
                            fontSize: .Nfont.nf4  
                            textIndent: "0.5em"                          
                    - type: view
                      style:
                        marginTop: "0.03"
                        # width: "0.334"
                        height: "0.4"
                      children: 
                        - type: label
                          text: Upload your document                    
                          style:
                            fontSize: .Nfont.nf4
                            fontFamily: "Roboto"
                            width: "0.334"     
                        - type: view
                          viewTag: showView
                          style:
                            width: "0.34"
                            height: "0.305"
                            top: "0.04"
                            isHidden: "true"        
                          children: 
                            - type: view
                              style:
                                width: "0.334"
                                height: "0.3"
                                top: "0.005"
                                left: "0"
                                backgroundColor: "0xf4f5f7"
                                border: 
                                  style: "4"
                                borderWidth: "1"
                                borderColor: "0xdddfe0"
                                borderRadius: "3"
                                boxSizing: border-box
                                textAlign: 
                                  x: center
                              children: 
                                - type: image
                                # - type: ecosDoc
                                  # ecosObj: ..formData.imageData
                                  # path: squareDefaultPicture.svg
                                  viewTag: imageView
                                  dataKey: AddMedicalDocument.formData.imageId
                                  path=func: .builtIn.utils.prepareDocToPath
                                  style:
                                    height: "0.3"
                            - type: image
                              path: deletePhoto.svg
                              onClick: 
                                - actionType: evalObject
                                  object:
                                    - ..apiRequest.uploadImg.deleteIn.id@: =..formData.imageId
                                    - =..apiRequest.uploadImg.docAPI.delete: ""
                                - actionType: builtIn
                                  funcName: hide
                                  viewTag: showView
                                - actionType: builtIn
                                  funcName: show
                                  viewTag: uploadView
                              style:
                                width: "0.01"
                                left: "0.329"
                        - type: view
                          viewTag: uploadView
                          style:
                            width: "0.334"
                            height: "0.3"
                            top: "0.045"
                            backgroundColor: "0xf4f5f7"
                            border: 
                              style: "4"
                            borderWidth: "1"
                            borderColor: "0xdddfe0"
                            borderRadius: "3"
                            boxSizing: border-box
                            textAlign: 
                              x: center
                          children: 
                            - type: image
                              path: cloudBlue.svg
                              style:
                                width: "0.04"
                                marginTop: "0.05"
                            - type: label
                              text: "Only the following file types are supported:"
                              dataKey: 
                              style:
                                marginTop: "0.015"
                                fontSize: .Nfont.nf2
                                color: "0x707070"
                            - type: label
                              text: ".jpeg, .png, .pdf, .xlsx, .pptx, .ppt, .docx, .doc, .numbers, .pages, .html"
                              dataKey: 
                              style:
                                marginTop: "0.005"
                                fontSize: .Nfont.nf2
                                color: "0x707070"     
                            - type: label
                              text: Please click the button to upload
                              dataKey: 
                              style:
                                marginTop: "0.015"
                                fontSize: .Nfont.nf2
                                color: "0x666666"                  
                            - type: button
                              text: Upload
                              onClick: 

                                - actionType: openPhotoLibrary
                                  dataObject: BLOB
                                  dataKey: AddMedicalDocument.apiRequest.uploadImg.docReq.name.data
                                - actionType: evalObject
                                  object:
                                    - =..apiRequest.uploadImg.docAPI.store: ""
                                - actionType: evalObject
                                  object:
                                    # - =.builtIn.utils.prepareDoc:
                                    #     dataIn:
                                    #       doc: =..apiRequest.uploadImg.docResp.doc
                                    #     dataOut: AddMedicalDocument.formData.imageData       
                                    - ..formData.imageId@: =..apiRequest.uploadImg.docResp.doc.id 
                                - actionType: builtIn
                                  funcName: redraw
                                  viewTag: imageView                                          
                                - actionType: builtIn
                                  funcName: hide
                                  viewTag: uploadView
                                - actionType: builtIn
                                  funcName: show
                                  viewTag: showView
                            
                              style:
                                left: "0.117"
                                marginTop: "0.02"
                                width: "0.1" 
                                height: "0.04" 
                                borderColor: "0x005795"
                                borderWeight: "2"
                                backgroundColor: "0x005795"
                                color: "0xffffff"
                                border:
                                  style: "3"
                                borderRadius: "3"
                                fontFamily: "Poppins"
                                fontSize: .Nfont.nf2
                                textAlign:
                                  x: center
                                  y: center
                        - type: label
                          text: File size must be no larger than 5M
                          dataKey: 
                          style:
                            top: "0.36"
                            fontSize: .Nfont.nf2
                            color: "0x707070"
                            width: "0.334"
                            textAlign: 
                              x: center
                # - type: button
                #   text: Confirm

                #   style:
                #     left: "0.67"
                #     marginTop: "0.08"
                #     width: "0.1" 
                #     height: "0.04" 
                #     borderColor: "0x005795"
                #     borderWeight: "2"
                #     backgroundColor: "0x005795"
                #     color: "0xffffff"
                #     border:
                #       style: "3"
                #     borderRadius: "3"
                #     fontFamily: "Poppins"
                #     fontSize: .Nfont.nf2
                #     textAlign:
                #       x: center
                #       y: center
                # - .FormsCloseButton:                             
            - .FormsBottomView: 
              children:
                - .FormsBottomButtons:
                  children:
                    - .FormsBottomLeftButton: 
                      onClick: 
                        - actionType: evalObject
                          object:
                            - if:
                              - =..apiRequest.meetingDocument.docReq.name.title
                              - continue
                              - actionType: popUp
                                popUpView: checkNameView
                                wait: true
                                popUpDismiss: 1000   
                            - ..apiRequest.meetingDocument.docReq.name.data.statusTag@: =..formDataTemp.privateTag
                            - ..apiRequest.meetingDocument.docReq.type@: 163840
                            - ..apiRequest.meetingDocument.docReq.name.data.fileId@: =..formData.imageId
                            - =..apiRequest.meetingDocument.docAPI.store: ""     
                        - actionType: builtIn
                          funcName: goBack
                          reload: true    
                    - .FormsBottomRightButton:   
                      onClick: 
                        - actionType: evalObject
                          object:
                            - if:
                              - =..apiRequest.meetingDocument.docReq.name.title
                              - continue
                              - actionType: popUp
                                popUpView: checkNameView
                                wait: true
                                popUpDismiss: 1000   
                            - ..apiRequest.meetingDocument.docReq.name.data.statusTag@: =..formDataTemp.publicTag
                            - ..apiRequest.meetingDocument.docReq.name.data.fileId@: =..formData.imageId
                            - =..apiRequest.meetingDocument.docAPI.store: ""     
                        - actionType: builtIn
                          funcName: goBack
                          reload: true                                       
        - .PopupLightPrompt:  
          viewTag: checkNameView    
          msg: Document name is required                     