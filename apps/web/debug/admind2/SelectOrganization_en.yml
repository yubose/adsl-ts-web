SelectOrganization: #xd page number 7
  pageNumber: "70"
  init:
    - .SignInCheck
    - .Global.formData.firstLogin@: true
    - .Global.menuBar.listData@: =.SideMenuBarDM.ScheduleManagement
    - actionType: evalObject
      object:
        .Global._nonce@:
          =.builtIn.math.random: ""
    - actionType: updateObject
      dataKey: Global.currentFacility
      dataObject: ""
    - .Global.jwt.edge.bvid@: =.Global.currentUser.vertex.id
    - actionType: evalObject
      object:
        - =.Global.jwt.edgeAPI.store: ""
    - ..listData.get
    # - ..auth.edgeAPI.get
    - if:
        - =..listData.organization.vertex.0
        - continue
        - =.builtIn.checkField:
            dataIn:
              contentType: messageHidden
              wait: 100
    - actionType: evalObject
      object: 
        - .Global.MedicalFacilityInfo@: ""
    - actionType: evalObject
      object: 
        - .Global.DEAUrl@: ""
    - actionType: evalObject
      object: 
        - .Global.MedicalLicenseUrl@: ""
    - actionType: evalObject
      object: 
        - .Global.BusinessLogoUrl@: ""
    - actionType: evalObject
      object: 
        - .Global.ProfileUrl@: ""
    - actionType: updateObject
      dataKey: Global.auth
      dataObject: ""
  formData:
    status: false
    auth:
      MFI:
        create: false
        edit: false
        review: false
      TDT:
        create: false
        edit: false
        review: false
      staff:
        create: false
        edit: false
        review: false
      patient:
        create: false
        edit: false
        review: false
      provider:
        create: false
        edit: false
        review: false
      scheduleInfo:
        create: false
        edit: false
        review: false
      PAT:
        create: false
        edit: false
        review: false
  auth:
    info: ""
    document:
      xfname: eid
      id: ""
      type: .DocType.Auth
    docAPI:
      get:
        api: rd
        dataIn: SelectOrganization.auth.document
        dataOut: SelectOrganization.auth.info
  relation:
    edgeStore: ""
    info: ""
    edge:
      xfname: bvid,evid
      id: []
      type: .EdgeType.StaffToFacility
      obfname: "ctime"
      _nonce: =.Global._nonce
      asc: false
    edgeAPI: 
      get:
        api: re
        dataIn: SelectOrganization.relation.edge
        dataOut: SelectOrganization.relation.info
  relation1:
    edge: ""
    edgeReq:
      xfname: bvid,evid
      id: []
      type: 1100
      _nonce: =.Global._nonce
    edgeAPI:
      get:
        api: re
        dataIn: SelectOrganization.relation1.edgeReq
        dataOut: SelectOrganization.relation1.edge
  listData:
    organization:
      vertex: ""
    vertex: 
      ObjType: "4"
      ids: 
        - .Global.currentUser.vertex.id
      xfname: "E.bvid"
      sCondition: "E.type in (1100,1200) AND V.type=20"
      maxcount : "100"
      obfname : "ctime"
      _nonce: =.Global._nonce
    get:
      api: rv
      dataOut: listData.organization
      dataIn: listData.vertex
  # medicalFacilityRootNoteBook:
  #   response: ""
  #   edge:
  #     id: ""
  #     type: 10000
  #     xfname: "bvid"
  #     sCondition: "subtype=1"
  #     _nonce: =.Global._nonce
  #   EdgeAPI:
  #     get:
  #       api: re
  #       dataIn: SelectOrganization.medicalFacilityRootNoteBook.edge
  #       dataOut: SelectOrganization.medicalFacilityRootNoteBook.response
  medicalFacility:
    response: ""
    vertex: 
      .Vertex: ""
      id: ""
    vertexAPI:
      get:
        api: rv
        dataIn: SelectOrganization.medicalFacility.vertex
        dataOut: SelectOrganization.medicalFacility.response
  FacilityJWT:
    JWT: ""
    edge:
      .Edge: ""
      type: .EdgeType.JWT
      bvid: ""
    edgeAPI:
      store:
        api: ce
        dataIn: SelectOrganization.FacilityJWT.edge
        dataOut: SelectOrganization.FacilityJWT.JWT
  components:
    - .BaseCheckView: ""
      message: "You have no authority to enter the facility"
      viewTag: statusTag
      style: 
        zIndex: "100000"
    - .MainView:
      children:
        - .Head0:
        - type: label
          text: 'LogOut'
          onClick:
            - goto: LogOut
          style:
            width: '0.08'
            height: '0.06'
            fontSize: .Nfont.nf3
            fontWeight: '500'
            color: "#235591"
            left: '0.9'
            top: '0'
            textAlign:
              x: center
              y: center
        - .CenterView:
          style:
            width: "0.84"
            left: "0.08"
            height: "0.86"
            top: "0.1"
            backgroundColor: "#ffffff"
          children:

            - type: label
              text: Select Organization
              style:
                fontSize: 2.2vh
                fontWeight: "600"
                top: "0.0626"
                left: "0.025"
                color: "0x000000"
            - type: label
              text: Existing Organizations
              style:
                fontSize: 1.8vh
                fontWeight: "400"
                top: "0.12"
                left: "0.075"    
                color: "#517086"
            - type: label
              text: Create a new organization
              style:
                fontSize: 1.8vh 
                fontWeight: "400"
                top: "0.12"
                left: "0.485"    
                color: "#517086"
            - type: scrollView
              style:
                height: "0.63"
                width: '0.42'
                top: '0.16'
                left: "0"
                marginTop: '0'
                overflowY: scroll
                overflowX: hidden
              children:
                - type: list
                  contentType: listObject
                  listObject: ..listData.organization.vertex
                  iteratorVar: itemObject
                  style:
                    width: "0.28"
                    left: "0.075"
                    height: auto
                    margin: "0"
                  children:
                    - type: listItem
                      itemObject: 
                      onClick:
                        - emit:
                            dataKey: 
                              var: itemObject
                            actions:
                              - .Global.currentFacility@: $var
                              - ..medicalFacilityRootNoteBook.edge.id@: $var.id
                              - .Global.currentId.facility@: $var.id
                              - .Global.currentId.location@: $var.id
                              - =.builtIn.string.concat:
                                  dataIn:
                                    - =.Config.searchLink
                                    - "/index.html?FacilityDetailLink&id="
                                    - $var.name.basicInfo.locationID
                                    - " "
                                  dataOut: Global.formData.facilityLink
                              # - .Global.fac_rootNotebook@: $var.deat.rnb64ID
                              # 用deat里面的数据 来代替rootnotebookid  xuchen 12.9
                              # - =..medicalFacilityRootNoteBook.EdgeAPI.get: ""
                        - actionType: evalObject
                          object:
                            .Global._nonce@:
                              =.builtIn.math.random: ""
                        - actionType: evalObject
                          object:
                            #- .Global.currentFacility.rootNotebookID@: =..medicalFacilityRootNoteBook.response.edge.0.id
                            # - ..relation.edge.id@: =.Global.currentFacility.id
                            - =.builtIn.array.add:
                                dataIn:
                                  object: =..relation.edge.id
                                  value: =.Global.currentUser.vertex.id
                            - =.builtIn.array.add:
                                dataIn:
                                  object: =..relation.edge.id
                                  value: =.Global.currentFacility.id
                            - =..relation.edgeAPI.get: ""
                            - actionType: evalObject
                              object:
                                .Global._nonce@:
                                  =.builtIn.math.random: ""
                            - if:
                              - =..relation.info.edge.0
                              - .Global.auth@: =..relation.info.edge.0.name.auth
                              - actionType: evalObject
                                object:
                                  # - ..relation1.edgeReq.id@: =.Global.currentFacility.id
                                  - =.builtIn.array.add:
                                      dataIn:
                                        object: =..relation1.edgeReq.id
                                        value: =.Global.currentUser.vertex.id
                                  - =.builtIn.array.add:
                                      dataIn:
                                        object: =..relation1.edgeReq.id
                                        value: =.Global.currentFacility.id
                                  - =..relation1.edgeAPI.get: ""
                            - if:
                              - =..relation.info.edge.0
                              - .Global.auth@: =..relation.edge.edge.0.name.auth
                              - actionType: evalObject
                                object:
                                  - .Global.auth@: =..relation1.edge.edge.0.name.auth
                            - .Global.facilityList@: =..listData.organization.vertex
                            # - ..FacilityJWT.edge.bvid@: =.Global.currentFacility.id
                            # - =..FacilityJWT.edgeAPI.store: ""
                            # - .Global.JWT@: =..FacilityJWT.JWT.jwt
                        - actionType: evalObject
                          object:
                            - if:
                              - =..relation.info.edge.0
                              - actionType: evalObject
                                object:
                                  - if: 
                                    - =.builtIn.string.equal:
                                        dataIn:
                                          string1: =..relation.info.edge.0.name.status
                                          string2: Inactive
                                    - ..formData.status@: false
                                    - ..formData.status@: true
                              - goto: ScheduleManagement
                            - if:
                              - =..formData.status
                              - goto: ScheduleManagement
                              - actionType: popUp
                                popUpView: statusTag
                        # - goto: ScheduleManagement
                      style:
                        width: '0.28'
                        height: '0.18'
                        left: '0'
                        marginTop: '0.02'
                        border:  
                          style: "3"
                        borderColor: "#008080"
                        borderWidth: "1"
                        # boxShadow: "0px 2px 9px 1px #a6bbca" 
                        borderRadius: "5"
                      children: 
                        - type: label
                          dataKey: itemObject.name.basicInfo.medicalFacilityName
                          style:
                            width: "0.217"
                            fontSize: .Nfont.nf5 
                            fontWeight: "500"
                            top: "0.015"
                            left: "0.012"    
                            textOverflow: ellipsis
                            overflow: hidden
                            color: "0x0063a5"
                        - type: image
                          path: "office-building.svg"
                          style: 
                            width: "0.03"
                            top: "0.06"
                            left: "0.11"
                        - type: label
                          text: "Registered Date:" 
                          style:
                            fontSize: .Nfont.nf2
                            fontWeight: "400"
                            top: "0.14"
                            left: "0.012" 
                            width: "0.077"   
                            color: "#517086"  
                        - type: label
                          text=func: .builtIn.string.formatUnixtime_en
                          dataKey: itemObject.ctime
                          style:
                            fontSize: .Nfont.nf2
                            fontWeight: "500"
                            top: "0.14"
                            left: "0.089"    
                            color: "#517086"  
                        - type: view  
                          style:
                            top: "0"
                            width: "0.05"
                            height: "0.18"
                            left: "0.23"
                            backgroundColor: "0x008080"
                            borderRadius: "5"
                            boxShadow: "0px 0px 1px 1px #a6bbca" 
                          children:
                            - type: image
                              path: "enter.svg"
                              style: 
                                width: "0.03"
                                top: "0.052"
                                left: "0.01"
                            - type: label
                              text: Enter
                              style:
                                fontSize: .Nfont.nf4 
                                fontWeight: "500"
                                top: "0.115"
                                left: "0.015"
                                color: "#FFFFFF"        
                # - type: label
                #   text: Medical Facility
                #   style:
                #     fontSize: "25"
                #     fontWeight: "500"
                #     top: "0.07"
                #     left: "0.11"
            - type: view
              contentType: messageHidden
              style:
                top: "0.1"
                left: "0"
                isHidden: "true"
                textAlign:
                  x: center
              children:
                - type: label
                  text: No existing Organization
                  style:
                    fontSize: .Nfont.nf6
                    fontWeight: "800"
                    top: "0.52"
                    left: "0"
                    width: "0.42"   
                    color: "#0063A8"
                - type: label
                  text: Create a new Organization
                  style:
                    fontSize: .Nfont.h4
                    fontWeight: "400"
                    top: "0.58"
                    left: "0" 
                    width: "0.42"   
                    color: "#0063A8"
                # - type: label
                #   text: Create a new Organization
                #   style:
                #     fontSize: .Nfont.nf4
                #     fontWeight: "400"
                #     top: "0.12"
                #     left: "0"    
                #     color: "#517086"
                - type: image
                  path: "office-building.svg"
                  style:
                    width: "0.15"
                    left: "0.135"
                    top: "0.16"
            - type: view
              onClick:
                - goto: MedicalFacility1
              style:
                height: "0.18"
                width: "0.28"
                left: "0.485"
                border: 
                  style: "3"
                boxShadow: "0px 1px 5px 0.1px #5b88a8"
                top: "0.18"
                backgroundColor: "#ffffff"
                borderRadius: "5"
                fontFamily: "Poppins"
                textAlign: 
                  y: center
              children:
                - type: image
                  path: "add1.svg"
                  style: 
                    width: "0.05"
                    top: "0.05"
                    left: "0.04"
                - type: label
                  text: Organization
                  style:
                    fontSize: .Nfont.nf6 
                    fontWeight: "500"
                    # top: "0.055"
                    left: "0.1"
                    textAlign:
                      y: center
  