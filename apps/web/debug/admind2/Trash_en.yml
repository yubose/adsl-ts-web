Trash:
  title: "Trash"
  
  pageNumber:
  
  init:
    - .SignInCheck 
    - actionType: evalObject
      object:
        .Global._nonce@:
          =.builtIn.math.random: ""  
    # - .Global.jwt.edge.bvid@: =.Global.currentUser.vertex.id
    # - =.Global.jwt.edgeAPI.store: ""        
    - .Global.jwt.edge.bvid@: =.Global.currentFacility.id
    - =.Global.jwt.edgeAPI.store: ""                   
    - =..apiRequest.trashList.docAPI.get: ""
    - if:   
      - =..apiRequest.trashList.docQueryResp.doc.0
      - =.builtIn.object.setObjectKey:
          dataIn:
            objectArr: =..apiRequest.trashList.docQueryResp.doc
            key: isSelected
            value: false  
          dataOut: Trash.formData.trashList
      - =.builtIn.checkField:
          dataIn:
            contentType: messageHidden
            wait: 100    
  formData: 
    trashList: []
    email: ""
    soloAttach: ""    # 选出的单个附件，用于展示    
    selectedID: []  # 被选中的邮件id，用于批量删除
    attachment: []   # 附件
    selectSeveral: []   # 多选
    selectOne: []
    selectedDocList: [] # 垃圾箱多选
    isAllSelected: false  # 全选
    selectedDocListLength: ""
    emailListLength: ""
    receiver: ""
  formDataTemp: 
  apiRequest:
    trashList:
      deleteReq: 
        id: ""
      docQueryResp: ""
      docQueryReq:
        ObjType: 544
        type: 1281
        id: .Global.currentFacility.id
        sCondition: E.type=10002 AND (D2.Type & 0xFF18 = 0xE08)
        xfname: (E.bvid|E.evid)
        obfname: mtime
        _nonce: =.Global._nonce 
        maxcount: "100"
      docAPI:
        get:
          api: rd
          dataIn: Trash.apiRequest.trashList.docQueryReq
          dataOut: Trash.apiRequest.trashList.docQueryResp
        delete: 
          api: dx
          dataIn: Trash.apiRequest.trashList.deleteReq
    emailTag:
      docQueryResp: ""
      docQueryReq: 
        _nonce: =.Global._nonce
        sCondition: type & 0xFF00 = 0xE00
        ids:
          - .Global..fac_rootNotebook
        xfname: eid,reid
      docCreateReq:
        type: .DocType.MailTag
        eid: .Global.rootNotebookID
        name: 
          data: ""     
        reid: ""
      docAPI:
        get:
          api: rd
          dataIn: Trash.apiRequest.emailTag.docQueryReq
          dataOut: Trash.apiRequest.emailTag.docQueryResp
    attachment:
      docQueryReq: 
        type: .DocType.Attachment
        id: "" 
        xfname: reid
        obfname : "ctime" 
        _nonce: =.Global._nonce        
      docQueryResp: ""
      docAPI:
        get: 
          api: rd
          dataIn: Trash.apiRequest.attachment.docQueryReq
          dataOut: Trash.apiRequest.attachment.docQueryResp           
  style: 

  components:
    - type: view
      style:
        width: "1"
        height: "1"
        margin: auto
      children:
        - .SideMenuBar:
          children:
            - .aitLogo:
            - .MenuBar:
        - .TopBar:
        - .BodyView:
          style: 
              height: "0.93"
          children: 
            - type: view
              viewTag: searchView
              style: 
                backgroundColor: "0xffffff"
                left: "0.008"
                width: "0.255"
                height: "0.07"
                marginTop: "0.015"
                borderRadius: "5px"
              children:
                - type: view
                  style:
                    left: "0.007"
                    top: "0.017"
                    height: "0.036"
                    width: "0.18"
                    border:
                      style: "3"
                    borderColor: "0xcecece"
                    borderRadius: "3px"
                  children:
                    - type: image
                      path: search.svg
                      style:
                        top: "0.008"
                        left: "0.005"
                        width: "0.012"
                        height: "0.02"
                    - type: textField
                      placeholder: Search
                      dataKey: 
                      style:
                        boxSizing: content-box
                        width: "0.155"
                        left: "0.022"
                        top: "0"
                        height: "0.034"
                        border: none
                        borderRadius: "3px"
                        fontSize: .Nfont.nf2
                - type: view
                  onClick: 
                    - actionType: evalObject
                      object:
                        - .Global.formData.reply.name.data.receiverName@: ""
                        - .Global.formData.reply.name.data.receiverAvatarId@: ""
                        - .Global.formData.reply.name.title@: ""
                        - .Global.formData.reply.eid@: =.Global.fac_rootNotebook      
                    - goto: NewMessage                
                  style:
                    top: "0.017"
                    width: "0.05"
                    height: "0.038"
                    left: "0.197"
                    backgroundColor: "0x005795"
                    borderRadius: "3px"
                    textAlign:
                      x: center
                      y: center
                  children:
                    - type: image
                      path: editPen.svg
                      style:
                        width: "0.012"
                        height: "0.02"                
            - type: view
              viewTag: messageView
              style: 
                left: "0.008"
                width: "0.255"
                height: "0.83"
                marginTop: "0"
              children:
                - type: view
                  style:
                    left: "0"
                    width: "0.255"
                    height: "0.07"
                    marginTop: "0"
                  children:
                    - type: view
                      style:
                        top: "0.018"
                        width: "0.02"
                        height: "0.034"
                        left: "0.003"
                        borderRadius: "5px"
                        textAlign:
                          x: center
                          y: center
                      children:
                        - type: image
                          viewTag: allSelectedView
                          path: 
                            emit: 
                              actions:
                                - if: 
                                  - =.builtIn.string.equal:
                                      dataIn:
                                        string1: true
                                        string2: =..formData.isAllSelected
                                  - selectBlue.svg
                                  - selectGray.svg  
                          onClick: 
                            - actionType: evalObject
                              object:
                                - if:
                                  - =.builtIn.string.equal:
                                      dataIn:
                                        string1: =..formData.isAllSelected
                                        string2: true 
                                  - actionType: evalObject
                                    object:
                                      - ..formData.isAllSelected@: false
                                      - =.builtIn.object.setObjectKey:
                                          dataIn:
                                            objectArr: =..formData.trashList 
                                            key: isSelected
                                            value: false  
                                          dataOut: Trash.formData.trashList
                                      - ..formData.selectSeveral@: []
                                  - actionType: evalObject
                                    object:
                                      - ..formData.isAllSelected@: true
                                      - =.builtIn.object.setObjectKey:
                                          dataIn:
                                            objectArr: =..formData.trashList 
                                            key: isSelected
                                            value: true  
                                          dataOut: Trash.formData.trashList 
                                      - ..formData.selectSeveral@: =..formData.trashList
                            - actionType: builtIn
                              funcName: redraw
                              viewTag: allSelectedView
                            - actionType: builtIn
                              funcName: redraw
                              viewTag: trashView
                          style:
                            width: "0.015"
                            height: "0.02"                    
                    - type: view
                      onClick:  
                        - actionType: evalObject
                          object:
                            - if: 
                              - =..formData.selectSeveral.0
                              - ..formData.selectedDocList@: =..formData.selectSeveral
                              - continue
                            - if: 
                              - =..formData.selectSeveral.0
                              - actionType: popUp
                                popUpView: dxSeveralMsgView
                                wait: true
                              - actionType: popUp
                                popUpView: noMessageTag
                                wait: true
                      style:
                        top: "0.018"
                        width: "0.02"
                        height: "0.034"
                        left: "0.026"
                        backgroundColor: "0xffffff"
                        borderRadius: "5px"
                        textAlign:
                          x: center
                          y: center
                      children:
                        - type: image
                          path: redTrash.svg
                          style:
                            width: "0.01"
                            height: "0.016"
                    - type: view
                      onClick: 
                        - actionType: evalObject
                          object:
                            - if: 
                              - =..formData.selectSeveral.0
                              - actionType: evalObject
                                object:
                                  - ..formData.selectedDocList@: =..formData.selectSeveral
                                  - actionType: popUp
                                    popUpView: recoverView
                                    wait: true
                              - actionType: popUp
                                popUpView: noMessageTag
                                wait: true                      
                      style:
                        top: "0.018"
                        width: "0.02"
                        height: "0.034"
                        left: "0.053"
                        backgroundColor: "0xffffff"
                        borderRadius: "5px"
                        textAlign:
                          x: center
                          y: center
                      children:
                        - type: image
                          path: retrieve.svg
                          style:
                            width: "0.01"
                            height: "0.016"                            
                - type: view
                  contentType: messageHidden
                  style:
                    left: "0"
                    width: "0.255"
                    height: "0.76"
                    top: "0.07"
                    borderRadius: "5px"
                    isHidden: "true"
                    zIndex: "5"
                    backgroundColor: "0xffffff" 
                  children: 
                    - type: label
                      text: No message here! 
                      dataKey: 
                      style:
                        width: "0.255"
                        height: "0.7"
                        color: "0x999999"
                        fontSize: .Nfont.nf5  
                        textAlign: 
                          x: center
                          y: center
                             
                - type: scrollView
                  style:
                    left: "0"
                    width: "0.255"
                    height: "0.76"
                    top: "0.07"
                    overflow: scroll
                    borderRadius: "5px"
                    backgroundColor: "0xffffff"
                  children:
                    - type: list
                      contentType: listObject
                      listObject: ..formData.trashList
                      iteratorVar: itemObject
                      viewTag: trashView
                      style:
                        width: "0.255"
                        margin: "0"
                        left: "0"
                        height: auto
                      children:
                        - type: listItem
                          itemObject: 
                          style:
                            width: "0.255"
                            height: "0.1"
                            left: "0"
                            marginTop: "0"
                          children:
                            - type: view
                              style:
                                left: "0"
                                width: "0.255"
                                height: "0.1"
                                marginTop: "0"
                                boxSizing: border-box
                                borderLeft: itemObject.border
                                backgroundColor: itemObject.backgroundColor
                              children:
                                - type: image
                                  viewTag: selectImgView
                                  path: 
                                    emit: 
                                      dataKey: 
                                        var: itemObject
                                      actions: 
                                        - if: 
                                          - =.builtIn.string.equal:
                                              dataIn:
                                                string1: true
                                                string2: $var.isSelected
                                          - selectBlue.svg
                                          - selectGray.svg   
                                  onClick: 
                                    - emit:
                                        dataKey:
                                          var: itemObject
                                        actions:
                                          - if:
                                            - =.builtIn.string.equal:
                                                dataIn:
                                                  string1: true
                                                  string2: $var.isSelected
                                            - =.builtIn.object.set:
                                                dataIn:
                                                  object: $var
                                                  key: isSelected
                                                  value: false
                                            - =.builtIn.object.set:
                                                dataIn:
                                                  object: $var
                                                  key: isSelected
                                                  value: true
                                          - if:
                                            - =.builtIn.string.equal:
                                                dataIn:
                                                  string1: true
                                                  string2: $var.isSelected
                                            - =.builtIn.array.add:
                                                dataIn:
                                                  object: =..formData.selectSeveral
                                                  value: $var
                                            - =.builtIn.array.removeById:
                                                dataIn:
                                                  object: =..formData.selectSeveral
                                                  id: $var.id
                                    - actionType: evalObject
                                      object: 
                                        - =.builtIn.array.getListLength: 
                                            dataIn: 
                                              object: =..formData.trashList
                                            dataOut: Trash.formData.emailListLength
                                        - =.builtIn.array.getListLength: 
                                            dataIn: 
                                              object: =..formData.selectSeveral
                                            dataOut: Trash.formData.selectedDocListLength
                                        - if:
                                          - =.builtIn.string.equal:
                                              dataIn:
                                                string1: =..formData.emailListLength
                                                string2: =..formData.selectedDocListLength
                                          - ..formData.isAllSelected@: true
                                          - ..formData.isAllSelected@: false
                                    - actionType: builtIn
                                      funcName: redraw
                                      viewTag: selectImgView
                                    - actionType: builtIn
                                      funcName: redraw
                                      viewTag: allSelectedView
                                  style:
                                    top: "0.04"
                                    left: "0.002"
                                    width: "0.015"
                                    height: "0.02"
                                - type: view
                                  style:
                                    width: "0.22"
                                    height: "0.1"
                                    left: "0.021"
                                    marginTop: "0"
                                    borderBottom: "1px solid #afc6d6"
                                    boxSizing: border-box
                                  onClick:
                                    - actionType: evalObject
                                      object:
                                        .Global._nonce@:
                                          =.builtIn.math.random: "" 
                                    - actionType: updateObject
                                      dataKey: Trash.formData.email
                                      dataObject: itemObject             
                                    - emit: 
                                        dataKey: 
                                          var: itemObject
                                        actions: 
                                          - ..formData.attachment@: []
                                          - =.builtIn.object.setProperty: 
                                              dataIn: 
                                                obj: =..formData.trashList
                                                label: "id"
                                                text: $var.id
                                                arr: ["border","backgroundColor"]
                                                valueArr: ["5px solid #005795","0xe2edf5"]
                                                errorArr: ["none","0xffffff"]  
                                          
                                          - =.builtIn.string.concat:
                                              dataIn:
                                                - "Sent to "
                                                - " "
                                                - $var.name.data.receiverName
                                              dataOut: Trash.formData.receiver
                                          - ..apiRequest.attachment.docQueryReq.id@: $var.id
                                          - =..apiRequest.attachment.docAPI.get: ""
                                          - ..formData.attachment@: =..apiRequest.attachment.docQueryResp.doc
                                    - actionType: builtIn
                                      funcName: hide
                                      viewTag: noEmailView
                                    - actionType: builtIn
                                      funcName: show
                                      viewTag: newMessageView 
                                    - actionType: builtIn
                                      funcName: redraw
                                      viewTag: newMessageView
                                    - actionType: builtIn
                                      funcName: redraw
                                      viewTag: trashView
                                    # backgroundColor: "0xff000033"
                                  children:                                  
                                    - type: image
                                      path: avatarMan.svg
                                      path=func: .builtIn.utils.prepareDocToPath
                                      dataKey: itemObject.name.user
                                      style:
                                        top: "0.025"
                                        left: "0"
                                        width: "0.03"
                                        height: "0.048"
                                    - type: view
                                      style:
                                        width: "0.16"
                                        top: "0.015"
                                        height: "0.07"
                                        left: "0.041"
                                      children:
                                        - type: label
                                          dataKey: itemObject.name.data.receiverName
                                          style:
                                            top: "0"
                                            left: "0"
                                            height: "0.02"
                                            width: "0.07"
                                            fontSize: .Nfont.nf2
                                            color: "0x000000"
                                            textAlign:
                                              y: center
                                        - type: image
                                          path: 
                                            emit: 
                                              dataKey: 
                                                var: itemObject
                                              actions: 
                                                - if: 
                                                  - $var.name.data.haveAttachment
                                                  - appendix.svg
                                                  - null.png
                                          style:
                                            top: "0"
                                            left: "0.08"
                                            width: "0.014"
                                            height: "0.022"                           
                                        - type: label
                                          # text: "Patient Census for June"
                                          dataKey: itemObject.name.title
                                          style:
                                            top: "0.026"
                                            left: "0"
                                            height: "0.02"
                                            width: "0.16"
                                            fontSize: .Nfont.nf2
                                            color: "0x000000"
                                            textAlign:
                                              y: center
                                        - type: label
                                          # text: "I attached the patient census for June..."
                                          dataKey: itemObject.name.data.content
                                          style:
                                            top: "0.048"
                                            left: "0"
                                            height: "0.02"
                                            width: "0.16"
                                            fontSize: .Nfont.nf2
                                            color: "0x333333"
                                            overflow: hidden
                                            textOverflow: ellipsis
                                            whiteSpace: nowrap
                                            textAlign:
                                              y: center
                                    - type: label
                                      text=func: .builtIn.string.formatUnixtime_en
                                      dataKey: itemObject.ctime
                                      style:
                                        top: "0.015"
                                        left: "0.14"
                                        width: "calc(7vw)"
                                        height: "0.02"
                                        fontSize: .Nfont.nf0
                                        color: "0x333333"
                                        textAlign: 
                                          x: right
            - type: view
              viewTag: noEmailView
              style: 
                width: "0.562"
                height: "0.9"
                top: "0.015"
                left: "0.27"
                backgroundColor: "0xffffff"
                borderRadius: "5"
                # zIndex: "5"
                isHidden: false
              children :
                - type: image
                  path: noInbox.svg
                  style:
                    width: "0.25"
                    left: "0.15"
                    top: "0.12"
                - type: label
                  text: "Welcome to check your inbox!"
                  dataKey: 
                  style:
                    fontSize: .Nfont.nf6
                    fontWeight: "700"
                    left: "0.15"
                    top: "0.6"
            - type: scrollView
              viewTag: newMessageView
              style:
                width: "0.562"
                height: "0.9"
                top: "0.015"
                left: "0.27"
                backgroundColor: "0xffffff"
                borderRadius: "5"
                isHidden: true
              children:
                - type: view
                  style:
                    width: "0.5"
                    height: "0.87"
                    margin: auto
                  children:
                    - type: view
                      style:
                        width: "0.5"
                        height: "0.05"
                        # marginTop: "0.005"
                      children:
                        - type: view
                          style:
                            width: "0.17"
                            height: "0.05"
                            left: "0.33"
                            top: "0.015"
                            display: flex
                            justifyContent: flex-end
                            alignItems: center
                            margin: "0"
                          children:
                            - type: view
                              style:
                                width: "0.05"
                                height: "0.05"
                                display: flex
                                justifyContent: space-around
                                alignItems: center
                              children:
                                - type: image
                                  path: cash.svg
                                  style:
                                    width: "0.011"
                                  onClick: 
                                    - actionType: evalObject
                                      object:
                                        - =.builtIn.array.add:
                                            dataIn:
                                              object: =..formData.selectOne
                                              value: =..formData.email
                                        - ..formData.selectedDocList@: =..formData.selectOne
                                        - ..formData.selectOne@: []
                                    - actionType: popUp
                                      popUpView: dxSeveralMsgView
                                      wait: true
                                - type: image
                                  path: strightLine.svg
                                  style:
                                    height: "0.03"
                                - type: image
                                  path: retrieveBlack.svg
                                  onClick: 
                                    - actionType: evalObject
                                      object:
                                        - =.builtIn.array.add:
                                            dataIn:
                                              object: =..formData.selectOne
                                              value: =..formData.email
                                        - ..formData.selectedDocList@: =..formData.selectOne
                                        - ..formData.selectOne@: []
                                    - actionType: popUp
                                      popUpView: recoverView
                                      wait: true
                                  style:
                                    width: "0.011"                                       
                    
                    # 2 infomation and date
                    - type: view
                      style:
                        width: "0.5"    
                        height: "0.1" 
                        border:
                          style: "2"
                        borderColor: "0xd1d1d1"   
                        borderWidth: "1"
                      children:
                        - type: image
                          path: avatarMan.svg
                          path=func: .builtIn.utils.prepareDocToPath
                          dataKey: formData.email.name.data.receiverAvatarId
                          style:
                            top: "0.01"
                            width: "0.04"
                        - type: label
                          text: "Me"
                          dataKey: formData.email.name.data.senderName
                          style:
                            width: "0.1"
                            fontSize: .Nfont.nf5
                            top: "0.015"
                            left: "0.05"
                        - type: label
                          dataKey: formData.receiver
                          style:
                            width: "0.25"
                            left: "0.05"
                            top: "0.045"
                            color: "0x0b4a7e"
                        - type: label
                          text=func: .builtIn.string.formatUnixtimeSecond
                          dataKey: formData.email.ctime
                          style:
                            width: "0.1"
                            left: "0.4"
                            top: "0.045"
                            color: "0x797979"
                            fontSize: .Nfont.nf3
                            textAlign: 
                              x: right
                    # 3 main
                    - type: view
                      style:
                        width: "0.5"
                        height: "0.686"
                      children:
                        - type: label
                          dataKey: formData.email.name.title
                          style:
                            width: "0.5"
                            height: "0.06"
                            fontSize: .Nfont.n5
                            marginTop: "0.012"
                        - type: view
                          style:
                            width: "0.5"
                            height: auto
                          children:
                            - type: label
                              dataKey: formData.email.name.data.content
                              style: 
                                fontSize: .Nfont.nf4
                                lineHeight: "2"
                        - type: list
                          contentType: listObject
                          listObject: ..formData.attachment
                          iteratorVar: itemObject
                          style:
                            width: "0.4"
                            margin: "0"
                            height: auto
                            marginTop: "0.01"
                          children:
                            - type: listItem
                              itemObject: ""
                              style:
                                width: "0.4"
                                height: "0.04"
                                left: "0"
                                marginTop: ""
                              children:
                                - type: view
                                  style:
                                    width: "0.4"
                                    height: "0.04"
                                    backgroundColor: "0xF4F5F7"
                                    marginTop: "0.015"
                                    borderRadius: "10"
                                  children:
                                    - type: view
                                      style:
                                        width: "0.24"
                                        height: "0.04"
                                        display: flex
                                        alignItems: center
                                      children:
                                        - type: image
                                          path: copyPhoto.svg
                                          style:
                                            width: "0.01"
                                            marginLeft: "10px"
                                        - type: label
                                          dataKey: itemObject.name.title
                                          style:
                                            # width: "0.12"
                                            color: "0x666666"
                                            fontSize: .Nfont.nf2
                                            marginLeft: "10px"
                                            
                                        - type: label
                                          text=func: .builtIn.string.bitFormatting
                                          dataKey: itemObject.size
                                          style: 
                                            color: "0x666666"
                                            fontSize: .Nfont.nf2
                                            marginLeft: "10px"
                                        
                                    - type: view
                                      onClick: 
                                        - emit: 
                                            dataKey: 
                                              var: itemObject
                                            actions: 
                                              - ..formData.soloAttach@: $var
                                        - actionType: builtIn
                                          funcName: redraw
                                          viewTag: attachView                                              
                                        - actionType: evalObject
                                          object:                                          
                                              - if: 
                                                - =.builtIn.string.equal:
                                                    dataIn:
                                                      string1: =..formData.soloAttach.name.type
                                                      string2: "application/pdf"
                                                - actionType: builtIn
                                                  funcName: hide
                                                  viewTag:  imgView
                                                - actionType: builtIn
                                                  funcName: show
                                                  viewTag: pdfView 
                                              - if: 
                                                - =.builtIn.string.equal:
                                                    dataIn:
                                                      string1: =..formData.soloAttach.name.type
                                                      string2: "application/pdf"
                                                - actionType: builtIn
                                                  funcName: hide
                                                  viewTag:  pdfView 
                                                - actionType: builtIn
                                                  funcName: show
                                                  viewTag: imgView
                                        - actionType: popUp
                                          popUpView: attachView                                    
                                      style:
                                        width: "0.05"
                                        height: "0.04"
                                        top: "0"
                                        left: "0.25"
                                        display: flex
                                        justifyContent: space-evenly
                                        alignItems: center
                                      children:
                                        - type: image
                                          path:  view.svg
                                          style:

                                        - type: label
                                          text: View
                                          style:
                                            fontSize: .Nfont.nf2
                                            color: "0x0b4a7e"
                                    - type: view
                                      onClick:
                                        - emit: 
                                            dataKey: 
                                              var: itemObject
                                            actions: 
                                              - =.builtIn.EcosObj.download:
                                                  dataIn:
                                                    ecosObj: $var                                              
                                      style:
                                        width: "0.07"
                                        height: "0.04"
                                        top: "0"
                                        left: "0.32"
                                        display: flex
                                        justifyContent: space-evenly
                                        alignItems: center
                                      children:
                                        - type: image
                                          path: downLoadBlue.svg
                                          style:
                                            
                                        - type: label
                                          text: Download
                                          style:
                                            fontSize: .Nfont.nf2
                                            color: "0x0b4a7e"
        # 删除成功
        - .SuccessDeletedPopUpView: ""
          msg: "Deleted Successfully！"
          viewTag: successTag
        # 删除垃圾箱中的邮件
        - type: popUp  # 多选删除
          viewTag: dxSeveralMsgView
          style:
            width: "0.23"
            height: "0.275"
            backgroundColor: "0xffffff"
            box-shadow: "0 0 9px 3px #cccccc"
            left: "0.45"
            top: "0.31"
          children:
            - type: view
              style:
                width: "0.23"
                height: "0.05"
                backgroundColor: "0xBF0000" 
              children:
                - type: label
                  text: Delete Availability
                  dataKey: 
                  style:
                    width: "0.23"
                    height: "0.05"
                    color: "0xffffff"
                    fontSize: .Nfont.nf2
                    display: flex
                    justifyContent: center
                    alignItems: center
            - type: image
              path: deleteAvailability.svg
              style:
                marginTop: "0.03"
                left: "0.1"
            - type: view
              style:
                width: "0.23"
                height: "0.07"
                border:
                  style: "2"
                borderWidth: "1"
                borderColor: "0xeeeeee"
                marginTop: "0.03"
                textAlign:
                  x: center
                display: flex
                justifyContent: center
              children:
                - type: label
                  text: Permanently delete these messages ?
                  dataKey: 
                  style:
                    width: "0.1"
                    fontSize: .Nfont.nf5
                    textAlign:
                      x: center
            - type: view
              style:
                width: "0.23"
                height: "0.046"
              children:
                - type: button
                  text: "Cancel"
                  style:
                    color: "0x2988e6"
                    fontSize: .Nfont.nf2
                    width: "0.12"
                    height: "0.046"
                    border: "none"
                    borderRight: "solid 1px #eeeeee"
                    backgroundColor: "0xffffff"
                    top: "0"
                    textAlign:
                      x: center
                      y: center
                  onClick:
                    # - actionType: evalObject
                    #   object:
                    #     - ..formData.selectSeveral@: []
                    - actionType: popUpDismiss
                      popUpView: dxSeveralMsgView
                - type: button
                  text: "Delete"
                  style:
                    color: "0x2988e6"
                    fontSize: .Nfont.nf2
                    border:
                      style: "1"
                    width: "0.11"
                    height: "0.046"
                    top: "0"
                    left: "0.12"
                    backgroundColor: "0xffffff"
                    textAlign:
                      x: center
                      y: center
                  onClick:
                    - actionType: popUpDismiss
                      popUpView: dxSeveralMsgView
                    - actionType: popUp
                      popUpView: uploadingTag
                    - actionType: evalObject
                      object:
                        .Global._nonce@:
                          =.builtIn.math.random: ""
                    - actionType: evalObject
                      object:
                        - =.builtIn.ecos.updateReidDocListType:
                            dataIn: 
                              sourceDocList: =..formData.selectedDocList
                              targetBit: 5
                              targetValue: 1
                              sCondition: type & 0xFF00 = 0xE00
                              eid: =.Global.fac_rootNotebook
                        - .Global.jwt.edge.bvid@: =.Global.currentFacility.id
                        - =.Global.jwt.edgeAPI.store: ""
                    - actionType: evalObject
                      object:                              
                        - =..apiRequest.trashList.docAPI.get: ""
                        - if:
                          - =..apiRequest.trashList.docQueryResp.doc.0
                          - =.builtIn.object.setObjectKey:
                              dataIn:
                                objectArr: =..apiRequest.trashList.docQueryResp.doc
                                key: isSelected
                                value: false  
                              dataOut: Sent.formData.trashList
                          - =.builtIn.checkField:
                              dataIn:
                                contentType: messageHidden
                                wait: 100    
                        # - ..formData.selectedDocList@: []
                        - =.builtIn.array.removeById:
                            dataIn:
                              object: =..formData.selectSeveral
                              id: =..formData.email.id
                        - =.builtIn.array.getListLength:
                            dataIn: 
                              object: =..formData.selectSeveral
                            dataOut: Trash.formData.selectedDocListLength
                        - =.builtIn.array.getListLength:
                            dataIn: 
                              object: =..formData.trashList
                            dataOut: Trash.formData.emailListLength
                        - if:
                          - =.builtIn.string.equal:
                              dataIn:
                                string1: =..formData.emailListLength
                                string2: =..formData.selectedDocListLength
                          - ..formData.isAllSelected@: true
                          - ..formData.isAllSelected@: false
                        - =.builtIn.array.ComparisonSettingProperties:
                            dataIn:
                              objArrOne: =..formData.selectSeveral
                              strOnePath: "id"
                              objArrTwo: =..formData.trashList
                              strTwoPath: "id"
                              strValue: "isSelected"
                              newValue: true
                            dataOut: Trash.formData.trashList
                    - actionType: builtIn
                      funcName: redraw
                      viewTag: allSelectedView                    
                    - actionType: builtIn
                      funcName: hide
                      viewTag: newMessageView
                    - actionType: builtIn
                      funcName: show
                      viewTag: noEmailView                    
                    - actionType: builtIn
                      funcName: redraw
                      viewTag: trashView
                    - actionType: popUpDismiss
                      popUpView: uploadingTag                            
                    - actionType: popUp
                      popUpView: deleteSuccessTag       
        # 删除成功
        - .SuccessDeletedPopUpView: ""
          viewTag: deleteSuccessTag
          msg: "Deleted Successfully！"
        # recover 成功
        - .SuccessDeletedPopUpView: ""
          viewTag: recoverSuccessView
          msg: "Recover Successfully！"        
        # recover email
        - type: popUp
          viewTag: recoverView
          style:
            left: "0"
            width: "1" 
            height: "1"
            top: "0"
            backgroundColor: "0x00000033"
            zIndex: "10"
          children: 
            - type: view
              style: 
                width: "0.32"
                height: "0.34"
                backgroundColor: "0xffffff"
                left: "0.4"
                top: "0.27"
              children:
                - type: view
                  style:
                    width: "0.32"
                    height: "0.13"
                    display: flex
                    justifyContent: center
                    alignItems: flex-end
                  children:
                    - type: label
                      text: "Recover the message?"
                      dataKey: 
                      style:
                        fontSize: .Nfont.nf5
                - type: view
                  style:
                    width: "0.32"
                    height: "0.15"
                    display: flex
                    justifyContent: space-evenly
                    alignItems: flex-end
                  children:
                    - type: button
                      text: "No"
                      style:
                        width: "0.065"
                        height: "0.045"
                        backgroundColor: "0xbebebe"
                        textAlign:
                          x: center
                          y: center
                        color: "0xffffff"
                        border:
                          style: "1"
                        borderRadius: "5"
                        fontSize: .Nfont.nf2
                      onClick:
                        - actionType: popUpDismiss
                          popUpView: recoverView
                    - type: button
                      text: "Yes"
                      style:
                        width: "0.065"
                        height: "0.045"
                        backgroundColor: "0x005795" 
                        textAlign:
                          x: center
                          y: center
                        color: "0xffffff"
                        border:
                          style: "1"
                        borderRadius: "5"
                        fontSize: .Nfont.nf2
                      onClick:
                        - actionType: popUpDismiss
                          popUpView: recoverView
                        - actionType: popUp
                          popUpView: uploadingTag                        
                        - actionType: evalObject
                          object:
                            .Global._nonce@:
                              =.builtIn.math.random: ""
                        - actionType: evalObject
                          object:
                            - .Global.jwt.edge.bvid@: =.Global.currentFacility.id
                            - =.Global.jwt.edgeAPI.store: ""
                            - =.builtIn.ecos.updateReidDocListType:
                                dataIn: 
                                  sourceDocList: =..formData.selectedDocList
                                  targetBit: 4
                                  targetValue: 0
                                  sCondition: type & 0xFF00 = 0xE00
                                  eid: =.Global.fac_rootNotebook

                        - actionType: evalObject
                          object:      
                            - .Global.jwt.edge.bvid@: =.Global.currentFacility.id
                            - =.Global.jwt.edgeAPI.store: ""                  
                            - =..apiRequest.trashList.docAPI.get: ""
                            - if:
                              - =..apiRequest.trashList.docQueryResp.doc.0
                              - =.builtIn.object.setObjectKey:
                                  dataIn:
                                    objectArr: =..apiRequest.trashList.docQueryResp.doc
                                    key: isSelected
                                    value: false  
                                  dataOut: Trash.formData.trashList
                              - =.builtIn.checkField:
                                  dataIn:
                                    contentType: messageHidden
                                    wait: 100                                
                        # empty selected status --start
                        - actionType: evalObject
                          object:
                            - ..formData.isAllSelected@: false                          
                            - ..formData.selectedDocList@: []
                        # end                               
                        - actionType: builtIn
                          funcName: hide
                          viewTag: newMessageView
                        - actionType: builtIn
                          funcName: show
                          viewTag: noEmailView
                        - actionType: builtIn
                          funcName: redraw
                          viewTag: allSelectedView                                                            
                        - actionType: builtIn
                          funcName: redraw
                          viewTag: trashView
                        - actionType: popUpDismiss
                          popUpView: uploadingTag                          
                        - actionType: popUp
                          popUpView: recoverSuccessView                             
        # 看附件的文件
        - .AttachmentView:
        # 正在加载
        - .LoadingPopUpView: ""
        # 没有选中的轻提示
        - .LittlePopUpView: ""                                   