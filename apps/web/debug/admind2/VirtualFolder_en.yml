VirtualFolder:
  title: "VirtualFolder"
  init:
    - .SignInCheck
    - actionType: evalObject
      object:
        .Global._nonce@:
          =.builtIn.math.random: ""
    - =..apiRequest.folder.docAPI.get: ""
  formData:
    editTitle: "" # 编辑的文件夹的dataKey
  formDataTemp:  
    folder: 
      type: .DocType.MailFolder
      eid: .Global.fac_rootNotebook
      name:
        data: ""
        title: ""           
  apiRequest:
    folder:
      docDeleteReq:
        id: ""
      docCreateReq:
        type: .DocType.MailFolder
        eid: .Global.fac_rootNotebook
        name:
          data: ""
          title: ""
      docGetReq:
        type: .DocType.MailFolder
        id: .Global.fac_rootNotebook
        sCondition: type & 0xFF08 = 0xD00
        xfname: eid
        obfname: ctime
        _nonce: =.Global._nonce
      docByIdResp: ""
      docAPI:
        store:
          api: cd
          dataIn: VirtualFolder.apiRequest.folder.docCreateReq 
        get: 
          api: rd
          dataIn: VirtualFolder.apiRequest.folder.docGetReq
          dataOut: VirtualFolder.apiRequest.folder.docGetResp
        delete: 
          api: dx
          dataIn: VirtualFolder.apiRequest.folder.docDeleteReq
  style:

  components:   
    - type: view
      style:
        width: '1'
        height: '1'
        margin: auto
      children:
        - .SideMenuBar:
          children:
            - .aitLogo:
            - .MenuBar:
        - .TopBar:
        - .BodyView:
          style: 
            height: "0.93"
          children:
            # Add New
            - type: view
              onClick:
                - actionType: popUp
                  popUpView: addFolderView            
              style:
                marginTop: "0.022"
                width: "0.05"
                height: "0.038"
                left: "0.008"
                backgroundColor: "0x005795"
                borderRadius: "3px"
              children:
                - type: image
                  path: addWhite.svg
                  style:
                    left: "0.003"
                    top: "0.0125"
                    width: "0.009"
                    height: "0.012"
                - type: label
                  text: "Add New"
                  style:
                    top: "0.0095"
                    left: "0.013"
                    color: "0xffffff"
                    fontSize: .Nfont.nf0
                    textAlign:
                      y: center
            - type: scrollView
              viewTag: mainView
              style: 
                marginTop: "0.02"
                left: "0.008"
                width: "0.824"
                height: "0.83"
                backgroundColor: "0xffffff"
                overflow: scroll
                borderRadius: "5px"
              children:              
                # folderTitle
                - type: view
                  style:
                    left: "0.062"
                    width: "0.7"
                    height: "0.08"
                    marginTop: "0"
                    textAlign:
                      y: center
                    borderBottom: "1px solid #afc6d6"
                  children:
                    - type: label
                      text: "Folder Name"
                      style:
                        width: "0.6"
                        display: inline-block
                        color: "0x000000"
                        letterSpacing: "1px"
                        fontFamily: Poppins
                        textAlign:
                          y: center
                    # - type: label
                    #   text: "Number Of Message"
                    #   style:
                    #     width: "0.3"
                    #     display: inline-block
                    #     color: "0x000000"
                    #     letterSpacing: "1px"
                    #     fontFamily: Poppins
                    #     textAlign:
                    #       y: center
                    - type: label
                      text: "Edit"
                      style:
                        width: "0.05"
                        display: inline-block
                        color: "0x000000"
                        letterSpacing: "1px"
                        fontFamily: Poppins
                        textAlign:
                          y: center
                          x: center
                    - type: label
                      text: "Delete"
                      style:
                        width: "0.05"
                        display: inline-block
                        color: "0x000000"
                        letterSpacing: "1px"
                        fontFamily: Poppins
                        textAlign:
                          y: center
                          x: center                                                    
                # folderList
                - type: view
                  viewTag: folderListView
                  style:
                    left: "0.062"
                    width: "0.7"
                    height: "auto"
                    marginTop: "0"
                    # backgroundColor: "0xff000033"
                  children:
                    - type: list
                      contentType: listObject
                      listObject: ..apiRequest.folder.docGetResp.doc
                      iteratorVar: itemObject
                      style:
                        width: "0.7"
                        margin: "0"
                        left: "0"
                        height: auto
                      children:
                        - type: listItem
                          itemObject: 
                          style:
                            width: "0.7"
                            height: "0.1"
                            left: "0"
                            marginTop: "0"
                          children:
                            - type: view
                              style:
                                left: "0"
                                width: "0.7"
                                height: "0.1"
                                marginTop: "0"
                                borderBottom: "1px solid #afc6d6"
                                textAlign:
                                  y: center
                              children:
                                - type: view
                                  style:
                                    display: inline-block
                                    width: "0.6"
                                    height: "3vh"
                                    marginTop: "0"
                                    lineHeight: "3vh"
                                  onClick:
                                    - goto: FolderPage
                                  children:
                                    - type: image
                                      path: folderYellow.svg
                                      style:
                                        display: inline-block
                                        # width: "0.015"
                                        height: "0.025"
                                        verticalAlign: middle                              
                                    - type: label
                                      dataKey: itemObject.name.title
                                      style:
                                        display: inline-block
                                        marginLeft: "0.02"
                                        width: "0.262"
                                        color: "0x000000"
                                        fontFamily: Poppins
                                        fontSize: .Nfont.nf0
                                        verticalAlign: middle
                                      onClick:
                                        - emit:
                                            dataKey:
                                              var: itemObject
                                            actions:
                                              - .Global.formData.folder@: $var
                                # - type: view
                                #   style:
                                #     display: inline-block
                                #     lineHeight: "3vh"
                                #     width: "0.3"
                                #     height: "3vh"
                                #     marginTop: "0"
                                #   children:                                          
                                #     - type: label
                                #       text: "250"
                                #       dataKey: itemObject.messagesNumber
                                #       style:
                                #         display: inline-block
                                #         color: "0x0b4a7e"
                                #         width: "0.1"
                                #         fontSize: .Nfont.nf0
                                #         fontFamily: Poppins
                                #         textAlign:
                                #           x: center
                                - type: view
                                  style:
                                    display: inline-block
                                    width: "0.05"
                                    height: "3vh"
                                    lineHeight: "3vh"
                                    marginTop: "0"
                                    textAlign:
                                      x: center
                                  children:
                                    - type: image
                                      path: editPenBlue.svg
                                      onClick: 
                                        - emit: 
                                            dataKey: 
                                              var: itemObject
                                            actions: 
                                              - ..formData.editTitle@: $var.name.title
                                              - ..apiRequest.folder.docCreateReq@: $var
                                        - actionType: builtIn
                                          funcName: redraw
                                          viewTag: editFolderView
                                        - actionType: popUp
                                          popUpView: editFolderView
                                      style:
                                        width: "0.01"
                                        height: "0.015"
                                - type: view
                                  style:
                                    display: inline-block
                                    width: "0.05"
                                    height: "3vh"
                                    lineHeight: "3vh"
                                    marginTop: "0"
                                    textAlign:
                                      x: center
                                  children:                                                                      
                                    - type: image
                                      path: redTrash.svg
                                      onClick: 
                                        - emit: 
                                            dataKey: 
                                              var: itemObject
                                            actions: 
                                              - ..apiRequest.folder.docDeleteReq.id@: $var.id                              
                                        - actionType: popUp
                                          popUpView: deleteFolderView                                                 
                                      style:
                                        width: "0.01"
                                        height: "0.017"
  
        # 新增文件夹                                                                                
        - type: popUp
          viewTag: addFolderView
          style:
            width: "1"
            height: "1"
            top: "0"
            left: "0"
            backgroundColor: "0x00000033"
            zIndex: "10"
          children:
            - type: view
              style:
                width: "0.4"
                height: "0.34"
                backgroundColor: "0xffffff"
                zIndex: "10"
                left: "0.38"
                top: "0.27"
              children:
                - type: image
                  path: close.svg
                  onClick: 
                    - actionType: popUpDismiss
                      popUpView: addFolderView
                  style:
                    left: "0.38"
                    width: "0.01"
                    marginTop: "0.015"
                - type: label
                  text: Add Folder
                  dataKey: 
                  style:
                    left: "0.05"
                    width: "0.15"
                    marginTop: "0.01"
                    fontSize: .Nfont.nf6
                    fontFamily: Poppins
                - type: view
                  style:
                    left: "0.05"
                    width: "0.3"
                    marginTop: "0.06"
                    height: "0.04"
                    display: flex
                    flexDirection: column
                    flexWrap: wrap
                    justifyContent: space-evenly
                    alignItems: center
                    alignContent: space-between                   
                  children: 
                    - type: label
                      text: "Folder Name:"
                      dataKey: 
                      style:
                        fontSize: .Nfont.nf4
                        fontFamily: Poppins
                    - type: textField
                      placeholder: Enter name here
                      dataKey: apiRequest.folder.docCreateReq.name.title
                      style:
                        width: "0.2"
                        height: "0.035"
                        backgroundColor: "0xe3e3e3"
                        textIndent: 2em
                        fontSize: .Nfont.nf4
                        border: 
                          style: "1"
                        borderWidth: "1"
                        borderColor: "0xe3e3e3"
                        borderRadius: "5"
                        boxSizing: border-box
                - type: view
                  style:
                    left: "0.05"
                    width: "0.3"
                    marginTop: "0.06"
                    height: "0.04"
                    display: flex
                    flexDirection: column
                    flexWrap: wrap
                    justifyContent: space-evenly
                    alignItems: center
                    alignContent: space-around     
                  children: 
                    - type: button
                      text: "No"
                      style:
                        width: "0.065"
                        height: "0.045"
                        backgroundColor: "0xbebebe"
                        textAlign:
                          x: center
                          y: center
                        color: "0xffffff"
                        border:
                          style: "1"
                        borderRadius: "5"
                        fontSize: .Nfont.nf2
                      onClick:
                        - actionType: evalObject
                          object:
                            - ..apiRequest.folder.docCreateReq.name.title@: ""
                        - actionType: builtIn
                          funcName: redraw
                          viewTag: addFolderView                      
                        - actionType: popUpDismiss
                          popUpView: addFolderView
                    - type: button
                      text: "Yes"
                      onClick:
                        - actionType: evalObject
                          object:
                            .Global._nonce@:
                              =.builtIn.math.random: ""
                        - actionType: evalObject
                          object:
                            - if:
                              - =.builtIn.array.checkElememtExist:
                                  dataIn:
                                    objArr: =..apiRequest.folder.docGetResp.doc
                                    values: =..apiRequest.folder.docCreateReq.name.title
                              - actionType: evalObject
                                object:
                                  - ..apiRequest.folder.docCreateReq.name.title@: ""
                                  - actionType: popUp
                                    popUpView: repeatView
                              - actionType: evalObject
                                object:
                                  - =..apiRequest.folder.docAPI.store: ""
                                  - ..apiRequest.folder.docCreateReq.name.title@: ""
                                  - =..apiRequest.folder.docAPI.get: ""
                        - actionType: builtIn
                          funcName: redraw
                          viewTag: mainView
                        - actionType: popUpDismiss
                          popUpView: addFolderView                      
                      style:
                        width: "0.065"
                        height: "0.045"
                        backgroundColor: "0x005795" 
                        textAlign:
                          x: center
                          y: center
                        color: "0xffffff"
                        border:
                          style: "1"
                        borderRadius: "5"
                        fontSize: .Nfont.nf2 
        # 编辑文件夹                        
        - type: popUp
          viewTag: editFolderView
          style:
            width: "1"
            height: "1"
            top: "0"
            left: "0"
            backgroundColor: "0x00000033"
            zIndex: "10"
          children:
            - type: view
              style:
                width: "0.4"
                height: "0.34"
                backgroundColor: "0xffffff"
                zIndex: "10"
                left: "0.38"
                top: "0.27"
              children:
                - type: image
                  path: close.svg
                  onClick: 
                    - actionType: popUpDismiss
                      popUpView: editFolderView
                  style:
                    left: "0.38"
                    width: "0.01"
                    marginTop: "0.015"
                - type: label
                  text: Edit Folder
                  dataKey: 
                  style:
                    left: "0.05"
                    width: "0.15"
                    marginTop: "0.01"
                    fontSize: .Nfont.nf6
                    fontFamily: Poppins
                - type: view
                  style:
                    left: "0.05"
                    width: "0.3"
                    marginTop: "0.06"
                    height: "0.04"
                    display: flex
                    flexDirection: column
                    flexWrap: wrap
                    justifyContent: space-evenly
                    alignItems: center
                    alignContent: space-between                   
                  children: 
                    - type: label
                      text: "Folder Name:"
                      dataKey: 
                      style:
                        fontSize: .Nfont.nf4
                        fontFamily: Poppins
                    - type: textField
                      placeholder: Enter name here
                      dataKey: formData.editTitle
                      style:
                        width: "0.2"
                        height: "0.035"
                        backgroundColor: "0xe3e3e3"
                        textIndent: 2em
                        fontSize: .Nfont.nf4
                        border: 
                          style: "1"
                        borderWidth: "1"
                        borderColor: "0xe3e3e3"
                        borderRadius: "5"
                        boxSizing: border-box
                - type: view
                  style:
                    left: "0.05"
                    width: "0.3"
                    marginTop: "0.06"
                    height: "0.04"
                    display: flex
                    flexDirection: column
                    flexWrap: wrap
                    justifyContent: space-evenly
                    alignItems: center
                    alignContent: space-around     
                  children: 
                    - type: button
                      text: "Cancel"
                      style:
                        width: "0.065"
                        height: "0.045"
                        backgroundColor: "0xbebebe"
                        textAlign:
                          x: center
                          y: center
                        color: "0xffffff"
                        border:
                          style: "1"
                        borderRadius: "5"
                        fontSize: .Nfont.nf2
                      onClick:
                        - actionType: evalObject
                          object:
                            - ..formData.editTitle@: ""
                        - actionType: builtIn
                          funcName: redraw
                          viewTag: editFolderView    
                        - actionType: popUpDismiss
                          popUpView: editFolderView
                    - type: button
                      text: "Confirm"
                      onClick:
                        - actionType: evalObject
                          object:
                            .Global._nonce@:
                              =.builtIn.math.random: ""
                        - actionType: evalObject
                          object:
                            - ..apiRequest.folder.docCreateReq.name.title@: =..formData.editTitle
                            - =..apiRequest.folder.docAPI.store: ""
                            - ..formData.editTitle@: ""
                            - ..apiRequest.folder.docCreateReq.name.title@: ""
                            - =..apiRequest.folder.docAPI.get: ""
                        - actionType: builtIn
                          funcName: redraw
                          viewTag: mainView  
                        - actionType: builtIn
                          funcName: redraw
                          viewTag: editFolderView                                        
                        - actionType: popUpDismiss
                          popUpView: editFolderView                      
                      style:
                        width: "0.065"
                        height: "0.045"
                        backgroundColor: "0x005795" 
                        textAlign:
                          x: center
                          y: center
                        color: "0xffffff"
                        border:
                          style: "1"
                        borderRadius: "5"
                        fontSize: .Nfont.nf2  
        - type: popUp
          viewTag: deleteFolderView
          style:
            width: "1"
            height: "1"
            top: "0"
            left: "0"
            backgroundColor: "0x00000033"
            zIndex: "10"
          children:    
            - type: view
              style:
                width: "0.23"
                height: "0.275"
                backgroundColor: "0xffffff"
                box-shadow: "0 0 9px 3px #cccccc"
                left: "0.45"
                top: "0.31"
                zIndex: "10"
              children:
                - type: view
                  style:
                    width: "0.23"
                    height: "0.05"
                    backgroundColor: "0xBF0000" 
                  children:
                    - type: label
                      text: Delete Availability
                      dataKey: 
                      style:
                        width: "0.23"
                        height: "0.05"
                        color: "0xffffff"
                        fontSize: .Nfont.nf2
                        display: flex
                        justifyContent: center
                        alignItems: center
                - type: image
                  path: deleteAvailability.svg
                  style:
                    marginTop: "0.03"
                    left: "0.1"
                - type: view
                  style:
                    width: "0.23"
                    height: "0.07"
                    border:
                      style: "2"
                    borderWidth: "1"
                    borderColor: "0xeeeeee"
                    marginTop: "0.03"
                    textAlign:
                      x: center
                    display: flex
                    justifyContent: center
                  children:
                    - type: label
                      text: "All message will be removed from this folder"
                      style:
                        width: "0.16"
                        fontSize: .Nfont.nf5
                        textAlign:
                          x: center
                - type: view
                  style:
                    width: "0.23"
                    height: "0.046"
                  children:
                    - type: button
                      text: "Cancel"
                      style:
                        color: "0x2988e6"
                        fontSize: .Nfont.nf4
                        width: "0.12"
                        height: "0.046"
                        border: "none"
                        borderRight: "solid 1px #eeeeee"
                        backgroundColor: "0xffffff"
                        top: "0"
                        textAlign:
                          x: center
                          y: center
                      onClick:
                        - actionType: popUpDismiss
                          popUpView: deleteFolderView
                    - type: button
                      text: "Delete"
                      style:
                        color: "0x2988e6"
                        fontSize: .Nfont.nf4
                        border:
                          style: "1"
                        width: "0.11"
                        height: "0.046"
                        top: "0"
                        left: "0.12"
                        backgroundColor: "0xffffff"
                        textAlign:
                          x: center
                          y: center
                      onClick:
                        - actionType: evalObject
                          object:
                            .Global._nonce@:
                              =.builtIn.math.random: ""                        
                        - actionType: evalObject
                          object:
                            - =..apiRequest.folder.docAPI.delete: ""
                            - =..apiRequest.folder.docAPI.get: ""
                        - actionType: builtIn
                          funcName: redraw
                          viewTag: mainView                                  
                        - actionType: popUpDismiss
                          popUpView: deleteFolderView                                                                            
        # 文件夹名重复
        - .SuccessDeletedPopUpView: ""
          viewTag: repeatView
          img: alertRed.svg
          msg: "The folder name is existed or empty"   
        - .SuccessDeletedPopUpView: ""
          viewTag: deleteSuccessTag
          msg: "Deleted Successfully！" 


