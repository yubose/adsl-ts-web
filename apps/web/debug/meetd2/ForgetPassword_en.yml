ForgetPassword:
  title: 'Forget Password'
  init:
    - actionType: evalObject
      object:
        .Global._nonce@:
          =.builtIn.math.random: ""
    - ..userData.get  
  userData:
    userVertex:
      vertex:
        isSelected: false
    get:
      .VertexAPI.get : ""
      api: rv
      dataKey: userData.userVertex
      ids: 
        - .ForgetPasswordIn.loginNewDevice.response.edge.deat.user_id
      ObjType: 4
      type: 1
      sCondition: "E.type=10002 AND E.tage=0 AND E.subtype=8 AND length(V.uid) >0 AND V.pk is not null"
      xfname : "(E.bvid)&!(V.id)"
      obfname : "mtime" 
      maxcount : "20"
      _nonce: =.Global._nonce
  emailList: 
    email: 
      edge: 
    request:
        id: 
          - =.Global.helperUser.vertex.id
          - .ForgetPasswordIn.loginNewDevice.response.edge.deat.user_id
        xfname: "evid,bvid"
        type: .EdgeType.Email
        _nonce: =.Global._nonce
        sCondition: "subtype=8"
    get: 
      api: re
      dataIn: emailList.request
      dataOut: emailList.email           
  generalInfo:
    value: true 
  components:
    - .BaseCheckView: ""
      message: "Please choose one helper"
      viewTag: emptyList  
    - .BaseHeader:
    - .HeaderLeftButton:
      onClick:
        - goto: ForgetPasswordIn
    - type: scrollView
      style:
        left: '0'
        width: '1'
        height: '0.9'
        top: '0.1'
        overflow: 'scroll'
      children:
        - type: image
          path: progressPercent33.png
          style:
            left: '0'
            marginTop: ''
            width: '1'
        - type: label
          text: 'Select one person from your password backup list, weâ€™ll send a password recover mail through the inbox.'
          style:
            marginTop: ''
            left: '0.08'
            width: '0.84'
            textAlign:
              y: 'center'
            height: '0.05'
            fontSize: '12'
        - type: view
          style:
            backgroundColor: '0xf0f0f0'
            marginTop: '0.02'
            width: '1'
            height: '0.04'
            left: '0'
            textAlign:
              y: 'center'
          children:
            - type: label
              text: 'PR helper list'
              style:
                fontSize: '16'
                fontWeight: '500'
                marginTop: '0'
                left: '0.08'
                width: '0.92'
        - type: list
          contentType: listObject
          listObject: ..userData.userVertex.vertex
          iteratorVar: itemObject
          viewTag: pathList
          style:
            width: '1'
            margin: '0'
            left: '0'
          children:
            - type: listItem
              itemObject: 
              style:
                border: 
                  style: "2"
                borderWidth: "1"
                borderColor: "0xf0f0f0"
                width: '1'
                height: '0.09'
                left: '0'
                marginTop: ''
              children:
                - type: image
                  path: accompany.png
                  style:
                    left: '0.05'
                    width: '0.1'
                    top: '0.022'
                - type: label
                  dataKey: itemObject.name.firstName
                  style:
                    left: '0.23'
                    width: '0.3'
                    top: '0.02'
                    height: '0.03'
                    textAlign:
                      y: center
                - type: label
                  dataKey: itemObject.name.phoneNumber
                  style:
                    left: '0.22'
                    # width: '0.4'
                    top: '0.05'
                    height: '0.03'
                - type: image
                  path: 
                    emit:
                      dataKey:
                        var: itemObject
                      actions: 
                      - if:
                        - =.builtIn.string.equal: 
                            dataIn:
                              string1: =..generalInfo.value
                              string2: $var.isSelected
                        - selected.png
                        - select.png
                  onClick: 
                    - actionType: updateObject
                      dataKey: Global.helperUser.vertex
                      dataObject: itemObject
                    - emit: 
                        dataKey: 
                          var: itemObject
                        actions: 
                          - if: 
                            - =.builtIn.string.equal: 
                                dataIn:
                                  string1: =..generalInfo.value
                                  string2: $var.isSelected
                            - =.builtIn.object.set: 
                                dataIn: 
                                  object: $var
                                  key: isSelected
                                  value: true
                            - =.builtIn.object.clearAndSetKey: 
                                dataIn: 
                                  object: =..userData.userVertex.vertex
                                  item: $var
                                  key: isSelected
                                  value: true        
                    - actionType: builtIn
                      funcName: redraw
                      viewTag: pathList
                  style:
                    left: '0.85'
                    top: '0.022'
                    height: '0.05'
                    width: '0.05'
        - type: view
          style:
            border: 
              style: "1"
            borderWidth: ""
            borderColor: "0x707070"
            borderRadius: "5"
            top: '0.75'
            left: '0.1'
            backgroundColor: "0x388eccff"
            width: '0.8'
            height: '0.05'
            textAlign:
              x: 'center'
              y: 'center'
          children:
            - type: label
              text: 'Next'
              onClick: 
                - actionType: evalObject
                  object:
                    - if:
                        - =.Global.helperUser.vertex.id
                        - continue
                        - actionType: popUp
                          popUpView: emptyList
                          wait: true
                - actionType: evalObject        #modify
                  object:                             
                    - .Global._nonce@: 
                        =.builtIn.math.random: ""                        
                    - =..emailList.get: ""
                - actionType: evalObject
                  object:                      
                    - if:
                      - ..emailList.email.edge.0
                      - .Global.email.id@: =..emailList.email.edge.0.id
                      - actionType: popUp
                        popUpView: emptyList
                        wait: true                                                 
                - goto: ForgetPasswordContact                       
              style:
                fontFamily: PMingLiU
                color: '0xffffff'

