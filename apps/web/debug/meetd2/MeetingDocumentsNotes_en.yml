MeetingDocumentsNotes:
  pageNumber: "180"  # xd page 13
  title: "Meeting Notes"
  init: 
    - .SignInCheck
    # - .MeetingDocumentsNotes.newNote.docAPI.get
    #     # if the .docResponse.doc is out of refernce1), target object could end up in following trhee form
    #     # 1) null, 2) keep the string literally, 3) leave target intact
    # - if:
    #    -  =..docResponse.doc.0
    #    -  .MeetingDocumentsNotes.newNote.document@: =..docResponse.doc.0
    #    # -  .MeetingDocumentsNotes.newNote.document@: .EmptyObj
    #    # -  .MeetingDocumentsNotes.newNote.document@: ..docResponse.doc.0
    #    - continue
    - .MeetingDocumentsNotes.newNote.document.name.targetRoomName@: =.Global.rootRoomInfo.edge.name.title   
  save: 
    - =.MeetingDocumentsNotes.newNote.docAPI.store: ""
    - if:
      -  =.MeetingDocumentsNotes.newNote.document.id
      - .Global.DocChat.document@: =.MeetingDocumentsNotes.newNote.document   
      - .Global.DocChat.document@: =.MeetingDocumentsNotes.newNote.document.doc
  update:
    - =.MeetingDocumentsNotes.newChat.docAPI.store: "" 
  newNote:
    document:
      .Document: ""
      eid: .Global.VideoChatObjStore.reference.edge.refid
      type: .DocType.UploadFile # "6" # meeting notes for all participants
      name: 
        title: ""
        type: ..newNote.document.subtype.mediaType
        data: ""
        user: .Global.currentUser.vertex.name.fullName
        targetRoomName: .Global.rootRoomInfo.edge.name.title 
      subtype:
        mediaType: "application/json" # mediaType : "image/jpeg"
    docAPI:
      .DocAPI: ""    
      store:
        api: cd 
        dataKey: newNote.document
      get:
        .DocAPI.get: "" 
        api: rd
        ids:
          - .Global.VideoChatObjStore.reference.edge.refid
        xfname: eid
        type: .DocType.UploadFile  # "6"
        scondition: "name like '%application/json%'"
        maxcount: "1"
        obfname: "mtime"
        dataKey: docResponse
        _nonce: =.Global._nonce
  newChat:
    document:
      .Document: ""
      eid: .Global.VideoChatObjStore.reference.edge.refid
      fid: ""
      type: .DocType.MeetingNote # "6" # meeting notes for all participants
      name: 
        title: ""
        type: ..newChat.document.subtype.mediaType
        data: ""
        user: .Global.currentUser.vertex.name.userName
      subtype:
        mediaType: "text/plain" # mediaType : "image/jpeg"          
    docAPI:
      .DocAPI: ""    
      store:
        api: cd 
        dataKey: newChat.document         
  docResponse: 
    doc:
      - type: .DocType.UploadFile # "6" # private profile
        eid: .Global.VideoChatObjStore.reference.edge.refid
        name: ""
    error: ""
    jwt: "" 
  components:
    - .BaseCheckView: ""
      message: "Please input note title"
      viewTag: noTitle     
    - .BaseHeader3:
    - type: label
      contentType: timer
      viewTag: "videoTimer"
      text=func: =.builtIn.string.formatTimer
      dataKey: Global.timer # to be remove after implemented builtIn   
      style:
        left: "0.8"
        top: "0"
        width: "0.1"
        height: "0.1"
        zIndex: 100
        #marginTop: "0.05"
        color: "0xffffff"
        fontSize: "17"
        textAlign:
          x: right
          y: center  
    - .HeaderLeftButton:
      onClick:
        - actionType: evalObject
          object: 
            .Global._nonce@: 
              =.builtIn.math.random: ""     
        - actionType: builtIn
          funcName: goBack

    - type: view
      style:
        top: "0.1"
        left: "0"
        width: "1"
        height: "0.9"
      children:
        - type: textField
          placeholder: Title Here
          dataKey: newNote.document.name.title
          style:
            top: "0.01"
            left: "0.15"
            height: "0.04"
            width: "0.7"
            color: "0x000000ff"
            fontWeight: "200"
            fontSize: 13
            borderWidth: "1"
            border:
              style: "2"
            textAlign: 
              x: center
        - type: textView
          isEditable: "true"
          placeholder: Text Here
          dataKey: newNote.document.name.data # users' input will be saved to this key
          style:
            textAlign:
              y: top
              x: left
            fontSize: "14"
            left: "0.1"
            top: "0.095"
            width: "0.8"
            height: "0.7"
            required: "true"
            fontFamily: "sans-serif"
            color: "0x000000ff"
            borderWidth: "1"
            border:
              style: "6"
        - type: button
          text: Save
          style:
            left: "0.15"
            height: "0.05"
            top: "0.84"
            width: "0.7"
            backgroundColor: "0x388ecc"
            color: "0xffffff"
            borderRadius: 2
            textAlign:
              x: center
          onClick:
            - actionType: evalObject
              object:
                - if:
                    - =..newNote.document.name.title
                    - continue
                    - actionType: popUp
                      popUpView: noTitle
                      wait: true            
            - actionType: evalObject
              object:  
                - .MeetingDocumentsNotes.newNote.document.name.user@: =.Global.currentUser.vertex.name.fullName 
                # - .Global.DocReference.document.id@: =.EmptyObj        
            - actionType: evalObject
              object: ..save
            - actionType: evalObject
              object:                
                - .MeetingDocumentsNotes.newChat.document.fid@: =.Global.DocChat.document.id
                - .MeetingDocumentsNotes.newChat.document.name.data@: =.Global.DocChat.document.name.data              
            - actionType: evalObject
              object: ..update              
            - actionType: evalObject
              object: 
                .Global._nonce@: 
                  =.builtIn.math.random: ""                                                                                                   
            - actionType: builtIn
              funcName: goBack
        # - type: popUp # view
        #   viewTag: confirmView
        #   style:
        #     left: "0.1"
        #     top: "0"
        #     width: "0.8"
        #     height: "0.9" 
        #     # backgroundColor: "0x00000066" 
        #   children:
        #     - type: view
        #       style:
        #         left: "0.0"
        #         top: "0.15"
        #         width: "0.8"
        #         height: "0.35"
        #         backgroundColor: "0xeeeeeeff"
        #         border:
        #           style: "5"
        #         borderRadius: "15"
        #       children:
        #         - type: label
        #           text: "Would you like to share your notes in this meeting?"
        #           style:
        #             .LabelStyle:
        #               left: "0.05"
        #               top: "0.1"
        #               width: "0.7"
        #               height: "0.04"
        #               color: "0x00000088"
        #               fontSize: "20"
        #               fontWeight: "500"
        #               display: inline
        #               textAlign:
        #                 x: center
        #                 y: center
        #         # - type: label
        #         #   text: "This note will be automatically saved to 'my documents'"
        #         #   style:
        #         #     .LabelStyle:
        #         #       left: "0.05"
        #         #       top: "0.15"
        #         #       width: "0.7"
        #         #       height: "0.04"
        #         #       color: "0x00000088"
        #         #       fontSize: "16"
        #         #       display: inline
        #         #       textAlign:
        #         #         x: center
        #         #         y: center                        
        #         - type: divider
        #           style:
        #             .DividerStyle:
        #               left: "0"
        #               top: "0.25436"
        #               width: "0.8"
        #               height: "0.001"
        #               backgroundColor: "0x00000088"
        #         - type: button
        #           onClick: 
        #             - actionType: popUpDismiss
        #               popUpView: confirmView
        #           text: Cancel
        #           style:
        #             .LabelStyle:
        #               left: "0"
        #               top: "0.275"
        #               width: "0.4"
        #               height: "0.06812"
        #               color: "0x007affff"
        #               fontSize: "17"
        #               display: inline
        #               textAlign:
        #                 x: center
        #                 y: center 
        #               border:
        #                 style: "5"
        #               borderRadius: "15"

        #         - type: button
        #           onClick:                                 
        #             - actionType: popUpDismiss
        #               popUpView: confirmView
        #             - actionType: evalObject
        #               object: ..save
        #             - actionType: evalObject
        #               object: 
        #                 .Global._nonce@: 
        #                   =.builtIn.math.random: ""                                                                                                   
        #             - goto: VideoChat
        #           text: Share
        #           style:
        #             .LabelStyle:
        #               left: "0.4"
        #               top: "0.275"
        #               width: "0.4"
        #               height: "0.06812"
        #               color: "0x007affff"
        #               fontSize: "17"
        #               display: inline
        #               textAlign:
        #                 x: center
        #                 y: center 
        #               border:
        #                 style: "5"
        #               borderRadius: "15"
        #         - type: divider
        #           style:
        #             .DividerStyle:
        #               left: "0.4"
        #               top: "0.26"
        #               width: "0.001"
        #               height: "0.07"
        #               backgroundColor: "0x00000088"     