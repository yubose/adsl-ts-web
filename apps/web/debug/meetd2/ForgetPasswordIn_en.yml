ForgetPasswordIn:
  pageNumber: "20"
  formData:
    countryCode: "+1"
    phoneNumber: ""
    code: ""
  apiData:
    phoneNumber: ""
  verificationCode:
    response: ""
    edge:
      .Edge: ""
      type: 1010
      name:
        phone_number: =..apiData.phoneNumber
    edgeAPI:
      .EdgeAPI: ""
      store:
        api: ce
        dataIn: ForgetPasswordIn.verificationCode.edge
        dataOut: ForgetPasswordIn.verificationCode.response
  loginNewDevice:
    response: ""
    edge:
      .Edge: ""
      type: 1040
      name:
        phone_number: =..apiData.phoneNumber
        verification_code: =..formData.code
      deat:
        UserId: ""
        Pk: ""
        Esk: ""
    edgeAPI:
      .EdgeAPI: ""
      store:
        api: ce
        dataIn: ForgetPasswordIn.loginNewDevice.edge
        dataOut: ForgetPasswordIn.loginNewDevice.response 
  loginUser:
    response: ""
    edge:
      .Edge: ""
      type: 1030
      bvid: =..loginNewDevice.response.edge.deat.user_id
    edgeAPI:
      .EdgeAPI: ""
      store:
        api: ce
        dataIn: ForgetPasswordIn.loginUser.edge
        dataOut: ForgetPasswordIn.loginUser.response               
  save:
    - =.builtIn.string.concat:
        dataIn:
          - =.ForgetPasswordIn.formData.countryCode
          - " "
          - =.ForgetPasswordIn.formData.phoneNumber
        dataOut: ForgetPasswordIn.apiData.phoneNumber
    - =.ForgetPasswordIn.verificationCode.edgeAPI.store: ""   
  check:
    - =.ForgetPasswordIn.loginNewDevice.edgeAPI.store: ""
    - if:
        - =.builtIn.string.equal:  # check vCode correct
            dataIn:
              string1: =..loginNewDevice.response.code
              string2: 112
        - actionType: popUp
          popUpView: wrongCode
          wait: true
        - continue
    - if:        
        - =.builtIn.string.equal:  # check vCode correct
            dataIn:
              string1: =..loginNewDevice.response.code
              string2: 4004
        - actionType: popUp
          popUpView: wrongCode
          wait: true
        - continue                   
  components:
    - .BaseCheckView: ""
      message: "Please input verification code"
      viewTag: emptyCode
    - .BaseCheckView: ""
      message: "Incorrect verificationCode"
      viewTag: wrongCode
    - .BaseCheckView: ""
      message: "Invalid Username/Phonenumber: Required length should be 6 to 16"
      viewTag: invaliduserid  
    - type: view
      style:
        left: "0"
        top: "0"
        width: "1"
        height: "1"
        position: "fixed"
      children:
        - type: image
          path: backpic.png
          style:
            left: "0"
            width: "1"
            top: "0"
        - type: image
          path: mLogo.png
          style:
            top: "0.08"
            width: "0.38"
            left: "0.31"
        - type: view
          style:
            top: "0.35"
            height: "0.9"
            width: "1"
            left: "0"
            backgroundColor: "0xffffff"
            border:
              style: 3
            borderRadius: "50"
            boxSizing: "border-box"
          children:
            - type: label
              text: Back
              onClick:
                - goto: SignIn
              style:
                color: "0x388eccff"
                left: "0.12"
                marginTop: "0.06"
                # top: "0.1"
                width: "0.1"
                height: auto
                fontSize: "20"
                textAlign:
                  x: left
                  y: center          
            - type: label
              text: Forget Password?
              style:
                color: "0x00000088"
                left: "0.35"
                # marginTop: "0.1"
                #top: "0.1"
                width: "0.4"
                height: auto
                fontSize: "22"
                textAlign:
                  x: left
                  y: center
            # user name input area
            - type: view
              viewTag: useUserName
              style:
                left: "0.12"
                marginTop: "0.05"
                width: "0.8"
                height: "0.09"
                display: none
              children:
                - type: label
                  text: "UserName"
                  style:
                    color: "0x00000058"
                    width: "0.12"
                    height: "0.041"
                    top: "0"
                    fontSize: "12"
                    textAlign:
                      x: left
                      y: center
                - type: textField
                  dataKey: apiData.phoneNumber
                  style:
                    textAlign:
                      x: left
                    fontSize: "14"
                    left: "0"
                    top: "0.045"
                    width: "0.55"
                    height: "0.041"
                    required: "true"
                    borderWidth: "1"
                    box-sizing: "border-box"
                    border:
                      style: "2"
            # This phone number input area
            - type: view
              viewTag: usePhoneNumber
              style:
                left: "0.12"
                marginTop: "0.05"
                width: "0.8"
                height: "0.09"
                isHidden: false
              children:
                - type: view
                  style:
                    width: "0.8"
                    top: "0"
                    height: "0.09"
                  children:
                    - type: label
                      text: Country
                      style:
                        width: "0.12"
                        height: "0.041"
                        top: "0"
                        fontSize: "12"
                        fontweight: 600
                        textAlign:
                          x: left
                          y: center
                    - type: select
                      #contentType: countryCode
                      contentType: countryCode
                      placeholder: ..formData.countryCode
                      dataKey: formData.countryCode # formData.countryCode : inputValue
                      options:
                        # - "+1"
                        # - "+52"
                        # - "+86"
                        # - "+965"
                        .CountryCode
                      required: "true"
                      #required: "true"
                      style:
                        width: "0.12"
                        height: "0.041"
                        top: "0.045"
                        fontSize: "14"
                        borderWidth: "1"
                        box-sizing: "border-box"
                        border:
                          style: "2"
                          #color: "0x00000058"
                - type: view
                  style:
                    left: "0.14"
                    top: "0"
                    width: "0.4"
                    height: "0.09"
                  children:
                    - type: label
                      text: Phone number
                      style:
                        left: "0"
                        top: "0"
                        width: "0.45"
                        height: "0.04"
                        fontSize: "12"
                        fontWeight: 600
                        textAlign:
                          x: left
                          y: center
                    - type: textField # take users' input
                      viewTag: phoneNumberVT
                      contentType: phoneNumber
                      placeholder: "your phone number"
                      dataKey: formData.phoneNumber  # users' input will be saved to this key
                      required: "true"
                      # when un-focus from the textField, dataKey object should be updated by the input data and use contentType to check the validation of the input.
                      onChange:
                        - emit:
                            actions:
                              - =.builtIn.typeCheck.phoneNumber:
                                  dataIn:
                                    phoneNumber: =..formData.phoneNumber
                                    countryCode: =..formData.countryCode
                                  dataOut: SignIn.formData.checkOk
                              - if:
                                  - =..formData.checkOk
                                  - continue
                                  - ..formData.checkMessage@: "Unacceptible phone number format example: 888-999-0000"
                              - =.builtIn.string.concat:
                                  dataIn:
                                    - =.SignIn.formData.countryCode
                                    - " "
                                    - =.SignIn.formData.phoneNumber
                                  dataOut: SignIn.apiData.phoneNumber
                              - =.builtIn.string.concat:
                                  dataIn:
                                    - "uid like '%"
                                    - =.SignIn.formData.countryCode
                                    - " "
                                    - =.SignIn.formData.phoneNumber
                                    - "'"
                                  dataOut: SignIn.rvCondition
                      style:
                        textAlign:
                          x: left
                        fontSize: "14"
                        left: "0"
                        top: "0.045"
                        width: "0.64"
                        height: "0.041"
                        required: "true"
                        borderWidth: "1"
                        box-sizing: "border-box"
                        border:
                          style: "2"
            - type: view
              style:
                marginTop: "0.03"
                left: "0.12"
                width: "0.8"
              children:
                - type: label
                  text: "Verification code"
                  style:
                    width: "0.5"
                    height: "0.041"
                    marginTop: "0"
                    fontSize: "12"
                    fontWeight: 600
                    textAlign:
                      x: left
                      y: center
                - type: textField
                  placeholder: "Enter here"
                  dataKey: formData.code
                  required: "true"
                  style:
                    textAlign:
                      x: left
                    fontSize: "14"
                    marginTop: "0.02"
                    left: "0"
                    width: "0.55"
                    height: "0.041"
                    backgroundColor: "0x388ecc00"
                    display: inline
                    borderWidth: "1"
                    border:
                      style: "2"
                - type: button
                  text: Get Code
                  onClick:
                    # - actionType: builtIn # reserved Value
                    #   funcName: signUp
                    # To get the verificationCode
                    - actionType: evalObject
                      object: 
                        - if:
                          - =..formData.phoneNumber
                          - continue
                          - actionType: popUp
                            popUpView: NoPhoneNum
                            wait: true
                    - actionType: evalObject
                      object: 
                        - =.builtIn.typeCheck.phoneNumber:
                            dataIn:
                              phoneNumber: =..formData.phoneNumber
                              countryCode: =..formData.countryCode
                            dataOut: ForgetPasswordIn.formData.checkOk
                        - if:
                          - ..formData.checkOk
                          - continue
                          - actionType: popUp
                            popUpView: WrongPhoneNum
                            wait: true
                    - actionType: evalObject
                      object: ..save
                    - actionType: evalObject
                      object:
                        .Global._nonce@:
                          =.builtIn.math.random: ""                  
                  style:
                    color: "0xffffffff"
                    fontSize: "16"
                    fontStyle: bold
                    left: "0.58"
                    top: "0.056"
                    #top: "0.46"
                    width: "0.2"
                    height: "0.05"
                    backgroundColor: "0x388eccff"
                    border:
                      style: "1"
                    display: inline
                    textAlign:
                      x: center
                      y: center
            - type: button
              text: Next
              onClick: 
                - actionType: evalObject
                  object: ..check
                - actionType: evalObject
                  object:
                    - if:
                        - =..formData.code  # 1040 response  Code:3010-Error:No Verification Code in name of edge
                        - continue
                        - actionType: popUp
                          popUpView: emptyCode
                          wait: true
                    - =.ForgetPasswordIn.loginUser.edgeAPI.store: ""                                        
                - goto: ForgetPassword
              style:
                color: "0xffffffff"
                fontSize: "16"
                fontStyle: bold
                left: "0.134"
                marginTop: "0.07"
                #top: "0.46"
                width: "0.747"
                height: "0.06"
                backgroundColor: "0x388eccff"
                border:
                  style: "1"
                display: inline
                textAlign:
                  x: center
                  y: center
        - .BaseTips:
          message: "Phone number required"
          viewTag: NoPhoneNum 
          style:
            top: "0.448"
          onChange:
            - emit:
                actions:
                  - =.builtIn.number.addition:
                    dataIn:
                      num: =.Global.zindex
                      step: 1
                    dataOut: Global.zindex  
        - .BaseTips:
          message: "lnvalid phone number format"
          message2: "Use numbers only, 10 digits required"
          viewTag: WrongPhoneNum
          style:
            top: "0.448"
          onChange:
            - emit:
                actions:
                  - =.builtIn.number.addition:
                    dataIn:
                      num: =.Global.zindex
                      step: 1
                    dataOut: Global.zindex                    