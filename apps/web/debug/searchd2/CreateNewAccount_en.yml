CreateNewAccount: # This is page name
  module: patient
  title: Create New Account
  pageNumber: "45"
  init:
    - if:
        - ..formData.vertex.name.phoneNumber
        - continue
        - goto: CareSignUp
  formData:
    fullName: ""
    rvCondition: ""
    response: ""
    vertex : # inherit from BaseDataModel_en.yml
      .Vertex: ""
      type : .Global.newAccountFlag
      name:
        countryCode: .Global.patientSign.countryCode
        phoneNumber: .Global.patientSign.phoneNumber
        userName: ""
        firstName: ""
        lastName: ""
        password: ""
        email: ""
        confirmPassword: ""
        avatar : "https://public.aitmed.com/avatar/JohnDoe.jpg"
        verificationCode: .Global.patientSign.key
        signature: ""
    vertexAPI:
      .VertexAPI: ""
      store:
        api: builtIn.createNewAccount # construct uid, pk, esk .. for new account
        dataIn: formData.vertex
        dataOut: formData.response
    target: false
    tar: false
    confirm: ""
    checkOk:
  # init: 
    # - if:
    #   - =.ServicesAgreement.agreement.servicesAgreement
    #   - ..selectData.tar@: "selectOn.png"
    #   - ..selectData.tar@: "selectOff.png"
  apiRequest:
    profile:
      docResponse: ""
      patientdocument:
        type: .DocType.PatientProfile
        eid: .Global.rootNotebookID
        name:
          # .Global.Profile: ""
          data:
            #profile版本
            version: 2
            insuranceId: ""
            basicInfo:
              avatar: ""
              phone: .Global.currentUser.vertex.uid
              firstName: .Global.currentUser.vertex.name.firstName
              middleName: ""
              lastName: .Global.currentUser.vertex.name.lastName
              dateOfBirth: ""
              gender: ""
              socialSecurity: ""
              fullName: ""
              userName: .Global.currentUser.vertex.name.userName
            # 联系信息
            contactInfo:
              alternatePhone: ""
              email: .Global.currentUser.vertex.name.email
              address: 
                fullAddress: ""
                line: ""
                secondLine: ""
                # 市
                city: ""
                # 郡，县
                county: ""
                state: ""
                zipCode: ""
                addressFirstLine: ""
                addressSecondLine: ""
              # 紧急联系人info
            emergencyContact: 
              firstName: ""
              middleName: ""
              lastName: ""
              #与当前用户的关系，如母子等
              relation: ""
              phone: 
                countryCode: 
                fullPhone:
                phoneNumber: 
            # 身份证信息
            identification: 
              type: Drive License
              id: ""
              imageId: ""
            # 雇佣者信息
            employment:
              employerName: ""
              dept: ""
              NatureBusiness: ""
              Occupation: ""
              Telephone: ""
              fax: ""
              email: ""
              address: 
                line: ""
                secondLine: ""
                # 市
                city: ""
                # 郡，县
                county: ""
                state: ""
                zipCode: ""
          type: "application/json"
      docAPI:
        # get:
        #   .DocAPI.get: "" 
        #   api: rd
        #   id: .Global.rootNotebookID
        #   xfname: eid
        #   type: .DocType.PatientProfile
        #   dataKey: apiRequest.profile.docResponse
        #   _nonce: =.Global._nonce 
        store:
          api: cd
          dataIn: CreateNewAccount.apiRequest.profile.patientdocument
          dataOut: CreateNewAccount.apiRequest.profile.docResponse
          subtype:
            mediaType: "application/json"
    getVertex:
      response: ""
      vertex:
        xfname: none
        type: 1
        sCondition: =..formData.rvCondition
        _nonce: =.Global._nonce
      vertexAPI:
        get:
          api: rv
          dataIn: CreateNewAccount.apiRequest.getVertex.vertex
          dataOut: CreateNewAccount.apiRequest.getVertex.response
  save: 
    - ..formData.vertexAPI.store #
    # - .Global.rootNotebook.edgeAPI.store
  update: 
    - .Global.currentUser.vertex@ : =..formData.response.vertex # set {".Global.currentUser.vertex":".builtIn.UserVertex"}
    - .Global.currentUser.vertex.name.firstName@ : =..formData.vertex.name.firstName
    - .Global.formData.profile.firstName@: =..formData.vertex.name.firstName
    - .Global.currentUser.vertex.name.lastName@ : =..formData.vertex.name.lastName 
    - .Global.currentUser.vertex.name.email@ : =..formData.vertex.name.email
    - .Global.currentUser.vertex.name.userName@ : =..formData.vertex.name.userName     
    - .Global.currentUser.JWT@ : =..formData.response.jwt
    - .Global.rootNotebookID@: =.Global.currentUser.vertex.deat.rnb64ID
    - .Global.currentUser.dataCache.loadingDateTime@ : =.Global.currentDateTime
  components:
    - type: view
      style:
        width: "1"
        margin: auto
        height: "1"
      children:
        - .BaseWarningViewOne:
          msg2: "Please check the box"
          viewTag: checkMissed1
          style: 
            margin: auto
            height: "1"
            width: "1"
          onClick:
            - actionType: popUpDismiss
              popUpView: checkMissed1
        - .BaseWarningViewOne:
          msg2: "Please check the box"
          viewTag: checkMissed2
          style: 
            margin: auto
            height: "1"
            width: "1"
          onClick:
            - actionType: popUpDismiss
              popUpView: checkMissed2
        - .BaseWarningViewOne:
          msg2: "Please fill all the text fields!"
          viewTag: emptyFieldExit
          style: 
            margin: auto
            height: "1"
            width: "1"
          onClick:
            - actionType: popUpDismiss
              popUpView: emptyFieldExit
        - .BaseWarningViewOne:
          msg2: "Password should be same"
          viewTag: passwordDifferent
          style: 
            margin: auto
            height: "1"
            width: "1"
          onClick:
            - actionType: popUpDismiss
              popUpView: passwordDifferent
        - .BaseWarningViewOne:
          msg2: "The userName has already been taken!"
          viewTag: userNameIsUsed
          style: 
            margin: auto
            height: "1"
            width: "1"
        - .BaseWarningViewOne:
          msg2: "Invalid Username: Required length should be 6 to 16!"
          viewTag: invalidUseriId 
          style: 
            margin: auto
            height: "1"
            width: "1"
        - .BaseWarningViewOne:
          msg2: "Incorrect verificationCode"
          viewTag: wrongCode   
          style: 
            margin: auto
            height: "1"
            width: "1"
        - .BaseWarningViewOne:
          viewTag: WaitView
          style: 
            margin: auto
            height: "1"
            width: "1"
        - type: view
          style:
            width: "0.56"
            height: "1"
          children:
            - type: view
              style:
                width: "0.56"
                height: "1"
                top: "0"
                # backgroundColor: red
              children:
                - type: image
                  path: bg.png
                  style:
                    top: 0
                    width: "0.555"
                    height: "1"
                - type: image
                  path: bgColor.svg
                  style:
                    top: 0
                    width: "0.555"
                    height: "1"
                - type: image
                  path: white.svg
                  style:
                    width: "0.015"
                    hieght: "0.015"
                    left: "0.05"
                    top: "0.04"
                  onClick:
                    - actionType: builtIn
                      funcName: goBack
                      reload: true
                - type: label
                  text: "Back"
                  style:
                    width: "0.1"
                    height: "0.05"
                    left: "0.07"
                    top: "0.037"
                    color: "#ffffff"
                    fontSize: .Nfont.h3
                    fontWeight: 500
                  onClick:
                    - actionType: builtIn
                      funcName: goBack
                      reload: true
                # - type: image
                #   path: Logo.png
                #   style:
                #     width: "0.16"
                #     left: "0.25"
                #     top: '0.23'
                #     zIndex: 1000
                - type: label
                  textBoard: 
                    - text: Welcome To 
                    - br: 
                    - text: Aitmed
                      fontWeight: 700
                  style: 
                    left: "0.06"
                    width: "0.46"
                    top: "0.35"
                    color: "0xffffff"
                    textAlign: 
                      x: center
                    fontSize: "6.6vh"
                    lineHeight: "1.5"
                    letterSpacing: "2.5px"
                - type: label
                  text: "WWW.AITMED.COM"
                  style: 
                    left: "0.05"
                    width: "0.46"
                    top: "0.9"
                    color: "0xffffff"
                    textAlign: 
                      x: center
                    fontSize: "2.5vh"
                    lineHeight: "1.5"
                    letterSpacing: "2.5px"
        - type: view
          style:
            left: "0.58"
            top: "0"
            width: "0.41"
            height: "1"
          children:
            - type: view
              style:
                width: "0.3"
                height: "0.9"
                marginTop: "0.05"
                marginLeft: "0.055"
                backgroundColor: "#ffffff"
                borderRadius: "7px"
                border: 
                  style: "3"
                borderColor: "#EEF6FD"
                boxShadow: "0px 0px  8px 5px #EEF6FD"
              children:
                - type: view
                  style:
                    width: "0.26"
                    height: auto
                    marginTop: 2vw
                    marginLeft: 3.8vw
                  children:
                    - type: view
                      style:
                        width: "0.05"
                        height: "0.08"
                      children:
                        - type: label
                          textBoard: 
                            - text: Country
                              fontWeight: 600
                            - text: "*"
                              color: "0xFB5051"
                          style:
                            color: "0x333333"
                            left: "0"
                            top: "0"
                            width: "0.05"
                            fontSize: .Nfont.h0
                            fontWeight: 600
                            textAlign: 
                              x: left
                              y: center
                        - type: select
                          contentType: countryCode
                          placeholder: ..formData.vertex.name.countryCode
                          dataKey: formData.vertex.name.countryCode # formData.countryCode : inputValue
                          options:
                            .CountryCode
                          required: "true"
                          style:
                            left: "0"
                            top: "0.031"
                            width: "0.05"
                            height: "0.041"
                            fontSize: .Nfont.h0
                            placeholder: "US +1"
                            borderWidth: "2"
                            border:
                              style: "3"
                              color: "0xDEDEDE"  
                            borderRadius: "7px"      
                    - type: view
                      style:
                        top: "0"
                        marginLeft: "0.06"
                        width: "0.18"
                        height: "0.08"
                      children:
                        - type: label
                          textBoard: 
                            - text: Phone
                              fontWeight: 600
                            - text: "*"
                              color: "0xFB5051"
                          style:
                            color: "0x333333"
                            left: "0"
                            top: "0"
                            width: "0.05"
                            fontSize: .Nfont.h0
                            fontWeight: 600
                            textAlign: 
                              x: left
                              y: center
                        - type: textField
                          # contentType: phoneNumber
                          # placeholder: ..formData.vertex.name.phoneNumber
                          dataKey: formData.vertex.name.phoneNumber # formData.countryCode : inputValue
                          # required: "true"
                          style:
                            textIndent: 0.5em
                            fontSize: .Nfont.h0
                            left: "0"
                            top: "0.031"
                            width: "0.16"
                            height: "0.041"
                            borderWidth: "2"
                            border:
                              style: "3"
                              color: "0xDEDEDE"  
                            borderRadius: "7px"     
                            textAlign: 
                              x: left
                              y: center
                    - type: view
                      style:
                        height: "0.08"
                      children:
                        - type: label
                          textBoard: 
                            - text: First Name
                              fontWeight: 600
                            - text: "*"
                              color: "0xFB5051"
                          style:
                            color: "0x333333"
                            left: "0"
                            top: "0"
                            width: "0.2"
                            height: "0.03"
                            fontSize: .Nfont.h0
                            fontWeight: 600
                            textAlign: 
                              x: left
                              y: center
                        - type: textField
                          contentType: text
                          placeholder: " Enter here"
                          dataKey: formData.vertex.name.firstName # formData.countryCode : inputValue
                          required: "true"
                          style:
                            fontSize: .Nfont.h0
                            textIndent: 0.5em
                            left: "0"
                            backgroundColor: "0xffffff"
                            top: "0.031"
                            width: "0.22"
                            height: "0.041"
                            borderWidth: "2"
                            border:
                              style: "3"
                              color: "0xDEDEDE"  
                            borderRadius: "7px"  
                            textAlign: 
                              x: left
                              y: center
                    - type: view
                      style:
                        height: "0.08"
                        width: "0.1"
                      children:
                        - type: label
                          textBoard: 
                            - text: Last Name
                              fontWeight: 600
                            - text: "*"
                              color: "0xFB5051"
                          style:
                            color: "0x333333"
                            left: "0"
                            top: "0"
                            width: "0.1"
                            height: "0.03"
                            fontSize: .Nfont.h0
                            fontWeight: 600
                            textAlign: 
                              x: left
                              y: center
                        - type: textField
                          contentType: text
                          placeholder: " Enter here"
                          dataKey: formData.vertex.name.lastName # formData.countryCode : inputValue
                          required: "true"
                          style:
                            fontSize: .Nfont.h0
                            textIndent: 0.5em
                            left: "0"
                            backgroundColor: "0xffffff"
                            top: "0.031"
                            width: "0.22"
                            height: "0.041"
                            borderWidth: "2"
                            border:
                              style: "3"
                              color: "0xDEDEDE"  
                            borderRadius: "7px"  
                            textAlign: 
                              x: left
                              y: center                  
                    - type: view
                      style:
                        height: "0.08"
                      children:
                        - type: label
                          textBoard: 
                            - text: Username
                              fontWeight: 600
                            - text: "*"
                              color: "0xFB5051"
                          style:
                            color: "0x333333"
                            left: "0"
                            top: "0"
                            width: "0.2"
                            height: "0.03"
                            fontSize: .Nfont.h0
                            textAlign: 
                              x: left
                              y: center
                        - type: textField
                          contentType: text
                          placeholder: "Create your own"
                          dataKey: formData.vertex.name.userName # formData.countryCode : inputValue
                          required: "true"
                          style:
                            fontSize: .Nfont.h0
                            textIndent: 0.5em
                            left: "0"
                            backgroundColor: "0xffffff"
                            top: "0.031"
                            width: "0.22"
                            height: "0.041"
                            borderWidth: "2"
                            border:
                              style: "3"
                              color: "0xDEDEDE"  
                            borderRadius: "7px"  
                            textAlign: 
                              x: left
                              y: center
                    - type: view
                      style:
                        height: "0.08"
                      children:
                        - type: label
                          textBoard: 
                            - text: Email
                              fontWeight: 600
                            - text: "*"
                              color: "0xFB5051"
                          style:
                            color: "0x333333"
                            left: "0"
                            top: "0"
                            width: "0.14"
                            height: "0.03"
                            fontSize: .Nfont.h0
                            fontWeight: 600
                            textAlign: 
                              x: left
                              y: center
                        - type: textField
                          contentType: text
                          placeholder: " Enter here"
                          dataKey: formData.vertex.name.email # formData.countryCode : inputValue
                          required: "true"
                          style:
                            fontSize: .Nfont.h0
                            textIndent: 0.5em
                            left: "0"
                            backgroundColor: "0xffffff"
                            top: "0.031"
                            width: "0.22"
                            height: "0.041"
                            borderWidth: "2"
                            border:
                              style: "3"
                              color: "0xDEDEDE"  
                            borderRadius: "7px"  
                            textAlign: 
                              x: left
                              y: center   
                    - type: view
                      style:
                        height: "0.08"
                      children:
                        - type: label
                          textBoard: 
                            - text: New Password
                              fontWeight: 600
                            - text: "*"
                              color: "0xFB5051"
                          style:
                            color: "0x333333"
                            left: "0"
                            top: "0"
                            width: "0.2"
                            height: "0.03"
                            fontSize: .Nfont.h0
                            fontWeight: 600
                            textAlign: 
                              x: left
                              y: center  
                        - type: view
                          style: 
                            left: "0"
                            backgroundColor: "0xffffff"
                            top: "0.031"
                            width: "0.22"
                            height: "0.041"
                            borderWidth: "2"
                            border:
                              style: "3"
                              color: "0xDEDEDE"  
                            borderRadius: "7px"  
                          children: 
                            - type: textField
                              contentType: password
                              placeholder: " Enter here"
                              dataKey: formData.vertex.name.password # formData.countryCode : inputValue
                              required: "true"
                              style:
                                fontSize: .Nfont.h0
                                textIndent: 0.5em
                                backgroundColor: "0xffffff"
                                top: "0.002"
                                width: "0.22"
                                height: "0.038"
                                border:
                                  style: "1"
                                textAlign: 
                                  x: left
                                  y: center
                    - type: view
                      style:
                        height: "0.08"
                      children:
                        - type: label
                          textBoard:
                            - text: Confirm Password
                              fontWeight: 600
                            - text: "*"
                              color: "0xFB5051"
                          style:
                            color: "0x333333"
                            left: "0"
                            top: "0"
                            width: "0.14"
                            height: "0.03"
                            fontSize: .Nfont.h0
                            textAlign: 
                              x: left
                              y: center
                        - type: view
                          style: 
                            left: "0"
                            backgroundColor: "0xffffff"
                            top: "0.031"
                            width: "0.22"
                            height: "0.041"
                            borderWidth: "2"
                            border:
                              style: "3"
                              color: "0xDEDEDE"  
                            borderRadius: "7px"  
                          children: 
                            - type: textField
                              contentType: password
                              placeholder: " Enter here"
                              dataKey: formData.vertex.name.confirmPassword # formData.countryCode : inputValue
                              required: "true"
                              style:
                                fontSize: .Nfont.h0
                                textIndent: 0.5em
                                left: "0.002"
                                backgroundColor: "0xffffff"
                                top: "0.002"
                                width: "0.22"
                                height: "0.038"
                                border:
                                  style: "1"
                                textAlign: 
                                  x: left
                                  y: center  
                - type: view 
                  style:
                    marginTop: "1vw"
                    marginLeft: 3.8vw
                    width: "0.25"
                  children:
                    - type: image
                      viewTag: select
                      onClick:
                        - emit:
                            actions:
                              - if:
                                - =.CreateNewAccount.formData.target
                                - .CreateNewAccount.formData.target@: false
                                - .CreateNewAccount.formData.target@: true    
                        - actionType: builtIn
                          funcName: redraw
                          viewTag: select
                      path: 
                        emit:
                          actions:
                            - if:
                                - =.CreateNewAccount.formData.target
                                - selectOnblue.svg
                                - selectBlack.svg
                      # path: selectOff.png
                      # pathSelected: selectOn.png
                      style:
                        width: "0.01"
                        top: "0.0065"
                    - type: label
                      style:
                        color: "0x333333"
                        marginLeft: 1.5vw
                        top: "0.005"
                        fontSize: .Nfont.h0
                        height: "0.03"
                        textAlign: 
                          x: left
                      onClick:
                        - ..fromData.flag@: "1"
                        - goto: PatientUserAgreement
                      textBoard:
                        - text: "I agree to "
                        - text: "&nbsp;"
                        - text: "Aitmed Terms of Use Agreement"
                          color: "#333333"
                          fontWeight: 700
                        - text: "&nbsp;"
                        - text: " and "
                    - type: label
                      style:
                        color: "0x333333"
                        marginLeft: 1.5vw
                        top: "0.03"
                        height: "0.03"
                        fontSize: .Nfont.h0
                        textAlign: 
                          x: left
                      onClick:
                        - ..fromData.flag@: "2"
                        - goto: PatientSubscriptionAgreement
                      textBoard:
                        - text: "AiTmed Master Subscription Agreement"
                          color: "#333333"
                          fontWeight: 700
                    - type: image
                      viewTag: select
                      onClick:
                        - emit:
                            actions:
                              - if:
                                - =.CreateNewAccount.formData.tar
                                - .CreateNewAccount.formData.tar@: false
                                - .CreateNewAccount.formData.tar@: true    
                        - actionType: builtIn
                          funcName: redraw
                          viewTag: select
                      path:
                        emit:
                          actions:
                            - if:
                                - =.CreateNewAccount.formData.tar
                                - selectOnblue.svg
                                - selectBlack.svg
                      style:
                        width: "0.01"
                        marginTop: 3.7vw
                    - type: label
                      onClick:
                        - ..fromData.flag@: "3"
                        - goto: PatientPrivacyPolicy
                      textBoard: 
                        - text: "I also agree to"
                        - text: "&nbsp;"
                        - text: " AiTmed Privacy Policy"
                          color: "#333333"
                          fontWeight: 700
                      style:
                        color: "0x333333"
                        marginLeft: 1.5vw
                        top: "0.065"
                        width: "0.22"
                        height: "0.03"
                        fontSize: .Nfont.h0
                        lineHeight: "1.3"
                        textAlign: 
                          x: left
                
                - type: view
                  style:
                    left: "0"
                    width: "0.3"
                    marginTop: 1.5vw
                  children:
                    - type: button
                      text: Sign Up
                      style:
                        color: "0xffffffff"
                        fontSize: .Nfont.h0
                        fontWeight: 600
                        width: "0.22"
                        height: "0.045"
                        margin: auto
                        backgroundColor: "#2988E6"
                        border:
                          style: "1"
                        borderRadius: "7px"
                        textAlign:
                          x: center
                          y: center
                      onClick: 
                        - actionType: evalObject
                          object:
                            - if:
                              - =..formData.target
                              - continue
                              - actionType: popUp
                                popUpView: checkMissed1
                                wait: true
                        - actionType: evalObject
                          object:
                            - if:
                              - =..formData.tar
                              - continue
                              - actionType: popUp
                                popUpView: checkMissed2
                                wait: true 
                        - actionType: evalObject
                          object:
                            - if:
                              - =..formData.vertex.name.password
                              - continue
                              - actionType: popUp
                                popUpView: emptyFieldExit
                                wait: true
                        - actionType: evalObject
                          object:
                            - if:
                                - =..formData.vertex.name.firstName
                                - continue
                                - actionType: popUp
                                  popUpView: emptyFieldExit
                                  wait: true
                        - actionType: evalObject
                          object:
                            - if:
                                - =..formData.vertex.name.lastName
                                - continue
                                - actionType: popUp
                                  popUpView: emptyFieldExit
                                  wait: true
                        - actionType: evalObject
                          object:
                            - if:
                                - =..formData.vertex.name.userName
                                - continue
                                - actionType: popUp
                                  popUpView: emptyFieldExit
                                  wait: true
                        - actionType: evalObject
                          object:
                            - if:
                                - =.builtIn.string.equal:
                                    dataIn:
                                      string1: =..formData.vertex.name.password
                                      string2: =..formData.vertex.name.confirmPassword
                                - continue
                                - actionType: popUp
                                  popUpView: passwordDifferent
                                  wait: true                          
                        - actionType: evalObject
                          object: 
                            .Global._nonce@: 
                              =.builtIn.math.random: ""
                        - actionType: evalObject
                          object:
                            - =.builtIn.typeCheck.userName:
                                dataIn:
                                  =..formData.vertex.name.userName
                                dataOut: CreateNewAccount.formData.checkOk
                        - actionType: evalObject
                          object: 
                            - if:
                                - =..formData.checkOk
                                - continue
                                - actionType: popUp
                                  popUpView: invalidUseriId
                                  wait: true 
                        - actionType: evalObject
                          object:
                            - =.builtIn.string.concat:
                                dataIn:
                                  - "uid like '"
                                  - =..formData.vertex.name.userName
                                  - "%'"
                                dataOut: CreateNewAccount.formData.rvCondition 
                            - =..apiRequest.getVertex.vertexAPI.get: ""
                            - if:
                                - =..apiRequest.getVertex.response.vertex.0.id
                                - actionType: popUp
                                  popUpView: userNameIsUsed
                                  wait: true
                                - continue
                        - actionType: evalObject
                          object: 
                            - if:
                              - =.builtIn.string.equal:
                                  dataIn:
                                    string1: =..formData.response.code
                                    string2: 1031
                              - actionType: popUp
                                popUpView: userNameIsUsed
                                wait: true
                              - continue    
                        - actionType: evalObject
                          object: 
                            - =..formData.vertexAPI.store: ""
                            - .Global.currentUser.vertex@ : =..formData.response.vertex # set {".Global.currentUser.vertex":".builtIn.UserVertex"}
                            - .Global.currentUser.vertex.name.firstName@ : =..formData.vertex.name.firstName
                            - .Global.formData.profile.firstName@: =..formData.vertex.name.firstName
                            - .Global.currentUser.vertex.name.lastName@ : =..formData.vertex.name.lastName 
                            - .Global.currentUser.vertex.name.email@ : =..formData.vertex.name.email
                            - .Global.currentUser.vertex.name.userName@ : =..formData.vertex.name.userName
                            - =.builtIn.string.concat:
                                dataIn:
                                  - =..formData.vertex.name.firstName
                                  - " "
                                  - =..formData.vertex.name.lastName 
                                dataOut: CreateNewAccount.formData.fullName    
                            - .Global.currentUser.vertex.name.fullName@: =..formData.fullName
                            - .Global.currentUser.JWT@ : =..formData.response.jwt
                            - .Global.rootNotebookID@: =.Global.currentUser.vertex.deat.rnb64ID
                            - .Global.currentUser.dataCache.loadingDateTime@ : =.Global.currentDateTime

                        - actionType: evalObject
                          object:
                            - =.builtIn.eccNaCl.decryptAES:
                                dataIn:
                                  key: =..formData.vertex.name.password
                                  message: =..formData.response.vertex.esk
                                dataOut: Global.currentUser.vertex.sk
                            - .Global.isCreateAppointment@: false
                            - .Global.isSignIn@: true
                            - .Global.newCareUser@: true
                            - .Global.FirstIns@: true
                        - actionType: evalObject
                          object:
                            - ..apiRequest.profile.patientdocument.eid@: =.Global.rootNotebookID
                            - ..apiRequest.profile.patientdocument.name.data.basicInfo.phone@: =.Global.currentUser.vertex.uid
                            - ..apiRequest.profile.patientdocument.name.data.basicInfo.firstName@: =.Global.currentUser.vertex.name.firstName
                            - ..apiRequest.profile.patientdocument.name.data.basicInfo.lastName@: =.Global.currentUser.vertex.name.lastName
                            - ..apiRequest.profile.patientdocument.name.data.basicInfo.userName@: =.Global.currentUser.vertex.name.userName
                            - ..apiRequest.profile.patientdocument.name.data.basicInfo.fullName@: =..formData.fullName
                        - actionType: evalObject
                          object:
                            - =..apiRequest.profile.docAPI.store: ""
                        - actionType: evalObject
                          object:
                            - if:
                              - =..formData.response.vertex.pk
                              - actionType: evalObject
                                object: 
                                  - .TitleInfo@: 1
                                  # - goto: =.Global.GoSignUp
                                  - actionType: popUp
                                    popUpView: successView
                                    wait: 1000
                              - actionType: popUp
                                popUpView: wrongCode 
                                wait: true  
                        - goto: PatientProfile
                - .ViewRow:
                  style:
                    alignItems: center
                    width: 22vw
                    justifyContent: space-between
                    marginTop: 1.5vw
                    marginLeft: 4vw
                  children: 
                    - type: label
                      style:
                        height: 0.1vw
                        width: 9vw
                        backgroundColor: "#C4C4C4"      
                    - type: label
                      text: OR
                      style:
                        fontSize: .Nfont.h0_0
                        color: "#333333"                 
                    - type: label
                      style:
                        height: 0.1vw
                        width: 9vw
                        backgroundColor: "#C4C4C4"
                - type: view 
                  style:
                    marginTop: 0.5vw
                    marginLeft: 6vw
                    width: "0.22"
                    height: "0.1"
                  children:
                    - type: label
                      text: Already have an account? 
                      style:
                        width: "0.15"
                        top: "0"
                        height: "0.03"
                        fontSize: .Nfont.h0
                        textAlign: 
                          x: center
                          y: center
                    - type: button
                      text: Sign In
                      style:
                        color: "0x143459"
                        fontSize: .Nfont.h0
                        left: "0.125"
                        width: "0.04"
                        height: "0.03"
                        textAlign: 
                          x: center
                          y: center
                        fontStyle: "bold"
                        backgroundColor: "0xffffff00"
                        border:
                          style: "1"
                      onClick: 
                        - goto: CareSignIn
        
                
    - .BaseSuccessfulView:
      viewTag: successView
      msg: "Successfully!"
      style:
        width: "1"
        height: "1"
        position: fixed
        zIndex: 1000
        margin: auto
        left: none
        marginLeft: 5.8vw