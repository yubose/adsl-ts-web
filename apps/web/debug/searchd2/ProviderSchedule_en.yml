ProviderSchedule: #xd page number: 1080
  pageNumber: "450" 
  viewPort: top
  title: "ProviderSchedule"
  init:
    - actionType: evalObject
      object:
        .Global._nonce@:
          =.builtIn.math.random: ""
    - actionType: evalObject
      object: .BaseDate.getDate
    - actionType: evalObject
      object: .BaseDate.getShow
    - .Global.locationAll@: []
    - .Global.currentSubtype@: 196609
    - if: 
      - =.Global.currentFacility.id
      - actionType: evalObject
        object:
          - =..locationList.vertexAPI.get: ""
          - =..fac_RootNotebook.edgeAPI.get: ""
          - .Global.fac_rootNotebook@: =..fac_RootNotebook.edge.edge.0.id
          - ..locationAll.document.eid@: =..fac_RootNotebook.edge.edge.0.id
          - ..middleList@: =..locationList.list.vertex
          - =.builtIn.object.extractArray: 
              dataIn: 
                obj: =..middleList
                arr: =..extractData
              dataOut: ProviderSchedule.locationAll.document.name.data.allLocation
          - .Global.jwt.edge.bvid@: =.Global.currentFacility.id
          - =.Global.jwt.edgeAPI.store: ""
          - =..locationAll.docAPI.store: ""
          - .Global.locationAll@: =..locationAll.document.name.data.allLocation
          - .Global.formData.locationId@: =.Global.locationAll.0.id  # initial account management id
          - =..patient.docAPI.get: ""
          - ..formData.timeTable.response@: ""  #表格置空
          - ..formData.providerId@: =.Global.currentUser.vertex.id
          - ..appointment.edge.id.0@: =.Global.currentFacility.id
          - .Global.formData.scheduleManageProdId@: =.Global.currentUser.vertex.id
          - .Global.formData.scheduleManageProdName@: =.Global.currentUser.vertex.name.fullName
          - ..formData.providerName@: =.Global.currentUser.vertex.name.fullName
          - =.builtIn.array.selectOneToArr:   # 获取所有的address
              dataIn:
                arr: =.Global.locationAll
                key: "medicalFacilityName"
              dataOut: ProviderSchedule.addressName
          - ..formDataOfficeVisisAddress@: =..addressName.0
          - =.builtIn.array.selectOneToArr:   # 获取所有的预约的id
              dataIn:
                arr: =.Global.locationAll
                key: "id"
              dataOut: ProviderSchedule.formData.allId
          - =.builtIn.array.add:
              dataIn:
                object: =..formData.allId
                value: =.Global.currentFacility.id
          - =.builtIn.array.push: # push for update allId_p
              dataIn:
                messages: =..formData.allId
                newMessage: =..formData.providerId
              dataOut: ProviderSchedule.formData.allId
          # - ..appointment.edge.id@: =..formData.allId
          # - ..approveInMeeting.edge.id.0@: =.Global.currentUser.vertex.id
          # - ..approveInMeeting.edge.id.1@: =.Global.currentFacility.id
          - ..approveInMeeting.edge.id@: =..formData.allId
          - =..approveInMeeting.edgeAPI.get: ""
          - ..appointment.edge.id.1@: =.Global.currentUser.vertex.id
          # 获取当前Facility下面的所有预约
          - =..visitQuestionnaire.docAPI.get: ""

          
          - =.builtIn.object.extractArray: 
              dataIn: 
                obj: =..approveInMeeting.edgeResp.edge
                arr:
                  - stime
                  - etime
                  - name.visitReason
                  - name.patientName
                  - name.visitType
                  - id
                  - name.duration
                  - tage
                  - subtype
              dataOut: ProviderSchedule.formData.timeTable.chartData
          - =..appointment.edgeAPI.get: ""
          - ..formData.appointment@: =..appointment.list.edge
          - =.builtIn.array.getListLength:
              dataIn:
                object: =..formData.appointment
              dataOut: ProviderSchedule.formData.appointmentLength
          - actionType: evalObject
            object: 
              - ..selectDate@: .BaseDate.calendarDate.todayDate
              - .Global.currentSubtype@: '196609'
              - .Global.visitType@: "Telemedicine"
              - ..newAppointment.edge.name.visitType@: "Telemedicine"
              - ..newAppointment.edge.name.visitTypeShow@: "Telemedicine"
      - continue
    - if:
      - =..approveInMeeting.edgeResp.edge.0
      - =.builtIn.search.ComputeObjectFieldCount:
          dataIn:
            objArr: =..approveInMeeting.edgeResp.edge
            strOne: 131078
            strTwo: 196614
          dataOut: ProviderSchedule.showArray
      - continue
    - =.builtIn.date.getTime:
        dataIn:
        dataOut: ProviderSchedule.nowTimeStamp
  
  middleList: []
  showArray: ["0","0"]
  nowTimeStamp: ""
  fac_RootNotebook:
    edgeReq:
      id: .Global.currentFacility.id
      xfname: bvid
      type: .EdgeType.RootNotebook
    edge: ""
    edgeAPI:
      get:
        api: re
        dataIn: ProviderSchedule.fac_RootNotebook.edgeReq
        dataOut: ProviderSchedule.fac_RootNotebook.edge
  extractData:   
    - id
    - name.basicInfo.medicalFacilityName
    - name.basicInfo.phoneNumber
    - name.basicInfo.address
  # 获取visitQuestion文档
  visitQuestionnaire: 
    docResponse:
        id: ""
        xfname: ovid
        type: .DocType.VitalQuestionnaire
        maxcount: 1
        obfname: ctime
        _nonce: =.Global._nonce
    docres: ""
    docAPI:
      .DocAPI: ""
      get:
        dataIn:  visitQuestionnaire.docResponse
        dataOut: visitQuestionnaire.docres
  # 获取patientdocument
  profile:
    docResponse: ""
    patientdocument: ""
    document: 
      id: ""
      xfname: E.id
      type: .DocType.PatientProfile
      obfname: "mtime"
      ObjType: 12
      sCondition: "E.type=40000"
      maxcount: "1"
      _nonce: =.Global._nonce 
    docAPI:
      get:
        .DocAPI.get: "" 
        api: rd
        dataIn: profile.document
        dataOut: profile.docResponse
  # 获取当前provider所有的patient好友
  patient:  
    list: ""
    docReq:
        type: .DocType.PatientProfile
        id: .Global.currentUser.vertex.id
        xfname: E.bvid|E.evid
        ObjType: 8
        sCondition: E.type=10002 AND E.tage>0
        _nonce: =.Global._nonce
    docAPI:
      get: 
        api: rd
        dataOut: ProviderSchedule.patient.list
        dataIn: ProviderSchedule.patient.docReq
  locationList: 
    list: ""
    vertexIn: 
      ObjType: 4
      id: .Global.currentFacility.id
      xfname: "E.bvid"
      sCondition: "E.type=1100 AND V.type!=20 AND V.type!=1"
      maxcount: "100"
      obfname: "ctime"
      asc: true
      _nonce: =.Global._nonce
    vertexAPI: 
      get: 
        api: rv
        dataIn: locationList.vertexIn
        dataOut: ProviderSchedule.locationList.list
  locationAll:
    docResp: "" 
    docIn:
      type: .DocType.LocationOfFacility
      id: ""
      xfname: eid
      obfname: mtime
      maxcount: "1"
      name: 
        data: 
          allLocation: 
    document:  
      type: .DocType.LocationOfFacility
      eid: ""
      name: 
        data: 
          allLocation: []
    docAPI:
      .DocAPI: ""
      store: 
        api: cd
        dataIn: ProviderSchedule.locationAll.document
        subtype:
          mediaType: "application/json"   
      get: 
        api: rd
        dataIn: ProviderSchedule.locationAll.docIn
        dataOut: ProviderSchedule.locationAll.docResp
  # 获取可预约时间
  schedule:     
    response: ""
    scheduleList: ""
    get:
      api: re
      dataIn: ProviderSchedule.schedule.edge
      dataOut: ProviderSchedule.schedule.scheduleList
    edge:
      type: 40000
      id: []
      sCondition: =.Global.scheduleScondition
      xfname: "bvid,evid"
      maxcount: "10000"
      obfname: "ctime"
      asc: true
      _nonce: =.Global._nonce
  # 获取reason for visit
  visitReason: 
    docResp: ""
    document: 
    docIn:
      type: .DocType.VisitReason
      id: ""
      xfname: "eid"
      obfname: "ctime"
      _nonce: =.Global_nonce
      maxcount: "1"
    docAPI: 
      get: 
        .DocAPI.get: ""
        api: rd
        dataIn: visitReason.docIn
        dataOut: ProviderSchedule.visitReason.docResp
  # provider预约patient请求
  appointment: 
    list:
      edge: []
    deleteReq:
      id: ""
    edge:
      .Edge: ""
      id: 
      ObjType: 20
      xfname: "(,E.evid)&(,E2.evid)"
      sCondition: "E2.type=40000 AND E2.subtype in (196609,131073) AND E.type = 40000 AND E.subtype in (196610,131074)"
      obfname: "stime"
      asc: true
      _nonce: .Global._nonce
      maxcount: "100"
    edgeAPI:
      get:
        api: re
        dataIn: ProviderSchedule.appointment.edge
        dataOut: ProviderSchedule.appointment.list
      delete:
        api: dx
        dataIn: ProviderSchedule.appointment.deleteReq

  approveInMeeting:  
    edgeResp: ""
    edge:
      .Edge: ""
      id:
        
      ObjType: "20"
      xfname: "E2.Bvid,E2.Evid"
      sCondition: "E2.type=40000 AND E2.subtype&0xff in (1,9) AND E.type = 40000 AND E.subtype&0xff in (6) AND E.tage&0x100 in (0)"
      obfname: "ctime"
      _nonce: .Global._nonce
      maxcount: "100"
    edgeAPI: 
      get: 
        api: re
        dataIn: approveInMeeting.edge
        dataOut: ProviderSchedule.approveInMeeting.edgeResp
  # 获取location vertex
  getLocation:
    response: ""
    vertex:
      id: ""
    get:
      api: rv
      dataIn: getLocation.vertex
      dataOut: getLocation.response
  
  # provider预约patient
  newAppointment:
    response: ""
    edge:
      .Edge: ""
      evid: ""
      bvid: ""
      subtype: "0x30002"        
      type: 40000
      tage: 1
      name:
        patientName: "" 
        patientAvatarId: ""
        visitType: "Telemedicine" 
        visitTypeShow: "" 
        providerName: "" 
        providerAvatarId: ""
        visitReason: "" 
        blockColor: ""
        fontColor: "" 
        Reason: ""  
        document: ""    
        facilityId: ""
        providerId: ""
    edgeAPI:
      .EdgeAPI: ""
      store:
        api: ce
        dataIn: newAppointment.edge
        dataOut: newAppointment.response
  # patient自动同意provider预约
  approveAppointment:
    edge:
      bvid: ""
      .Edge: ""
      name: ""
      type: .EdgeType.WaitingRoom 
      subtype: 5
      refid: ""
      evid: ""
      stime: ""
      etime: ""
    edgeAPI:
      store:
        api: ce
        dataIn: approveAppointment.edge
        dataOut: approveAppointment.response
  approveAppointment10:
    response:
    edge:
      bvid: ""
      .Edge: ""
      name: ""
      type: 1053
      # subtype: 10
      refid: ""
      evid: ""
      stime: ""
      etime: ""
    edgeAPI:
      store:
        api: ce
        dataIn: approveAppointment10.edge
        dataOut: approveAppointment10.response
  
  # 获取当前facility下的所有provider
  providerList:
    list: ""
    docAPI:
      get: 
        api: rd
        dataKey: providerList.list
        ObjType: 12
        type: .DocType.DoctorProfile
        id: .Global.currentFacility.id
        xfname: E.bvid|E.evid
        sCondition: E.type=10002 AND E.tage=1
        maxcount: "10000"
        _nonce: =.Global._nonce
  isContact1: 
    response: ""
    edge:
      # .Edge: ""
      bvid: ""
      evid: ""
      subtype: 131072
      type: 10002
      tage: 1
      _nonce: =.Global._nonce
    getedge:
      id: []
      xfname: Bvid,Evid
      type: 10002
      _nonce: =.Global._nonce
    edgeAPI:
      .EdgeAPI: ""
      store:
        api: ce
        dataIn: isContact1.edge
        dataOut: isContact1.response
      get:
        api: re
        dataIn: isContact1.getedge
        dataOut: isContact1.getresponse
  apiRequest:
    appointmentListTag:
      docCreateResp: ""
      docCreateReq:
        subtype:
          isEncrypted: "0"
          isOnServer: "0"
        type: .DocType.RelatedAppTag
        # 创建时  eid 和 reid 都指向 当前房间的边，
        # 创建 related appointment 时， 需要一个reid 指向上一个小尾巴，fid指向跟边，所以eid和fid都需要根据情况判断
        eid: =..formData.appointmentLink.eid
        fid: =..formData.appointmentLink.fid
        reid: =..formData.appointmentLink.reid
        name:
          data: ""
      docAPI:
        store:
          api: cd
          dataIn: apiRequest.appointmentListTag.docCreateReq
          dataOut: ProviderSchedule.apiRequest.appointmentListTag.docCreateResp    
    # cancel
    cancelAppoint:
      edgeRes: ""
      edge:
        type: "40000"
        subtype: 7
        bvid: .Global.currentUser.vertex.id
        refid: ""
        evid: ""
        stime: ""
        etime: ""
      edgeAPI:
        store:
          api: ce
          dataIn: apiRequest.cancelAppoint.edge
          dataOut: ProviderSchedule.apiRequest.cancelAppoint.edgeRes
    # 查询拒绝邮件需要挂在的edge的id
    relation:
      edgeReq:
        id: []
        type: .EdgeType.Email
        xfname: Evid&Bvid
        maxcount: "1"
        obfname: "ctime"
        _nonce: =.Global._nonce
      edgeRes: ""
      edgeAPI:
        get:
          api: re
          dataIn: ProviderSchedule.apiRequest.relation.edgeReq
          dataOut: ProviderSchedule.apiRequest.relation.edgeRes
    # 创建拒绝邮件doc
    cancelEmail:
      docReq:
        type: .DocType.InboxMessage #邮件类型，默认1281
        eid: "" #邮件需要挂在的edge的id，为发送方与接收方之间10002的edge
        name:
          data:
            #邮件内容
            content: ""
            #收件人姓名
            receiverName: ""
            #发送人姓名
            senderName: "automatic-reply@aitmed.com"
            #收件人头像的id
            receiverAvatarId: ""
            #是否带附件
            haveAttachment: false
            #收件人id
            receiverId: ""
          title: "Cancel Appointment"
          user: ""
      docRes: ""
      docAPI:
        store:
          api: cd
          dataIn: ProviderSchedule.apiRequest.cancelEmail.docReq
          dataOut: ProviderSchedule.apiRequest.cancelEmail.docRes
    # get10002
    connection:
      edgeResp: ""
      edge:
        id: 
          - .Global.currentFacility.id
          - .Global.currentUser.vertex.id
        xfname: "bvid,evid"
        type: 10002
        sCondition: "tage>0"
      edgeAPI:
        .EdgeAPI:
        get: 
          api: re
          dataIn: apiRequest.connection.edge
          dataOut: ProviderSchedule.apiRequest.connection.edgeResp
  visitType: "Telemedicine"
  splitTime: []  
  reasonForVisit: []
  locationId: .Global.locationAll.0.id  
  clock: ""
  selectDate: ""
  appointmentTime: ""
  formData: 
    appointmentLink: #如果当前是一个 related 预约，则从Global去拿
      eid: ""
      fid: ""
      reid: ""
    nextBtnColor: "0xd3dde9"
    providerFullInfo: ""
    locationAddress: ""
    patientId: ""
    appointment: []   
    allId: []   
    inviteMessage: ""
    locationList: ""
    shareDocId: ""
    dataStruc:
        - reason 
        - duration
    appointmentInfo: ""
    providerList: []
    providerName: 
    providerId: 
    FacilityId: ""
    appointmentLength: "0"
    durationMinutes: ""
    roomInfo: 
    timeTable:
      chartType: "calendarTable"
      chartData:  []
      response: ""
    patientDoc: ""
  components:
    - type: view
      style:
        width: "1"
        height: "1"
        margin: auto
      children:
        - .BaseWarningViewOne: 
          msg2: "The time before today cannot be selected. Please select the correct time!!!"
          viewTag: judgeTime   
          style:
            margin: auto
            width: "1"
            height: "1"
          onClick:
            - actionType: popUpDismiss
              popUpView: judgeTime
          
        - .BaseWarningViewOne: 
          msg2: "Please select the Patient!!!"
          viewTag: judgePatient 
          style:
            margin: auto
            width: "1"
            height: "1"
          onClick:
            - actionType: popUpDismiss
              popUpView: judgePatient
        - type: view
          style:
            background-image: 'linear-gradient(#0063a8, #004371)'   
            height: "1"
            width: "0.16"
          children:
            - .aitLogo:
            - .Menu:
        - .TopBar:
        - .BodyView:
          style: 
            backgroundColor: "#f4f8fa"
            width: "0.84"
            height: "0.92"
            left: '0.16'
            top: "0.08"
            
          children:
            - type: view
              style: 
                display: flex
                flexDirection: row
                justifyContent: space-between
                alignItems: center
                height: 4vw
                width: 80vw
                marginLeft: 1vw
              children:
                - .Label1:
                  type: label
                  text: "Appointments Overview"
                  style:
                    marginLeft: 1vw
                    fontSize: 1.2vw
                - .Addbutton:
                  style: 
                    float: right
                  onClick:
                    # - actionType: updateObject
                    #   dataKey: ProviderSchedule.visitReason.response
                    #   dataObject: []
                    - actionType: evalObject
                      object:
                        .Global._nonce@:
                          =.builtIn.math.random: ""
                    - actionType: evalObject
                      object: 
                        - =..apiRequest.connection.edgeAPI.get: ""
                        - ..visitReason.docResp.0.doc.0.name.data.reasonForVisit@: []
                        - ..visitReason.docIn.id@: =..apiRequest.connection.edgeResp.edge.0.id
                        - ..newAppointment.edge.name.providerName@: =.Global.MyProfile.name.data.fullName
                        - =..visitReason.docAPI.get: ""
                        # - =.builtIn.object.extractArray: 
                        #     dataIn: 
                        #       obj: =..visitReason.response.doc.0.name.data.reasonForVisit
                        #       arr: =..formData.dataStruc
                        #     dataOut: ProviderSchedule.middleStruc  
                        - ..visitReason.document@: =..visitReason.docResp.0.doc.0
                        - =.builtIn.array.convertToList:
                            dataIn:
                              array: =..visitReason.document.name.data.reasonForVisit.Telemedicine
                              key: reason
                            dataOut: ProviderSchedule.reasonForVisit
                        - =.builtIn.array.getByKey:
                            dataIn:
                              array: =..visitReason.document.name.data.reasonForVisit.Telemedicine
                              key1: reason
                              value: =..reasonForVisit.0
                              key2: duration
                            dataOut: ProviderSchedule.selectData.duration
                        - =.builtIn.array.getByKey:
                            dataIn:
                              array: =..visitReason.document.name.data.reasonForVisit.Telemedicine
                              key1: reason
                              value: =..reasonForVisit.0
                              key2: fee
                            dataOut: ProviderSchedule.selectData.fee    
                        - .ProviderSchedule.selectData.document@: =..visitReason.document.name.data.reasonForVisit.Telemedicine.0.document
                        - =.builtIn.array.add:
                            dataIn:
                              object: =..schedule.edge.id
                              value: =.Global.currentFacility.id
                        - =.builtIn.array.add:
                            dataIn:
                              object: =..schedule.edge.id
                              value: =.Global.currentUser.vertex.id
                        - =.builtIn.string.retainNumber:
                            dataIn:
                              value: =..selectData.duration
                            dataOut: ProviderSchedule.formData.duration
                        - .ProviderSchedule.selectData.reason@: =..reasonForVisit.0
                        - .ProviderSchedule.selectData.document@: =..visitReason.document.name.data.reasonForVisit.0.document
                        - =.builtIn.date.transformMonth:
                            dataIn:
                              month: =.BaseDate.calendarDate.month
                            dataOut: BaseDate.calendarDate.monthName
                        - =.builtIn.date.getTimeStampOfDate:
                            dataIn:
                              date: =.BaseDate.calendarDate.todayDate
                            dataOut: BaseDate.calendarDate.todayStamp
                        - =.builtIn.string.concat:
                            dataIn:
                              - "(stime<"
                              - =.BaseDate.calendarDate.todayStamp.start
                              - " AND "
                              - "etime>"
                              - =.BaseDate.calendarDate.todayStamp.start
                              - " OR "
                              - "stime>"
                              - =.BaseDate.calendarDate.todayStamp.start
                              - " AND "
                              - "etime<"
                              - =.BaseDate.calendarDate.todayStamp.end
                              - " OR "
                              - "stime<"
                              - =.BaseDate.calendarDate.todayStamp.end
                              - " AND "
                              - "etime>"
                              - =.BaseDate.calendarDate.todayStamp.end
                              - ")"
                              - " AND "
                              - "subtype="
                              - =.Global.currentSubtype
                            dataOut: Global.scheduleScondition
                    - actionType: evalObject
                      object:
                        - .BaseDate.schedule.scheduleList.edge@: []

                    # - actionType: updateObject
                    #   dataKey: ProviderSchedule.visitReason.document
                    #   dataObject: []
                    # - actionType: updateObject
                    #   dataKey: ProviderSchedule.visitReason.doc.id
                    #   dataObject: []
                    - actionType: evalObject
                      object: 
                        .Global._nonce@: 
                          =.builtIn.math.random: ""
                    - .Global.jwt.edge.bvid@: =.Global.currentUser.vertex.id
                    - =.Global.jwt.edgeAPI.store: ""
                    - actionType: evalObject
                      object:
                        - =..schedule.get: ""
                        - ..schedule.edge.id@: []
                    - actionType: evalObject
                      object:           
                        - =.builtIn.date.splitTime:
                            dataIn:
                              object2: =..schedule.scheduleList.edge
                              timeSlot: =..formData.duration
                              year: =.BaseDate.calendarDate.year
                              month: =.BaseDate.calendarDate.month
                              day: =.BaseDate.calendarDate.day
                              isSplitCurrent: true
                            dataOut: ProviderSchedule.splitTime 
                        - =.builtIn.object.setObjectKey:
                            dataIn:
                              objectArr: =.ProviderSchedule.splitTime 
                              key: fontColor
                              value: "0x4b4b4b"
                            dataOut: ProviderSchedule.splitTime 
                        - =.builtIn.object.setObjectKey:
                            dataIn:
                              objectArr: =.ProviderSchedule.splitTime 
                              key: borColor
                              value: "0xebebeb"
                            dataOut: ProviderSchedule.splitTime
                        - ..formData.nextBtnColor@: "0xd3dde9"
                        - ..getLocation.vertex.id@: =..locationId
                        - =..getLocation.get: ""
                        - ..formData.locationAddress@: =..getLocation.response.vertex.0.name.basicInfo.location 
                    - actionType: builtIn
                      funcName: redraw
                      viewTag: create1
                    - actionType: popUp
                      popUpView: create1
                    - actionType: builtIn
                      funcName: redraw
                      viewTag: btnView
            - type: view
              style: 
                display: flex
                flexDirection: row
                alignItems: center
                width: 80vw
                marginLeft: 1vw
              children:
                - type: view
                  style: 
                    width: 20vw
                    height: "0.8"
                    display: flex
                    flexDirection: column
                  children:
                    - type: view
                      style:
                        width: 20vw
                        height: 9vw
                        display: flex
                        flexDirection: row
                        justifyContent: space-between
                      children:
                        - type: view 
                          style:
                            width: 9.5vw
                            height: 9vw
                            backgroundColor: "#ffffff"
                            display: flex
                            flexDirection: column
                            justifyContent: flex-start
                            alignItems: center
                          children:
                            - type: label
                              text: Telemedicine
                              style: 
                                marginTop: 2vw
                                fontSize: 1vw
                                color: '0x333333'
                                fontFamily: "Poppins"
                            - type: label
                              text: ..showArray.1
                              style:
                                color: "#30B354"
                                fontSize: 2.5vw
                                marginTop: 1vw
                                fontFamily: "Arial"
                        - type: view 
                          style:
                            width: 9.5vw
                            height: 9vw
                            backgroundColor: "#ffffff"
                            display: flex
                            flexDirection: column
                            justifyContent: flex-start
                            alignItems: center
                          children:
                            - type: label
                              text: Office Visit
                              style: 
                                marginTop: 2vw
                                fontSize: 1vw
                                color: '0x333333'
                                fontFamily: "Poppins"
                            - type: label
                              text: ..showArray.0
                              style:
                                color: '0xFED25A'
                                fontSize: 2.5vw
                                marginTop: 1vw
                                fontFamily: "Arial"
                    - type: view
                      style: 
                        width: 20vw
                        height: 35vw
                        marginTop: 1vw
                        backgroundColor: "0xffffff"
                        display: flex
                        flexDirection: column
                      children: 
                        - .Label1:
                          text: Appointment Request
                          style:
                            marginTop: 0.5vw
                            marginLeft: 1vw
                            fontSize: 1vw
                        - type: view
                          style:
                            width: 18vw
                            marginLeft: 1vw
                            marginTop: "0.5vw"
                            backgroundColor: "0xffffff"
                            display: flex
                            flexDirection: row
                          viewTag: appointmentLengthTag
                          children:
                            - .Label1:
                              dataKey: approveInMeeting.edgeResp.edge.length
                              style:
                                fontSize: 0.8vw
                                color: '#0063A8'
                            - .Label1:
                              text: pending request
                              style:
                                marginLeft: 0.3vw
                                color: '#0063A8'
                                fontSize: 0.8vw
                        - type: scrollView
                          viewTag: appointmentTag
                          style:
                            width: 18vw
                            marginLeft: 1vw
                            marginTop: 0.5vw
                            height: 30vw
                            overflow: scroll
                            backgroundColor: "0xffffff"
                          children:
                            - .BaseList:
                              # viewTag: appointmentTag
                              listObject: ..approveInMeeting.edgeResp.edge
                              style:
                                width: 18vw
                                height: 'auto'
                              children:
                                - .BaseListItem:
                                  style:
                                    width: 18vw
                                    height: 7vw
                                    marginTop: 0.5vw
                                    display: inline-block
                                    backgroundColor: '#F4F8FA'
                                    borderRadius: '10'
                                    # overflow: "hidden"
                                  onClick:
                                    - emit:
                                        dataKey: 
                                          var: itemObject
                                        actions:
                                          - ..profile.document.id@: $var.id
                                          # - ..visitQuestionnaire.docResponse.id@: $var.bvid
                                    - actionType: evalObject
                                      object:
                                        - =..profile.docAPI.get: ""
                                        - .Global.PatientProfile@: =..profile.docResponse.doc.0.name.data
                                    - goto: PatientDetail
                                  children:
                                    - .ViewRow:
                                      style:
                                        width: "17vw"
                                        height: '3vw'
                                        margin: "auto"
                                        marginTop: "1vw"
                                        # backgroundColor: white
                                        justifyContent: flex-start
                                      children:
                                        - type: image
                                          path=func: .builtIn.utils.prepareDocToPath
                                          dataKey: itemObject.name.patientAvatarId
                                          path: ava.png
                                          style:
                                            width: "3vw"
                                            height: "3vw"
                                            borderRadius: "1.5vw"
                                        - type: view
                                          style: 
                                            marginLeft: "0.5vw"
                                          children: 
                                            - type: label
                                              dataKey: itemObject.name.patientName
                                              style: 
                                                textDecoration: underline
                                                color: "#383459"
                                                fontFamily: "Poppins"
                                                fontSize: "1vw"
                                                maxWidth: "6vw"
                                                overflow: hidden
                                                whiteSpace: nowrap
                                                textOverflow: ellipsis
                                            - type: label
                                              dataKey: itemObject.name.Reason
                                              style:
                                                fontSize: "0.8vw"
                                        - type: image
                                          path:
                                            emit:
                                              dataKey:
                                                var: itemObject
                                              actions:                        
                                                - if:
                                                  - =.builtIn.string.equal:
                                                      dataIn:
                                                        string1: $var.name.visitType
                                                        string2: Telemedicine
                                                  - newtelemedicine.svg
                                                  - newofficeVisit.svg
                                          style:
                                            width: "1.2vw"
                                            height: "1.2vw"
                                            marginLeft: "0.8vw"
                                    - type: view
                                      style:
                                        width: "0.2"
                                        height: "0.03"
                                        top: "0.095"
                                        left: "0"
                                      children:
                                        - type: view
                                          style:
                                            marginLeft: "0.005"
                                            width: "0.06"
                                            display: inline-block 
                                            borderRight: "1px solid #999999"
                                          children:
                                            - type: image
                                              path: schedule.svg
                                              style:
                                                width: '0.01'
                                                marginLeft: "0.003"
                                                display: inline-block 
                                            - .Label1:
                                              text=func: .builtIn.string.formatUnixtimeL_en
                                              dataKey: itemObject.stime
                                              style:
                                                marginLeft: '0.003'
                                                color: '#333333'
                                                fontSize: "0.8vw"
                                                display: inline-block 
                                        # - type: view
                                        #   style:
                                        #     marginLeft: "0.005"
                                        #     width: "0.0008"
                                        #     height: "0.025"
                                        #     backgroundColor: "#999999"
                                        #     display: inline-block

                                        - type: view
                                          style:
                                            marginLeft: "0.002"
                                            width: "0.053"
                                            display: inline-block 
                                            borderRight: "1px solid #999999"
                                          children:
                                            - type: image
                                              path: history.svg
                                              style:
                                                width: '0.01'
                                                marginLeft: "0.003"
                                                display: inline-block 
                                            - .Label1:
                                              text=func: .builtIn.string.formatUnixtimeLT_en
                                              dataKey: itemObject.stime
                                              style:
                                                marginLeft: '0.003'
                                                color: '#333333'
                                                fontSize: "0.8vw"
                                                display: inline-block    
                                        # - type: view
                                        #   style:
                                        #     marginLeft: "0.005"
                                        #     width: "0.0008"
                                        #     height: "0.025"
                                        #     backgroundColor: "#999999"
                                        #     display: inline-block
                                        - type: view
                                          style:
                                            marginLeft: "0.002"
                                            width: "0.074"
                                            display: inline-block 
                                            # borderRight: "1px solid #999999"
                                          children:
                                            - type: image
                                              path: doctor.svg
                                              style:
                                                width: '0.01'
                                                marginLeft: "0.003"
                                                display: inline-block 
                                            - .Label1:
                                              dataKey: itemObject.name.providerName
                                              style:
                                                marginLeft: '0.003'
                                                color: '#333333'
                                                fontSize: 0.8vw
                                                display: inline-block
                                                overflow: hidden
                                                whiteSpace: nowrap
                                                textOverflow: ellipsis
                                    # - .ViewRow:
                                    #   style: 
                                    #     width: "6vw"
                                    #     left: "0.12"
                                    #     top: "0.005"
                                    #   children:
                                    #     - type: image
                                    #       path: changeApp.svg
                                    #       style:
                                    #         width: 2.8vw
                                    #       # onClick:
                                    #       #   - emit:
                                    #       #       dataKey:
                                    #       #         var: itemObject
                                    #       #       actions:
                                    #       #         - .Global.formData.currentRequest@: $var
                                    #       #         - goto: ChangeRequest
                                    #     - type: image
                                    #       path: cancelApp.svg
                                    #       style: 
                                    #         width: 2.8vw
                                    #       # onClick: 
                                    #       #   - emit:
                                    #       #       dataKey:
                                    #       #         var: itemObject
                                    #       #       actions:
                                    #       #         - ..apiRequest.cancelAppoint.edge.refid@: $var.id
                                    #       #         - ..apiRequest.cancelAppoint.edge.stime@: $var.stime
                                    #       #         - ..apiRequest.cancelAppoint.edge.etime@: $var.etime
                                    #       #         - ..apiRequest.cancelEmail.docReq.name.user@: $var.bvid
                                    #       #         - ..formData.roomInfo@: $var
                                    #       #         - ..profile.document.id@: $var.bvid
                                    #       #         - =..profile.docAPI.get: ""
                                    #       #   - actionType: popUp
                                    #       #     popUpView: cancelAppointmentTag
                                            
                - type: scrollView
                  viewTag: chartContent
                  style:
                    width: "61vw"
                    height: "0.8"
                    marginLeft: 1vw
                    backgroundColor: "0xffffff"
                    overflowY: scroll
                    isHidden: false
                  children: 
                    - type: chart
                      dataKey: formData.timeTable
                      viewTag: calenderTableView
                      # onClick: 
                      #   - actionType: evalObject
                      #     object: 
                      #       - .Global.formData.patientHistoryInfo.id@: =..formData.timeTable.response
                      #   - actionType: evalObject
                      #     object: 
                      #       - if:
                      #         - =..formData.timeTable.response
                      #         - goto: PatientSummary 
                      #         - continue
                        
                      style:
                        width: 58vw
                        height: 37vw
                        left: "0"
                        top: "0"
                
                 
        - .BasePopUp:
          viewTag: Contacts
          style: 
            width: "1"
            height: "1"
            zIndex: "1000"
            backgroundColor: "0x00000040"
            top: 0
          children:
            - type: view
              style: 
                width: '0.4'
                height: "1"
                float: right
                backgroundColor: "0xffffff"
              children:
                - type: view
                  style:
                    width: '0.4'
                    height: 4vw
                    backgroundColor: '#005795'
                    display: flex
                    flexDirection: row
                    justifyContent: space-between
                    alignItems: center
                  children:
                    - type: label
                      text: 'Invite'
                      style:
                        fontSize: '2vh'
                        left: '0.03'
                        top: '0'
                        height: "0.08"
                        color: '0xffffff'
                        # fontWeight: '500' 
                        textAlign: 
                          y: center
                    - type: image
                      path: closeButton.svg
                      style:
                        width: '0.012'
                        left: '0.36'
                        top: '0.024'
                      onClick:
                        - actionType: popUpDismiss
                          popUpView: Contacts     
                - type: view
                  style:
                    height: "0.92"
                    width: '0.4'
                    marginTop: 0
                    backgroundColor: '0xffffff'
                    display: flex
                    flexDirection: column
                    alignItems: center
                  viewTag: ContactsTag
                  children:
                    # - .QuestionViewRow:
                    #   style: 
                    #     width: 30vw
                    #     marginTop: 1vw
                    #     height: 2vw
                    #     border: 
                    #       style: "3"
                    #     borderWidth: "1"
                    #     borderColor: "0xbbbbbb"
                    #     borderRadius: "10" 
                    #     alignItems: center
                    #   children: 
                    #     - type: textField
                    #       placeholder: Search
                    #       style: 
                    #         left: 0.7vw
                    #         width: 20vw
                    #         height: 1.9vw
                    #         fontSize: 1vw
                    #         border: 
                    #           style: "1"
                    #     - type: button
                    #       text: Search
                    #       style: 
                    #         marginLeft: 4vw
                    #         width: 6vw
                    #         height: 2vw
                    #         fontSize: 1vw
                    #         color: "0xffffff"
                    #         backgroundColor: "0x2988e6"
                    #         border: 
                    #           style: "3"
                    #         borderWidth: "1"
                    #         borderColor: "0x2988e6"
                    #         borderRadius: "10"
                    
                    - type: label
                      text: Patient List
                      style: 
                        marginTop: 1vw
                        width: 30vw
                        height: 2vw
                        fontSize: 1vw
                        fontFamily: sans-serif
                        fontWeight: "500"
                        textAlign: 
                          x: left
                    - type: scrollView
                      style:
                        width: 30vw
                        height: 30vw
                        marginTop: 1vw
                        display: flex
                        margin: "0"
                      children:
                        - .BaseList:
                          listObject: ..patient.list.doc
                          style:
                            width: 30vw
                            display: flex
                            margin: "0"
                          children:
                            - .BaseListItem:
                              style:
                                height: 2vw
                                width: 30vw
                                marginTop: 0
                                display: inline-block
                                border: 
                                  style: "2"
                                borderWidth: "1"
                                borderColor: "0xbbbbbb"
                              onClick:
                                - emit:
                                    dataKey:
                                      var: itemObject
                                    actions:
                                      - ..newAppointment.edge.evid@: $var.bsig
                                      - ..newAppointment.edge.name.patientName@: $var.name.data.basicInfo.fullName
                                      - ..newAppointment.edge.name.patientPhoneNumber@: $var.name.data.basicInfo.phone
                                      - ..newAppointment.edge.name.patientAvatarId@: $var.name.data.basicInfo.avatar
                                      - ..newAppointment.edge.name.visitReason@: =.ProviderSchedule.selectData.reason
                                      - ..formData.patientDoc@: $var
                                - actionType: popUpDismiss
                                  popUpView: Contacts
                                - actionType: builtIn
                                  funcName: redraw
                                  viewTag: Details
                                - actionType: popUp
                                  popUpView: Details
                              children:
                                - .QuestionViewRow:
                                  style:
                                    width: 30vw
                                    height: 2vw
                                  children:
                                    - .QuestionAnswer:
                                      dataKey: itemObject.name.data.basicInfo.fullName
                                      style: 
                                        width: 15vw
                                        marginLeft: 4vw
                                        height: 2vw
                                        textAlign:
                                          y: center
                                        fontSize: 0.8vw
                                    - .QuestionAnswer:
                                      text=func: .builtIn.string.formatUnixtimeL_en
                                      dataKey: itemObject.ctime
                                      style:
                                        marginLeft: 1vw
                                        height: 2vw
                                        textAlign:
                                          y: center
                                        fontSize: 0.8vw
                      
        - .BasePopUp:
          viewTag: Details
          style: 
            top: 0
            width: "1"
            height: "1"
            zIndex: "1000"
            backgroundColor: "0x00000040"
          children:
            - type: view
              style:
                width: '0.4'
                height: "1"
                float: right
                backgroundColor: "0xffffff"
              children:
                - type: view
                  style:
                    width: '0.4'
                    height: 4vw
                    backgroundColor: '#005795'
                    display: flex
                    flexDirection: row
                    justifyContent: space-between
                    alignItems: center
                  children:
                    - type: label
                      text: 'Create an Appointment'
                      style:
                        fontSize: '2vh'
                        left: '0.03'
                        top: '0'
                        height: "0.08"
                        color: '0xffffff'
                        # fontWeight: '500' 
                        textAlign: 
                          y: center
                    - type: image
                      path: closeButton.svg
                      style:
                        width: '0.012'
                        left: '0.36'
                        top: '0.024'
                      onClick:
                        - actionType: popUpDismiss
                          popUpView: Details
                - type: view
                  style:
                    height: "0.92"
                    width: '0.4'
                    top: '0.08'
                    backgroundColor: '0xffffff'
                  children:
                    - type: view
                      style:
                        width: '0.4'
                        marginTop: '0'
                        backgroundColor: '#ffffff'
                      children:
                        - type: view
                          style:
                            marginTop: '0.03'
                            left: "0.05"
                            display: flex
                            justifyContent: space-between
                            alignItems: center
                            width: "0.3"
                          children: 
                            - type: label
                              text: Date & Time
                              style:
                                color: '#000000'
                                fontSize: .Nfont.nf5
                                fontWeight: "700"
                            - type: label
                              dataKey: appointmentTime
                              style:
                                fontSize: '18'
                                color: '#000000'
                                textAlign:
                                  x: center
                        - type: view
                          style:
                            marginTop: "0.02"
                            left: "0.05"
                            width: "0.3"
                            height: "0.2"
                            backgroundColor: "0xf7f9fa"
                            border: 
                              style: '3'
                            borderColor: "0xf7f9fa"
                            boxSizing: border-box
                          children:
                            - .QuestionViewRow:
                              style: 
                                justifyContent: space-between
                                alignItems: center
                                marginTop: "0.015"
                                width: "0.22"
                              children:
                              - .QuestionTitle:
                                text: Type
                              - .QuestionAnswer: 
                                dataKey: newAppointment.edge.name.visitType
                            - .QuestionViewRow:
                              style: 
                                justifyContent: space-between
                                alignItems: center
                                marginTop: "0.015"
                                width: "0.22"
                              children:
                                - .QuestionTitle:
                                  text: Reason for Visit
                                - .QuestionAnswer:
                                  dataKey: selectData.reason
                            - .QuestionViewRow:
                              style: 
                                justifyContent: space-between
                                alignItems: center
                                marginTop: "0.015"
                                width: "0.22"
                              children:
                                - .QuestionTitle:
                                  text: Duration
                                - .QuestionAnswer:
                                  dataKey: selectData.duration
                                # -
                                # - .ProviderScheduleText: 
                                #   text: Notes
                                #   style: 
                                #     top: "0.15"
                                # - .ProviderScheduleDatakey: 
                                #   dataKey: selectData.reason
                                #   style: 
                                #     top: "0.15"
                            
                            - type: button
                              text: "Change Details"
                              onClick:
                                - actionType: popUpDismiss
                                  popUpView: Details
                                - actionType: popUp
                                  popUpView: create1
                              style:
                                left: "0.09"
                                height: "0.035"
                                top: "0.23"
                                width: "0.1"
                                fontSize: .Nfont.h0_1
                                borderWidth: "3"
                                border: 
                                  style: "3"
                                  color: "#005795"
                                backgroundColor: "#ffffff"
                                color: "#005795"
                                textAlign: 
                                  x: center
                                  y: center
                    - type: view
                      style:
                        height: '0.48'
                        width: '0.35'
                        marginTop: '0.13'
                        left: '0.05'
                      children:
                        - .QuestionViewRow: 
                          style: 
                            width: '0.3'
                            marginTop: 0.5vw
                            alignItems: center
                            justifyContent: space-between
                            marginLeft: 0
                          children:
                            - type: label
                              text: Add Patient
                              style:
                                fontSize: .Nfont.h2
                                color: '#000000'
                                fontWeight: "700"
                                width: '0.2'
                            - type: button
                              text: "Patient List"
                              onClick: 
                                - actionType: popUpDismiss
                                  popUpView: Details
                                - actionType: popUp
                                  popUpView: Contacts
                              style:
                                height: 1.5vw
                                width: 7vw
                                fontSize: 0.9vw
                                # borderWidth: 1px
                                # borderColor: "#005795"
                                color: "#005795"
                                backgroundColor: "#ffffff"
                                textAlign: 
                                  x: center
                                  y: center

                        - type: divider
                          style:
                            marginTop: 0.5vw
                            width: 30vw
                            height: 0.1vw
                            backgroundColor: "#333333"
                        - .QuestionViewColumn: 
                          style:
                            marginTop: 1vw
                            width: 24vw
                            justifyContent: flex-start
                            marginLeft: 0
                          children:
                            - .QuestionViewColumn:
                              style: 
                                width: "0.3"
                                marginLeft: 0
                              children:
                                - .QuestionTitle:
                                  text: Patient Name
                                - .TextField1:
                                  placeholder: 'Enter Here' 
                                  dataKey: newAppointment.edge.name.patientName
                                  style:
                                    height: 2vw
                                    width: "0.3"
                                    marginTop: 0.3vw
                                    fontSize: 0.9vw
                                    borderRadius: "5"
                            - .QuestionViewColumn:
                              style: 
                                width: "0.3"
                                marginLeft: 0
                              children:
                                - .QuestionTitle:
                                  text: 'Phone Number'
                                - .TextField1:
                                  placeholder: 'Enter Here' 
                                  dataKey: newAppointment.edge.name.patientPhoneNumber
                                  style:
                                    height: 2vw
                                    width: "0.3"
                                    marginTop: 0.3vw
                                    fontSize: 0.9vw
                                    borderRadius: "5"
                        - type: button
                          text: "Create Appointment"
                          onClick:
                            - actionType: evalObject
                              object:
                                - if:
                                  - =.builtIn.string.equal: 
                                      dataIn: 
                                        string1: =..newAppointment.edge.name.patientName
                                        string2: ""
                                  - actionType: popUp
                                    popUpView: judgePatient
                                    wait: true
                                  - continue
                                - ..newAppointment.edge.name.Reason@: =..selectData.reason
                                - ..newAppointment.edge.name.duration@: =..formData.duration
                                - ..newAppointment.edge.name.document@: =..selectData.document
                                - if:
                                  - =.builtIn.string.equal: 
                                      dataIn: 
                                        string1: =..newAppointment.edge.name.visitType
                                        string2: "Telemedicine"
                                  - ..newAppointment.edge.name.blockColor@: "0xe4f5e9" 
                                  - actionType: evalObject
                                    object:
                                      - ..newAppointment.edge.name.blockColor@: "0xfff7e3" 
                                      - ..newAppointment.edge.name.locationName@: =..formDataOfficeVisisAddress
                                - if:
                                  - =.builtIn.string.equal: 
                                      dataIn: 
                                        string1: =..newAppointment.edge.name.visitType
                                        string2: "Telemedicine"
                                  - ..newAppointment.edge.name.fontColor@: "0x30b354" 
                                  - ..newAppointment.edge.name.fontColor@: "0xffc02d" 
                                - ..newAppointment.edge.name.facilityId@: =.Global.currentFacility.id
                                - ..newAppointment.edge.name.location@: =..formData.locationAddress
                                - ..newAppointment.edge.name.locationName@: =..formDataOfficeVisisAddress
                                - ..newAppointment.edge.name.providerId@: =.Global.currentUser.vertex.id
                                - ..newAppointment.edge.name.providerAvatarId@: =.Global.MyProfile.name.data.avatar
                                - =.builtIn.string.concat:
                                    dataIn:
                                      - =..newAppointment.edge.name.providerName
                                      - " - "
                                      - =.Global.MyProfile.name.data.selectedSpecialty.0
                                    dataOut: ProviderSchedule.formData.providerFullInfo
                                - .ProviderSchedule.newAppointment.edge.name.providerFullInfo@: =..formData.providerFullInfo
                                - .Global.jwt.edge.bvid@: =..newAppointment.edge.bvid
                                - =.Global.jwt.edgeAPI.store: ""
                                - =..newAppointment.edgeAPI.store: ""
                                - ..formData.appointmentInfo.name.patientName@: =..newAppointment.response.edge.name.patientName
                            # patient同意provider
                            - actionType: evalObject
                              object:
                                - ..approveAppointment.edge.evid@: =..newAppointment.response.edge.evid
                                - ..approveAppointment.edge.bvid@: =..newAppointment.response.edge.bvid
                                - ..approveAppointment.edge.name@: =..newAppointment.response.edge.name
                                - ..approveAppointment.edge.refid@: =..newAppointment.response.edge.id
                                - ..approveAppointment.edge.stime@: =..newAppointment.response.edge.stime
                                - ..approveAppointment.edge.etime@: =..newAppointment.response.edge.etime
                                - =..approveAppointment.edgeAPI.store: ""
                                
                                - ..approveAppointment10.edge.stime@: =..newAppointment.response.edge.stime
                                - ..approveAppointment10.edge.etime@: =..newAppointment.response.edge.etime
                                - ..approveAppointment10.edge.bvid@: =..newAppointment.response.edge.evid
                                - ..approveAppointment10.edge.evid@: =.Global.currentFacility.id
                                - ..approveAppointment10.edge.refid@: =..newAppointment.response.edge.id
                                - =..approveAppointment10.edgeAPI.store: ""
                                # 切patient的jwt
                                - .Global.jwt.edge.bvid@: =..newAppointment.response.edge.evid
                                - =.Global.jwt.edgeAPI.store: ""
                                - ..isContact1.edge.bvid@: =..newAppointment.response.edge.evid
                                - ..isContact1.edge.evid@: =.Global.currentFacility.id
                                - ..isContact1.getedge.id@: []
                                - =.builtIn.array.add:
                                    dataIn:
                                      object: =..isContact1.getedge.id
                                      value: =.Global.currentFacility.id 
                                - =.builtIn.array.add:
                                    dataIn:
                                      object: =..isContact1.getedge.id
                                      value: =..newAppointment.response.edge.evid #patient id  
                                - =..isContact1.edgeAPI.get: ""
                                - if:
                                  - =..isContact1.getresponse.edge.0.id
                                  - ..isContact1.response@: ""
                                  - actionType: evalObject
                                    object:
                                      - =..isContact1.edgeAPI.store: ""
                                      - ..formData.shareDocId@: =..isContact1.response.edge.id
                                      - ..isContact1.getresponse@: ""   
                                      # share patient profile  
                                      - =.builtIn.ecos.shareDoc: 
                                          dataIn:                
                                            sourceDoc: =..formData.patientDoc
                                            targetEdgeID: =..formData.shareDocId
                                      # - .Global.jwt.edge.bvid@: =..newAppointment.response.edge.bvid
                                      # - =.Global.jwt.edgeAPI.store: ""
                                                   # 创建关联预约的tag
                                # 创建完预约之后打 appointment link 的tag,回头需要加判断
                            - actionType: evalObject
                              object:
                                # fid 指向 房间
                                - ..formData.appointmentLink.eid@: =..newAppointment.response.edge.id
                                - ..formData.appointmentLink.fid@: ""
                                - ..formData.appointmentLink.reid@: =..newAppointment.response.edge.id
                                # 创建 tag
                                - =..apiRequest.appointmentListTag.docAPI.store: ""
                            - actionType: popUpDismiss
                              popUpView: Details
                            - actionType: builtIn
                              funcName: redraw  
                              viewTag: PatientNameTag
                            - actionType: popUp
                              popUpView: inviteSuccess
                          style:
                            marginTop: 5vw
                            left: "0.08"
                            height: "0.043"
                            width: 14vw
                            fontSize: 1vw
                            backgroundColor: "#005795"
                            borderRadius: "5"
                            border: 
                              style: "6"
                            color: "#ffffff"
                            textAlign: 
                              x: center  
    
        - .BasePopUp:
          viewTag: inviteSuccess
          style: 
            width: "1"
            height: "1"
            zIndex: "1000"
            backgroundColor: "0x00000040"
            top: 0
          children:
            - type: view
              style: 
                width: '0.4'
                height: "1"
                float: right
                backgroundColor: "0xffffff"
              children:
                - type: view
                  style:
                    width: '0.4'
                    height: 4vw
                    backgroundColor: '#005795'
                    display: flex
                    flexDirection: row
                    justifyContent: space-between
                    alignItems: center
                  children:
                    - type: label
                      text: 'Appointment Details'
                      style:
                        fontSize: '2vh'
                        left: '0.03'
                        top: '0'
                        height: "0.08"
                        color: '0xffffff'
                        # fontWeight: '500' 
                        textAlign: 
                          y: center
                    - type: image
                      path: closeButton.svg
                      style:
                        width: '0.012'
                        left: '0.36'
                        top: '0.024'
                      onClick:
                        - actionType: popUpDismiss
                          popUpView: inviteSuccess
            - type: view
              style:
                height: "0.92"
                width: '0.4'
                float: right
                marginTop: 4.5vw
                left: 40vw
                backgroundColor: '0xffffff'
                display: flex
                flexDirection: column
                alignItems: center
                justifyContent: space-around
              children:
                - type: image
                  path: successCheck.png
                  style:
                    width: 10vw
                - type: label
                  text: 'Success!'
                  style:
                    fontSize: 2vw
                - type: label
                  text: 'The appointment invitation has been sent to'
                  style:
                    fontSize: 1.2vw
                - type: label
                  viewTag: PatientNameTag
                  dataKey: formData.appointmentInfo.name.patientName
                  style:
                    fontSize: 1.2vw
                - type: button
                  text: 'Done'
                  style:
                    width: "0.12"
                    height: 2.5vw
                    borderRadius: 5px
                    backgroundColor: '#005795'
                    color: '0xffffff'
                    fontSize: 1.2vw
                  onClick:
                    - actionType: evalObject
                      object: 
                        .Global._nonce@: 
                          =.builtIn.math.random: ""
                    - actionType: evalObject
                      object:   
                        - ..appointment.list.edge@: []
                        - ..appointment.edge.id@: =..formData.providerId
                    - actionType: evalObject
                      object:
                        .Global._nonce@:
                          =.builtIn.math.random: ""
                    - actionType: evalObject
                      object: 
                        - =..appointment.edgeAPI.get: ""
                        - =.builtIn.array.getListLength:
                            dataIn:
                              object: =..appointment.list.edge
                            dataOut: ProviderSchedule.formData.appointmentLength
                        - =.builtIn.search.ComputeObjectFieldCount:
                            dataIn:
                              objArr: =..approveInMeeting.edgeResp.edge
                              strOne: 131078
                              strTwo: 196614
                            dataOut: ProviderSchedule.showArray
                        - ..appointment.list.edge@: []
                        - =..appointment.edgeAPI.get: ""
                        - =.builtIn.goto:
                            dataIn:
                              destination: ProviderSchedule
                              pageReload: true
                    - actionType: builtIn
                      funcName: redraw
                      viewTag: appointmentTag
                    - actionType: builtIn
                      funcName: redraw
                      viewTag: appointmentLengthTag
                    - actionType: popUpDismiss
                      popUpView: inviteSuccess
                    # - goto: ProviderSchedule          
        
        - .BasePopUp:
          style:
            top: 0
            width: "1"
            height: "1"
            zIndex: "1000"
            backgroundColor: "0x00000040"
          viewTag: create1
          children:
            - type: view
              style: 
                width: '0.4'
                height: "1"
                float: right
                backgroundColor: "0xffffff"
              children:
                - type: view
                  style:
                    width: '0.4'
                    height: 4vw
                    backgroundColor: '#005795'
                    display: flex
                    flexDirection: row
                    justifyContent: space-between
                    alignItems: center
                  children:
                    - type: label
                      text: 'Create an Appointment'
                      style:
                        fontSize: '2vh'
                        left: '0.03'
                        top: '0'
                        height: "0.08"
                        color: '0xffffff'
                        # fontWeight: '500' 
                        textAlign: 
                          y: center
                    - type: image
                      path: closeButton.svg
                      style:
                        width: '0.012'
                        left: '0.36'
                        top: '0.024'
                      onClick:
                        - actionType: popUpDismiss
                          popUpView: create1
                        - actionType: builtIn
                          funcName: hide
                          viewTag: addressView
                        
                - type: view
                  style:
                    height: "0.92"
                    width: '0.4'
                    marginTop: 0
                    backgroundColor: '0xffffff'
                    display: flex
                    flexDirection: column
                  viewTag: DataTag
                  children:
                    - type: label
                      text: Please complete the fields below
                      style:
                        marginLeft: 5.5vw
                        marginTop: 1vw
                        fontSize: .Nfont.h1
                        color: '#333333'
                        fontWeight: 600
                    - type: view
                      style:
                        width: "0.4"
                        height: auto
                      children:
                        - .QuestionViewRow: 
                          style: 
                            width: "0.3"
                          children:
                            - .QuestionViewColumn:
                              style: 
                                width: 9vw
                              children:
                                - type: label
                                  text: Provider
                                  style:
                                    fontSize: 0.8vw
                                    fontWeight: 550
                                - .TextField1:
                                  dataKey: Global.MyProfile.name.data.fullName
                                  isEditable: "true"
                                  style:
                                    width: 9vw
                                    height: 2vw
                                    marginTop: 0.5vw
                                    fontSize: 0.8vw
                                    backgroundColor: "0xffffff"
                                    borderRadius: 5px
                            - .QuestionViewColumn:
                              style: 
                                marginLeft: 1vw
                                width: 9vw
                              children:
                                - type: label
                                  text: Type
                                  style:
                                    fontSize: 0.8vw
                                    fontWeight: 550
                                - type: select
                                  options: 
                                    - "Telemedicine"
                                    - "Office Visit"
                                  dataKey: visitType
                                  onChange:
                                    - actionType: evalObject
                                      object:
                                        - if: 
                                          - =.builtIn.string.equal:
                                              dataIn:
                                                string1: =..visitType
                                                string2: 'Telemedicine'
                                          - actionType: builtIn
                                            funcName: hide
                                            viewTag: addressView
                                          - actionType: builtIn
                                            funcName: show
                                            viewTag: addressView
                                        - if: 
                                          - =.builtIn.string.equal:
                                              dataIn:
                                                string1: =..visitType
                                                string2: 'Telemedicine'
                                          - actionType: evalObject
                                            object:
                                              - .ProviderSchedule.formData.currentSubtype@: '196609'
                                              - .Global.currentSubtype@: 196609
                                              - .Global.visitType@: "Telemedicine"
                                              - ..newAppointment.edge.name.visitType@: "Telemedicine"
                                              - ..newAppointment.edge.name.visitTypeShow@: "Telemedicine"
                                              - ..newAppointment.edge.subtype: "131074"  # 0x20002 表示类型为telemedicine
                                              - .Global.jwt.edge.bvid@: =.Global.currentUser.vertex.id
                                              - ..schedule.edge.id.0@: =.Global.currentFacility.id
                                              - ..getLocation.vertex.id@: =..locationId
                                              - =..getLocation.get: ""
                                              - ..formData.locationAddress@: =..getLocation.response.vertex.0.name.basicInfo.location
                                          - continue
                                        - if: 
                                          - =.builtIn.string.equal:
                                              dataIn:
                                                string1: =..visitType
                                                string2: 'Office Visit'
                                          - actionType: evalObject
                                            object:
                                              - .ProviderSchedule.formData.currentSubtype@: 131073
                                              - .Global.currentSubtype@: '131073'
                                              - .Global.visitType@: "Office Visit"
                                              - ..newAppointment.edge.name.visitType@: "Office Visit"
                                              - ..newAppointment.edge.name.visitTypeShow@: "Office Visit"
                                              - ..newAppointment.edge.subtype: "196610"  # 0x30002 表示类型为office visit
                                              - .Global.jwt.edge.bvid@: =.Global.currentUser.vertex.id
                                              - ..schedule.edge.id.0@: =..locationId
                                              - ..getLocation.vertex.id@: =..locationId
                                              - =..getLocation.get: ""
                                              - ..formData.locationAddress@: =..getLocation.response.vertex.0.name.basicInfo.location
                                          - continue
                                    - actionType: evalObject
                                      object: 
                                        - if:
                                          - =.builtIn.string.equal:
                                              dataIn:
                                                string1: =..visitType
                                                string2: "Telemedicine"
                                          - actionType: evalObject
                                            object: 
                                              - =.builtIn.array.convertToList:
                                                  dataIn:
                                                    array: =..visitReason.document.name.data.reasonForVisit.Telemedicine
                                                    key: reason
                                                  dataOut: ProviderSchedule.reasonForVisit
                                              - =.builtIn.array.getByKey:
                                                  dataIn:
                                                    array: =..visitReason.document.name.data.reasonForVisit.Telemedicine
                                                    key1: reason
                                                    value: =..reasonForVisit.0
                                                    key2: duration
                                                  dataOut: ProviderSchedule.selectData.duration
                                              - =.builtIn.array.getByKey:
                                                  dataIn:
                                                    array: =..visitReason.document.name.data.reasonForVisit.Telemedicine
                                                    key1: reason
                                                    value: =..reasonForVisit.0
                                                    key2: fee
                                                  dataOut: ProviderSchedule.selectData.fee    
                                              - .ProviderSchedule.selectData.document@: =..visitReason.document.name.data.reasonForVisit.Telemedicine.0.document
                                          - continue
                                    - actionType: evalObject
                                      object: 
                                        - if:
                                          - =.builtIn.string.equal:
                                              dataIn:
                                                string1: =..visitType
                                                string2: "Office Visit"
                                          - actionType: evalObject
                                            object: 
                                              - =.builtIn.array.convertToList:
                                                  dataIn:
                                                    array: =..visitReason.document.name.data.reasonForVisit.OfficeVisits
                                                    key: reason
                                                  dataOut: ProviderSchedule.reasonForVisit
                                              - =.builtIn.array.getByKey:
                                                  dataIn:
                                                    array: =..visitReason.document.name.data.reasonForVisit.OfficeVisits
                                                    key1: reason
                                                    value: =..reasonForVisit.0
                                                    key2: duration
                                                  dataOut: ProviderSchedule.selectData.duration
                                              - =.builtIn.array.getByKey:
                                                  dataIn:
                                                    array: =..visitReason.document.name.data.reasonForVisit.OfficeVisits
                                                    key1: reason
                                                    value: =..reasonForVisit.0
                                                    key2: fee
                                                  dataOut: ProviderSchedule.selectData.fee
                                              - .ProviderSchedule.selectData.document@: =..visitReason.document.name.data.reasonForVisit.OfficeVisits.0.document
                                          - continue
                                    - actionType: evalObject
                                      object:
                                        - .BaseDate.schedule.scheduleList.edge@: []
                                        - ..splitTime@: [] 
                                    - actionType: updateObject
                                      dataKey: ProviderSchedule.schedule.scheduleList.edge
                                      dataObject: []  
                                    - =.Global.jwt.edgeAPI.store: ""
                                    - actionType: evalObject
                                      object:
                                        - ..schedule.edge.id.1@: =.Global.currentUser.vertex.id
                                        - =.builtIn.string.concat:
                                            dataIn:
                                              - "(stime<"
                                              - =.BaseDate.calendarDate.todayStamp.start
                                              - " AND "
                                              - "etime>"
                                              - =.BaseDate.calendarDate.todayStamp.start
                                              - " OR "
                                              - "stime>"
                                              - =.BaseDate.calendarDate.todayStamp.start
                                              - " AND "
                                              - "etime<"
                                              - =.BaseDate.calendarDate.todayStamp.end
                                              - " OR "
                                              - "stime<"
                                              - =.BaseDate.calendarDate.todayStamp.end
                                              - " AND "
                                              - "etime>"
                                              - =.BaseDate.calendarDate.todayStamp.end
                                              - ")"
                                              - " AND "
                                              - "subtype="
                                              - =.Global.currentSubtype
                                              # - " AND "
                                              # - "name like '%"
                                              # - =..selectData.reason
                                              # - "%'"
                                            dataOut: Global.scheduleScondition
                                    - actionType: evalObject
                                      object: 
                                        .Global._nonce@: 
                                          =.builtIn.math.random: ""
                                    - actionType: evalObject
                                      object:
                                        - =..schedule.get: ""
                                        - ..schedule.edge.id@: []
                                    - actionType: evalObject
                                      object: 
                                        - if: 
                                          - ..schedule.scheduleList.edge.0
                                          - =.builtIn.date.splitTime:
                                              dataIn:
                                                object2: =..schedule.scheduleList.edge
                                                timeSlot: =..formData.duration
                                                year: =.BaseDate.calendarDate.year
                                                month: =.BaseDate.calendarDate.month
                                                day: =.BaseDate.calendarDate.day
                                                isSplitCurrent: true
                                              dataOut: ProviderSchedule.splitTime 
                                          - ..splitTime@: [] 
                                        - =.builtIn.object.setObjectKey:
                                            dataIn:
                                              objectArr: =.ProviderSchedule.splitTime 
                                              key: fontColor
                                              value: "0x4b4b4b"
                                            dataOut: ProviderSchedule.splitTime 
                                        - =.builtIn.object.setObjectKey:
                                            dataIn:
                                              objectArr: =.ProviderSchedule.splitTime 
                                              key: borColor
                                              value: "0xebebeb"
                                            dataOut: ProviderSchedule.splitTime
                                        - ..formData.nextBtnColor@: "0xd3dde9"
                                    - actionType: builtIn
                                      funcName: redraw
                                      viewTag: btnView
                                    - actionType: builtIn
                                      funcName: redraw
                                      viewTag: calendarTag
                                    - actionType: builtIn
                                      funcName: redraw
                                      viewTag: splitTimeTag
                                    - actionType: builtIn
                                      funcName: redraw
                                      viewTag: reasonTag
                                  style:
                                    marginTop: 0.5vw
                                    fontSize: 0.8vw
                                    borderColor: "#EAEAEA" 
                                    borderWidth: 1px
                                    width: 9vw
                                    height: 2.5vw
                                    textIndent: 10px
                                    borderRadius: 5px
                            - .QuestionViewColumn:
                              viewTag: addressView
                              style: 
                                display: none
                                marginLeft: "1vw"
                                width: 9vw
                              children: 
                                - type: label
                                  text: Address
                                  style: 
                                    fontSize: 0.8vw
                                    fontWeight: 550
                                - type: select
                                  dataKey: formDataOfficeVisisAddress
                                  options:
                                    ..addressName
                                  onChange:
                                    - actionType: evalObject
                                      object: 
                                        - =.builtIn.array.matchInArray:
                                            dataIn:
                                              arr: =.Global.locationAll
                                              value: =..formDataOfficeVisisAddress
                                              key: medicalFacilityName
                                              key1: "id"
                                            dataOut: ProviderSchedule.locationId
                                        - =.builtIn.string.concat:
                                            dataIn:
                                              - "(stime<"
                                              - =.BaseDate.calendarDate.todayStamp.start
                                              - " AND "
                                              - "etime>"
                                              - =.BaseDate.calendarDate.todayStamp.start
                                              - " OR "
                                              - "stime>"
                                              - =.BaseDate.calendarDate.todayStamp.start
                                              - " AND "
                                              - "etime<"
                                              - =.BaseDate.calendarDate.todayStamp.end
                                              - " OR "
                                              - "stime<"
                                              - =.BaseDate.calendarDate.todayStamp.end
                                              - " AND "
                                              - "etime>"
                                              - =.BaseDate.calendarDate.todayStamp.end
                                              - ")"
                                              - " AND "
                                              - "subtype="
                                              - =.Global.currentSubtype
                                              # - " AND "
                                              # - "name like '%"
                                              # - =..selectData.reason
                                              # - "%'"
                                            dataOut: Global.scheduleScondition
                                    - actionType: evalObject
                                      object: 
                                        .Global._nonce@: 
                                          =.builtIn.math.random: ""
                                    - actionType: evalObject
                                      object:
                                        - .BaseDate.schedule.scheduleList.edge@: []
                                        - ..splitTime@: [] 
                                        - ..schedule.edge.id@: []
                                    - actionType: updateObject
                                      dataKey: ProviderSchedule.schedule.scheduleList.edge
                                      dataObject: []  
                                    - actionType: evalObject
                                      object:
                                        - =.builtIn.array.add:
                                            dataIn:
                                              object: =..schedule.edge.id
                                              value: =..locationId
                                        - .Global.jwt.edge.bvid@: =..locationId
                                        - =.Global.jwt.edgeAPI.store: ""
                                        - =.builtIn.array.add:
                                            dataIn:
                                              object: =..schedule.edge.id
                                              value: =.Global.currentUser.vertex.id
                                    - actionType: evalObject
                                      object:
                                        - =..schedule.get: ""
                                        - ..schedule.edge.id@: []
                                    - actionType: evalObject
                                      object: 
                                        - if: 
                                          - ..schedule.scheduleList.edge.0
                                          - =.builtIn.date.splitTime:
                                              dataIn:
                                                object2: =..schedule.scheduleList.edge
                                                timeSlot: =..formData.duration
                                                year: =.BaseDate.calendarDate.year
                                                month: =.BaseDate.calendarDate.month
                                                day: =.BaseDate.calendarDate.day
                                                isSplitCurrent: true
                                              dataOut: ProviderSchedule.splitTime 
                                          - ..splitTime@: [] 
                                        - =.builtIn.object.setObjectKey:
                                            dataIn:
                                              objectArr: =.ProviderSchedule.splitTime 
                                              key: fontColor
                                              value: "0x4b4b4b"
                                            dataOut: ProviderSchedule.splitTime 
                                        - =.builtIn.object.setObjectKey:
                                            dataIn:
                                              objectArr: =.ProviderSchedule.splitTime 
                                              key: borColor
                                              value: "0xebebeb"
                                            dataOut: ProviderSchedule.splitTime
                                        - ..formData.nextBtnColor@: "0xd3dde9"
                                        - ..getLocation.vertex.id@: =..locationId
                                        - =..getLocation.get: ""
                                        - ..formData.locationAddress@: =..getLocation.response.vertex.0.name.basicInfo.location
                                    - actionType: builtIn
                                      funcName: redraw
                                      viewTag: btnView
                                    - actionType: builtIn
                                      funcName: redraw
                                      viewTag: calendarTag
                                    # - actionType: builtIn
                                    #   funcName: redraw
                                    #   viewTag: DataTag
                                    - actionType: builtIn
                                      funcName: redraw
                                      viewTag: splitTimeTag
                                  style: 
                                    marginTop: 0.5vw
                                    fontSize: 0.8vw
                                    borderColor: "#EAEAEA" 
                                    borderWidth: 1px
                                    width: 9vw
                                    height: 2.5vw
                                    textIndent: 10px
                                    marginleft: 0.5vw
                                    borderRadius: 5px
                        - .QuestionViewRow: 
                          viewTag: reasonTag
                          style: 
                            width: "0.3"
                          children:
                            - .QuestionViewColumn:
                              children:
                                - type: label
                                  text: Reason for visit(notes)
                                  style:
                                    fontSize: 0.8vw     
                                    fontWeight: 550
                                - type: select
                                  dataKey: selectData.reason
                                  options:
                                    ..reasonForVisit
                                  style:
                                    fontSize: 0.8vw
                                    marginTop: 0.5vw
                                    borderWidth: "1px"
                                    borderColor: "#EAEAEA" 
                                    width: 12vw
                                    height: 2.5vw
                                    textIndent: 10px
                                    backgroundColor: "0xffffff"
                                    borderRadius: 5px
                                  onChange:
                                    - actionType: evalObject
                                      object: 
                                        - if:
                                          - =.builtIn.string.equal:
                                              dataIn:
                                                string1: =..visitType
                                                string2: "Telemedicine"
                                          - actionType: evalObject
                                            object: 
                                              - =.builtIn.array.getByKey:
                                                  dataIn:
                                                    array: =..visitReason.document.name.data.reasonForVisit.Telemedicine
                                                    key1: reason
                                                    value: =..selectData.reason
                                                    key2: duration
                                                  dataOut: ProviderSchedule.selectData.duration
                                              - =.builtIn.array.getByKey:
                                                  dataIn:
                                                    array: =..visitReason.document.name.data.reasonForVisit.Telemedicine
                                                    key1: reason
                                                    value: =..selectData.reason
                                                    key2: document
                                                  dataOut: ProviderSchedule.selectData.document
                                              - =.builtIn.array.getByKey:
                                                  dataIn:
                                                    array: =..visitReason.document.name.data.reasonForVisit.Telemedicine
                                                    key1: reason
                                                    value: =..selectData.reason
                                                    key2: fee
                                                  dataOut: ProviderSchedule.selectData.fee
                                          - actionType: evalObject
                                            object: 
                                              - =.builtIn.array.getByKey:
                                                  dataIn:
                                                    array: =..visitReason.document.name.data.reasonForVisit.OfficeVisits
                                                    key1: reason
                                                    value: =..selectData.reason
                                                    key2: duration
                                                  dataOut: ProviderSchedule.selectData.duration
                                              - =.builtIn.array.getByKey:
                                                  dataIn:
                                                    array: =..visitReason.document.name.data.reasonForVisit.OfficeVisits
                                                    key1: reason
                                                    value: =..selectData.reason
                                                    key2: document
                                                  dataOut: ProviderSchedule.selectData.document
                                              - =.builtIn.array.getByKey:
                                                  dataIn:
                                                    array: =..visitReason.document.name.data.reasonForVisit.OfficeVisits
                                                    key1: reason
                                                    value: =..selectData.reason
                                                    key2: fee
                                                  dataOut: ProviderSchedule.selectData.fee
                                        - =.builtIn.string.retainNumber:
                                            dataIn:
                                              value: =..selectData.duration
                                            dataOut: ProviderSchedule.formData.duration
                                        - .BaseDate.formData.duration@: =.ProviderSchedule.formData.duration
                                    - actionType: evalObject
                                      object: 
                                        - =.builtIn.date.splitTime:
                                            dataIn:
                                              object2: =..schedule.scheduleList.edge
                                              timeSlot: =..formData.duration
                                              year: =.BaseDate.calendarDate.year
                                              month: =.BaseDate.calendarDate.month
                                              day: =.BaseDate.calendarDate.day
                                              isSplitCurrent: true
                                            dataOut: ProviderSchedule.splitTime 
                                        - =.builtIn.object.setObjectKey:
                                            dataIn:
                                              objectArr: =.ProviderSchedule.splitTime 
                                              key: fontColor
                                              value: "0x4b4b4b"
                                            dataOut: ProviderSchedule.splitTime 
                                        - =.builtIn.object.setObjectKey:
                                            dataIn:
                                              objectArr: =.ProviderSchedule.splitTime 
                                              key: borColor
                                              value: "0xebebeb"
                                            dataOut: ProviderSchedule.splitTime
                                        - ..formData.nextBtnColor@: "0xd3dde9"
                                    - actionType: builtIn
                                      funcName: redraw
                                      viewTag: btnView
                                    - actionType: builtIn
                                      funcName: redraw
                                      viewTag: durationTag
                                    - actionType: builtIn
                                      funcName: redraw
                                      viewTag: splitTimeTag
                                    - actionType: builtIn
                                      funcName: redraw
                                      viewTag: FeeTag
                            - .QuestionViewColumn:
                              children:
                                - type: label
                                  text: Duration
                                  style:
                                    fontSize: 0.8vw
                                    fontWeight: 550
                                    marginLeft: "0.5vw"
                                - type: view
                                  isEditable: true
                                  dataKey: ProviderSchedule.selectData.duration
                                  viewTag: durationTag
                                  style: 
                                    marginLeft: "0.5vw"
                                    marginTop: 0.5vw
                                    fontSize: 0.8vw
                                    borderWidth: "1px"
                                    borderColor: "#EAEAEA" 
                                    boxSizing: "border-box"
                                    borderRadius: 5px
                                    width: 7vw
                                    height: 2.5vw
                                    textIndent: 10px
                                    backgroundColor: "0xeeeeee"
                                    textAlign:
                                      x: center
                                      y: center
                            - .QuestionViewColumn:
                              children:
                                - type: label
                                  text: Fee
                                  style:
                                    fontSize: 0.8vw
                                    fontWeight: 550
                                    marginLeft: "0.5vw"
                                - type: view
                                  isEditable: true
                                  dataKey: ProviderSchedule.selectData.fee
                                  viewTag: FeeTag
                                  style: 
                                    marginLeft: "0.5vw"
                                    marginTop: 0.5vw
                                    fontSize: 0.8vw
                                    borderWidth: "1px"
                                    borderColor: "#EAEAEA" 
                                    boxSizing: "border-box"
                                    borderRadius: 5px
                                    width: 7vw
                                    height: 2.5vw
                                    textIndent: 10px
                                    backgroundColor: "0xeeeeee"
                                    textAlign:
                                      x: center
                                      y: center
                    - type: label
                      text: Date
                      style:
                        marginLeft: 6vw
                        marginTop: 2vw
                        fontSize: 1vw   
                        fontWeight: 550
                    - type: view
                      style:
                        backgroundColor: white
                        marginTop: 1vw
                        borderWidth: "0"
                        width: "0.4"
                      children:
                        - type: view
                          viewTag: calendarTag
                          style:
                            width: "0.4"
                            top: "0"
                            height: "0.19"
                            border: 
                              style: "1"
                            backgroundColor: "0xf7f9fa"
                            borderColor: "#d0d9df"
                            borderRadius: "5"
                            borderWidth: "0"
                          children:
                            - type: view
                              style: 
                                width: "0.2"
                                margin: auto
                                height: "0.05 "
                              children:
                                - type: view
                                  style:
                                    top: "0"
                                    left: "0.025"
                                    width: "0.1"
                                    height: "0.05"
                                  children:
                                    - type: image
                                      path: blueright.png
                                      onClick:
                                        - emit:
                                            actions:
                                              - =.builtIn.date.loopMonth:
                                                  dataIn:
                                                    month: =.BaseDate.calendarDate.month
                                                    step: -1
                                                  dataOut: BaseDate.calendarDate.month
                                              - =.builtIn.date.transformMonth:
                                                  dataIn:
                                                    month: =.BaseDate.calendarDate.month
                                                  dataOut: BaseDate.calendarDate.monthName
                                              - =.builtIn.date.calendarArray:
                                                  dataIn:
                                                    year: =.BaseDate.calendarDate.year
                                                    month: =.BaseDate.calendarDate.month
                                                    today: 1
                                                  dataOut: BaseDate.calendarDate.dayLable
                                              - =.builtIn.date.miniWeeklyCalendarArray:
                                                  dataIn:
                                                    year: =.BaseDate.calendarDate.year
                                                    month: =.BaseDate.calendarDate.month
                                                    today: 32
                                                    markDay: 1
                                                    color: "0x333333"
                                                    backgroundColor: "0xFFFFFF6f"
                                                    todayColor: "0xffffff"
                                                    todayBackgroundColor: "0x2988E6"
                                                  dataOut: BaseDate.calendarDate.minidayLable
                                              - .BaseDate.calendarDate.day@: 1
                                        - actionType: builtIn
                                          funcName: redraw
                                          viewTag: calendarTag
                                      style:
                                        height: "0.015"
                                        top: "0.0175"
                                    - type: label
                                      dataKey: BaseDate.calendarDate.monthName
                                      style:
                                        width: "0.02"
                                        height: "0.02"
                                        left: "0.019"
                                        top: "0.01"
                                        fontSize: "16"
                                        color: "0x003254"
                                        textAlign:
                                          x: center
                                    - type: image
                                      path: blueleft.png
                                      onClick:
                                        - emit:
                                            actions:
                                              - =.builtIn.date.loopMonth:
                                                  dataIn:
                                                    month: =.BaseDate.calendarDate.month
                                                    step: 1
                                                  dataOut: BaseDate.calendarDate.month
                                              - =.builtIn.date.transformMonth:
                                                  dataIn:
                                                    month: =.BaseDate.calendarDate.month
                                                  dataOut: BaseDate.calendarDate.monthName
                                              - =.builtIn.date.calendarArray:
                                                  dataIn:
                                                    year: =.BaseDate.calendarDate.year
                                                    month: =.BaseDate.calendarDate.month
                                                    today: 1
                                                  dataOut: BaseDate.calendarDate.dayLable 
                                              - =.builtIn.date.miniWeeklyCalendarArray:
                                                  dataIn:
                                                    year: =.BaseDate.calendarDate.year
                                                    month: =.BaseDate.calendarDate.month
                                                    today: 32
                                                    markDay: 1
                                                    color: "0x333333"
                                                    backgroundColor: "0xFFFFFF6f"
                                                    todayColor: "0xffffff"
                                                    todayBackgroundColor: "0x2988E6"
                                                  dataOut: BaseDate.calendarDate.minidayLable
                                              - .BaseDate.calendarDate.day@: 1            
                                        - actionType: builtIn
                                          funcName: redraw
                                          viewTag: calendarTag
                                      style:
                                        left: "0.055"
                                        height: "0.015"
                                        top: "0.0175"
                            
                                - type: view
                                  style:
                                    top: "0"
                                    left: "0.115"
                                    width: "0.1"
                                    height: "0.05"
                                  children:
                                    - type: image
                                      path: blueright.png
                                      onClick:
                                        - emit:
                                            actions:
                                              - =.builtIn.number.Subtraction:
                                                  dataIn:
                                                    num: =.BaseDate.calendarDate.year
                                                    step: 1
                                                  dataOut: BaseDate.calendarDate.year
                                              - =.builtIn.date.calendarArray:
                                                  dataIn:
                                                    year: =.BaseDate.calendarDate.year
                                                    month: 1
                                                    today: 1
                                                  dataOut: BaseDate.calendarDate.dayLable
                                              - =.builtIn.date.miniWeeklyCalendarArray:
                                                  dataIn:
                                                    year: =.BaseDate.calendarDate.year
                                                    month: 1
                                                    today: 32
                                                    markDay: 1
                                                    color: "0x333333"
                                                    backgroundColor: "0xFFFFFF6f"
                                                    todayColor: "0xffffff"
                                                    todayBackgroundColor: "0x2988E6"
                                                  dataOut: BaseDate.calendarDate.minidayLable
                                        - actionType: evalObject
                                          object: 
                                            - .BaseDate.calendarDate.month@: 1
                                            - .BaseDate.calendarDate.day@: 1
                                        - actionType: evalObject
                                          object:
                                            - =.builtIn.date.transformMonth:
                                                dataIn:
                                                  month: =.BaseDate.calendarDate.month
                                                dataOut: BaseDate.calendarDate.monthName
                                        - actionType: builtIn
                                          funcName: redraw
                                          viewTag: calendarTag
                                        
                                      style:
                                        height: "0.015"
                                        top: "0.0175"
                                    - type: label
                                      dataKey: BaseDate.calendarDate.year
                                      style:
                                        width: "0.02"
                                        height: "0.02"
                                        left: "0.019"
                                        top: "0.01"
                                        fontSize: "16"
                                        color: "0x003254"
                                        textAlign:
                                          x: center
                                    - type: image
                                      path: blueleft.png
                                      onClick:
                                        - emit:
                                            actions:
                                              - =.builtIn.number.addition:
                                                  dataIn:
                                                    num: =.BaseDate.calendarDate.year
                                                    step: 1
                                                  dataOut: BaseDate.calendarDate.year
                                              - =.builtIn.date.calendarArray:
                                                  dataIn:
                                                    year: =.BaseDate.calendarDate.year
                                                    month: 1
                                                    today: 1
                                                  dataOut: BaseDate.calendarDate.dayLable
                                              - =.builtIn.date.miniWeeklyCalendarArray:
                                                  dataIn:
                                                    year: =.BaseDate.calendarDate.year
                                                    month: 1
                                                    today: 32
                                                    markDay: 1
                                                    color: "0x333333"
                                                    backgroundColor: "0xFFFFFF6f"
                                                    todayColor: "0xffffff"
                                                    todayBackgroundColor: "0x2988E6"
                                                  dataOut: BaseDate.calendarDate.minidayLable
                                        - actionType: evalObject
                                          object: 
                                            - .BaseDate.calendarDate.month@: 1
                                            - .BaseDate.calendarDate.day@: 1
                                        - actionType: evalObject
                                          object:
                                            - =.builtIn.date.transformMonth:
                                                dataIn:
                                                  month: =.BaseDate.calendarDate.month
                                                dataOut: BaseDate.calendarDate.monthName
                                        - actionType: builtIn
                                          funcName: redraw
                                          viewTag: calendarTag
                                      style:
                                        left: "0.055"
                                        height: "0.015"
                                        top: "0.0175"
                                
                            - type: list
                              contentType: listObject
                              listObject: 
                                - key: SU
                                - key: MO
                                - key: TU
                                - key: WE
                                - key: TH
                                - key: FR
                                - key: SA
                              iteratorVar: itemObject
                              style:
                                top: "0.06"
                                width: "0.3"
                                left: "0.06"
                                height: "0.05"
                                justifyContent: "space-between"
                              children:
                                - type: listItem
                                  itemObject: ""
                                  style:
                                    width: "0.04"
                                    height: "0.05"
                                    boxSizing: "border-box"
                                    border: "none"
                                    padding: "0"
                                    display: "inline-block"
                                  children:
                                    - type: label 
                                      dataKey: itemObject.key
                                      style:
                                        color: "0x003254"
                                        width: "0.04"
                                        height: "0.05"
                                        fontSize: "14"
                                        # backgroundColor: "0xffffff"
                                        textAlign:
                                          x: center
                            - type: list
                              contentType: listObject
                              listObject: =.BaseDate.calendarDate.minidayLable
                              iteratorVar: itemObject
                              style:
                                top: "0.08"
                                left: "0.064"
                                width: "0.3"
                              children:
                                - type: listItem
                                  itemObject: ""
                                  onClick:
                                    - emit:
                                        dataKey:
                                          var: itemObject
                                        actions:
                                          - =.builtIn.date.miniWeeklyCalendarArray:
                                              dataIn:
                                                year: $var.year
                                                month: $var.month
                                                today: $var.day
                                                markDay: $var.day
                                                color: "0x333333"
                                                backgroundColor: "0xFFFFFF6f"
                                                todayColor: "0xffffff"
                                                todayBackgroundColor: "0x2988E6"
                                              dataOut: BaseDate.calendarDate.minidayLable
                                          - .BaseDate.calendarDate.year@: $var.year
                                          - .BaseDate.calendarDate.month@: $var.month
                                          - .BaseDate.calendarDate.day@: $var.day
                                          - =.builtIn.date.ShowDateByNumber:
                                              dataIn:
                                                year: =.BaseDate.calendarDate.year
                                                month: =.BaseDate.calendarDate.month
                                                day: =.BaseDate.calendarDate.day
                                                formatType: "Y-M-D"
                                              dataOut: BaseDate.calendarDate.todayDate
                                          - =.builtIn.date.transformMonth:
                                              dataIn:
                                                month: =.BaseDate.calendarDate.month
                                              dataOut: BaseDate.calendarDate.monthName
                                          - =.builtIn.date.getTimeStampOfDate:
                                              dataIn:
                                                date: =.BaseDate.calendarDate.todayDate
                                              dataOut: BaseDate.calendarDate.todayStamp
                                          - =.builtIn.string.concat:
                                              dataIn:
                                                - "(stime<"
                                                - =.BaseDate.calendarDate.todayStamp.start
                                                - " AND "
                                                - "etime>"
                                                - =.BaseDate.calendarDate.todayStamp.start
                                                - " OR "
                                                - "stime>"
                                                - =.BaseDate.calendarDate.todayStamp.start
                                                - " AND "
                                                - "etime<"
                                                - =.BaseDate.calendarDate.todayStamp.end
                                                - " OR "
                                                - "stime<"
                                                - =.BaseDate.calendarDate.todayStamp.end
                                                - " AND "
                                                - "etime>"
                                                - =.BaseDate.calendarDate.todayStamp.end
                                                - ")"
                                                - " AND "
                                                - "subtype="
                                                - =.Global.currentSubtype
                                                # - " AND "
                                                # - "name like '%"
                                                # - =..selectData.reason
                                                # - "%'"
                                              dataOut: Global.scheduleScondition
                                          # - =.builtIn.string.concat:
                                          #     dataIn:
                                          #       - "stime>"
                                          #       - =.BaseDate.calendarDate.todayStamp.start
                                          #       - " AND "
                                          #       - "etime<"
                                          #       - =.BaseDate.calendarDate.todayStamp.end
                                          #       - " AND "
                                          #       - "subtype="
                                          #       - =.Global.currentSubtype
                                          #     dataOut: Global.scheduleScondition
                                    - actionType: evalObject
                                      object:
                                        - if:
                                          - =.builtIn.math.greater:
                                              dataIn:
                                                num1: =.BaseDate.calendarDate.todayStamp.end
                                                num2: =.ProviderSchedule.nowTimeStamp
                                          - continue
                                          - actionType: popUp
                                            popUpView: judgeTime
                                            wait: true
                                        - .BaseDate.schedule.scheduleList.edge@: []
                                        - ..splitTime@: [] 
                                    - actionType: updateObject
                                      dataKey: ProviderSchedule.schedule.scheduleList.edge
                                      dataObject: []    # 将所得的可用时间置空,防止所选的那天为空,但是使用了缓存值
                                    - actionType: evalObject
                                      object: 
                                        .Global._nonce@: 
                                          =.builtIn.math.random: ""
                                    - actionType: evalObject
                                      object:
                                        - if:  
                                          - =.builtIn.string.equal:
                                              dataIn:
                                                string1: =..newAppointment.edge.name.visitType
                                                string2: "Office Visit"
                                          - .Global.jwt.edge.bvid@: =..locationId
                                          - .Global.jwt.edge.bvid@: =.Global.currentUser.vertex.id
                                        - =.Global.jwt.edgeAPI.store: ""
                                        - if: 
                                          - =.builtIn.string.equal:
                                              dataIn:
                                                string1: =..newAppointment.edge.name.visitType
                                                string2: "Office Visit"
                                          - =.builtIn.array.add:
                                              dataIn:
                                                object: =..schedule.edge.id
                                                value: =..locationId
                                          - =.builtIn.array.add:
                                              dataIn:
                                                object: =..schedule.edge.id
                                                value: =.Global.currentFacility.id
                                        - =.builtIn.array.add:
                                            dataIn:
                                              object: =..schedule.edge.id
                                              value: =.Global.currentUser.vertex.id
                                    - actionType: evalObject
                                      object:
                                        - =..schedule.get: ""
                                        - ..schedule.edge.id@: []
                                    - actionType: evalObject
                                      object: 
                                        - if: 
                                          - ..schedule.scheduleList.edge.0
                                          - =.builtIn.date.splitTime:
                                              dataIn:
                                                object2: =..schedule.scheduleList.edge
                                                timeSlot: =..formData.duration
                                                year: =.BaseDate.calendarDate.year
                                                month: =.BaseDate.calendarDate.month
                                                day: =.BaseDate.calendarDate.day
                                                isSplitCurrent: true
                                              dataOut: ProviderSchedule.splitTime 
                                          - ..splitTime@: [] 
                                        - =.builtIn.object.setObjectKey:
                                            dataIn:
                                              objectArr: =.ProviderSchedule.splitTime 
                                              key: fontColor
                                              value: "0x4b4b4b"
                                            dataOut: ProviderSchedule.splitTime 
                                        - =.builtIn.object.setObjectKey:
                                            dataIn:
                                              objectArr: =.ProviderSchedule.splitTime 
                                              key: borColor
                                              value: "0xebebeb"
                                            dataOut: ProviderSchedule.splitTime
                                    - actionType: builtIn
                                      funcName: redraw
                                      viewTag: calendarTag
                                    # - actionType: builtIn
                                    #   funcName: redraw
                                    #   viewTag: DataTag
                                    - actionType: builtIn
                                      funcName: redraw
                                      viewTag: splitTimeTag
                                    # - actionType: evalObject
                                    #   object: 
                                    #     - ..splitTime@: []
                                  style:
                                    width: "0.04"
                                    height: "0.02"
                                    # boxSizing: "border-box"
                                    # border: "none"
                                    padding: "0"
                                    margin: "0"
                                    display: "inline-block"
                                    # flex: "auto"
                                    marginTop: "0.02"
                                  children:
                                    - type: label
                                      dataKey: itemObject.day
                                      style:
                                        top: "0"
                                        left: "0.0065"
                                        width: "0.02"
                                        height: "0.04"
                                        color: itemObject.color
                                        backgroundColor: itemObject.backgroundColor
                                        borderRadius: "50"
                                        fontSize: "18"
                                        textAlign:
                                          x: center
                                          y: center
                        - type: view
                          style:
                            top: "0.08"
                            # left: "0.5"
                            left: "0.04"
                            width: "0.02"
                            height: "0.08"
                          children:
                            - type: image
                              path: blueright.png
                              onClick:
                                - emit:
                                    actions:
                                        - =.builtIn.date.LastWeek:
                                            dataIn:
                                              year: =.BaseDate.calendarDate.minidayLable.0.year
                                              month: =.BaseDate.calendarDate.minidayLable.0.month
                                              day: =.BaseDate.calendarDate.minidayLable.0.day
                                            dataOut: BaseDate.calendarDate.tempDate
                                        - =.builtIn.date.miniWeeklyCalendarArray:
                                            dataIn:
                                              year: =.BaseDate.calendarDate.tempDate.year
                                              month: =.BaseDate.calendarDate.tempDate.month
                                              today: 32
                                              markDay: =.BaseDate.calendarDate.tempDate.day
                                              color: "0x333333"
                                              backgroundColor: "0xFFFFFF6f"
                                              todayColor: "0xffffff"
                                              todayBackgroundColor: "0x2988E6"
                                            dataOut: BaseDate.calendarDate.minidayLable
                                - actionType: evalObject
                                  object:
                                    - .BaseDate.calendarDate.year@: =.BaseDate.calendarDate.tempDate.year
                                    - .BaseDate.calendarDate.month@: =.BaseDate.calendarDate.tempDate.month
                                    - =.builtIn.date.transformMonth:
                                        dataIn:
                                          month: =.BaseDate.calendarDate.month
                                        dataOut: BaseDate.calendarDate.monthName
                                - actionType: builtIn
                                  funcName: redraw
                                  viewTag: calendarTag
                              style:
                                top: "0.02"
                                height: "0.015"
                        - type: view
                          style:
                            top: "0.025"
                            left: "0.36"
                            width: "0.02"
                            # height: "0.08"
                          children:
                            - type: image
                              path: blueleft.png
                              style:
                                top: "0.07"
                                # left: "0.1"
                                height: "0.015"
                              onClick:
                                - emit:
                                    actions:
                                      - =.builtIn.date.NextWeek:
                                            dataIn:
                                              year: =.BaseDate.calendarDate.minidayLable.6.year
                                              month: =.BaseDate.calendarDate.minidayLable.6.month
                                              day: =.BaseDate.calendarDate.minidayLable.6.day
                                            dataOut: BaseDate.calendarDate.tempDate
                                      - =.builtIn.date.miniWeeklyCalendarArray:
                                            dataIn:
                                              year: =.BaseDate.calendarDate.tempDate.year
                                              month: =.BaseDate.calendarDate.tempDate.month
                                              today: 32
                                              markDay: =.BaseDate.calendarDate.tempDate.day
                                              color: "0x333333"
                                              backgroundColor: "0xFFFFFF6f"
                                              todayColor: "0xffffff"
                                              todayBackgroundColor: "0x2988E6"
                                            dataOut: BaseDate.calendarDate.minidayLable
                                - actionType: evalObject
                                  object:
                                    - .BaseDate.calendarDate.year@: =.BaseDate.calendarDate.tempDate.year
                                    - .BaseDate.calendarDate.month@: =.BaseDate.calendarDate.tempDate.month
                                    - =.builtIn.date.transformMonth:
                                        dataIn:
                                          month: =.BaseDate.calendarDate.month
                                        dataOut: BaseDate.calendarDate.monthName
                                - actionType: builtIn
                                  funcName: redraw
                                  viewTag: calendarTag
                        
                    - type: label
                      text: Availability
                      style:
                        marginLeft: 6vw
                        marginTop: 12vw
                        fontSize: 1vw
                        fontWeight: 550
                    - type: scrollView
                      viewTag: splitTimeTag
                      style: 
                        height: "0.29"
                        width: "0.32"
                        left: "0.06"
                        overflow: scroll
                      children: 
                        # - type: label
                        #   dataKey: splitTime.0.showTime
                        #   style:
                        #     top: "0"
                        - type: list
                          contentType: listObject
                          listObject: =..splitTime
                          iteratorVar: itemObject
                          style:
                            height: 20vw
                            width: "0.32"
                            display: inline-block
                          children:
                            - type: listItem
                              itemObject: "" 
                              onClick:
                                - emit: 
                                    dataKey: 
                                      var: itemObject
                                    actions: 
                                      - =.builtIn.object.setProperty: 
                                          dataIn: 
                                            obj: =..splitTime
                                            label: "showTime"
                                            text: $var.showTime
                                            arr: ["fontColor","bgColor","borColor"]
                                            valueArr: ["0x005795","0xeaf1f6","0xeaf1f6"]
                                            errorArr: ["0x4b4b4b","0xffffff","0xebebeb"]    
                                      - =.builtIn.string.concat: 
                                          dataIn: 
                                            - =.BaseDate.calendarDate.monthName
                                            - " "
                                            - =.BaseDate.calendarDate.day
                                            - ","
                                            - =.BaseDate.calendarDate.year
                                            - " "
                                            - "at"
                                            - " "
                                            - $var.showTime
                                          dataOut: ProviderSchedule.appointmentTime
                                      - ..clock@: $var
                                      - ..newAppointment.edge.stime@: =..clock.stime
                                      - ..newAppointment.edge.etime@: =..clock.etime
                                      - ..newAppointment.edge.refid@: =..clock.refid
                                      # - ..newAppointment.edge.evid@: =..formData.providerId
                                - actionType: evalObject
                                  object: 
                                    # - if: 
                                        # - ..newAppointment.edge.name.visitType@: "Office Visit"
                                        # - =.builtIn.string.equal:
                                        #     dataIn:
                                        #       string1: =..newAppointment.edge.name.visitType
                                        #       string2: "Office Visit"
                                        # - ..newAppointment.edge.bvid@: =..locationId
                                        # - ..newAppointment.edge.bvid@: =.Global.currentUser.vertex.id
                                    - ..newAppointment.edge.bvid@: =.Global.currentUser.vertex.id
                                    - ..formData.nextBtnColor@: "0x005795"
                                - actionType: builtIn
                                  funcName: redraw
                                  viewTag: btnView
                                - actionType: builtIn
                                  funcName: redraw
                                  viewTag: splitTimeTag
                              style:
                                width: '0.0576'
                                height: '0.035'
                                marginRight: "0.015"
                                float: left
                                marginTop: "0.02"
                                backgroundColor: itemObject.bgColor
                                border:   
                                  style: '3'
                                borderColor: itemObject.borColor
                                borderRadius: "3"
                              children:
                                - type: label
                                  dataKey: itemObject.showTime
                                  style: 
                                    left: "0"
                                    height: "0.035"
                                    color: itemObject.fontColor
                                    fontSize: .Nfont.nf3
                                    textAlign:
                                      x: center
                                      y: center 
                    - type: button
                      text: Next
                      viewTag: btnView
                      onClick: 
                        - actionType: builtIn
                          funcName: hide
                          viewTag: addressView
                        - actionType: builtIn
                          funcName: redraw
                          viewTag: Details
                        - actionType: evalObject
                          object:
                            - if: 
                              - =.builtIn.string.equal:
                                  dataIn:
                                    string1: =..formData.nextBtnColor
                                    string2: "0x005795"
                              - actionType: popUpDismiss
                                popUpView: create1
                              - continue  
                        - actionType: evalObject
                          object:                        
                            - if: 
                              - =.builtIn.string.equal:
                                  dataIn:
                                    string1: =..formData.nextBtnColor
                                    string2: "0x005795"
                              - actionType: popUp
                                popUpView: Details  
                              - continue      
                      style:
                        top: "0.83"
                        width: "0.28"
                        height: "0.043"
                        left: "0.06"
                        color: "0xffffff"
                        fontSize: .Nfont.nf2
                        fontFamily: "Roboto"
                        backgroundColor: =..formData.nextBtnColor
                        border:
                          style: "1"
                        borderRadius: "3"
                        textAlign:
                          x: center
                          y: center    
    # 取消会议弹窗
    - type: popUp
      viewTag: cancelAppointmentTag
      style:
        width: "1"
        height: "1"
        top: 0
        backgroundColor: "#00000033"
        margin: auto
        right: 0
        zIndex: 1000
      children:
        - type: view
          style:
            width: "0.29"
            height: "0.36"
            backgroundColor: "0xffffff"
            top: "0.23"
            left: "0.38"
            boxShadow: "1px 1px 11px 9px #b3b3b333"
            borderRadius: "10"
          children:
            - type: image
              path: deleteGray.svg
              style:
                height: "0.015"
                left: "0.27"
                top: "0.02"
              onClick:
                - actionType: popUpDismiss
                  popUpView: cancelAppointmentTag
            - type: view
              style:
                width: "0.27"
                left: "0.022"
                marginTop: "0.06"
              children:
                - type: label
                  text: "The appointment &nbsp"
                  style:
                    fontSize: 1.15vw
                    color: "0x4b4b4b"
                    fontWeight: "600"
                    display: inline-block
                - type: label
                  text: " Cancel &nbsp"
                  dataKey: 
                  style:
                    fontSize: 1.15vw
                    color: "0xfc3a3a"
                    fontWeight: "600"
                    display: inline-block
                - type: label
                  text: " by Provider"
                  dataKey: 
                  style:
                    fontSize: 1.15vw
                    color: "0x4b4b4b"
                    fontWeight: "600"
                    display: inline-block
            - type: label
              text: "Reason for cancellation"
              dataKey: 
              style:
                fontSize: 1.15vw
                color: "0x4b4b4b"
                marginTop: "0.01"
                left: "0.022"
                fontWeight: "600"
            
            - type: textView
              placeholder: Enter here...
              dataKey: apiRequest.cancelEmail.docReq.name.data.content
              style:
                width: "0.25"
                left: "0.022"  
                borderWidth: "2"  
                borderColor: "0xe5e5e5"
                height: "0.11"
                borderRadius: "5"
                textIndent: "1em"
                fontFamily: "Poppins"
                paddingTop: "5px"
                color: "#999999"
                marginTop: "0.02"
            - type: view
              style:
                width: "0.29"
                height: "0.07"
                backgroundColor: "0xedeef2"
                border-bottom-left-radius: "5"
                border-bottom-right-radius: "5"
                marginTop: "0.02"
                boxShadow: "1px 8px 10px 10px #b3b3b333"
              children:
                - .BaseJudgeButtonNo: ""
                  style: 
                    left: "0.172"
                    fontFamily: "Proxima Nova"
                - .BaseJudgeButtonYes:
                  style: 
                    left: "0.205"
                    width: "0.058"
                    fontFamily: "Proxima Nova"
                  onClick:
                    - actionType: popUpDismiss
                      popUpView: cancelAppointmentTag
                    - actionType: evalObject
                      object:
                        - if:
                          - =.builtIn.string.equal:
                              dataIn:
                                string1: =..formData.roomInfo.evid
                                string2: =.Global.currentUser.vertex.id
                          - actionType: evalObject
                            object:
                              - ..formData.patientId@: =..formData.roomInfo.bvid
                              - ..formData.FacilityId@: =..formData.roomInfo.name.facilityId
                          - actionType: evalObject
                            object:
                              - ..formData.patientId@: =..formData.roomInfo.evid
                              - ..formData.FacilityId@: =..formData.roomInfo.name.facilityId
                    - actionType: evalObject
                      object:
                        - .Global.jwt.edge.bvid@: =.Global.currentUser.vertex.id
                        - =.Global.jwt.edgeAPI.store: ""
                        - =..apiRequest.cancelAppoint.edgeAPI.store: ""
                    # 发patients
                    - actionType: evalObject
                      object:
                        - =.builtIn.array.add:
                            dataIn:
                              object: =..apiRequest.relation.edgeReq.id
                              value: =..formData.patientId
                        - =.builtIn.array.add:
                            dataIn:
                              object: =..apiRequest.relation.edgeReq.id
                              value: =.Global.currentUser.vertex.id
                        - =..apiRequest.relation.edgeAPI.get: ""
                        - ..apiRequest.cancelEmail.docReq.name.data.receiverName@: =..formData.roomInfo.name.patientName
                        - ..apiRequest.cancelEmail.docReq.name.data.receiverAvatarId@: =..profile.docResponse.doc.0.name.data.basicInfo.avatar
                        - ..apiRequest.cancelEmail.docReq.name.data.receiverId@: =..formData.patientId
                        - ..apiRequest.cancelEmail.docReq.eid@: =..apiRequest.relation.edgeRes.edge.0.id
                        - if:
                          - =..apiRequest.cancelAppoint.edgeRes.edge.id
                          - =..apiRequest.cancelEmail.docAPI.store: ""
                          - continue
                    # 发facility
                    - actionType: evalObject
                      object:
                        - ..apiRequest.relation.edgeRes.edge@: ""
                        - ..apiRequest.relation.edgeReq.id@: []
                        - =.builtIn.array.add:
                            dataIn:
                              object: =..apiRequest.relation.edgeReq.id
                              value: =..formData.FacilityId
                        - =.builtIn.array.add:
                            dataIn:
                              object: =..apiRequest.relation.edgeReq.id
                              value: =.Global.currentUser.vertex.id
                        - =..apiRequest.relation.edgeAPI.get: ""
                        - ..apiRequest.cancelEmail.docReq.name.data.receiverName@: =.Global.currentFacility.name.basicInfo.medicalFacilityName
                        # - ..apiRequest.cancelEmail.docReq.name.data.receiverAvatarId@: ""
                        - ..apiRequest.cancelEmail.docReq.name.data.receiverId@: =..formData.FacilityId
                        - ..apiRequest.cancelEmail.docReq.eid@: =..apiRequest.relation.edgeRes.edge.0.id
                        - if:
                            - =..apiRequest.cancelAppoint.edgeRes.edge.id
                            - =..apiRequest.cancelEmail.docAPI.store: ""
                            - continue
                    - actionType: popUp
                      popUpView: successView
                    - actionType: evalObject
                      object:
                        - =.builtIn.goto:
                            dataIn:
                              destination: ProviderSchedule
                              pageReload: true
    # 取消会议成功弹窗
    - .BaseSuccessfulView: 
      viewTag: successView
      msg: "cancel Successfully!"
      style:
        margin: auto
        width: "1"
        height: "1"
    
           
