AppointmentDetail:
  title: "Appointment Detail"
  dataObject: .Global.roomInfo.edge
  pageNumber: "100"
  init:
    - .SignInCheck
    - actionType: evalObject
      object:
        .Global._nonce@:
          =.builtIn.math.random: ""
    - ..listData.get
  save:
    - =..roomInfo.edgeAPI.store: ""
  inviteesInfo:
    response: ""
    edge:
      .Edge: ""
    edgeAPI:
      .EdgeAPI: ""
      store:
        api: ce
        dataIn: inviteesInfo.edge
        dataOut: inviteesInfo.response
  roomInfo:
    edge: .Global.roomInfo.edge
    edgeAPI:
      .EdgeAPI: ""
      store:
        api: ce
        dataKey: roomInfo.edge

  listData:
    invitees:
      edge: ""
    get:
      .EdgeAPI.get: ""
      api: re
      dataKey: listData.invitees
      id: ..roomInfo.edge.id
      type: .EdgeType.InviteInfo
      xfname: refid
      maxcount: "20"
      # sCondition: "tage=0 AND ctime>UNIX_TIMESTAMP()-7200"
      sCondition: "tage=0"
      _nonce: .Global._nonce
  components:
    - .BaseHeader:
    - .HeaderLeftButton:
      onClick:
        - goto: PatientInWaiting
    - .HeaderRightButton:
      text: Invite
      style:
        textDecoration: underline
      onClick:
        - goto: InviteCompletedForm
        # - goto: UploadFavorite
    - type: view
      style:
        left: "0"
        top: "0.09"
        width: "1"
        height: "0.1"
        backgroundColor: "0x2988e6ff"
      children:
        - type: textField # take users' input
          contentType: text
          placeholder: " "
          dataKey: roomInfo.edge.name.visitReason # users' input will be saved to this key
          style:
            left: "0.05"
            top: "0.03"
            width: "0.9"
            height: "0.041"
            color: "0xffffff"
            backgroundColor: "0x00000000"
            textAlign:
              x: left
            fontSize: .Nfont.h14
            required: "true"
            borderWidth: "1"
            borderColor: "0xffffffff"
            border:
              style: "2"
    - type: label
      text: Date and Time
      style:
        top: "0.22"
        width: "0.8"
        left: "0.15"
        fontSize: .Nfont.h14
        color: "0x000000"
        # fontWeight: "200"
        textAlign:
          x: left

    - type: label
      # text= func: .builtIn.string.formatUnixtime_en
      # dataIn: roomInfo.edge.ctime
      # dataKey: roomInfo.edge.ctime
      text=func: .builtIn.string.formatUnixtime_en
      dataKey: roomInfo.edge.stime
      style:
        top: "0.28"
        fontSize: "18"
        fontWeight: "300"
        width: "0.7"
        left: "0.15"
        textIndent: "10px"
        textAlign:
          x: left
        paddingBottom: "10px"
        borderWidth: "1"
        border:
          style: "2"
          color: "0x939393"

    - type: view
      style:
        left: "0"
        top: "0.34"
        height: "60px"
        width: "1"
      children:
        - type: view
          text=func: .builtIn.string.getFirstChar
          dataKey: roomInfo.edge.name.providerName
          style:
            top: "10px"
            left: "0.06"
            height: "40px"
            width: "40px"
            backgroundColor: "0xf56160"
            color: "0xffffff"
            textAlign:
              x: center
            lineHeight: "40px"
        - type: label
          text: "provider: "
          style:
            top: "0"
            fontSize: .Nfont.h16
            fontWeight: 600
            left: "0.24"
            height: "60px"
            lineHeight: "60px"
            color: "0x000000"
        - type: label
          dataKey: roomInfo.edge.name.providerName
          style:
            top: "0"
            fontSize: .Nfont.h16
            fontWeight: 600
            left: "0.44"
            height: "60px"
            lineHeight: "60px"
            color: "0x000000"

    - type: view
      style:
        left: "0"
        top: "0.41"
        height: "60px"
        width: "1"
      children:
        - type: view
          text=func: .builtIn.string.getFirstChar
          dataKey: roomInfo.edge.name.patientName
          style:
            top: "10px"
            left: "0.06"
            height: "40px"
            width: "40px"
            backgroundColor: "0xf56160"
            color: "0xffffff"
            textAlign:
              x: center
            lineHeight: "40px"
        - type: label
          text: "patient: "
          style:
            top: "0"
            fontSize: .Nfont.h16
            fontWeight: 600
            left: "0.24"
            height: "60px"
            lineHeight: "60px"
            color: "0x000000"
        - type: label
          dataKey: roomInfo.edge.name.patientName
          style:
            top: "0"
            fontSize: .Nfont.h16
            fontWeight: 600
            left: "0.44"
            height: "60px"
            lineHeight: "60px"
            color: "0x000000"

    - type: view
      style:
        width: "1"
        top: "0.46"
        height: "0.2"
      children:
        - type: list
          contentType: listObject
          listObject: ..listData.invitees.edge # to dataObject to enumerate the list
          iteratorVar: itemObject
          style:
            top: "0"
            left: "0"
            width: "1"
            height: "0.12"
            overflow: scroll
            # border:
            #   style: "2"
            #   color: "0x00000011"
            # borderWidth: "1"
            # boxShadow: "0px 0px 1px #888888"
          children:
            - type: listItem
              itemObject: ""
              # onClick:
              #   - goto:
              style:
                left: "0"
                top: "0"
                width: "1"
                height: "60px"
                # backgroundColor: "0x000000"
              children:
                - type: view
                  text=func: .builtIn.string.getFirstChar
                  dataKey: itemObject.name.firstName
                  style:
                    top: "10px"
                    left: "0.06"
                    height: "40px"
                    width: "40px"
                    backgroundColor: "0xf56160"
                    color: "0xffffff"
                    textAlign:
                      x: center
                    lineHeight: "40px"
                - type: label
                  text: "patient: "
                  style:
                    top: "0"
                    fontSize: .Nfont.h16
                    fontWeight: 600
                    left: "0.24"
                    height: "60px"
                    lineHeight: "60px"
                    color: "0x000000"
                - type: label
                  dataKey: itemObject.name.firstName
                  style:
                    top: "0"
                    fontSize: .Nfont.h16
                    fontWeight: 600
                    left: "0.44"
                    height: "60px"
                    lineHeight: "60px"
                    color: "0x000000"
                - type: image
                  onClick:
                    - actionType: updateObject # updateObject(dataKey, dataObject, dataObjectKey)
                      dataKey: AppointmentDetail.inviteesInfo.edge
                      dataObject: itemObject # this must be a rootRoom
                    - actionType: evalObject
                      object:
                        .AppointmentDetail.inviteesInfo.edge.tage@: 1
                    - actionType: evalObject
                      object:
                        - =.AppointmentDetail.inviteesInfo.edgeAPI.store: ""
                    - actionType: evalObject
                      object:
                        .Global._nonce@:
                          =.builtIn.math.random: ""
                    - actionType: refresh
                  path: delete.svg
                  style:
                    left: "0.8"
                    top: "15px"
                    height: "30px"
                    fontSize: .Nfont.h14
    - type: view
      style:
        top: "0.61"
        width: "1"
        left: "0"
        height: "0.7"
      children:
        - .PatientDashboardView:
          onClick:
            - goto: CovidQuestionnaire
          style:
            width: "0.35"
            top: "0"
            left: "0.325"
          children:
            - .PatientDashboardImage:
              style:
                left: "0.12"
              path: covid19.svg
            - .PatientDashboardLabel:
              style:
                width: "0.35"
              text: Covid Questionnaire

        - .PatientDashboardView:
          style:
            top: "0.2"
          onClick:
            - goto: MeetingVitalSigns
          children:
            - .PatientDashboardImage:
              path: remoteHealth.svg
            - .PatientDashboardLabel:
              text: Vital Signs

        - .PatientDashboardView:
          # style:
          #   top: "0.2"
          onClick:
            # - actionType: evalObject
            #   object:
            #     .Global.rootRoomInfo.edge.id@: =.Global.VideoChatObjStore.reference.edge.id
            - actionType: evalObject
              object:
                .Global._nonce@:
                  =.builtIn.math.random: ""
            - goto: VisitQuestionnaire
          style:
            top: "0.2"
            left: "0.55"
          children:
            - .PatientDashboardImage:
              path: visitQueationnaire.svg
            - .PatientDashboardLabel:
              text: Visit Questionnaire

        - .PatientDashboardView:
          onClick:
            # - actionType: evalObject
            #   object:
            #     .Global.rootRoomInfo.edge.id@: =.Global.VideoChatObjStore.reference.edge.id
            - goto: PatientChart
          style:
            top: "0.4"
          children:
            - .PatientDashboardImage:
              path: iconsForms.svg
            - .PatientDashboardLabel:
              text: Patient Chart

        - .PatientDashboardView:
          onClick:
            - goto: PatientDoc
          style:
            top: "0.4"
            left: "0.55"
          children:
            - .PatientDashboardImage:
              path: medicalRecords.svg
            - .PatientDashboardLabel:
              text: Medical Records
    - .BaseView:
      style:
        top: "1.21"
        height: "0.2"
      children:
        - .SmallButton:
          onClick:
            # - goto: ExamRoomWaiting
            - actionType: updateObject
              dataKey: Global.roomInfo.edge.name.roomName
              dataObject: ..roomInfo.edge.name.roomName
            - actionType: evalObject
              object: ..save
            - actionType: evalObject
              object:
                .Global.VideoChatObjStore.reference.edge@: =..dataObject
            - goto: VideoChat
          text: Enter Exam Room
          style:
            top: "0"
            width: "0.8"
            left: "0.1"
            backgroundColor: "0x2988e6"
        - .SmallButton:
          onClick:
            - actionType: evalObject
              object:
                ..roomInfo.edge.tage@: -1
            - actionType: evalObject
              object: ..save
            - actionType: evalObject
              object:
                .Global._nonce@:
                  =.builtIn.math.random: ""
            # - goto: MeetingRoomHistory
            - goto: AppointmentHistory
          text: Close Room
          style:
            top: "0.1"
            width: "0.8"
            left: "0.1"
            backgroundColor: "0xD6444A"
