AgreeRequest:
  pageNumber: "140"

  edgeE1Info: ""
  title: "Approve successful"
  init:
    - .SignInCheck
    - actionType: evalObject
      object:
        .Global._nonce@:
          =.builtIn.math.random: ""
    - ..dataObject@: =.Global.appoinment.request
    - ..approveRequest.edge.refid@: =..dataObject.id
    # - =.builtIn.FCM.getAPPID:
    #     dataIn:
    #       appName: =.AppName
    #     dataOut: FirebaseToken.edge.evid
    # - .Global.updateJwt: ""
    # - =.Global.jwt.edgeAPI.store: ""
    - actionType: evalObject
      object: ..approvePatientReq
    # - ..requestE2.get
    # - ..getE1EdgeId.get
    # - ..getE1Edge.get
    # - actionType: evalObject
    #   object:
    #     # .AgreeRequest.MeetingRequest.edge.refid@: =.AgreeRequest.dataObject.id
    # - actionType: evalObject
    #   object:
    #     .AgreeRequest.edgeE1Info@: =.AgreeRequest.getE1Edge.edge[0]
    - =..getAvailability.get: ""
    - =..getVertex.get: ""
    - ..newAppointment2.edge.id@: ""
    - ..newAppointment2.edge.subtype@: 10
    - ..newAppointment2.edge.evid@: =..getAvailability.response.edge.0.bvid
    - ..newAppointment2.edge.bvid@: =.Global.currentUser.vertex.id
    - ..newAppointment2.edge.refid@: =.Global.appoinment.request.id
    - =..newAppointment2.edgeAPI.store: ""
    # - =.builtIn.date.stampToDay:
    #     dataIn:
    #       timeStamp: =..newAppointment2.response.edge.stime
    #     dataOut: AgreeRequest.time
    - =.builtIn.string.concat:
        dataIn:
          - your appointment
          - " "
          - =..newAppointment2.response.edge.name.visitType
          - " "
          - with
          - " "
          - =..newAppointment2.response.edge.name.providerName
          - " "
          - at
          - " "
          # - =.AgreeRequest.time #todo get time
          - had been approved
        dataOut: AgreeRequest.sendNotification.document.name.notification.context
    # your appointment (telemedicine or office visit) with dr. provider at 11:40 had been (approved or denied)
    #    - =.builtIn.FCM.getAPPID:
    #        dataIn:
    #          appName: =.TargetApp.patient
    #        dataOut: FirebaseToken.edge.evid
    #    - actionType: evalObject
    #      object: .Global.updateJwt
    #    - =.Global.jwt.edgeAPI.store: ""
    - ..sendNotification.document.fid@: =.Global.patdAPPID
    - ..sendNotification.document.eid@: =..newAppointment2.response.edge.id
    - =..sendNotification.docAPI.store: ""
    #    - =.builtIn.FCM.getAPPID:
    #        dataIn:
    #          appName: =.AppName
    #        dataOut: FirebaseToken.edge.evid
    #    - actionType: evalObject
    #      object: .Global.updateJwt
    #    - =.Global.jwt.edgeAPI.store: ""
    - ..invite.edge.refid@: =..newAppointment2.response.edge.id
    # - actionType: evalObject
    #   object:
    #     - if:
    #       - =.builtIn.string.equal:
    #           dataIn:
    #             string1: =..getVertex.response.vertex.0.type
    #             string2: 20
    #       - actionType: evalObject
    #         object: ..trueOp
    #       - actionType: evalObject
    #         object: ..falseOp
    - ..invite.edge.refid@: =..newAppointment2.response.edge.id
    - ..invite.edge.evid@: =..getAvailability.response.edge.0.bvid
    - =..invite.edgeAPI.store: ""
  time: ""
  dataObject: ""
  formData:
    requestData: ""
  approvePatientReq:
    - =.AgreeRequest.approveRequest.edgeAPI.store: ""
  trueOp:
    # - ..invite.edge.refid@: =..newAppointment.response.edge.id
    # - ..invite.edge.name.phoneNumber@: =..getVertex.response.vertex.0.name.basicInfo.phoneNumber
    - ..invite.edge.name.name@: =..getVertex.response.vertex.0.name.basicInfo.medicalFacilityName
    - ..invite.edge.name.firstName@: ""
    - ..invite.edge.name.lastName@: ""
    - ..invite.edge.name.roomName@: ""
    - ..invite.edge.name.hostName@: =..getVertex.response.vertex.0.name.basicInfo.medicalFacilityName
  falseOp:
    # - ..invite.edge.refid@: =..newAppointment.response.edge.id
    # - ..invite.edge.name.phoneNumber@: =..getVertex.response.vertex.0.uid
    - ..invite.edge.name.name@: =..getVertex.response.vertex.0.name.userName
    - ..invite.edge.name.firstName@: =..getVertex.response.vertex.0.name.firstName
    - ..invite.edge.name.lastName@: =..getVertex.response.vertex.0.name.lastName
    - ..invite.edge.name.roomName@: =..getAvailability.response.edge.0.name.roomName
    - ..invite.edge.name.hostName@: =..getVertex.response.vertex.0.name.userName
  #get E1
  getAvailability:
    response:
    edge:
      id: .Global.appoinment.request.refid
      xfname: "id"
      type: 40000
    get:
      api: re
      dataIn: getAvailability.edge
      dataOut: getAvailability.response
  getVertex:
    response:
    vertex:
      id: ..getAvailability.response.edge.0.bvid
      xfname: "id"
    get:
      api: rv
      dataIn: getVertex.vertex
      dataOut: getVertex.response
  invite:
    edge:
      type: .EdgeType.InviteInfo
      # refid: .Global.appoinment.request.id
      refid: ""
      bvid: .Global.currentUser.vertex.id
      # bvid: .MyActiveProvider.providerId
      evid: ""
      _nonce: =.Global._nonce
      # evid: "NzczFCtoRgYkcD3yEvGhRA=="
      name:
        # phoneNumber: .Global.currentUser.vertex.uid
        firstName: ""
        lastName: ""
        # name: .Global.currentUser.vertex.name.userName
        # hostName: .Global.currentFacility.name.basicInfo.medicalFacilityName
        roomName: ""
        date: ""
    edgeAPI:
      .EdgeAPI: ""
      store:
        api: ce
        dataIn: invite.edge
  newAppointment2:
    response: ""
    edge:
      .Global.appoinment.request: ""
      # name:
      #   roomName: ..dataObject.name.visitReason
      # .Edge: ""
      # # evid: .Global.currentUser.vertex.id
      # evid: ""
      # bvid: .Global.currentUser.vertex.id
      # id: ""
      # refid: .Global.appoinment.request.id #the_selected_time_slot_edge.id
      # subtype: 2
      # type: 40000
      # name:
      #   patientName: .Global.currentUser.vertex.name.userName
      #   providerName: .Global.ActiveProvider.name
      #   visitType: ""
      #   visitTypeShow: ""
      #   visitReason: ""
      #   Reason: "Cold"
      #   blockColor: ""
      #   fontColor: ""
      #   date: ""
      #   # document
    edgeAPI:
      .EdgeAPI: ""
      store:
        api: ce
        dataIn: newAppointment2.edge
        dataOut: newAppointment2.response
  approveRequest:
    response:
    edge:
      .Edge: ""
      id: ""
      subtype: 5
      type: 40000
      bvid: .Global.currentUser.vertex.id
      refid: ..dataObject.id # E2 id
      evid: ..dataObject.bvid # patient id
      stime: ..dataObject.stime
      etime: ..dataObject.etime
      name:
        roomName: ..dataObject.name.visitReason
        setting:
          timeSlotBackColor: ..dataObject.name.blockColor
          timeSlotColor: ..dataObject.name.fontColor
          patientName: ..dataObject.name.patientName
          providerName: ..dataObject.name.providerName
          visitReason: ..dataObject.name.visitReason
          visitType: ..dataObject.name.visitType
          Reason: ..dataObject.name.Reason
    edgeAPI:
      .EdgeAPI: ""
      store:
        api: ce
        dataIn: approveRequest.edge
        dataOut: AgreeRequest.approveRequest.response
  #E0
  # updateE2Edge:
  #   edge:
  #     .AgreeRequest.dataObject: ""
  #   edgeAPI:
  #     .EdgeAPI: ""
  #     store:
  #       api: ce
  #       dataKey: updateE2Edge.edge
  getE1EdgeId:
    edge: ""
    get:
      .EdgeAPI.get: ""
      api: re
      dataKey: getE1EdgeId
      id: ..dataObject.id
      xfname: "id"
      maxcount: "1"
      _nonce: =.Global._nonce
  getE1Edge:
    edge:
    get:
      .EdgeAPI.get: ""
      api: re
      dataKey: getE1Edge
      id: ..getE1EdgeId.edge.0.refid
      xfname: "id"
      _nonce: =.Global._nonce
  # updateE1Edge:
  #   edge:
  #     .AgreeRequest.edgeE1Info: ""
  #   edgeAPI:
  #     .EdgeAPI: ""
  #     store:
  #       api: ce
  #       dataKey: updateE1Edge.edge
  sendNotification:
    document:
      .Document: ""
      eid: =..newAppointment2.response.edge.id
      subtype:
        isOnServer: 1
        isZipped: 0
        isBinary: 0
        isEncrypted: 0
        isExtraKeyNeeded: 0
        isEditable: 0
        applicationDataType: 0
        # 7 th bit
        notification: 1
        ringToneNotify: 0
        sendtoSelf: 0
        # 10 bit
        textMessage: 0
        mediaType: 8
      type: .DocType.Notification
      tage: 5
      name:
        data: ""
        notification:
          title: AiTmed Connection Request
          context: ""
          body: ""
          landingPage: WaitingRoom
          targetApp: =.Global.prodAPPID
    docAPI:
      store:
        api: cd
        dataIn: sendNotification.document
  components:
    - type: view
      style:
        left: "0"
        top: "0"
        width: "1"
        height: "1"
      children:
        - .BaseHeader:
        - type: view
          style:
            left: "0"
            top: "0.15"
            width: "1"
            height: "0.85"
          #for loop through listObject, we got each itemObject
          children:
            - type: image
              path: popUpSuccess.svg
              style:
                left: "0.35"
                top: "0.15"
                width: "0.3"
                # height: "0.21"
            - type: label
              text: "You have approved this request."
              style:
                left: "0.1"
                top: "0.35"
                width: "0.8"
                height: "0.03"
                fontSize: "20"
                fontStyle: "bold"
                color: "0x000000bb"
                display: "inline"
                textAlign:
                  x: center
                  y: center
            - type: label
              text: "Patient will receive your consent notice"
              style:
                left: "0.1"
                top: "0.42"
                width: "0.8"
                height: "0.03"
                fontSize: .Nfont.h16
                color: "0x00000088"
                display: "inline"
                textAlign:
                  x: center
                  y: center
            # - type: label
            #   dataKey: dataObject.name.firstName
            #   #text: "John"
            #   style:
            #     left: "0.1"
            #     top: "0.48"
            #     width: "0.8"
            #     height: "0.03"
            #     fontSize: .Nfont.h16
            #     color: "0x00000088"
            #     display: "inline"
            #     textAlign:
            #       x: center
            #       y: center
            # - type: label
            #   dataKey: dataObject.name.phoneNumber
            #   #text: "+1 7148397253"
            #   style:
            #     left: "0.1"
            #     top: "0.54"
            #     width: "0.8"
            #     height: "0.03"
            #     fontSize: .Nfont.h16
            #     color: "0x00000088"
            #     display: "inline"
            #     textAlign:
            #       x: center
            #       y: center
            - type: button
              onClick:
                # - actionType: evalObject
                #   object: ..updateE1
                - actionType: builtIn
                  funcName: goBack
                # - goto: PatientInWaiting
              text: Okay
              style:
                left: "0.1"
                top: "0.65"
                width: "0.8"
                height: "0.06"
                fontSize: "18"
                color: "0xffffffff"
                backgroundColor: "0x2988e6ff"
                textAlign:
                  x: center
                border:
                  style: "1"
