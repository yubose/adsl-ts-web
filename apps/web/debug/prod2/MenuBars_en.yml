MenuBars:
  pageNumber: "290" # xd page 9
  title: "Me"
  init:
    - .SignInCheck
    - ..feedback.edgeAPI.get
    # - ..avatar1.docAPI.get
    - ..profile.docAPI.get
    - if:
        - =..profile.docResponse.doc.0.id
        - actionType: evalObject
          object:
            - =.builtIn.string.concat:
                dataIn:
                  - =..profile.docResponse.doc.0.name.data.firstName
                  - " "
                  - =..profile.docResponse.doc.0.name.data.lastName
                dataOut: MenuBars.name
        - actionType: evalObject
          object:
            - .MenuBars.name@: ""
    # - actionType: evalObject
    #   object:
    #     - ..avatar1.showdocument@: =..avatar1.docResponse.doc.0
    # - actionType: evalObject
    #   object:
    #     - =.builtIn.utils.prepareDoc:
    #         dataIn:
    #           doc: =..avatar1.showdocument
    #         dataOut: MenuBars.avatar1.showdocument
    - actionType: evalObject
      object:
        - ..avatar1.url@: =..avatar1.showdocument.name.data
        - .Global.avatarUrl@: =..avatar1.showdocument.name.data
    - actionType: evalObject
      object:
        - .MenuBars.feedback.edge@: =..feedback.response.edge.0
    - if:
        - =.builtIn.string.equal:
            dataIn:
              string1: =.Global.requestListNum
              string2: "0"
        - ..requestListHidden@: true
        - ..requestListHidden@: false
    - =.builtIn.string.concat: # concat the medical facility name
        dataIn:
          - "Work For:"
          - "  "
          # - =.Global.currentFacility.name.basicInfo.medicalFacilityName
          - =.Global.dashboardName
        dataOut: MenuBars.facility
    - actionType: evalObject
      object:
        - =.builtIn.string.concat:
            dataIn:
              - "E.type=1060 AND name like 'MedicalFacilityName' OR id="
              - =.Global.currentUser.vertex.id
            dataOut: Dashboard.sCondition
        - ..listData.organizations@: =.Global.organizations

    - actionType: evalObject
      object:
        - =.builtIn.string.concat:
            dataIn:
              - =.Global.MyProfile.name.data.fullName
              - "&nbsp;-&nbsp;"
              - =.Global.MyProfile.name.data.title
            dataOut: MenuBars.formData.providerTitle
    #获取未读邮件数量
    - actionType: evalObject
      object:
        - =..apiRequest.unReadEmail.docAPI.get: ""
        - =.builtIn.array.getListLength:
            dataIn:
              object: =..apiRequest.unReadEmail.docQueryResp.doc
            dataOut: MenuBars.formData.unReadEmailNum
        - if:
            - =.builtIn.string.equal:
                dataIn:
                  string1: =..formData.unReadEmailNum
                  string2: "0"
            - ..formData.inboxHidden@: "true"
            - ..formData.inboxHidden@: "false"
    - ..formData.gotoSchedule@: false
    # 是否有facility
    - actionType: evalObject
      object:
        - if:
            - =.builtIn.string.equal:
                dataIn:
                  string1: =.Global.dashboardName
                  string2: ""
            - actionType: evalObject
              object:
                - ..formData.faciltyInfo@: "none"
                - ..formData.faciltyEmpty@: "block"
            - actionType: evalObject
              object:
                - ..formData.faciltyInfo@: "block"
                - ..formData.faciltyEmpty@: "none"
  formData:
    gotoSchedule: false
    providerTitle: ""
    unReadEmailNum: "0"
    inboxHidden: "true"
    faciltyInfo: "none"
    faciltyEmpty: "block"
  generalInfo:
    value: true
    flag: true
  listData:
    organizations: ""
  facility: ""
  requestListHidden: "true"
  name: "username"
  #获取未读邮件
  apiRequest:
    unReadEmail:
      docQueryResp: ""
      docQueryReq:
        id: .Global.currentUser.vertex.id
        ObjType: 544
        type: 1281
        sCondition: E.type=10002 AND (D2.Type&0xFF02=0xE00 OR D2.reid IS NULL OR D2.Type = 66561)
        xfname: (E.bvid|E.evid)&!D.ovid
        obfname: ctime
        maxcount: "100"
        _nonce: =.Global._nonce
      docAPI:
        get:
          api: rd
          dataIn: MenuBars.apiRequest.unReadEmail.docQueryReq
          dataOut: MenuBars.apiRequest.unReadEmail.docQueryResp
  avatar1:
    url: providerImage.svg
    showdocument:
      .Document: ""
      subtype:
        isEncrypted: "1"
        isOnServer: "0"
      type: .DocType.UserAvatar
      name:
        title: ""
        type: ..avatar1.docAPI.store.subtype.mediaType
        data: binFile
      deat:
        sig: ""
        url: ""
      eid: .Global.rootNotebookID
    document:
      .Document: ""
      subtype:
        isEncrypted: "1"
        isOnServer: "0"
      type: .DocType.UserAvatar
      name:
        title: ""
        type: ..avatar1.docAPI.store.subtype.mediaType
        data: binFile
      deat:
        sig: ""
        url: ""
      eid: .Global.rootNotebookID
    docResponse:
      doc:
        - type: .DocType.UserAvatar
          eid: .Global.rootNotebookID
          name: ""
      error: ""
      jwt: ""
    docAPI:
      get:
        .DocAPI.get: ""
        id: .Global.rootNotebookID
        xfname: eid
        type: .DocType.UserAvatar
        dataKey: avatar1.docResponse
        _nonce: .Global._nonce
        maxcount: "1"
        obfname: "ctime"
  emailList:
    email:
      edge: ""
    get:
      .EdgeAPT.get: ""
      api: re
      dataKey: emailList.email
      id: .Global.currentUser.vertex.id
      xfname: evid
      type: .EdgeType.Email
      obfname: "ctime"
      maxcount: 200
      sCondition: subtype=20
      _nonce: =.Global._nonce
  avatar:
    url: aitmedLogoBlack.svg
    document:
      .Document: ""
      subtype:
        isEncrypted: "1"
        isOnServer: "0"
      type: .DocType.UploadProfile
      name:
        title: ""
        type: ..avatar.docAPI.store.subtype.mediaType
        data: binFile
      deat:
        sig: ""
        url: ""
      eid: .Global.rootNotebookID
    docResponse:
      doc:
        - type: .DocType.UploadProfile
          eid: .Global.rootNotebookID
          name: ""
      error: ""
      jwt: ""
    docAPI:
      get:
        .DocAPI.get: ""
        id: .Global.rootNotebookID
        xfname: eid
        type: .DocType.UploadProfile
        dataKey: avatar.docResponse
        _nonce: .Global._nonce
        maxcount: "1"
        obfname: "mtime"
  feedback:
    response: ""
    edge:
      .Edge: ""
      type: .EdgeType.Feedback
      bvid: .Global.currentUser.vertex.id
      name:
        stars: 5
        content: ""
    edgeAPI:
      .EdgeAPI: ""
      store:
        api: ce
        dataKey: feedback.edge
      get:
        dataKey: feedback.response
        type: .EdgeType.Feedback
  menuBarList:
    - ImgPath: invite.svg
      Title: "Invite to join AiTmed"
      pageJump: "AddConnect"
      color: "0x000000"
    - ImgPath: greenschedule.svg
      Title: "Schedule Profile"
      pageJump: "ScheduleProfile"
      color: "0x000000"
    - ImgPath: fAQ.svg
      Title: "FAQ"
      pageJump: "FAQs"
      color: "0x000000"
    - ImgPath: search.svg
      Title: "CPT Search"
      pageJump: "CPTsearch"
      color: "0x000000"
    - ImgPath: aboutGreen.svg
      Title: "About"
      pageJump: "AboutAitmed"
      color: "0x000000"
    - ImgPath: tool.svg
      Title: "Customer Support"
      pageJump: "ConactSupport"
      color: "0x000000"
    - ImgPath: logout2.svg
      Title: "Log out"
      pageJump: "LogOut"
      color: "0xfd3a3a"
  profile:
    docResponse:
      doc:
        type: .DocType.DoctorProfile
        eid: .Global.rootNotebookID
        name:
          data:
            firstName: ""
            middleName: ""
            lastName: ""
            title: ""
            userName: ""
            phone: ""
            email: ""
            fax: ""
            address: ""
            specialty: []
            NPI: ""
            medicalLicenseState: ""
            medicalLicense: ""
            licenseExpiration: ""
            DEA: ""
            boardCertified: ""
            avatar: ""
    docAPI:
      get:
        .DocAPI.get: ""
        api: rd
        id: .Global.rootNotebookID
        xfname: eid
        type: .DocType.DoctorProfile
        dataKey: profile.docResponse
        _nonce: =.Global._nonce
  components:
    - type: popUp
      viewTag: softTips
      style:
        top: "0"
        left: "0"
        width: "1"
        height: "1"
        backgroundColor: "0x00000066"
        zIndex: "1000"
        textAlign:
          y: center
      onClick:
        - actionType: popUpDismiss
          popUpView: __.viewTag
      children:
        - type: view
          style:
            width: "0.64"
            marginLeft: "0.18"
            backgroundColor: "0xE6E6E6"
            borderRadius: "14px"
            textAlign:
              x: center
          children:
            - type: label
              # text: ___.message
              textBoard:
                - text: "You need to "
                - text: "&nbsp;"
                - text: "contact facility first"
                  color: "#2988e6"
                - text: "&nbsp;"
                - text: ",or you can't schedule with patients in our platform"
              style:
                width: "0.476"
                marginLeft: "0.082"
                marginTop: "0.027"
                fontSize: .Nfont.h14
                fontFamily: "Arial"
                textAlign:
                  x: center
                color: "0x333333"
            - type: view
              style:
                height: "0.027"
    - .TipsOneLine:
      message: Please add a facility
      viewTag: noOrganizationView1
    # - type: popUp
    #   message: "Please add a facility"
    #   viewTag: noOrganizationView1
    #   colorChange: "0x2988e6"
    #   imgPath: aboutBlue.svg
    #   otherAction:
    #   style:
    #     width: "1"
    #     height: "1"
    #     top: "0"
    #     left: "0"
    #     backgroundColor: "0xffffff00"
    #     zIndex: "1000"
    #     # isHidden: .Global.nonFirstProfile
    #   children:
    #     - type: view
    #       style:
    #         width: "0.8"
    #         height: "0.3"
    #         top: "0.3"
    #         left: "0.1"
    #         zIndex: "10000"
    #         backgroundColor: "0xffffff"
    #         borderRadius: "7"
    #         border:
    #           style: "3"
    #         borderColor: "#f4f8fa"
    #         borderWidth: "3"
    #       children:
    #         - .BaseCheckViewImg:
    #         - .BaseCheckViewLabel:
    #         - .BaseCheckViewButton:
    #           onClick:
    #             - actionType: evalObject
    #               object:
    #                 - ..formData.gotoSchedule@: false
    #             - actionType: popUpDismiss
    #               popUpView: ____.viewTag
    - .BaseHeader:

    - type: view
      style:
        top: "0.1"
        height: "0.8"
        width: "1"
        # backgroundColor: "pink"
      children:
        # avatar
        - type: view
          style:
            height: "auto"
            marginTop: "0.03"
          children:
            - type: view
              style:
                width: auto
                # border:
                #   style: "2"
                # borderWidth: "2"
                borderColor: "0xdddddd"
                display: inline-block
                verticalAlign: middle
              children:
                - type: view
                  style:
                    marginLeft: "0.08"
                    width: "0.22"
                    overflow: hidden
                    textAlign:
                      x: center
                      y: center
                  children:
                    - type: image
                      style:
                        height: "0.1"
                      path: providerImage.svg
                      path=func: =.builtIn.utils.prepareDocToPath
                      dataKey: Global.MyProfile.name.data.avatar
            - type: view
              style:
                height: auto
                width: "0.42"
                marginLeft: "0.05"
                display: inline-block
                verticalAlign: middle
              children:
                - type: label
                  dataKey: formData.providerTitle
                  style:
                    color: "0x333333"
                    fontWeight: 700
                    fontFamily: Airal
                    fontSize: .Nfont.h18
                    wordWrap: break-word
                    width: "0.42"
                - type: view
                  style:
                    height: auto
                    marginTop: "0.005"
                    width: auto
                  children:
                    - type: label
                      text: "User Name:"
                      style:
                        color: "#666666"
                        fontFamily: Airal
                        fontSize: .Nfont.h14
                        display: inline-block
                    - type: label
                      dataKey: Global.currentUser.vertex.name.userName
                      style:
                        fontFamily: Airal
                        color: "#666666"
                        marginLeft: "0.01"
                        fontSize: .Nfont.h14
                        display: inline-block

            - type: view
              style:
                height: auto
                width: auto
                marginLeft: "0.026"
                display: inline-block
                verticalAlign: middle
              children:
                - type: image
                  onClick:
                    - goto: MyQRCode
                  path: qrCode1.svg
                  style:
                    width: "0.06"
                    display: inline-block
                    verticalAlign: middle
                - type: image
                  path: blueRight.svg
                  style:
                    width: "0.035"
                    marginLeft: "0.06"
                    display: inline-block
                    verticalAlign: middle
                  # children:

                  #     style:
                  #       height: "0.025"
                  onClick:
                    - actionType: evalObject
                      object:
                        - if:
                            - =.builtIn.string.equal:
                                dataIn:
                                  string1: =.Global.providerProfileVar
                                  string2: "About"
                            - continue
                            - .Global.providerProfileVar@: "About"
                    - goto: MyProfile
        - type: label
          dataKey: MenuBars.facility
          viewTag: faciltyTag
          style:
            display: ..formData.faciltyInfo
            marginLeft: "0.3493"
            width: "0.6"
            height: "auto"
            color: "#2988e6"
            textAlign:
              x: left
            fontSize: ".Nfont.h12"
            fontWeight: "400"
            overflow: hidden
            textOverflow: ellipsis
            whiteSpace: nowrap
        - type: view
          style:
            display: ..formData.faciltyEmpty
            marginLeft: "0.3493"
            width: "0.6"
            height: "auto"
          children:
            - type: image
              path: videoWarn.svg
              style:
                display: "inline-block"
                height: "0.0172"
                verticalAlign: middle
            - type: label
              text: "Work For: No Facility"
              dataKey:
              onClick:
                - actionType: popUp
                  popUpView: "softTips"
              style:
                marginLeft: "0.02"
                display: "inline-block"
                height: "auto"
                width: "auto"
                fontSize: ".Nfont.h12"
                fontWeight: "600"
                verticalAlign: middle
                color: "0xfb5051"

        - type: view
          style:
            width: "1"
            height: "0.02"
            borderColor: "0xDEDEDF"
            border:
              style: "2"
            borderWidth: "2"
        - type: view
          style:
            width: "1"
            height: "0.5"
            left: "0"
          children:
            - type: list
              contentType: listObject
              listObject: ..menuBarList
              iteratorVar: itemObject
              viewTag: calendarColor
              style:
                width: "1"
                left: "0"
                margin: "0"
                marginTop: "0"
                height: "0.5"

              children:
                - type: listItem
                  itemObject: ""
                  style:
                    width: "1"
                    left: "0"
                    marginTop: "0"
                    height: "0.06"
                    backgroundColor: "0xffffff"
                    border:
                      style: "2"
                    borderWidth: "2"
                    borderColor: "0xdddddd"
                  onClick:
                    - emit:
                        dataKey:
                          var: itemObject
                        actions:
                          - if:
                              - =.builtIn.string.equal:
                                  dataIn:
                                    string1: $var.Title
                                    string2: Schedule Profile
                              - ..formData.gotoSchedule@: true
                              - continue
                    - actionType: evalObject
                      object:
                        - if:
                            - =..formData.gotoSchedule
                            - actionType: evalObject
                              object:
                                - if:
                                    - =.Global.hasOrganization
                                    - continue
                                    - actionType: popUp
                                      popUpView: noOrganizationView1
                                      wait: true
                            - continue
                    - emit:
                        dataKey:
                          var: itemObject
                        actions:
                          - if:
                              - true
                              - goto: $var.pageJump
                              - goto: $var.pageJump
                  children:
                    - type: image
                      path:
                        emit:
                          dataKey:
                            var: itemObject
                          actions:
                            - if:
                                - =$var.ImgPath
                                - $var.ImgPath
                                - $var.ImgPath
                      style:
                        height: "0.03"
                        top: "0.015"
                        left: "0.1"
                    - type: label
                      dataKey: itemObject.Title
                      style:
                        top: "0"
                        width: "0.5"
                        left: "0.23"
                        fontSize: .Nfont.h2
                        height: "0.06"
                        textAlign:
                          y: center
                        color: itemObject.color
            # - type: view
            #   onClick:
            #     - actionType: popUp
            #       popUpView: selectOrganizationView
            #   style:
            #     width: "1"
            #     left: "0"
            #     height: "0.06"
            #     backgroundColor: "0xffffff"
            #     border:
            #       style: "2"
            #     borderWidth: "2"
            #     borderColor: "0xdddddd"
            #   children:
            #     - type: image
            #       path: switch.svg
            #       style:
            #         height: "0.03"
            #         top: "0.015"
            #         left: "0.1"
            #     - type: label
            #       text: Switch Organizations
            #       style:
            #         top: "0"
            #         width: "0.5"
            #         left: "0.23"
            #         fontFamily: sans-serif
            #         fontWeight: "500"
            #         height: "0.06"
            #         fontSize: .Nfont.h2
            #         textAlign:
            #           y: center
            #         color: "0x000000"
            # - type: view
            #   onClick:
            #     - goto: LogOut
            #   style:
            #     width: "1"
            #     marginTop: "0"
            #     height: "0.06"
            #     left: "0"
            #     backgroundColor: "0xffffff"
            #     border:
            #       style: "2"
            #     borderWidth: "2"
            #     borderColor: "0xdddddd"
            #   children:
            #     - type: image
            #       path: logout2.svg
            #       style:
            #         height: "0.03"
            #         top: "0.015"
            #         left: "0.1"
            #     - type: label
            #       text: Log out
            #       style:
            #         top: "0"
            #         width: "0.5"
            #         fontFamily: sans-serif
            #         fontWeight: "500"
            #         left: "0.23"
            #         height: "0.06"
            #         fontSize: .Nfont.h2
            #         textAlign:
            #           y: center
            #         color: "0xfd3a3a"
    - .footerBox:
      style:
        top: "0.9"
      children:
        - .footerMenuBox:
          onClick:
            - goto: "Dashboard"
          children:
            - .footerMenuImg:
              path: dashboard0.svg
            - .footerMenuLabel:
              text: Dashboard

        - .footerMenuBox:
          onClick:
            - goto: "InboxDashboard"
          children:
            - .footerMenuImg:
              path: inbox0.svg
            - .footerMenuLabel:
              text: Inbox
            - .numberMark:
              dataKey: formData.unReadEmailNum
              style:
                isHidden: ..formData.inboxHidden

        - .footerMenuBox:
          onClick:
            - goto: AppointmentSchedule
          children:
            - .footerMenuImg:
              path: schedule0.svg
            - .footerMenuLabel:
              text: Schedule

        - .footerMenuBox:
          onClick:
            - goto: MenuBars
          children:
            - .footerMenuImg:
              path: meYellow.svg
            - .footerMenuLabel:
              text: Me
              style:
                color: "0xfece55"

    - type: popUp
      viewTag: selectOrganizationView
      style:
        left: "0"
        width: "1"
        top: "0"
        height: "1"
        backgroundColor: "0x00000033"
      children:
        - type: scrollView
          style:
            left: "0.05"
            width: "0.9"
            top: "0.6"
            height: "0.27"
            backgroundColor: "0xFFFFFF"
            borderRadius: "10"
          children:
            - type: label
              text: switch to another organization
              style:
                top: "0.02"
                width: "0.9"
                textAlign:
                  x: center
            - .BaseList:
              listObject: ..listData.organizations
              style:
                width: "0.9"
                height: "auto"
                left: "0"
                top: "0.05"
                backgroundColor: "0xffffff"
                border:
                  style: "3"
                borderWidth: "1"
                borderColor: "0xf0f0f0"
                borderRadius: "5"
              children:
                - .BaseListItem:
                  onClick:
                    - actionType: evalObject
                      object:
                        - .Global.organizations@: =..listData.organizations
                    - actionType: evalObject
                      object:
                        - =.builtIn.string.concat:
                            dataIn:
                              - "Work For:"
                              - "  "
                              - =.Global.currentFacility.name.basicInfo.medicalFacilityName
                            dataOut: MenuBars.facility
                        - .Global.dashboardName@: =.Global.currentFacility.name.basicInfo.medicalFacilityName
                    - actionType: builtIn
                      funcName: redraw
                      viewTag: faciltyTag
                    - actionType: popUpDismiss
                      popUpView: selectOrganizationView
                  style:
                    width: "0.9"
                    height: "0.07"
                    border:
                      style: "2"
                    borderWidth: "1"
                    borderColor: "0xf0f0f0"
                  children:
                    - type: label
                      dataKey: itemObject.name.basicInfo.medicalFacilityName
                      style:
                        left: "0"
                        width: "0.9"
                        height: "0.07"
                        fontSize: .Nfont.h3
                        textAlign:
                          x: center
                          y: center
        - type: label
          text: Cancel
          onClick:
            - actionType: popUpDismiss
              popUpView: selectOrganizationView
          style:
            top: "0.88"
            width: "0.9"
            height: "0.07"
            left: "0.05"
            fontSize: .Nfont.h3
            backgroundColor: "0xFFFFFF"
            fontStyle: bold
            borderRadius: "10"
            color: "#2988e6"
            textAlign:
              x: center
              y:
                center
                # - .DashboardListImg:
                #   path:
                #     emit:
                #       dataKey:
                #         var: itemObject
                #       actions:
                #         - if:
                #             - =.builtIn.string.equal:
                #                 dataIn:
                #                   string1: =..generalInfo.value
                #                   string2: $var.isSelected
                #             - selectOn.svg
                #             - selectOff.svg
                #   onClick:
                #     - actionType: evalObject
                #       object:
                #         - if:
                #           - =.builtIn.string.equal:
                #               dataIn:
                #                 string1: true
                #                 string2: itemObject.isSelected
                #           - actionType: evalObject
                #             object:
                #               - =.builtIn.array.toggleStatus:
                #                   dataIn:
                #                     object: =..listData.organizations
                #                     key: isSelected
                #                     flag: false
                #               - =.builtIn.object.set:
                #                   dataIn:
                #                     object: =..generalInfo
                #                     key: flag
                #                     value: true
                #           - actionType: evalObject
                #             object:
                #               - actionType: updateObject
                #                 dataKey: Global.currentFacility
                #                 dataObject: itemObject
                #               - =.builtIn.array.toggleStatus:
                #                   dataIn:
                #                     object: =..listData.organizations
                #                     key: isSelected
                #                     flag: false
                #               - =.builtIn.object.set:
                #                   dataIn:
                #                     object: =..generalInfo
                #                     key: flag
                #                     value: false
                #     - emit:
                #         dataKey:
                #           var: itemObject
                #         actions:
                #           - if:
                #               - =.builtIn.string.equal:
                #                   dataIn:
                #                     string1: =..generalInfo.value
                #                     string2: =..generalInfo.flag
                #               - =.builtIn.array.toggleStatus:
                #                   dataIn:
                #                     object: =..listData.organizations
                #                     key: isSelected
                #                     flag: false
                #               - =.builtIn.object.set:
                #                   dataIn:
                #                     object: $var
                #                     key: isSelected
                #                     value: true
                #     - actionType: evalObject
                #       object:
                #         - .Global.organizations@: =..listData.organizations
                #     - actionType: evalObject
                #       object:
                #         - =.builtIn.string.concat:
                #             dataIn:
                #               - "Work For:"
                #               - "  "
                #               - =.Global.currentFacility.name.basicInfo.medicalFacilityName
                #             dataOut: MenuBars.facility
                #         - .Global.dashboardName@: =.Global.currentFacility.name.basicInfo.medicalFacilityName
                #     - actionType: builtIn
                #       funcName: redraw
                #       viewTag: faciltyTag
                #     - actionType: popUpDismiss
                #       popUpView: selectOrganizationView
                # - .DashboardListText1:
                #   dataKey: itemObject.name.basicInfo.medicalFacilityName
                #   style:
                #     left: "0.1"
