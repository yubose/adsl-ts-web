CreateAppointmentNew:
  title: "Change Appointment"
  init:
    - .SignInCheck
    - ..dataObject@: =.Global.roomInfo.edge
    - actionType: evalObject
      object:
        .Global._nonce@:
          =.builtIn.math.random: ""
    - =.builtIn.number.transformSubtype:
        dataIn:
          subtype: =..dataObject.subtype
          addition: 1
        dataOut: CreateAppointmentNew.formData.currentSubtype
    - .Global.patientChartDoc@: ""
    - .Global.visitQuestionnaireDoc@: ""
    - .Global.generalInfoDoc@: ""
    - .Global.vaccine@: []
    - .Global.vaccineDoc@: []
    - actionType: evalObject
      object:
        - .BaseComponents.calendarDate.year@: ""
        - .BaseComponents.calendarDate.month@: ""
        - .BaseComponents.calendarDate.day@: ""
        - .BaseComponents.calendarDate.monthName@: ""
        - .BaseComponents.calendarDate.todayDate@: ""
        - .BaseComponents.calendarDate.flag@: ""
        - .BaseComponents.calendarDate.dayLable@: []
        - .BaseComponents.year@: []
        - .BaseComponents.flag: ""
        #生成年份
        - =.builtIn.date.generateYear:
            dataIn:
              last: 121
              next: 10
            dataOut: BaseComponents.year
        - =.builtIn.date.getYear:
            dataIn:
            dataOut: CreateAppointmentNew.calendarDate.year
    - actionType: evalObject
      object:
        #获取当前时间的unix时间戳
        - =.builtIn.date.getNowLocalUnixTime:
            dataIn: ""
            dataOut: CreateAppointmentNew.formData.currentLocalTime
        #设置可预约时间的scondition
        - =.builtIn.string.concat:
            dataIn:
              - "(etime>"
              - =..formData.currentLocalTime
              - " OR "
              - "stime>="
              - =..formData.currentLocalTime
              - ")"
              - " AND "
              - "subtype="
              - =..formData.currentSubtype
            dataOut: Global.scheduleScondition2
        - =.CreateAppointmentNew.apiRequest.getFirstAvail.edgeAPI.get: ""
        - ..formData.isApiRequest@: =..apiRequest.getFirstAvail.response.edge.0
        - if:
            - =..formData.isApiRequest.id
            - actionType: evalObject
              object:
                - =.builtIn.date.stampToDay:
                    dataIn:
                      timeStamp: =..apiRequest.getFirstAvail.response.edge.0.stime
                    dataOut: CreateAppointmentNew.formData.adjacentEdgeTime
                - .CreateAppointmentNew.calendarDate.year@: =.CreateAppointmentNew.formData.adjacentEdgeTime.year
                - .CreateAppointmentNew.calendarDate.month@: =.CreateAppointmentNew.formData.adjacentEdgeTime.month
                - .CreateAppointmentNew.calendarDate.day@: =.CreateAppointmentNew.formData.adjacentEdgeTime.day
            - actionType: evalObject
              object:
                - =.builtIn.date.getMonth:
                    dataIn: ""
                    dataOut: CreateAppointmentNew.calendarDate.month
                - =.builtIn.date.getYear:
                    dataIn: ""
                    dataOut: CreateAppointmentNew.calendarDate.year
                - =.builtIn.date.getDate:
                    dataIn: ""
                    dataOut: CreateAppointmentNew.calendarDate.day
    - actionType: evalObject
      object:
        - =.builtIn.date.transformMonth:
            dataIn:
              month: =..calendarDate.month
            dataOut: CreateAppointmentNew.calendarDate.monthName
    - actionType: evalObject
      object:
        - =.builtIn.string.concat:
            dataIn:
              - =..calendarDate.year
              - "-"
              - =..calendarDate.month
              - "-"
              - =..calendarDate.day
            dataOut: CreateAppointmentNew.calendarDate.todayDate
    - actionType: evalObject
      object:
        - =.builtIn.date.getTimeStampOfDate:
            dataIn:
              date: =..calendarDate.todayDate
            dataOut: CreateAppointmentNew.calendarDate.todayStamp
        - =..apiRequest.appointment_E1.edgeAPI.get: ""
        - =.builtIn.array.push:
            dataIn:
              messages: =..schedule.edge.id
              newMessage: =..apiRequest.appointment_E1.edgeQueryResp.edge.0.evid
            dataOut: CreateAppointmentNew.schedule.edge.id
        - =.builtIn.array.push:
            dataIn:
              messages: =..schedule.edge.id
              newMessage: =..apiRequest.appointment_E1.edgeQueryResp.edge.0.bvid
            dataOut: CreateAppointmentNew.schedule.edge.id
    - actionType: evalObject
      object:
        - =.builtIn.string.concat:
            dataIn:
              - "(stime<="
              - =..calendarDate.todayStamp.start
              - " AND "
              - "etime>="
              - =..calendarDate.todayStamp.start
              - " OR "
              - "stime>="
              - =..calendarDate.todayStamp.start
              - " AND "
              - "etime<="
              - =..calendarDate.todayStamp.end
              - " OR "
              - "stime<="
              - =..calendarDate.todayStamp.end
              - " AND "
              - "etime>="
              - =..calendarDate.todayStamp.end
              - ")"
              - " AND "
              - "subtype="
              - =..formData.currentSubtype
            dataOut: Global.scheduleScondition
    - actionType: evalObject
      object:
        - =..schedule.get: ""
    - actionType: evalObject
      object:
        - =.builtIn.date.ShowDateByNumber:
            dataIn:
              year: =..calendarDate.year
              month: =..calendarDate.month
              day: =..calendarDate.day
            dataOut: CreateAppointmentNew.selectDate
    - actionType: evalObject
      object:
        - =.builtIn.date.miniWeeklyCalendarArray:
            dataIn:
              year: =..calendarDate.year
              month: =..calendarDate.month
              today: =..calendarDate.day
              markDay: =..calendarDate.day
              color: "0x4b4b4b"
              backgroundColor: "0xffffff00"
              todayColor: "0xffffff"
              todayBackgroundColor: "0x2988e6"
              currentDateTime: =.calendarDate.todayDate
              pastTimeColor: "0xbababa"
            dataOut: CreateAppointmentNew.calendarDate.dayLable
    - actionType: evalObject
      object:
        ..visitReason.document@: =..visitReason.response.doc.0
    - actionType: evalObject
      object:
        - =..schedule.get: ""
        - =.builtIn.date.splitTime:
            dataIn:
              object2: =..schedule.scheduleList.edge
              timeSlot: =..dataObject.name.duration
              year: =..calendarDate.year
              month: =..calendarDate.month
              day: =..calendarDate.day
              isSplitCurrent: true
            dataOut: CreateAppointmentNew.splitTime
    - =.builtIn.date.getTime:
        dataIn:
        dataOut: CreateAppointmentNew.nowTimeStamp
  splitTime:
    morning: []
    afternoon: []
  reasonForVisit: []
  temporaryInfo: ""
  reason: ""
  duration: ""
  selectDate: ""
  visitType: "Telemedicine"
  docu: []
  clock: ""
  currentFaci:
    vertexResp: ""
    vertexIn:
      ObjType: 4
      id: ""
      xfname: "E.bvid|E.evid"
      sCondition: "E.type=1100 AND V.type=20"
      _nonce: =.Global._nonce
      maxcount: "1"
    vertexAPI:
      get:
        api: rv
        dataIn: currentFaci.vertexIn
        dataOut: CreateAppointmentNew.currentFaci.vertexResp
  visitReason:
    response: ""
    document:
      type: .DocType.VisitReason
      name:
        data:
          reasonForVisit: []
      eid: .Global.rootNotebookID
    docQueryReq:
      type: .DocType.VisitReason
      id: ..formData.doctorId
      obfname: ctime
      xfname: ovid
      _nonce: =.Global._nonce
    docAPI:
      get:
        api: rd
        dataIn: CreateAppointmentNew.visitReason.docQueryReq
        dataOut: CreateAppointmentNew.visitReason.response
  formData:
    adjacentEdgeTime: ""
    doctorId: .Global.currentUser.vertex.id
    rootnootbookInfo:
    rootnootbookId: ""
    duration: ""
    currentSubtype: "196609"
    currentLocalTime: ""
    nextBtnColor: "0xc1c1c1"
    isApiRequest:
      id: ""
  checkData:
    check:
      edge: ""
    get:
      edgeAPI.get: ""
      api: re
      dataKey: checkData.check
      id:
        - .Global.currentUser.vertex.id
        - .Global.currentUser.vertex.id
      xfname: bvid,evid
      type: 40000
      sCondition: "subtype=196609"
      _nonce: =.Global._nonce
  save:
    - =.CreateAppointmentNew.newAppointment.edgeAPI.store: ""
  schedule:
    response: ""
    scheduleList: ""
    edge:
      type: 40000
      id: []
      sCondition: =.Global.scheduleScondition
      maxcount: "10000"
      xfname: bvid,evid
      obfname: "stime"
      asc: true
      _nonce: =.Global._nonce
    get:
      api: re
      dataIn: CreateAppointmentNew.schedule.edge
      dataOut: CreateAppointmentNew.schedule.scheduleList
  todaySchedule: ""
  calendarDate:
    month: ""
    year: ""
    day: ""
    dayLable: []
    weekLabel:
      - key: SU
      - key: MO
      - key: TU
      - key: WE
      - key: TH
      - key: FR
      - key: SA
    todayDate: "YYYY-MM-DD"
    monthName: ""
    tempDate: ""
    calendarDate:
    Scondition: ""
    todayStamp: ""
  nowTimeStamp: ""
  apiRequest:
    # get e1 so that get e1.bvid and evid
    appointment_E1:
      edgeQueryReq:
        ObjType: 4
        id: .Global.roomInfo.edge.id
        xfname: E.id
      edgeQueryResp: ""
      edgeAPI:
        get:
          api: re
          dataIn: CreateAppointmentNew.apiRequest.appointment_E1.edgeQueryReq
          dataOut: CreateAppointmentNew.apiRequest.appointment_E1.edgeQueryResp
    #获取最近可预约时间段
    getFirstAvail:
      response: ""
      edge:
        type: 40000
        id: .Global.currentUser.vertex.id
        sCondition: "=.Global.scheduleScondition2"
        maxcount: "1"
        xfname: "evid"
        obfname: "stime"
        asc: true
        _nonce: =.Global._nonce
      edgeAPI:
        get:
          .EdgeAPI.get: ""
          api: re
          dataIn: CreateAppointmentNew.apiRequest.getFirstAvail.edge
          dataOut: CreateAppointmentNew.apiRequest.getFirstAvail.response
  components:
    - .BaseHeader:
    - .HeaderLeftButton:
    - .BackgroundColorGray:
      style:
        zIndex: 1000
      viewTag: timeWarning
      onClick:
        - actionType: popUpDismiss
          popUpView: timeWarning
      children:
        - type: view
          style:
            width: "0.4"
            height: "0.14"
            backgroundColor: "0xe5e5e5"
            borderRadius: "12"
            top: "0.43"
            left: "0.3"
            textAlign:
              x: center
          children:
            - type: image
              path: aboutRed.svg
              style:
                width: "0.105"
                marginTop: "0.025"
            - type: label
              text: "Please select an appointment time"
              dataKey:
              style:
                color: "0x555555"
                fontSize: .Nfont.h12
                fontFamily: "Arial"
                width: "0.35"
                marginLeft: "0.025"
                marginTop: "0.009"
                textAlign:
                  x: center
    - .BackgroundColorGray:
      style:
        zIndex: 1000
      viewTag: noAvailableTag
      onClick:
        - actionType: evalObject
          object:
            - ..calendarDate@: =..temporaryInfo
            - ..temporaryInfo@: ""
            - =.builtIn.date.ShowDateByNumber:
                dataIn:
                  year: =..calendarDate.year
                  month: =..calendarDate.month
                  day: =..calendarDate.day
                dataOut: CreateAppointmentNew.selectDate
            - ..splitTime@: =..formData.temporarySplitTime
        - actionType: popUpDismiss
          popUpView: noAvailableTag
      children:
        - type: view
          style:
            width: "0.51"
            height: auto
            backgroundColor: "0xe5e5e5"
            borderRadius: "12"
            top: "0.41"
            left: "0.24"
            textAlign:
              x: center
          children:
            - type: image
              path: aboutRed.svg
              style:
                width: "0.105"
                marginTop: "0.03"
                textAlign:
                  x: center
            - type: label
              text: "There is no appointment available"
              dataKey:
              style:
                color: "0x555555"
                fontSize: .Nfont.h1
                width: "0.43"
                height: auto
                marginLeft: "0.04"
                fontFamily: "Arial"
                # margin: auto
                word-break: break-word
                marginTop: "0.01"
                textAlign:
                  x: center
            - type: view
              style:
                width: "0.01"
                height: "0.015"
    - .BackgroundColorGray:
      style:
        zIndex: 1000
      viewTag: dateCheck
      onClick:
        - actionType: evalObject
          object:
            - ..calendarDate@: =..temporaryInfo
            - ..temporaryInfo@: ""
            - =.builtIn.date.ShowDateByNumber:
                dataIn:
                  year: =..calendarDate.year
                  month: =..calendarDate.month
                  day: =..calendarDate.day
                dataOut: CreateAppointmentNew.selectDate
        - actionType: popUpDismiss
          popUpView: dateCheck
      children:
        - type: view
          style:
            width: "0.51"
            height: auto
            backgroundColor: "0xe5e5e5"
            borderRadius: "12"
            top: "0.41"
            left: "0.24"
            textAlign:
              x: center
          children:
            - type: image
              path: aboutRed.svg
              style:
                width: "0.105"
                marginTop: "0.03"
                textAlign:
                  x: center
            - type: label
              text: "Please don't choose the past time"
              dataKey:
              style:
                color: "0x555555"
                fontSize: .Nfont.h1
                width: "0.43"
                height: auto
                fontFamily: "Arial"
                marginLeft: "0.04"
                textAlign:
                  x: center
                word-break: break-word
                marginTop: "0.01"
            - type: view
              style:
                width: "0.01"
                height: "0.015"
    # - .BaseCheckView:
    #   viewTag: noAvailableTag
    #   message: "There is no appointment available"
    #   colorChange: "0x2988e6"
    #   imgPath: aboutBlue.svg
    #   children:
    #     - type: view
    #       style:
    #         width: "0.8"
    #         height: "0.3"
    #         top: "0.3"
    #         left: "0.1"
    #         zIndex: "100"
    #         backgroundColor: "0xffffff"
    #         borderRadius: "7"
    #         border:
    #           style: "3"
    #         borderColor: "#f4f8fa"
    #         borderWidth: "3"
    #       children:
    #         - .BaseCheckViewImg:
    #         - .BaseCheckViewLabel:
    #         - .BaseCheckViewButton:
    #           onClick:
    #             - actionType: evalObject
    #               object:
    #                 - ..calendarDate@: =..temporaryInfo
    #                 - ..temporaryInfo@: ""
    #                 - =.builtIn.date.ShowDateByNumber:
    #                     dataIn:
    #                       year: =..calendarDate.year
    #                       month: =..calendarDate.month
    #                       day: =..calendarDate.day
    #                     dataOut: CreateAppointmentNew.selectDate
    #             - actionType: popUpDismiss
    #               popUpView: ____.viewTag
    # - .BaseCheckView:
    #   viewTag: dateCheck
    #   message: "Please don't choose the past time"
    #   colorChange: "0xd81e06"
    #   imgPath: popUpWrong.svg
    #   children:
    #     - type: view
    #       style:
    #         width: "0.8"
    #         height: "0.3"
    #         top: "0.3"
    #         left: "0.1"
    #         zIndex: "100"
    #         backgroundColor: "0xffffff"
    #         borderRadius: "7"
    #         border:
    #           style: "3"
    #         borderColor: "#f4f8fa"
    #         borderWidth: "3"
    #       children:
    #         - .BaseCheckViewImg:
    #         - .BaseCheckViewLabel:
    #         - .BaseCheckViewButton:
    #           onClick:
    #             - actionType: evalObject
    #               object:
    #                 - ..calendarDate@: =..temporaryInfo
    #                 - ..temporaryInfo@: ""
    #                 - =.builtIn.date.ShowDateByNumber:
    #                     dataIn:
    #                       year: =..calendarDate.year
    #                       month: =..calendarDate.month
    #                       day: =..calendarDate.day
    #                     dataOut: CreateAppointmentNew.selectDate
    #             - actionType: popUpDismiss
    #               popUpView: ____.viewTag
    - type: view
      style:
        width: "1"
        height: "0.9"
        top: "0.1"
      children:
        - type: view
          style:
            width: "0.9"
            height: "0.2"
            left: "0.06"
          children:
            - type: view
              style:
                marginTop: "0.015"
                height: "0.1"
              children:
                - .questionTitle:
                  text: "Appointment Type"
                - .questionTextField:
                  # placeholder: "Telemedicine"
                  dataKey: dataObject.name.visitType
                  style:
                    borderColor: "0xdededf"
                    borderRadius: "5"
                    borderWidth: "1"
                    border:
                      style: "3"
                    width: "0.89"
            - type: view
              style:
                height: "auto"
                width: "0.9"
              children:
                - type: view
                  style:
                    width: "0.45"
                    display: "inline-block"
                  children:
                    - .questionTitle:
                      text: "Reason for visit"
                    - .questionTextField:
                      # placeholder: "Follow-up"
                      dataKey: dataObject.name.Reason
                      style:
                        borderColor: "0xdededf"
                        borderRadius: "5"
                        borderWidth: "1"
                        border:
                          style: "3"
                        width: "0.45"
                - type: view
                  style:
                    width: "0.25"
                    display: "inline-block"
                    marginLeft: "0.05"
                  children:
                    - .questionTitle:
                      text: "Duration (min)"
                    - .questionTextField:
                      # placeholder: "15min"
                      dataKey: dataObject.name.duration
                      style:
                        borderColor: "0xdededf"
                        borderRadius: "5"
                        borderWidth: "1"
                        width: "0.25"
                        border:
                          style: "3"
                - type: view
                  style:
                    width: "0.1"
                    display: "inline-block"
                    marginLeft: "0.05"
                  children:
                    - .questionTitle:
                      # text: "Files"
                      style:
                        color: "#2988e6"
                        textDecoration: underline
                        marginTop: "0.05"
        - type: view
          viewTag: setSchedule
          style:
            marginTop: "0.01"
            height: "auto"
            width: "1"
            backgroundColor: "0xe9f2fc"
            overflow: hidden
          children:
            - type: view
              style:
                marginTop: "0.01"
                marginLeft: "0.05"
                height: "0.04"
                width: "0.9"
              children:
                - type: select
                  dataKey: calendarDate.monthName
                  options: .BaseComponents.month
                  style:
                    verticalAlign: "middle"
                    display: "inline-block"
                    width: "0.15"
                    height: "0.03"
                    boxSizing: "border-box"
                    border:
                      style: 1
                    color: "0x474747"
                    fontSize: .Nfont.h1
                    backgroundColor: "0xe9f2fc"
                  onChange:
                    - actionType: evalObject
                      object:
                        - .BaseComponents.calendarDate.monthName@: =..calendarDate.monthName
                        - .BaseComponents.calendarDate.year@: =..calendarDate.year
                        - =.builtIn.date.transformMonth:
                            dataIn:
                              month: =.BaseComponents.calendarDate.monthName
                              flag: 2
                            dataOut: CreateAppointmentNew.calendarDate.month
                        - =.builtIn.date.calendarArray:
                            dataIn:
                              year: =.BaseComponents.calendarDate.year
                              month: =.BaseComponents.calendarDate.month
                              today: 1
                            dataOut: CreateAppointmentNew.calendarDate.dayLable
                        - .BaseComponents.calendarDate.day@: 1
                        - =.builtIn.date.miniWeeklyCalendarArray:
                            dataIn:
                              year: =..calendarDate.year
                              month: =..calendarDate.month
                              today: 33
                              markDay: 1
                              color: "0x4b4b4b"
                              backgroundColor: "0xffffff00"
                              todayColor: "0xffffff"
                              todayBackgroundColor: "0x2988e6"
                              currentDateTime: =.CreateAppointmentNew.calendarDate.todayDate
                              pastTimeColor: "0xbababa"
                            dataOut: CreateAppointmentNew.calendarDate.dayLable
                    - actionType: builtIn
                      funcName: redraw
                      viewTag: setSchedule
                - type: select
                  dataKey: calendarDate.year
                  options: .BaseComponents.year
                  style:
                    verticalAlign: "middle"
                    display: "inline-block"
                    marginLeft: "0.02"
                    width: "0.15"
                    height: "0.03"
                    boxSizing: "border-box"
                    border:
                      style: 1
                    color: "0x474747"
                    fontSize: .Nfont.h1
                    backgroundColor: "0xe9f2fc"
                  onChange:
                    - actionType: evalObject
                      object:
                        - .BaseComponents.calendarDate.year@: =..calendarDate.year
                        - =.builtIn.date.transformYear:
                            dataIn:
                              year: =..calendarDate.year
                            dataOut: CreateAppointmentNew.calendarDate.year
                        - =.builtIn.date.miniWeeklyCalendarArray:
                            dataIn:
                              year: =..BaseComponents.calendarDate.year
                              month: 1
                              today: 33
                              markDay: 1
                              color: "0x4b4b4b"
                              backgroundColor: "0xffffff00"
                              todayColor: "0xffffff"
                              todayBackgroundColor: "0x2988e6"
                              currentDateTime: =.CreateAppointmentNew.calendarDate.todayDate
                              pastTimeColor: "0xbababa"
                            dataOut: CreateAppointmentNew.calendarDate.dayLable
                    - actionType: evalObject
                      object:
                        - .CreateAppointmentNew.calendarDate.month@: 1
                    - actionType: evalObject
                      object:
                        - =.builtIn.date.transformMonth:
                            dataIn:
                              month: =..calendarDate.month
                            dataOut: CreateAppointmentNew.calendarDate.monthName
                    - actionType: builtIn
                      funcName: redraw
                      viewTag: setSchedule
                - type: label
                  dataKey: CreateAppointmentNew.selectDate
                  style:
                    verticalAlign: "middle"
                    display: "inline-block"
                    fontFamily: "Arial"
                    height: "auto"
                    width: "0.57"
                    color: "0x474747"
                    fontSize: .Nfont.h1
                    textAlign:
                      x: right

            - type: view
              style:
                marginTop: "0.01"
                height: "auto"
                width: "1"
              children:
                - type: view
                  style:
                    display: "inline-block"
                    height: "0.08"
                    width: "0.08"
                    textAlign:
                      x: center
                    boxSizing: "border-box"
                  children:
                    - type: image
                      path: leftDate.svg
                      style:
                        top: "0.02"
                        left: "0"
                        height: "0.05"
                      onClick:
                        - emit:
                            actions:
                              - =.builtIn.date.LastWeek:
                                  dataIn:
                                    year: =..calendarDate.dayLable.0.year
                                    month: =..calendarDate.dayLable.0.month
                                    day: =..calendarDate.dayLable.0.day
                                  dataOut: CreateAppointmentNew.calendarDate.tempDate
                              - =.builtIn.date.miniWeeklyCalendarArray:
                                  dataIn:
                                    year: =..calendarDate.tempDate.year
                                    month: =..calendarDate.tempDate.month
                                    today: =..calendarDate.day
                                    markDay: =..calendarDate.tempDate.day
                                    color: "0x4b4b4b"
                                    backgroundColor: "0xffffff00"
                                    todayColor: "0xffffff"
                                    todayBackgroundColor: "0x2988e6"
                                    currentDateTime: =.CreateAppointmentNew.calendarDate.todayDate
                                    pastTimeColor: "0xbababa"
                                  dataOut: CreateAppointmentNew.calendarDate.dayLable
                        - actionType: evalObject
                          object:
                            - ..calendarDate.year@: =..calendarDate.tempDate.year
                            - ..calendarDate.month@: =..calendarDate.tempDate.month
                            - =.builtIn.date.transformMonth:
                                dataIn:
                                  month: =..calendarDate.month
                                dataOut: CreateAppointmentNew.calendarDate.monthName
                        - actionType: builtIn
                          funcName: redraw
                          viewTag: setSchedule
                - type: view
                  style:
                    display: "inline-block"
                    height: "0.08"
                    width: "0.84"
                    boxSizing: "border-box"
                    # backgroundColor: "pink"
                  children:
                    - type: list
                      contentType: listObject
                      listObject: ..calendarDate.dayLable
                      iteratorVar: itemObject
                      viewTag: calendarColor
                      style:
                        axis: horizontal
                        width: "0.823"
                        height: "0.08"
                        boxSizing: "border-box"
                      children:
                        - type: listItem
                          itemObject: ""
                          style:
                            marginLeft: "0"
                            width: "0.1175"
                            height: "0.08"
                            boxSizing: "border-box"
                            backgroundColor: itemObject.backgroundColor
                            borderRadius: "22px 22px 22px 22px"
                            overflow: hidden
                          children:
                            - type: label
                              dataKey: itemObject.weekDay
                              style:
                                marginTop: "0.01"
                                width: "0.1175"
                                color: itemObject.color
                                fontSize: .Nfont.h1
                                textAlign:
                                  x: center
                            - type: label
                              dataKey: itemObject.day
                              style:
                                marginTop: "0.01"
                                width: "0.1175"
                                height: "0.045"
                                color: itemObject.color
                                fontSize: .Nfont.h2
                                borderRadius: "80"
                                textAlign:
                                  x: center
                              onClick:
                                - actionType: evalObject
                                  object:
                                    - ..temporaryInfo@: =..calendarDate
                                    - ..formData.temporarySplitTime@: =..splitTime
                                - emit:
                                    dataKey:
                                      var: itemObject
                                    actions:
                                      - .CreateAppointmentNew.splitTime@: []
                                      - ..calendarDate.year@: $var.year
                                      - ..calendarDate.month@: $var.month
                                      - ..calendarDate.day@: $var.day
                                      - =.builtIn.date.ShowDateByNumber:
                                          dataIn:
                                            year: =..calendarDate.year
                                            month: =..calendarDate.month
                                            day: =..calendarDate.day
                                          dataOut: CreateAppointmentNew.selectDate
                                      - =.builtIn.date.transformMonth:
                                          dataIn:
                                            month: =..calendarDate.month
                                          dataOut: CreateAppointmentNew.calendarDate.monthName
                                      - =.builtIn.string.concat:
                                          dataIn:
                                            - =..calendarDate.year
                                            - "-"
                                            - =..calendarDate.month
                                            - "-"
                                            - $var.day
                                          dataOut: CreateAppointmentNew.calendarDate.todayDate
                                      - =.builtIn.date.getTimeStampOfDate:
                                          dataIn:
                                            date: =..calendarDate.todayDate
                                          dataOut: CreateAppointmentNew.calendarDate.todayStamp
                                      - =.builtIn.date.miniWeeklyCalendarArray:
                                          dataIn:
                                            year: $var.year
                                            month: $var.month
                                            today: $var.day
                                            markDay: $var.day
                                            color: "0x4b4b4b"
                                            backgroundColor: "0xffffff00"
                                            todayColor: "0xffffff"
                                            todayBackgroundColor: "0x2988e6"
                                            currentDateTime: =.CreateAppointmentNew.calendarDate.todayDate
                                            pastTimeColor: "0xbababa"
                                          dataOut: CreateAppointmentNew.calendarDate.dayLable
                                      - =.builtIn.string.concat:
                                          dataIn:
                                            - "(stime<="
                                            - =..calendarDate.todayStamp.start
                                            - " AND "
                                            - "etime>="
                                            - =..calendarDate.todayStamp.start
                                            - " OR "
                                            - "stime>="
                                            - =..calendarDate.todayStamp.start
                                            - " AND "
                                            - "etime<="
                                            - =..calendarDate.todayStamp.end
                                            - " OR "
                                            - "stime<="
                                            - =..calendarDate.todayStamp.end
                                            - " AND "
                                            - "etime>="
                                            - =..calendarDate.todayStamp.end
                                            - ")"
                                            - " AND "
                                            - "subtype="
                                            - =..formData.currentSubtype
                                          dataOut: Global.scheduleScondition
                                - actionType: evalObject
                                  object:
                                    - if:
                                        - =.builtIn.math.greater:
                                            dataIn:
                                              num1: =.CreateAppointmentNew.calendarDate.todayStamp.end
                                              num2: =.CreateAppointmentNew.nowTimeStamp
                                        - continue
                                        - actionType: popUp
                                          popUpView: dateCheck
                                          wait: true
                                    - ..schedule.scheduleList.edge@: []
                                - actionType: evalObject
                                  object:
                                    .Global._nonce@:
                                      =.builtIn.math.random: ""
                                - actionType: evalObject
                                  object:
                                    - =..schedule.get: ""
                                - actionType: evalObject
                                  object:
                                    - .CreateAppointmentNew.splitTime@: []
                                - actionType: evalObject
                                  object:
                                    - =.builtIn.date.splitTime:
                                        dataIn:
                                          object2: =..schedule.scheduleList.edge
                                          timeSlot: =..dataObject.name.duration
                                          year: =..calendarDate.year
                                          month: =..calendarDate.month
                                          day: =..calendarDate.day
                                          isSplitCurrent: true
                                        dataOut: CreateAppointmentNew.splitTime
                                    - if:
                                        - =.CreateAppointmentNew.splitTime.0.stime
                                        - continue
                                        - actionType: popUp
                                          popUpView: noAvailableTag
                                          wait: true
                                - actionType: evalObject
                                  object:
                                    - ..clock.bvid@: ""
                                    - if:
                                        - =..clock.bvid
                                        - ..formData.nextBtnColor@: "0x2988e6"
                                        - ..formData.nextBtnColor@: "0xc1c1c1"
                                - actionType: builtIn
                                  funcName: redraw
                                  viewTag: splitTimeTag
                                - actionType: builtIn
                                  funcName: redraw
                                  viewTag: setSchedule
                                - actionType: builtIn
                                  funcName: redraw
                                  viewTag: nextBtn
                - type: view
                  style:
                    display: "inline-block"
                    height: "0.08"
                    width: "0.08"
                    textAlign:
                      x: center
                    boxSizing: "border-box"
                  children:
                    - type: image
                      path: rightDate.svg
                      style:
                        top: "0.02"
                        right: "0"
                        height: "0.05"
                      onClick:
                        - emit:
                            actions:
                              - =.builtIn.date.NextWeek:
                                  dataIn:
                                    year: =..calendarDate.dayLable.6.year
                                    month: =..calendarDate.dayLable.6.month
                                    day: =..calendarDate.dayLable.6.day
                                  dataOut: CreateAppointmentNew.calendarDate.tempDate
                              - =.builtIn.date.miniWeeklyCalendarArray:
                                  dataIn:
                                    year: =..calendarDate.tempDate.year
                                    month: =..calendarDate.tempDate.month
                                    today: =..calendarDate.day
                                    markDay: =..calendarDate.tempDate.day
                                    color: "0x4b4b4b"
                                    backgroundColor: "0xffffff00"
                                    todayColor: "0xffffff"
                                    todayBackgroundColor: "0x2988e6"
                                    currentDateTime: =.CreateAppointmentNew.calendarDate.todayDate
                                    pastTimeColor: "0xbababa"
                                  dataOut: CreateAppointmentNew.calendarDate.dayLable
                        - actionType: evalObject
                          object:
                            - ..calendarDate.year@: =..calendarDate.tempDate.year
                            - ..calendarDate.month@: =..calendarDate.tempDate.month
                            - =.builtIn.date.transformMonth:
                                dataIn:
                                  month: =..calendarDate.month
                                dataOut: CreateAppointmentNew.calendarDate.monthName
                        - actionType: builtIn
                          funcName: redraw
                          viewTag: setSchedule
            - type: view
              style:
                marginTop: "0.02"

        - type: view
          style:
            top: "0.4"
            left: "0"
            width: "1"
            height: "0.42"
          viewTag: splitTimeTag
          children:
            - .BaseList:
              androidGrid: true
              listObject: ..splitTime
              style:
                height: "0.41"
                width: "0.9"
                left: "0.05"
                overflow: scroll
                backgroundColor: "0xffffff"
              children:
                - type: listItem
                  itemObject: ""
                  style:
                    left: "0"
                    width: "0.29"
                    height: "0.07"
                    display: "inline-block"
                  children:
                    - type: label
                      dataKey: itemObject.showTime
                      onClick:
                        - emit:
                            dataKey:
                              var: itemObject
                            actions:
                              - ..clock@: $var
                              - .Global.clock@: $var
                        - actionType: evalObject
                          object:
                            - =.builtIn.object.setProperty:
                                dataIn:
                                  obj: =..splitTime
                                  label: "showTime"
                                  text: =..clock.showTime
                                  arr: ["backgroundColor", "fontColor"]
                                  valueArr: ["0x2988e6", "0xffffff"]
                                  errorArr: ["0xffffff", "0x474747"]
                                dataOut: CreateAppointmentNew.splitTime
                        - actionType: evalObject
                          object:
                            - if:
                                - =..clock.bvid
                                - ..formData.nextBtnColor@: "0x2988e6"
                                - ..formData.nextBtnColor@: "0xc1c1c1"
                        - actionType: evalObject
                          object:
                            - .Global.formData.appointment.visitType@: =..dataObject.name.visitType
                            - .Global.formData.appointment.selectDate@: =..selectDate
                            - .Global.formData.appointment.duration@: =..duration
                            - .Global.formData.appointment.docu@: =..docu
                            - .Global.formData.appointment.reason@: =..reason
                            - .Cov19TestDM.patientChart.patientInfo@: ""
                            - .Cov19TestDM.patientChart.symptomProfile@: ""
                            - .Cov19TestDM.patientChart.billingInfo@: ""
                            - ..currentFaci.vertexIn.id@: =..clock.bvid
                            # - =..currentFaci.vertexAPI.get: ""
                            # - .Global.currentFacility@: =..currentFaci.vertexResp.vertex.0
                        - actionType: builtIn
                          funcName: redraw
                          viewTag: splitTimeTag
                        - actionType: builtIn
                          funcName: redraw
                          viewTag: nextBtn
                      style:
                        width: "0.25"
                        height: "0.05"
                        # top: "0.01"
                        left: "0.03"
                        fontWeight: "400"
                        zIndex: "100"
                        color: itemObject.fontColor
                        fontSize: .Nfont.h15
                        backgroundColor: itemObject.backgroundColor
                        borderRadius: "6"
                        boxSizing: "border-box"
                        border:
                          style: 3
                        borderColor: "0xdededf"
                        borderWidth: "1"
                        textAlign:
                          x: center
                          y: center
        - type: button
          text: "Next"
          viewTag: nextBtn
          style:
            top: "0.83"
            left: "0.1"
            width: "0.8"
            height: "0.045"
            fontWeight: "500"
            fontFamily: "Arial"
            fontSize: .Nfont.h3
            color: "0xffffff"
            backgroundColor: ..formData.nextBtnColor
            border:
              style: 3
            borderColor: =..formData.nextBtnColor
            borderRadius: "2"
            borderWidth: "1"
            textAlign:
              x: center
              y: center
          onClick:
            - actionType: evalObject
              object:
                - if:
                    - =..clock.bvid
                    - continue
                    - actionType: popUp
                      popUpView: timeWarning
                      wait: true
            - goto: CreateAppointmentNewNext
