SurgeryAuthorization:
  title: Surgery Authorization

  init: #Page initialization
    - .SignInCheck

    - actionType: evalObject #android use calendar init
      object:
        - .BaseComponents.calendarDate.year@: ""
        - .BaseComponents.calendarDate.month@: ""
        - .BaseComponents.calendarDate.day@: ""
        - .BaseComponents.calendarDate.monthName@: ""
        - .BaseComponents.calendarDate.todayDate@: ""
        - .BaseComponents.calendarDate.flag@: ""
        - .BaseComponents.calendarDate.dayLable@: []
        - .BaseComponents.year@: []
        - .BaseComponents.flag: ""
        #生成年份
        - =.builtIn.date.generateYear:
            dataIn:
              last: 121
              next: 10
            dataOut: BaseComponents.year
    - actionType: evalObject #android use calendar init
      object: .BaseComponents.getDate
    - actionType: evalObject #android use calendar init
      object: .BaseComponents.getShow
    - actionType: evalObject
      object:
        - ..calendarDate@: =.BaseComponents.calendarDate
    - actionType: evalObject #IOS use calendar init
      object:
        - =.builtIn.date.getMonth:
            dataIn:
            dataOut: SurgeryAuthorization.calendarDate.month
        - =.builtIn.date.getYear:
            dataIn:
            dataOut: SurgeryAuthorization.calendarDate.year
        - =.builtIn.date.getDate:
            dataIn:
            dataOut: SurgeryAuthorization.calendarDate.day
    - actionType: evalObject #IOS use calendar init
      object:
        - =.builtIn.date.calendarArray:
            dataIn:
              year: =.SurgeryAuthorization.calendarDate.year
              month: =.SurgeryAuthorization.calendarDate.month
              today: =.SurgeryAuthorization.calendarDate.day
            dataOut: SurgeryAuthorization.calendarDate.dayLable
        - =.builtIn.date.transformMonth:
            dataIn:
              month: =.SurgeryAuthorization.calendarDate.month
            dataOut: SurgeryAuthorization.calendarDate.monthName
        - =.builtIn.date.ShowDateByNumber:
            dataIn:
              year: =.SurgeryAuthorization.calendarDate.year
              month: =.SurgeryAuthorization.calendarDate.month
              day: =.SurgeryAuthorization.calendarDate.day
              formatType: "M/D/Y"
            dataOut: SurgeryAuthorization.calendarDate.todayDate

    - if:
        #判断是否从ProviderMacros回来，需要复现之前已填的数据
        - =.Global.formData.providerDoc.surgeryAuthorization.id
        - actionType: evalObject
          object:
            - ..apiRequest.surgeryForm.docReq@: =.Global.formData.providerDoc.surgeryAuthorization
            # # physician
            - ..formData.selectStatus.physician@: =..apiRequest.surgeryForm.docReq.name.data.surgeryInfo.physician
            # # Postoperative  Therapy
            - ..formData.postTherapy@: =..apiRequest.surgeryForm.docReq.name.data.surgeryInfo.postTherapy
            # medicalSelect
            - ..formData.medicalClear@: =..apiRequest.surgeryForm.docReq.name.data.surgeryInfo.medicalStatus.medicalSelect
            # # H&P / Medical clearance
            - ..formData.selectStatus.clearance@: =..apiRequest.surgeryForm.docReq.name.data.surgeryInfo.medicalStatus.clearSelect
        - actionType: evalObject
          object:
            #页面进入时就创建文档
            - =.SurgeryAuthorization.apiRequest.surgeryForm.docAPI.store: ""
            # 将创建的文档数据重新给note 进行update
            - ..apiRequest.surgeryForm.docReq@: =..apiRequest.surgeryForm.docResp.doc

    # 判断是否签名
    - if:
        - =..apiRequest.surgeryForm.docReq.name.data.whetherSignature
        - continue
        # 非空修改显示的标识,刷新签名区域
        - actionType: evalObject
          object:
            # 签名的时间
            - ..formData.signatureCtime@: =.SurgeryAuthorization.apiRequest.surgeryForm.docReq.name.data.signatureCtime
            # 签名的id
            - ..formData.temporarySignature@: =.SurgeryAuthorization.apiRequest.surgeryForm.docReq.name.data.signatureId
            - ..formData.flag@: "block"
    - actionType: evalObject
      object:
        # 拼接lic
        - =.builtIn.string.concat:
            dataIn:
              - =.Global.MyProfile.name.data.MedicalLicense.0.state
              - "&nbsp;"
              - =.Global.MyProfile.name.data.MedicalLicense.0.medicalLicense
            dataOut: SurgeryAuthorization.apiRequest.surgeryForm.docReq.name.data.providerInfo.license

        # 拼接 provider fullName
        - =.builtIn.string.concat:
            dataIn:
              - =.Global.MyProfile.name.data.fullName
              - ","
              - =.Global.MyProfile.name.data.title
            dataOut: SurgeryAuthorization.apiRequest.surgeryForm.docReq.name.data.providerInfo.physicianName

    - actionType: evalObject
      object:
        - =.builtIn.array.formatStringFill:
            dataIn:
              strArr: =.Global.MyProfile.name.data.selectedSpecialty
              sfill: ","
            dataOut: SurgeryAuthorization.apiRequest.surgeryForm.docReq.name.data.providerInfo.specialty

  calendarDate:
    year: ""
    month: ""
    day: ""
    dayLable: []
    todayDate: ""
    monthName: ""
  formData: #Input data here
    searchShow: "none"
    diagnosis:
      descriptiveList:
        code: ""
        description: ""
        comment: ""
    selectedDiagnosis: ""
    selectedProRequest: ""
    proRequest:
      descriptiveList:
        code: ""
        description: ""
        qTY: ""
    selectStatus:
      physician:
        isRequired: ""
        content: ""
        isExplain: none
      clearance:
        isClear: ""
    # 七个圆圈 week
    postTherapy:
      perWeek: ""
      week: ""
      body: ""
    medicalClear: []
    flag: "none"
    medicalLicenseLength: ""
    whetherSignature: ""
    signatureCtime: ""
    listDataFlag: "none"
    listDataFlagPro: "none"
  formDataTemp: #Input data temp here, datatemp should not mix with formData
    normalInfo: ""
    perWeekTemp:
      - key: perWeek
        value: "1"
      - key: perWeek
        value: "2"
      - key: perWeek
        value: "3"
    weekTemp:
      - key: week
        value: "1"
      - key: week
        value: "2"
      - key: week
        value: "3"
      - key: week
        value: "4"
    physicianTemp:
      - key: isRequired
        value: "Yes"
      - key: isRequired
        value: "No"
    clearTemp:
      - key: isClear
        value: "Yes"
      - key: isClear
        value: "No"
    medicalSelect:
      - key: CBC
        value: CBC
      - key: PT
        value: PT/PTT
      - key: CH
        value: CHEM 7
      - key: HCG
        value: HCG - Urine
      - key: Chest
        value: Chest X-ray
      - key: EKG
        value: EKG
      - key: covid
        value: COVID-19 test
    allListInfo: []
    allListString: []
    allCodes: []
    allDescription: []
    allCPTListInfo: []
    allCPTListString: []
    allCPTCodes: []
    allCPTDescription: []
  apiRequest: #Input data request here
    surgeryForm:
      docResp: ""
      docReq:
        eid: .Global.currentRoom.edge.id
        reid: "" # .Global.formData.meetingDocReid
        type: .DocType.surgeryForm
        subtype:
          mediaType: "application/json"
        name:
          title: "Surgery Authorization"
          user: .Global.formData.providerTitle
          data:
            classTag:
              name: Provider
              fontColor: "0x30b354"
              backgroundColor: "0xe4f5e9"
              display: block
            statusTag:
              name: Private
              fontColor: "0x4c5264"
              backgroundColor: "0xececee"
              display: block
            signatureId: ""
            signatureCtime: ""
            whetherSignature: true
            facilityInfo:
              facilityAvatarID: .Global.currentFacilityDoc.name.data.basicInfo.businessLogo
              facilityName: .Global.currentFacilityDoc.name.data.basicInfo.medicalFacilityName
              location: .Global.currentFacilityDoc.name.data.basicInfo.location
              email: .Global.currentFacilityDoc.name.data.basicInfo.email
              main: .Global.currentFacilityDoc.name.data.basicInfo.phoneNumber
              fax: .Global.currentFacilityDoc.name.data.basicInfo.fax
              website: .Global.currentFacilityDoc.name.data.basicInfo.website
            providerInfo:
              physicianName: ""
              license: ""
              npi: .Global.MyProfile.name.data.NPI
              dea: .Global.MyProfile.name.data.DEA
              email: .Global.MyProfile.name.data.email
              phone: .Global.currentFacilityDoc.name.data.basicInfo.phoneNumber
              Medicine: .Global.currentFacilityDoc.name.data.basicInfo.medicalFacilityName
              specialty: ""
            patientInfo:
              examDate: .Global.roomInfo.edge.stime
              patientName: .Global.currentMeetingPatientProfile.basicInfo.fullName
              dob: .Global.currentMeetingPatientProfile.basicInfo.dateOfBirth
              phone: .Global.currentMeetingPatientProfile.basicInfo.phone
              email: .Global.currentMeetingPatientProfile.contactInfo.email
              address: .Global.currentMeetingPatientProfile.contactInfo.address.fullAddress
            surgeryInfo:
              surgicalFacility: ""
              surgicalDate: ""
              diagnosis:
                descriptiveList: []
              proRequest:
                descriptiveList: []
              proDescription: ""
              physician: ""
              postTherapy: ""
              equipment: ""
              medicalStatus:
                medicalSelect: ""
                clearSelect: ""
      docAPI:
        .DocAPI: ""
        store:
          api: cd
          dataIn: SurgeryAuthorization.apiRequest.surgeryForm.docReq
          dataOut: SurgeryAuthorization.apiRequest.surgeryForm.docResp
    # 签名文档
    newSign:
      docRes: ""
      docReq: #DOC
        type: .DocType.DocumentSignature
        name:
          title: ""
          type: ..apiRequest.newSign.docReq.subtype.mediaType
          data: ""
        eid: .Global.rootNotebookID
        subtype:
          mediaType: ""
      docAPI: # DOCAPI
        store:
          api: cd
          dataIn: apiRequest.newSign.docReq
          dataOut: SurgeryAuthorization.apiRequest.newSign.docRes

  style: #Input style fragment here

  components:
    - .BasePublicHeader:
      children:
        - .BasePublicHeaderLeft:
        - .BasePublicHeaderTitle:
        - .BasePublicHeaderRightText:
          onClick:
            # 签名处理
            - actionType: saveSignature
              dataObject: BLOB
              dataKey: SurgeryAuthorization.apiRequest.newSign.docReq.name.data
              isEmpty: SurgeryAuthorization.formData.whetherSignature
            # 保存签名
            - actionType: evalObject
              object:
                - ..apiRequest.newSign.docReq.reid@: =.SurgeryAuthorization.apiRequest.surgeryForm.docReq.id

            - actionType: evalObject
              object:
                - if:
                    - =..formData.whetherSignature
                    - continue
                    - =..apiRequest.newSign.docAPI.store: ""
            - actionType: evalObject
              object:
                - if:
                    - =..formData.temporarySignature
                    - actionType: evalObject
                      object:
                        - ..apiRequest.surgeryForm.docReq.name.data.signatureCtime@: =..formData.signatureCtime
                        - ..apiRequest.surgeryForm.docReq.name.data.signatureId@: =..formData.temporarySignature
                        - ..apiRequest.surgeryForm.docReq.name.data.whetherSignature@: false
                        - ..formData.whetherSignature@: false
                    - actionType: evalObject
                      object:
                        - ..apiRequest.surgeryForm.docReq.name.data.signatureCtime@: =..apiRequest.newSign.docRes.doc.ctime
                        - ..apiRequest.surgeryForm.docReq.name.data.signatureId@: =..apiRequest.newSign.docRes.doc.id
                        - ..apiRequest.surgeryForm.docReq.name.data.whetherSignature@: =..formData.whetherSignature
            - actionType: evalObject
              object:
                # physician
                - ..apiRequest.surgeryForm.docReq.name.data.surgeryInfo.physician@: =..formData.selectStatus.physician
                # Postoperative  Therapy
                - ..apiRequest.surgeryForm.docReq.name.data.surgeryInfo.postTherapy@: =..formData.postTherapy
                # medicalSelect
                - ..apiRequest.surgeryForm.docReq.name.data.surgeryInfo.medicalStatus.medicalSelect@: =..formData.medicalClear
                # H&P / Medical clearance
                - ..apiRequest.surgeryForm.docReq.name.data.surgeryInfo.medicalStatus.clearSelect@: =..formData.selectStatus.clearance
                - =.SurgeryAuthorization.apiRequest.surgeryForm.docAPI.store: ""
                - .Global.formData.providerDoc.surgeryAuthorization@: =..apiRequest.surgeryForm.docResp.doc
                - goto: ProviderMacros
    - type: scrollView
      style:
        width: "1"
        height: "0.846"
        overflow: scroll
        fontFamily: "Arial"
      children:
        - type: view
          style:
            marginLeft: "0.04"
            marginTop: "0.0246"
            height: "auto"
            width: "0.92"
          children:
            - type: image
              path: office-building.svg
              path=func: .builtIn.utils.prepareDocToPath
              dataKey: apiRequest.surgeryForm.docReq.name.data.facilityInfo.facilityAvatarID
              style:
                verticalAlign: middle
                display: "inline-block"
                height: "0.0578"
                width: "5.78vh"
            - type: view
              style:
                verticalAlign: middle
                marginLeft: "0.08"
                display: "inline-block"
                height: "auto"
                width: "0.71"
                overflow: hidden
              children:
                - type: label
                  dataKey: apiRequest.surgeryForm.docReq.name.data.facilityInfo.facilityName
                  style:
                    width: "0.71"
                    height: "auto"
                    fontSize: .Nfont.h20
                    fontWeight: "600"
                    fontFamily: "Arial"
                    verticalAlign: middle
                    wordWrap: break-word
                - type: label
                  dataKey: apiRequest.surgeryForm.docReq.name.data.facilityInfo.location
                  style:
                    marginTop: "0.0110"
                    width: "0.71"
                    height: "auto"
                    fontSize: .Nfont.h14
                    color: "0x666666"
                    fontFamily: "Arial"
                    verticalAlign: middle
                    wordWrap: break-word
        - type: view
          style:
            marginLeft: "0.04"
            marginTop: "0.00738"
            width: "0.92"
            height: "auto"
            overflow: hidden
          children:
            - .DocPublicStyleOneBox:
              children:
                - .DocPublicStyleOneLeft:
                  text: Email
                - .DocPublicStyleOneRight:
                  dataKey: apiRequest.surgeryForm.docReq.name.data.facilityInfo.email
            - .DocPublicStyleOneBox:
              children:
                - .DocPublicStyleOneLeft:
                  text: Website
                - .DocPublicStyleOneRight:
                  dataKey: apiRequest.surgeryForm.docReq.name.data.facilityInfo.website
            - .DocPublicStyleOneBox:
              children:
                - .DocPublicStyleOneLeft:
                  text: "Main #"
                - .DocPublicStyleOneRight:
                  dataKey: apiRequest.surgeryForm.docReq.name.data.facilityInfo.main
            - .DocPublicStyleOneBox:
              children:
                - .DocPublicStyleOneLeft:
                  text: "Fax #"
                - .DocPublicStyleOneRight:
                  dataKey: apiRequest.surgeryForm.docReq.name.data.facilityInfo.fax

        - .DocPublicLine:
        - type: view
          style:
            marginLeft: "0.04"
            marginTop: "0.00738"
            width: "0.92"
            height: "auto"
            overflow: hidden
          children:
            - .DocPublicStyleTwoBox:
              children:
                - .DocPublicStyleTwoLeft:
                  text: Exam Date
                - .DocPublicStyleTwoRight:
                  text=func: .builtIn.string.formatUnixtime_en
                  dataKey: apiRequest.surgeryForm.docReq.name.data.patientInfo.examDate
            - .DocPublicStyleTwoBox:
              children:
                - .DocPublicStyleTwoLeft:
                  text: Patient Name
                - .DocPublicStyleTwoRight:
                  dataKey: apiRequest.surgeryForm.docReq.name.data.patientInfo.patientName
            - .DocPublicStyleTwoBox:
              children:
                - .DocPublicStyleTwoLeft:
                  text: Date of Birth
                - .DocPublicStyleTwoRight:
                  dataKey: apiRequest.surgeryForm.docReq.name.data.patientInfo.dob
            - .DocPublicStyleTwoBox:
              children:
                - .DocPublicStyleTwoLeft:
                  text: "Phone #"
                - .DocPublicStyleTwoRight:
                  dataKey: apiRequest.surgeryForm.docReq.name.data.patientInfo.phone
            - .DocPublicStyleTwoBox:
              children:
                - .DocPublicStyleTwoLeft:
                  text: "Email"
                - .DocPublicStyleTwoRight:
                  dataKey: apiRequest.surgeryForm.docReq.name.data.patientInfo.email
            - .DocPublicStyleTwoBox:
              children:
                - .DocPublicStyleTwoLeft:
                  text: "Patient Address"
            - .DocPublicStyleTwoBox:
              children:
                - .DocPublicStyleTwoLeft:
                  dataKey: apiRequest.surgeryForm.docReq.name.data.patientInfo.address
                  style:
                    height: "auto"
                    width: "0.92"
                    fontSize: .Nfont.h14
                    wordWrap: break-word
                    color: "0x333333"
                    fontWeight: "600"
        - .DocPublicLine:
        - type: label
          text: "Surgical facility name"
          dataKey:
          style:
            marginLeft: "0.04"
            marginTop: "0.0246"
            fontWeight: "600"
            width: "0.92"
            height: "auto"
            color: "0x333333"
            fontSize: .Nfont.h14
        - type: textView
          placeholder: Enter here
          dataKey: apiRequest.surgeryForm.docReq.name.data.surgeryInfo.surgicalFacility
          style:
            marginLeft: "0.04"
            marginTop: "0.01"
            textIndent: "12px"
            height: "0.0874"
            width: "0.92"
            boxSizing: border-box
            border:
              style: 3
            borderRadius: "4"
            borderWidth: "1.5"
            borderColor: "0xdedede"
            fontSize: .Nfont.h14
            fontFamily: "Arial"
            color: "0x333333"
            paddingTop: "6px"
        - type: label
          text: "Date of Surgery"
          dataKey:
          style:
            marginLeft: "0.04"
            marginTop: "0.0246"
            fontWeight: "600"
            width: "0.92"
            height: "auto"
            color: "0x333333"
            fontSize: .Nfont.h14
        - type: view
          viewTag: dateViewTag
          style:
            marginLeft: "0.04"
            marginTop: "0.01"
            width: "0.6"
            height: "auto"
            border:
              style: 3
            borderRadius: "4"
            boxSizing: "border-box"
            borderColor: "#dedede"
            overflow: hidden
            verticalAlign: middle
          children:
            - type: textField
              placeholder: "Select"
              dataKey: apiRequest.surgeryForm.docReq.name.data.surgeryInfo.surgicalDate
              isEditable: "false"
              style:
                marginLeft: "0.032"
                width: "0.504"
                height: "0.037"
                fontSize: .Nfont.h14
                fontFamily: "Arial"
                display: "inline-block"
                boxSizing: "border-box"
                border:
                  style: 1
                verticalAlign: middle
                backgroundColor: "0xffffff"
                color: "0x333333"
            - type: image
              path: dateImg.svg
              style:
                display: "inline-block"
                height: "0.0172"
                verticalAlign: middle
          onClick:
            - actionType: popUp
              popUpView: startDateTag
        - type: view
          style:
            width: "1"
            height: "auto"
            overflow: "auto"
            marginTop: "0.0246"
          children:
            - type: label
              text: "Diagnoses"
              dataKey:
              style:
                marginLeft: "0.04"
                fontWeight: "600"
                width: "0.92"
                height: "auto"
                color: "0x333333"
                fontSize: .Nfont.h14

            - type: view
              viewTag: searchBox
              style:
                marginLeft: "0.04"
                height: "auto"
                width: "0.92"
              children:
                - type: view
                  style:
                    marginTop: "0.01"
                    width: "0.92"
                    height: "auto"
                    boxSizing: border-box
                  children:
                    - type: view
                      viewTag: selectDateTag
                      style:
                        display: "inline-block"
                        height: "0.037"
                        width: "0.325"
                        boxSizing: border-box
                        border:
                          style: 3
                        borderRadius: "4"
                        borderWidth: "1.5"
                        borderColor: "0xcdcdcd"
                        overflow: hidden
                      children:
                        - type: image
                          path: ICDsearch.svg
                          style:
                            marginLeft: "0.016"
                            display: "inline-block"
                            height: "0.015"
                            verticalAlign: middle
                        - type: textField
                          viewTag: CodeListTag
                          placeholder: Search
                          dataKey: formData.diagnosis.descriptiveList.code
                          style:
                            marginLeft: "0.01"
                            display: "inline-block"
                            height: "0.037"
                            width: "0.24"
                            boxSizing: border-box
                            border:
                              style: 1
                            fontSize: .Nfont.h12
                            verticalAlign: middle
                            fontFamily: "Arial"
                            color: "0x333333"
                          onInput:
                            - actionType: evalObject
                              object:
                                - if:
                                    - =.builtIn.string.equal:
                                        dataIn:
                                          string1: =..formData.diagnosis.descriptiveList.code
                                          string2: ""
                                    - actionType: evalObject
                                      object:
                                        - ..formData.listDataflag@: "block"
                                        - ..formData.searchShow@: "none"
                                    - actionType: evalObject
                                      object:
                                        - ..formData.listDataflag@: "none"
                                        - ..formData.searchShow@: "block"
                            - actionType: evalObject
                              object:
                                - ..formDataTemp.allListInfo@: []
                                - ..formDataTemp.allListString@: []
                            - actionType: evalObject
                              object:
                                - =.builtIn.search.queryCode:
                                    dataIn:
                                      query: =..formData.diagnosis.descriptiveList.code
                                    dataOut: SurgeryAuthorization.formDataTemp.allListInfo
                                - ..formDataTemp.allListString@: =..formDataTemp.allListInfo
                            - actionType: builtIn
                              funcName: redraw
                              viewTag: CodeTag
                            - actionType: builtIn
                              funcName: redraw
                              viewTag: CodeTags
                            - actionType: builtIn
                              funcName: show
                              viewTag: CodeTag
                            # - actionType: builtIn
                            #   funcName: hide
                            #   viewTag: listData
                            - actionType: builtIn
                              funcName: redraw
                              viewTag: listData
                            - actionType: builtIn
                              funcName: show
                              viewTag: ShowTag
                            - actionType: popUp
                              popUpView: CodeTag
                              dismissOnTouchOutside: true
                            - actionType: builtIn
                              funcName: redraw
                              viewTag: searchShowTag
                    - type: textField
                      viewTag: descriptionTag
                      placeholder: Description
                      dataKey: formData.diagnosis.descriptiveList.description
                      style:
                        marginLeft: "0.02"
                        display: "inline-block"
                        height: "0.037"
                        width: "0.573"
                        textIndent: "12px"
                        boxSizing: border-box
                        border:
                          style: 3
                        borderRadius: "4"
                        borderWidth: "1.5"
                        borderColor: "0xcdcdcd"
                        fontFamily: "Arial"
                        color: "0x333333"
                - type: textView
                  viewTag: CommentsTag
                  placeholder: Comments
                  dataKey: formData.diagnosis.descriptiveList.comment
                  style:
                    marginTop: "0.01"
                    width: "0.92"
                    height: "0.0874"
                    boxSizing: border-box
                    textIndent: "12px"
                    border:
                      style: 3
                    borderRadius: "4"
                    borderWidth: "1.5"
                    borderColor: "0xcdcdcd"
                    fontFamily: "Arial"
                    color: "0x333333"
                    padding: "6px 0"
                    fontSize: .Nfont.h14
                
            - type: label
              text: + add more
              style:
                marginLeft: "0.76"
                marginTop: "0.0073"
                fontSize: .Nfont.h14
                color: "0x1492e6"
                height: "auto"
                width: "auto"
                fontWeight: "600"
              onClick:
                - actionType: evalObject
                  object:
                    - if:
                        - =.builtIn.array.allComplete:
                            dataIn:
                              - =..formData.diagnosis.descriptiveList.code
                              - =..formData.diagnosis.descriptiveList.description
                        - continue
                        - actionType: popUp
                          popUpView: SearchWarning
                          wait: true
                          popUpDismiss: 2000
                - emit:
                    actions:
                      - =.builtIn.array.add:
                          dataIn:
                            object: =..apiRequest.surgeryForm.docReq.name.data.surgeryInfo.diagnosis.descriptiveList
                            value: =..formData.diagnosis.descriptiveList
                - actionType: evalObject
                  object:
                    - ..formData.diagnosis.descriptiveList.code@: ""
                    - ..formData.diagnosis.descriptiveList.description@: ""
                    - ..formData.diagnosis.descriptiveList.comment@: ""
                - actionType: builtIn
                  funcName: redraw
                  viewTag: listData
                - actionType: builtIn
                  funcName: redraw
                  viewTag: CodeListTag
                - actionType: builtIn
                  funcName: redraw
                  viewTag: descriptionTag
                - actionType: builtIn
                  funcName: hide
                  viewTag: ShowTag
                - actionType: builtIn
                  funcName: show
                  viewTag: listData
                - actionType: builtIn
                  funcName: redraw
                  viewTag: CommentsTag
                - actionType: builtIn
                  funcName: hide
                  viewTag: CodeTag
            - type: view
              style:
                marginTop: "0.01"
                height: "auto"
                width: "0.92"
              children:
                - type: view
                  viewTag: listData
                  style:
                    marginLeft: "0.04"
                    width: "0.92"
                    height: "auto"
                    marginTop: "0.01477"
                    # display: ..formData.listDataFlag
                  children:
                    - type: list
                      viewTag: listData
                      contentType: listObject
                      listObject: ..apiRequest.surgeryForm.docReq.name.data.surgeryInfo.diagnosis.descriptiveList # to dataObject to enumerate the list
                      iteratorVar: itemObject
                      style:
                        width: "0.92"
                        height: "auto"
                        margin: "0"
                      children:
                        - type: listItem
                          itemObject: ""
                          style:
                            marginTop: "0.01"
                            width: "0.92"
                            height: "auto"
                            left: "0"
                            overflow: hidden
                          children:
                            - type: view
                              style:
                                width: "0.92"
                                height: "auto"
                              children:
                                - type: image
                                  path: x.svg
                                  style:
                                    display: "inline-block"
                                    height: "0.025"
                                    zIndex: 10
                                    verticalAlign: top
                                  onClick:
                                    - actionType: popUp
                                      popUpView: BaseDelWarningView
                                    - actionType: updateObject
                                      dataKey: SurgeryAuthorization.formData.selectedDiagnosis
                                      dataObject: itemObject
                                - type: label
                                  dataKey: itemObject.code
                                  style:
                                    display: "inline-block"
                                    marginLeft: "0.02"
                                    height: "auto"
                                    width: "0.17"
                                    textAlign:
                                      x: left
                                    fontFamily: "Arial"
                                    backgroundColor: "0xffffff"
                                    wordWrap: break-word
                                    fontSize: .Nfont.h14
                                    fontWeight: "550"
                                    verticalAlign: top
                                    color: "0x333333"
                                - type: label
                                  text: "-"
                                  style:
                                    verticalAlign: middle
                                    display: "inline-block"
                                    width: "auto"
                                    height: "auto"
                                    fontSize: .Nfont.h2
                                - type: label
                                  dataKey: itemObject.description
                                  style:
                                    verticalAlign: top
                                    marginLeft: "0.02"
                                    display: "inline-block"
                                    height: "auto"
                                    width: "0.64"
                                    textAlign:
                                      x: left
                                    backgroundColor: "0xffffff"
                                    fontFamily: "Arial"
                                    wordWrap: break-word
                                    fontSize: .Nfont.h14
                                    color: "0x333333"
                            - type: label
                              dataKey: itemObject.comment
                              style:
                                marginTop: "0.002"
                                marginLeft: "0.07"
                                width: "0.845"
                                height: "auto"
                                color: "0x666666"
                                fontFamily: "Arial"
                                wordWrap: break-word
                                fontSize: .Nfont.h14

            - type: label
              text: "Procedure request"
              dataKey:
              style:
                marginLeft: "0.04"
                marginTop: "0.0246"
                fontWeight: "600"
                width: "0.92"
                height: "auto"
                color: "0x333333"
                fontSize: .Nfont.h14

            - type: view
              viewTag: searchBoxPro
              style:
                marginLeft: "0.04"
                height: "auto"
                width: "0.92"
                overflow: hidden
              children:
                - type: view
                  style:
                    marginTop: "0.01"
                    width: "0.92"
                    height: "auto"
                    boxSizing: border-box
                  children:
                    - type: view
                      viewTag: selectDateTag
                      style:
                        display: "inline-block"
                        height: "0.037"
                        width: "0.325"
                        boxSizing: border-box
                        border:
                          style: 3
                        borderRadius: "4"
                        borderWidth: "1.5"
                        borderColor: "0xcdcdcd"
                        overflow: hidden
                      children:
                        - type: image
                          path: ICDsearch.svg
                          style:
                            marginLeft: "0.016"
                            display: "inline-block"
                            height: "0.015"
                            verticalAlign: middle
                        - type: textField
                          viewTag: CPTCodeListTag
                          placeholder: Search
                          dataKey: formData.proRequest.descriptiveList.code
                          style:
                            marginLeft: "0.01"
                            display: "inline-block"
                            height: "0.037"
                            width: "0.24"
                            boxSizing: border-box
                            border:
                              style: 1
                            fontSize: .Nfont.h12
                            verticalAlign: middle
                            fontFamily: "Arial"
                            color: "0x333333"
                          # 暂时注释
                          # onInput:
                          #   - actionType: evalObject
                          #     object:
                          #       - ..formDataTemp.allCPTListInfo@: []
                          #       - ..formDataTemp.allCPTListString@: []
                          #   - actionType: evalObject
                          #     object:
                          #       - =.builtIn.apiRequest.queryCPT:
                          #           dataIn:
                          #             query: =..formData.proRequest.descriptiveList.code
                          #           dataOut: SurgeryAuthorization.formDataTemp.allCPTListInfo
                          #       - ..formDataTemp.allCPTListString@: =..formDataTemp.allCPTListInfo
                          #   - actionType: builtIn
                          #     funcName: redraw
                          #     viewTag: CPTCodeTag
                          #   - actionType: builtIn
                          #     funcName: redraw
                          #     viewTag: CPTCodeTags
                          #   - actionType: builtIn
                          #     funcName: show
                          #     viewTag: CPTCodeTag
                          #   - actionType: builtIn
                          #     funcName: hide
                          #     viewTag: CPTlistData
                          #   - actionType: builtIn
                          #     funcName: show
                          #     viewTag: ShowTag
                          #   - actionType: popUp
                          #     popUpView: CPTCodeTag
                          #     dismissOnTouchOutside: true
                    - type: textField
                      viewTag: CPTdescriptionTag
                      placeholder: Description
                      dataKey: formData.proRequest.descriptiveList.description
                      style:
                        marginLeft: "0.02"
                        display: "inline-block"
                        height: "0.037"
                        width: "0.573"
                        textIndent: "12px"
                        boxSizing: border-box
                        border:
                          style: 3
                        borderRadius: "4"
                        borderWidth: "1.5"
                        borderColor: "0xcdcdcd"
                        fontFamily: "Arial"
                        color: "0x333333"
                - type: textView
                  viewTag: CommentsTagPro
                  placeholder: QTY
                  dataKey: formData.proRequest.descriptiveList.qTY
                  style:
                    marginTop: "0.01"
                    width: "0.92"
                    height: "0.0874"
                    boxSizing: border-box
                    textIndent: "12px"
                    border:
                      style: 3
                    borderRadius: "4"
                    borderWidth: "1.5"
                    borderColor: "0xcdcdcd"
                    fontFamily: "Arial"
                    color: "0x333333"
                    padding: "6px 0"
                    fontSize: .Nfont.h14
            - type: label
              text: + add more
              style:
                marginLeft: "0.76"
                marginTop: "0.0073"
                fontSize: .Nfont.h14
                color: "0x1492e6"
                height: "auto"
                width: "auto"
                fontWeight: "600"
              onClick:
                - actionType: evalObject
                  object:
                    - if:
                        - =.builtIn.array.allComplete:
                            dataIn:
                              - =..formData.proRequest.descriptiveList.code
                              - =..formData.proRequest.descriptiveList.description
                        - continue
                        - actionType: popUp
                          popUpView: SearchWarning
                          wait: true
                          popUpDismiss: 2000
                - actionType: evalObject
                  object:
                    - =.builtIn.array.add:
                        dataIn:
                          object: =..apiRequest.surgeryForm.docReq.name.data.surgeryInfo.proRequest.descriptiveList
                          value: =..formData.proRequest.descriptiveList
                - actionType: evalObject
                  object:
                    - ..formData.proRequest.descriptiveList.code@: ""
                    - ..formData.proRequest.descriptiveList.description@: ""
                    - ..formData.proRequest.descriptiveList.qTY@: ""
                - actionType: builtIn
                  funcName: redraw
                  viewTag: CPTlistData
                - actionType: builtIn
                  funcName: redraw
                  viewTag: CPTCodeListTag
                - actionType: builtIn
                  funcName: redraw
                  viewTag: CPTdescriptionTag
                - actionType: builtIn
                  funcName: hide
                  viewTag: CPTCodeTag
                - actionType: builtIn
                  funcName: show
                  viewTag: CPTlistData
                - actionType: builtIn
                  funcName: redraw
                  viewTag: CommentsTagPro
            - type: view
              style:
                marginTop: "0.01"
                height: "auto"
                width: "0.92"
              children:
                - type: view
                  viewTag: CPTCodeTag
                  style:
                    marginLeft: "0.035"
                    display: "none"
                    width: "0.92"
                    height: "auto"
                    fontFamily: "Arial"
                    border:
                      style: 3
                      color: "0xeeeeee"
                    borderWidth: "1"
                    zIndex: 10
                  children:
                    - type: scrollView
                      viewTag: ShowTag
                      style:
                        width: "0.9"
                        height: "0.3"
                        marginLeft: "0.02"
                        overflow: scroll
                      children:
                        - type: list
                          contentType: listObject
                          listObject: ..formDataTemp.allCPTListString
                          iteratorVar: itemObject
                          viewTag: CPTCodeTags
                          style:
                            width: "0.9"
                            height: "auto"
                            margin: "0"
                            marginTop: "0"
                          children:
                            - type: listItem
                              itemObject: ""
                              style:
                                width: "0.9"
                                marginTop: "0.002"
                                height: "auto"
                                overflow: hidden
                              children:
                                - type: label
                                  dataKey: itemObject
                                  style:
                                    width: "0.88"
                                    textIndent: 20px
                                    marginTop: "0.005"
                                    textAlign:
                                      x: left
                                      y: center
                                    height: "auto"
                                    fontSize: .Nfont.h14
                                    color: "0x143459"
                                    wordWrap: break-word
                                  onClick:
                                    - emit:
                                        dataKey:
                                          var: itemObject
                                        actions:
                                          - ..formData.proRequest.descriptiveList.code@: $var.0
                                          - ..formData.proRequest.descriptiveList.description@: $var.1
                                    - actionType: builtIn
                                      funcName: redraw
                                      viewTag: CPTCodeListTag
                                    - actionType: builtIn
                                      funcName: redraw
                                      viewTag: CPTdescriptionTag
                                    - actionType: builtIn
                                      funcName: hide
                                      viewTag: CPTCodeTag
                                    - actionType: builtIn
                                      funcName: show
                                      viewTag: CPTlistData
                - type: view
                  viewTag: CPTlistData
                  style:
                    marginLeft: "0.04"
                    width: "0.92"
                    height: "auto"
                    marginTop: "0.01477"
                    # display: ..formData.listDataFlagPro
                  children:
                    - type: list
                      viewTag: CPTlistData
                      contentType: listObject
                      listObject: ..apiRequest.surgeryForm.docReq.name.data.surgeryInfo.proRequest.descriptiveList
                      iteratorVar: itemObject
                      style:
                        width: "0.92"
                        height: "auto"
                        margin: "0"
                      children:
                        - type: listItem
                          itemObject: ""
                          style:
                            marginTop: "0.01"
                            width: "0.92"
                            height: "auto"
                            left: "0"
                            overflow: hidden
                          children:
                            - type: view
                              style:
                                width: "0.92"
                                height: "auto"
                              children:
                                - type: image
                                  path: x.svg
                                  style:
                                    display: "inline-block"
                                    height: "0.025"
                                    zIndex: 10
                                    verticalAlign: top
                                  onClick:
                                    - actionType: popUp
                                      popUpView: BaseCPTDelWarningView
                                    - actionType: updateObject
                                      dataKey: SurgeryAuthorization.formData.selectedProRequest
                                      dataObject: itemObject
                                - type: label
                                  dataKey: itemObject.code
                                  style:
                                    display: "inline-block"
                                    marginLeft: "0.02"
                                    height: "auto"
                                    width: "0.17"
                                    textAlign:
                                      x: left
                                    fontFamily: "Arial"
                                    backgroundColor: "0xffffff"
                                    wordWrap: break-word
                                    fontSize: .Nfont.h14
                                    fontWeight: "550"
                                    verticalAlign: top
                                    color: "0x333333"
                                - type: label
                                  text: "-"
                                  style:
                                    verticalAlign: middle
                                    display: "inline-block"
                                    width: "auto"
                                    height: "auto"
                                    fontSize: .Nfont.h2
                                - type: label
                                  dataKey: itemObject.description
                                  style:
                                    verticalAlign: top
                                    marginLeft: "0.02"
                                    display: "inline-block"
                                    height: "auto"
                                    width: "0.64"
                                    textAlign:
                                      x: left
                                    backgroundColor: "0xffffff"
                                    fontFamily: "Arial"
                                    wordWrap: break-word
                                    fontSize: .Nfont.h14
                                    color: "0x333333"
                            - type: label
                              dataKey: itemObject.qTY
                              style:
                                marginTop: "0.002"
                                marginLeft: "0.07"
                                width: "0.845"
                                height: "auto"
                                color: "0x666666"
                                fontFamily: "Arial"
                                wordWrap: break-word
                                fontSize: .Nfont.h14
            - type: view
              viewTag: searchShowTag
              style:
                top: "0.07"
                left: "0.04"
                display: ..formData.searchShow
                width: "auto"
                height: "auto"
                backgroundColor: "0xffffff"
                borderRadius: "4"
                boxSizing: "border-box"
                boxShadow: "1px 1px 4px 1px #dededf"
                zIndex: "20"
              children:
                - type: view
                  viewTag: CodeTag
                  style:
                    display: "none"
                    width: "0.92"
                    height: "auto"
                    fontFamily: "Arial"
                    borderRadius: "4"
                    boxSizing: "border-box"
                    boxShadow: "1px 1px 4px 1px #dededf"
                    zIndex: 10
                  children:
                    - type: view
                      viewTag: ShowTag
                      style:
                        width: "0.9"
                        height: "0.3"
                        marginLeft: "0.02"
                        overflow: scroll
                      children:
                        - type: list
                          contentType: listObject
                          listObject: ..formDataTemp.allListString
                          iteratorVar: itemObject
                          viewTag: CodeTags
                          style:
                            width: "0.9"
                            height: "0.3"
                            margin: "0"
                            marginTop: "0"
                          children:
                            - type: listItem
                              itemObject: ""
                              style:
                                width: "0.9"
                                marginTop: "0.002"
                                height: "auto"
                                overflow: hidden
                              children:
                                - type: label
                                  dataKey: itemObject.0.2
                                  style:
                                    width: "0.88"
                                    textIndent: 20px
                                    marginTop: "0.005"
                                    textAlign:
                                      x: left
                                      y: center
                                    height: "auto"
                                    fontSize: .Nfont.h14
                                    color: "0x143459"
                                    wordWrap: break-word
                                  onClick:
                                    - emit:
                                        dataKey:
                                          var: itemObject
                                        actions:
                                          - ..formData.diagnosis.descriptiveList.code@: $var.0.0
                                          - ..formData.diagnosis.descriptiveList.description@: $var.0.1
                                    - actionType: builtIn
                                      funcName: redraw
                                      viewTag: CodeListTag
                                    - actionType: builtIn
                                      funcName: redraw
                                      viewTag: descriptionTag
                                    # - actionType: popUpDismiss
                                    #   popUpView: CodeTag
                                    - actionType: builtIn
                                      funcName: hide
                                      viewTag: ShowTag
                                    - actionType: builtIn
                                      funcName: show
                                      viewTag: listData
                                    - actionType: builtIn
                                      funcName: hide
                                      viewTag: CodeTag

        - type: label
          text: "Procedure Description"
          dataKey:
          style:
            marginLeft: "0.04"
            marginTop: "0.0246"
            fontWeight: "600"
            width: "0.92"
            height: "auto"
            color: "0x333333"
            fontSize: .Nfont.h14
        - type: textView
          placeholder: Enter here
          dataKey: apiRequest.surgeryForm.docReq.name.data.surgeryInfo.proDescription
          style:
            marginLeft: "0.04"
            marginTop: "0.01"
            textIndent: "12px"
            height: "0.0874"
            width: "0.92"
            boxSizing: border-box
            border:
              style: 3
            borderRadius: "4"
            borderWidth: "1.5"
            borderColor: "0xdedede"
            fontSize: .Nfont.h14
            fontFamily: "Arial"
            color: "0x333333"
            paddingTop: "6px"
        - type: label
          text: "Physician Assistant Required"
          dataKey:
          style:
            marginLeft: "0.04"
            marginTop: "0.0246"
            fontWeight: "600"
            width: "0.92"
            height: "auto"
            color: "0x333333"
            fontSize: .Nfont.h14
        - type: list
          viewTag: isRequiredTag
          contentType: listObject
          listObject: ..formDataTemp.physicianTemp
          iteratorVar: itemObject
          style:
            width: "0.92"
            margin: "0"
            marginTop: "0.0147"
            left: "0.04"
            axis: horizontal
            height: auto
          children:
            - type: listItem
              itemObject:
              style:
                width: "0.306"
                height: "auto"
                overflow: hidden
              children:
                - type: view
                  style:
                    width: "0.306"
                    height: "auto"
                  children:
                    - type: image
                      style:
                        display: "inline-block"
                        verticalAlign: "middle"
                        height: "0.0197"
                      path:
                        emit:
                          dataKey:
                            var: itemObject
                          actions:
                            - if:
                                - =.builtIn.string.equal:
                                    dataIn:
                                      string1: =..formData.selectStatus.physician.isRequired
                                      string2: $var.value
                                - radioOn.svg
                                - radioOff.svg
                      onClick:
                        - emit:
                            dataKey:
                              var: itemObject
                            actions:
                              - if:
                                  - =.builtIn.string.equal:
                                      dataIn:
                                        string1: =..formData.selectStatus.physician.isRequired
                                        string2: $var.value
                                  - =.builtIn.object.clear:
                                      dataIn:
                                        object: =..formData.selectStatus.physician
                                        key: $var.key
                                  - =.builtIn.object.set:
                                      dataIn:
                                        object: =..formData.selectStatus.physician
                                        key: $var.key
                                        value: $var.value
                        - actionType: evalObject
                          object:
                            - if:
                                - =.builtIn.string.equal:
                                    dataIn:
                                      string1: =..formData.selectStatus.physician.isRequired
                                      string2: "No"
                                - ..formData.selectStatus.physician.isExplain@: block
                                - actionType: evalObject
                                  object:
                                    - ..formData.selectStatus.physician.isExplain@: none
                                    - ..formData.selectStatus.physician.content@: ""
                        - actionType: builtIn
                          funcName: redraw
                          viewTag: isExplainTag
                        - actionType: builtIn
                          funcName: redraw
                          viewTag: isRequiredTag
                    - type: label
                      text:
                      dataKey: itemObject.value
                      style:
                        display: "inline-block"
                        marginLeft: "0.021"
                        fontSize: .Nfont.h14
                        fontFamily: "Arial"
                        color: "0x333333"
                        verticalAlign: "middle"
        - .DocPublicStyleFiveBox:
          viewTag: isExplainTag
          style:
            display: ..formData.selectStatus.physician.isExplain
          children:
            - .DocPublicStyleFiveTitle:
              text: "If “no,” please explain below:"
              style:
                fontWeight: "400"
            - .DocPublicStyleFiveinput:
              dataKey: formData.selectStatus.physician.content
        - type: label
          text: "Postoperative  Therapy"
          dataKey:
          style:
            marginLeft: "0.04"
            marginTop: "0.0246"
            fontWeight: "600"
            width: "0.92"
            height: "auto"
            color: "0x333333"
            fontSize: .Nfont.h14
        - .DocPublicStyleFiveBox:
          children:
            - .DocPublicStyleFiveTitle:
              text: "times per week"
              style:
                fontWeight: "400"
        - type: list
          viewTag: perWeekTag
          contentType: listObject
          listObject: ..formDataTemp.perWeekTemp
          iteratorVar: itemObject
          style:
            width: "0.92"
            margin: "0"
            marginTop: "0.0123"
            left: "0.04"
            axis: horizontal
            height: "auto"
          children:
            - type: listItem
              itemObject:
              style:
                display: "inline-block"
                width: "0.23"
                height: "auto"
              children:
                - type: image
                  style:
                    display: "inline-block"
                    verticalAlign: "middle"
                    height: "0.0197"
                  path:
                    emit:
                      dataKey:
                        var: itemObject
                      actions:
                        - if:
                            - =.builtIn.string.equal:
                                dataIn:
                                  string1: =..formData.postTherapy.perWeek
                                  string2: $var.value
                            - radioOn.svg
                            - radioOff.svg
                  onClick:
                    - emit:
                        dataKey:
                          var: itemObject
                        actions:
                          - if:
                              - =.builtIn.string.equal:
                                  dataIn:
                                    string1: =..formData.postTherapy.perWeek
                                    string2: $var.value
                              - =.builtIn.object.clear:
                                  dataIn:
                                    object: =..formData.postTherapy
                                    key: $var.key
                              - =.builtIn.object.set:
                                  dataIn:
                                    object: =..formData.postTherapy
                                    key: $var.key
                                    value: $var.value
                    - actionType: builtIn
                      funcName: redraw
                      viewTag: perWeekTag
                - type: label
                  text:
                  dataKey: itemObject.value
                  style:
                    display: "inline-block"
                    marginLeft: "0.021"
                    fontSize: .Nfont.h14
                    fontFamily: "Arial"
                    color: "0x333333"
                    verticalAlign: "middle"

        - .DocPublicStyleFiveBox:
          children:
            - .DocPublicStyleFiveTitle:
              text: "week(s)"
              style:
                marginTop: "0.006"
                fontWeight: "400"
        - type: list
          viewTag: weekTag
          contentType: listObject
          listObject: ..formDataTemp.weekTemp
          iteratorVar: itemObject
          style:
            width: "0.92"
            margin: "0"
            marginTop: "0.0123"
            axis: horizontal
            left: "0.04"
            height: "auto"
          children:
            - type: listItem
              itemObject:
              style:
                display: "inline-block"
                width: "0.22"
                height: "auto"
              children:
                - type: image
                  style:
                    display: "inline-block"
                    verticalAlign: "middle"
                    height: "0.0197"
                  path:
                    emit:
                      dataKey:
                        var: itemObject
                      actions:
                        - if:
                            - =.builtIn.string.equal:
                                dataIn:
                                  string1: =..formData.postTherapy.week
                                  string2: $var.value
                            - radioOn.svg
                            - radioOff.svg
                  onClick:
                    - emit:
                        dataKey:
                          var: itemObject
                        actions:
                          - if:
                              - =.builtIn.string.equal:
                                  dataIn:
                                    string1: =..formData.postTherapy.week
                                    string2: $var.value
                              - =.builtIn.object.clear:
                                  dataIn:
                                    object: =..formData.postTherapy
                                    key: $var.key
                              - =.builtIn.object.set:
                                  dataIn:
                                    object: =..formData.postTherapy
                                    key: $var.key
                                    value: $var.value
                    - actionType: builtIn
                      funcName: redraw
                      viewTag: weekTag
                - type: label
                  text:
                  dataKey: itemObject.value
                  style:
                    display: "inline-block"
                    marginLeft: "0.021"
                    fontSize: .Nfont.h14
                    fontFamily: "Arial"
                    color: "0x333333"
                    verticalAlign: "middle"
        - .DocPublicStyleFiveBox:
          children:
            - .DocPublicStyleFiveTitle:
              text: "Body Part"
              style:
                marginTop: "0.006"
                fontWeight: "400"
            - .DocPublicStyleFiveinput:
              dataKey: formData.postTherapy.body

        - type: label
          text: "Special Supplies / Equipment"
          dataKey:
          style:
            marginLeft: "0.04"
            marginTop: "0.0246"
            fontWeight: "600"
            width: "0.92"
            height: "auto"
            color: "0x333333"
            fontSize: .Nfont.h14
        - type: textView
          placeholder: Enter here
          dataKey: apiRequest.surgeryForm.docReq.name.data.surgeryInfo.equipment
          style:
            marginLeft: "0.04"
            marginTop: "0.01"
            textIndent: "12px"
            height: "0.0874"
            width: "0.92"
            boxSizing: border-box
            border:
              style: 3
            borderRadius: "4"
            borderWidth: "1.5"
            borderColor: "0xdedede"
            fontSize: .Nfont.h14
            fontFamily: "Arial"
            color: "0x333333"
            paddingTop: "6px"
        - type: label
          text: "Medical Clearance"
          dataKey:
          style:
            marginLeft: "0.04"
            marginTop: "0.0246"
            fontWeight: "600"
            width: "0.92"
            height: "auto"
            color: "0x333333"
            fontSize: .Nfont.h14
        - type: list
          viewTag: SelectTag
          androidGrid: true
          contentType: listObject
          listObject: ..formDataTemp.medicalSelect
          iteratorVar: itemObject
          style:
            margin: "0"
            left: "0.04"
            marginTop: "0.006"
            # axis: horizontal
            height: "0.138"
            width: "0.92"
          children:
            - type: listItem
              itemObject:
              style:
                width: "0.45"
                height: "auto"
                display: inline-block
                overflow: hidden
              children:
                - type: view
                  style:
                    marginTop: "0.0123"
                    width: "auto"
                    height: "auto"
                    overflow: hidden
                  children:
                    - type: image
                      style:
                        display: "inline-block"
                        verticalAlign: "middle"
                        height: "0.0197"
                      path:
                        emit:
                          dataKey:
                            var: itemObject
                          actions:
                            - if:
                                - =.builtIn.array.has:
                                    dataIn:
                                      object: =..formData.medicalClear
                                      value: $var.key
                                - radioOn.svg
                                - radioOff.svg
                      onClick:
                        - emit:
                            dataKey:
                              var: itemObject
                            actions:
                              - if:
                                  - =.builtIn.array.has:
                                      dataIn:
                                        object: =..formData.medicalClear
                                        value: $var.key
                                  - =.builtIn.array.removeByValue:
                                      dataIn:
                                        object: =..formData.medicalClear
                                        value: $var.key
                                  - =.builtIn.array.add:
                                      dataIn:
                                        object: =..formData.medicalClear
                                        value: $var.key
                        - actionType: builtIn
                          funcName: redraw
                          viewTag: SelectTag
                    - type: label
                      dataKey: itemObject.value
                      style:
                        display: "inline-block"
                        marginLeft: "0.021"
                        fontSize: .Nfont.h14
                        fontFamily: "Arial"
                        color: "0x333333"
                        verticalAlign: "middle"

        - type: label
          text: "H&P / Medical clearance"
          dataKey:
          style:
            marginLeft: "0.04"
            marginTop: "0.0184"
            width: "0.92"
            height: "auto"
            color: "0x333333"
            fontSize: .Nfont.h14
        - type: list
          viewTag: isClearTag
          contentType: listObject
          listObject: ..formDataTemp.clearTemp
          iteratorVar: itemObject
          style:
            width: "0.92"
            margin: "0"
            marginTop: "0.0147"
            axis: horizontal
            left: "0.04"
            height: auto
          children:
            - type: listItem
              itemObject:
              style:
                display: "inline-block"
                width: "0.306"
                height: "auto"
                overflow: hidden
              children:
                - type: view
                  style:
                    width: "0.306"
                    height: "auto"
                  children:
                    - type: image
                      style:
                        display: "inline-block"
                        verticalAlign: "middle"
                        height: "0.0197"
                      path:
                        emit:
                          dataKey:
                            var: itemObject
                          actions:
                            - if:
                                - =.builtIn.string.equal:
                                    dataIn:
                                      string1: =..formData.selectStatus.clearance.isClear
                                      string2: $var.value
                                - radioOn.svg
                                - radioOff.svg
                      onClick:
                        - emit:
                            dataKey:
                              var: itemObject
                            actions:
                              - if:
                                  - =.builtIn.string.equal:
                                      dataIn:
                                        string1: =..formData.selectStatus.clearance.isClear
                                        string2: $var.value
                                  - =.builtIn.object.clear:
                                      dataIn:
                                        object: =..formData.selectStatus.clearance
                                        key: $var.key
                                  - =.builtIn.object.set:
                                      dataIn:
                                        object: =..formData.selectStatus.clearance
                                        key: $var.key
                                        value: $var.value
                        - actionType: builtIn
                          funcName: redraw
                          viewTag: isClearTag
                    - type: label
                      text:
                      dataKey: itemObject.value
                      style:
                        display: "inline-block"
                        marginLeft: "0.021"
                        fontSize: .Nfont.h14
                        fontFamily: "Arial"
                        color: "0x333333"
                        verticalAlign: "middle"
        - type: label
          text: "Please fax all results 3 business days prior to surgery date."
          dataKey:
          style:
            marginLeft: "0.04"
            marginTop: "0.0246"
            fontWeight: "600"
            width: "0.92"
            height: "auto"
            color: "0x333333"
            fontSize: .Nfont.h14
            wordWrap: break-word

        - type: label
          text: "If preops results are not received as request surgery will be subject to cancellation."
          dataKey:
          style:
            marginLeft: "0.04"
            marginTop: "0.0123"
            width: "0.92"
            height: "auto"
            color: "0x333333"
            fontSize: .Nfont.h14
            wordWrap: break-word
        - .DocPublicLine:
        - type: view
          style:
            marginLeft: "0.04"
            marginTop: "0.03"
            width: "0.92"
            height: "auto"
            overflow: hidden
          children:
            - type: view
              style:
                height: "auto"
                width: "0.92"
              children:
                - type: label
                  text: "Signature"
                  style:
                    display: "inline-block"
                    width: "0.816"
                    fontSize: .Nfont.h14
                    height: "auto"
                    color: "0x333333"
                    fontWeight: "600"
                    textAlign:
                      x: left
                - type: label
                  text: "Clear"
                  style:
                    display: "inline-block"
                    width: "auto"
                    fontSize: .Nfont.h14
                    height: "auto"
                    color: "0xfb5051"
                  onClick:
                    - actionType: removeSignature
                      dataObject: BLOB
                      dataKey: SurgeryAuthorization.apiRequest.newSign.docReq.name.data
                      viewTag: signatureTag
                    - actionType: evalObject
                      object:
                        - ..formData.temporarySignature@: ""
                        - ..formData.signatureCtime@: ""
                        - ..formData.flag@: "none"
                    - actionType: builtIn
                      funcName: redraw
                      viewTag: signatureTimeTag
                    # 显示签名区域隐藏
                    - actionType: builtIn
                      funcName: hide
                      viewTag: signatureShowTag
                    - actionType: builtIn
                      funcName: show
                      viewTag: signatureTag
        - type: view
          style:
            marginLeft: "0.04"
            marginTop: "0.01"
            height: "0.128"
            width: "0.9"
            border:
              style: "4"
              color: "0xa9a9a9"
            borderWidth: "2"
          children:
            - type: label
              text: X
              style:
                .SignLabelStyle:
            - type: canvas
              dataKey: SurgeryAuthorization.apiRequest.newSign.docReq.name.data
              viewTag: signatureTag
              style:
                left: "0"
                width: "0.88"
                height: "0.128"
                overflow: scroll
            # 显示暂存的签名
            - type: image
              viewTag: signatureShowTag
              path=func: .builtIn.utils.prepareDocToPath
              # 传入签名文档的id
              dataKey: SurgeryAuthorization.formData.temporarySignature
              style:
                # 控制显示
                display: =..formData.flag
                left: "0"
                width: "0.88"
                top: "0"
                height: "0.128"
                overflow: scroll
                zIndex: "1000"

        - type: view
          style:
            marginLeft: "0.04"
            marginTop: "0.0146"
            width: "0.92"
            height: "auto"
            overflow: hidden
          children:
            - type: view
              viewTag: signatureTimeTag
              style:
                display: ..formData.flag
                marginTop: "0.01"
                height: "auto"
                width: "0.92"
              children:
                - type: label
                  text=func: .builtIn.string.formatUnixtime_en
                  dataKey: apiRequest.surgeryForm.docReq.name.data.signatureCtime
                  style:
                    display: "inline-block"
                    width: "auto"
                    height: "auto"
                    fontSize: .Nfont.h12
                    color: "0x757575"
                    verticalAlign: middle
                - type: label
                  text: "Digitally Signed"
                  dataKey:
                  style:
                    marginLeft: "0.02"
                    display: "inline-block"
                    width: "auto"
                    height: "auto"
                    fontSize: .Nfont.h12
                    color: "0x757575"
                    verticalAlign: middle
            - type: view
              style:
                marginTop: "0.01"
                width: "auto"
                height: "auto"
              children:
                - type: label
                  text: Date
                  style:
                    display: "inline-block"
                    width: "auto"
                    height: "auto"
                    color: "0x666666"
                    fontSize: .Nfont.h12
                - type: label
                  text=func: .builtIn.string.formatUnixtimeL_en
                  dataKey: apiRequest.surgeryForm.docReq.ctime
                  style:
                    marginLeft: "0.0373"
                    display: "inline-block"
                    width: "auto"
                    height: "auto"
                    color: "0x333333"
                    fontSize: .Nfont.h12
                    fontWeight: "600"
        - type: view
          style:
            marginLeft: "0.04"
            marginTop: "0.0246"
            width: "0.92"
            height: "auto"
            overflow: hidden
          children:
            - type: label
              dataKey: apiRequest.surgeryForm.docReq.name.data.providerInfo.physicianName
              style:
                height: "auto"
                width: "0.92"
                color: "0x333333"
                fontSize: .Nfont.h16
                fontWeight: "600"
                wordWrap: break-word
            - type: label
              dataKey: apiRequest.surgeryForm.docReq.name.data.providerInfo.specialty
              style:
                marginTop: "0.006"
                height: "auto"
                width: "0.92"
                color: "0x666666"
                fontSize: .Nfont.h14
                wordWrap: break-word
            - .DocPublicStyleOneBox:
              children:
                - .DocPublicStyleOneLeft:
                  text: "LIC #"
                - .DocPublicStyleOneRight:
                  dataKey: apiRequest.surgeryForm.docReq.name.data.providerInfo.license
            - .DocPublicStyleOneBox:
              children:
                - .DocPublicStyleOneLeft:
                  text: "NPI #"
                - .DocPublicStyleOneRight:
                  dataKey: apiRequest.surgeryForm.docReq.name.data.providerInfo.npi
            - .DocPublicStyleOneBox:
              children:
                - .DocPublicStyleOneLeft:
                  text: "DEA #"
                - .DocPublicStyleOneRight:
                  dataKey: apiRequest.surgeryForm.docReq.name.data.providerInfo.dea
            - .DocPublicStyleOneBox:
              children:
                - .DocPublicStyleOneLeft:
                  text: "Email"
                - .DocPublicStyleOneRight:
                  dataKey: apiRequest.surgeryForm.docReq.name.data.providerInfo.email
            - .DocPublicStyleOneBox:
              children:
                - .DocPublicStyleOneLeft:
                  text: "Fax #"
                - .DocPublicStyleOneRight:
                  dataKey: apiRequest.surgeryForm.docReq.name.data.facilityInfo.fax
            - .DocPublicStyleOneBox:
              children:
                - .DocPublicStyleOneLeft:
                  text: "Main #"
                - .DocPublicStyleOneRight:
                  dataKey: apiRequest.surgeryForm.docReq.name.data.facilityInfo.main
            - .DocPublicStyleOneBox:
              children:
                - .DocPublicStyleOneLeft:
                  text: "Address"
                - .DocPublicStyleOneRight:
                  dataKey: apiRequest.surgeryForm.docReq.name.data.facilityInfo.location
            - .DocPublicLine:
              style:
                marginTop: "0.0246"
                height: "0.00369"
        - type: label
          dataKey: apiRequest.surgeryForm.docReq.name.data.facilityInfo.website
          style:
            marginTop: "0.01"
            width: "1"
            height: "auto"
            color: "0x666666"
            fontSize: .Nfont.h12
            textAlign:
              x: center
        - type: view
          style:
            marginTop: "0.03"
    - .BasePublicFooter:
      children:
        - type: view
          style:
            height: auto
            width: auto
          children:
            - .DocButtonPrivate:
              onClick:
                # 签名处理
                - actionType: saveSignature
                  dataObject: BLOB
                  dataKey: SurgeryAuthorization.apiRequest.newSign.docReq.name.data
                  isEmpty: SurgeryAuthorization.formData.whetherSignature

                # 保存签名
                - actionType: evalObject
                  object:
                    # 签名reid指向 doc 的id
                    - ..apiRequest.newSign.docReq.reid@: =.SurgeryAuthorization.apiRequest.surgeryForm.docReq.id

                - actionType: evalObject
                  object:
                    - if:
                        - =..formData.whetherSignature
                        - continue
                        - =..apiRequest.newSign.docAPI.store: ""

                #  指定 eid 和 reid
                - actionType: evalObject
                  object:
                    - ..apiRequest.surgeryForm.docReq.eid@: =.Global.currentRoom.edge.id
                    - ..apiRequest.surgeryForm.docReq.reid@: =.Global.roomInfo.edge.id

                # 签名处理
                - actionType: evalObject
                  object:
                    - if:
                        - =..formData.temporarySignature
                        - actionType: evalObject
                          object:
                            - ..apiRequest.surgeryForm.docReq.name.data.signatureCtime@: =..formData.signatureCtime
                            - ..apiRequest.surgeryForm.docReq.name.data.signatureId@: =..formData.temporarySignature
                            - ..apiRequest.surgeryForm.docReq.name.data.whetherSignature@: false
                            - ..formData.whetherSignature@: false
                        - actionType: evalObject
                          object:
                            - ..apiRequest.surgeryForm.docReq.name.data.signatureCtime@: =..apiRequest.newSign.docRes.doc.ctime
                            - ..apiRequest.surgeryForm.docReq.name.data.signatureId@: =..apiRequest.newSign.docRes.doc.id
                            - ..apiRequest.surgeryForm.docReq.name.data.whetherSignature@: =..formData.whetherSignature

                #  修改type
                - actionType: evalObject
                  object:
                    - =.builtIn.number.inhx:
                        dataIn:
                          intHex: =..apiRequest.surgeryForm.docReq.type
                          index: 1
                          hex: 0
                        dataOut: SurgeryAuthorization.apiRequest.surgeryForm.docReq.type

                # 保存
                - actionType: evalObject
                  object:
                    # physician
                    - ..apiRequest.surgeryForm.docReq.name.data.surgeryInfo.physician@: =..formData.selectStatus.physician
                    # Postoperative  Therapy
                    - ..apiRequest.surgeryForm.docReq.name.data.surgeryInfo.postTherapy@: =..formData.postTherapy
                    # medicalSelect
                    - ..apiRequest.surgeryForm.docReq.name.data.surgeryInfo.medicalStatus.medicalSelect@: =..formData.medicalClear
                    # H&P / Medical clearance
                    - ..apiRequest.surgeryForm.docReq.name.data.surgeryInfo.medicalStatus.clearSelect@: =..formData.selectStatus.clearance

                    - =..apiRequest.surgeryForm.docAPI.store: ""

                    - =.builtIn.array.add:
                        dataIn:
                          object: =.Global.currentMeetingDoc
                          value: =..apiRequest.surgeryForm.docResp.doc

                - actionType: evalObject
                  object:
                    .Global._nonce@:
                      =.builtIn.math.random: ""

                - actionType: evalObject
                  object:
                    - goto: ProviderNoteSelect

            - .DocButtonRelease:
              onClick:
                # Physician Assistant Required no
                - actionType: evalObject
                  object:
                    - if:
                        - =.builtIn.string.equal:
                            dataIn:
                              string1: =..formData.selectStatus.physician.isRequired
                              string2: "No"
                        - actionType: evalObject
                          object:
                            - if:
                                - =.builtIn.string.equal:
                                    dataIn:
                                      string1: =..formData.selectStatus.physician.content
                                      string2: ""
                                - actionType: popUp
                                  popUpView: unCompleteTag
                                  wait: true
                                  popUpDismiss: 2000
                                - continue
                        - continue

                # 签名处理
                - actionType: saveSignature
                  dataObject: BLOB
                  dataKey: SurgeryAuthorization.apiRequest.newSign.docReq.name.data
                  isEmpty: SurgeryAuthorization.formData.whetherSignature

                # 保存签名
                - actionType: evalObject
                  object:
                    # 签名reid指向 doc 的id
                    - ..apiRequest.newSign.docReq.reid@: =.SurgeryAuthorization.apiRequest.surgeryForm.docReq.id

                - actionType: evalObject
                  object:
                    - if:
                        - =..formData.whetherSignature
                        - continue
                        - =..apiRequest.newSign.docAPI.store: ""

                #  指定 eid 和 reid
                - actionType: evalObject
                  object:
                    - ..apiRequest.surgeryForm.docReq.eid@: =.Global.currentRoom.edge.id
                    - ..apiRequest.surgeryForm.docReq.reid@: =.Global.roomInfo.edge.id

                # 签名处理
                - actionType: evalObject
                  object:
                    - if:
                        - =..formData.temporarySignature
                        - actionType: evalObject
                          object:
                            - ..apiRequest.surgeryForm.docReq.name.data.signatureCtime@: =..formData.signatureCtime
                            - ..apiRequest.surgeryForm.docReq.name.data.signatureId@: =..formData.temporarySignature
                            - ..apiRequest.surgeryForm.docReq.name.data.whetherSignature@: false
                            - ..formData.whetherSignature@: false
                        - actionType: evalObject
                          object:
                            - ..apiRequest.surgeryForm.docReq.name.data.signatureCtime@: =..apiRequest.newSign.docRes.doc.ctime
                            - ..apiRequest.surgeryForm.docReq.name.data.signatureId@: =..apiRequest.newSign.docRes.doc.id
                            - ..apiRequest.surgeryForm.docReq.name.data.whetherSignature@: =..formData.whetherSignature

                - actionType: evalObject
                  object:
                    - if:
                        - =.SurgeryAuthorization.formData.whetherSignature
                        - actionType: popUp
                          popUpView: BaseWarningView
                          wait: true
                          popUpDismiss: 2000
                        - continue

                #  修改type
                - actionType: evalObject
                  object:
                    - =.builtIn.number.inhx:
                        dataIn:
                          intHex: =..apiRequest.surgeryForm.docReq.type
                          index: 1
                          hex: 1
                        dataOut: SurgeryAuthorization.apiRequest.surgeryForm.docReq.type

                - actionType: evalObject
                  object:
                    # 更新文档状态
                    - ..apiRequest.surgeryForm.docReq.name.data.statusTag.name@: "Released"
                    - ..apiRequest.surgeryForm.docReq.name.data.statusTag.fontColor@: "0x2988e6"
                    - ..apiRequest.surgeryForm.docReq.name.data.statusTag.backgroundColor@: "0xdfedfc"

                # 保存
                - actionType: evalObject
                  object:
                    # physician
                    - ..apiRequest.surgeryForm.docReq.name.data.surgeryInfo.physician@: =..formData.selectStatus.physician
                    # Postoperative  Therapy
                    - ..apiRequest.surgeryForm.docReq.name.data.surgeryInfo.postTherapy@: =..formData.postTherapy
                    # medicalSelect
                    - ..apiRequest.surgeryForm.docReq.name.data.surgeryInfo.medicalStatus.medicalSelect@: =..formData.medicalClear
                    # H&P / Medical clearance
                    - ..apiRequest.surgeryForm.docReq.name.data.surgeryInfo.medicalStatus.clearSelect@: =..formData.selectStatus.clearance

                    - =..apiRequest.surgeryForm.docAPI.store: ""

                    - =.builtIn.array.add:
                        dataIn:
                          object: =.Global.currentMeetingDoc
                          value: =..apiRequest.surgeryForm.docResp.doc

                - actionType: evalObject
                  object:
                    .Global._nonce@:
                      =.builtIn.math.random: ""

                - actionType: evalObject
                  object:
                    - goto: ProviderNoteSelect

    # 弹窗区域
    - .BaseWarningView:
      message: "Please complete required fields: Search&Description"
      viewTag: SearchWarning

    - .BaseWarningView:
      viewTag: unCompleteTag
      message: "Please complete the items you selected."

    - .BaseWarningView:
      message: "You haven't signed the form"

    - type: popUp
      viewTag: startDateTag
      style:
        left: "0"
        top: "0"
        width: "1"
        height: "1"
        backgroundColor: "0x00000066"
        zIndex: "1000"
      children:
        - .BaseComponents.calendar:
          children:
            - .BaseComponents.calendarHeader:
              children:
                - type: view
                  style:
                    marginTop: "0.024"
                    left: "0"
                    height: "0.035"
                    width: "0.9"
                  children:
                    - .BaseComponents.newMonthView:
                    - .BaseComponents.newYearView:
                - .BaseComponents.newdevider:
                - .BaseComponents.weekView:
            - .BaseComponents.dayView:
            - .BaseComponents.addButton:
              text: "Select"
              onClick:
                - actionType: evalObject
                  object:
                    - ..apiRequest.surgeryForm.docReq.name.data.surgeryInfo.surgicalDate@: =.BaseComponents.calendarDate.todayDate
                - actionType: builtIn
                  funcName: redraw
                  viewTag: dateViewTag
                - actionType: popUpDismiss
                  popUpView: startDateTag

    - .publicDeleteUP:
      viewTag: BaseDelWarningView
      leftButton:
        - actionType: popUpDismiss
          popUpView: BaseDelWarningView
      rightButton:
        - actionType: evalObject
          object:
            - =.builtIn.array.removeByName:
                dataIn:
                  object: =..apiRequest.surgeryForm.docReq.name.data.surgeryInfo.diagnosis.descriptiveList
                  key: code
                  name: =..formData.selectedDiagnosis.code
            - ..formData.listDataflag@: "block"
            - actionType: builtIn
              funcName: redraw
              viewTag: listData
        - actionType: popUpDismiss
          popUpView: BaseDelWarningView

    - .publicDeleteUP:
      viewTag: BaseCPTDelWarningView
      leftButton:
        - actionType: popUpDismiss
          popUpView: BaseCPTDelWarningView
      rightButton:
        - actionType: evalObject
          object:
            - =.builtIn.array.removeByName:
                dataIn:
                  object: =..apiRequest.surgeryForm.docReq.name.data.surgeryInfo.proRequest.descriptiveList
                  key: code
                  name: =..formData.selectedProRequest.code
            - ..formData.listDataFlagPro@: "block"
            - actionType: builtIn
              funcName: redraw
              viewTag: CPTlistData
        - actionType: popUpDismiss
          popUpView: BaseCPTDelWarningView
