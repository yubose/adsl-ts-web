Drafts:
  pageNumber: "120"
  title: "Drafts"
  init:
    - .SignInCheck
    - actionType: updateObject
      dataKey: Global.inboxContact
      dataObject: .EmptyObj
    - actionType: updateObject
      dataKey: Global.email
      dataObject: .EmptyObj
    - actionType: updateObject
      dataKey: Global.inboxMessage
      dataObject: .EmptyObj
    - actionType: updateObject
      dataKey: Global.formData.attachments
      dataObject: .EmptyObj
    - ..apiRequest.email.docAPI.get
    - actionType: evalObject
      object:
        - if:
            - =..apiRequest.email.docQueryResp.doc.0
            - continue
            - =.builtIn.checkField:
                dataIn:
                  contentType: messageHidden
                  wait: 100
  apiRequest:
    email:
      docQueryResp: ""
      docQueryReq:
        ObjType: 544
        type: 1281
        sCondition: E.type=10000 AND (D2.type & 0xFF18 =0xE00 OR D2.reid is NULL)
        xfname: (E.bvid|E.evid)&D.ovid
        obfname: ctime
        maxcount: "100"
        _nonce: =.Global._nonce
      docAPI:
        get:
          api: rd
          dataIn: Drafts.apiRequest.email.docQueryReq
          dataOut: Drafts.apiRequest.email.docQueryResp
  components:
    - .BaseHeader:
    - .HeaderRightImg:
      path: sideNav3.svg
      onClick:
        - goto: InboxMenu
    - type: view
      style:
        left: "0"
        width: "1"
        top: "0.1"
        height: "0.06"
        border:
          style: "2"
        borderColor: "0x00000033"
        backgroundColor: "0x2988e6"
        borderWidth: "1"
        zIndex: "10"
      children:
        - type: textField
          placeholder: "Search"
          dataKey: formData.serachInfo
          style:
            top: "0.015"
            width: "0.7"
            left: "0.05"
            height: "0.03"
            backgroundColor: "0xffffff"
            borderRadius: "5"
            paddingLeft: "20px"
            borderWidth: "0"
        - type: label
          text: Edit
          onClick:
            - actionType: evalObject
              object:
                - .Global.emailForEdit@: ""
                - .Global.emailEditFunction@: ""
                - .Global.editTitle@: ""
                # 将页面的邮件传入edit中，让后可以进行的操作也进行传输
                - .Global.emailForEdit@: =..apiRequest.email.docQueryResp.doc #数据
                - .Global.emailEditFunction@: [
                      null.png,
                      null.png,
                      inboxDelete.svg,
                    ] #功能
                - .Global.editTitle@: "Edit Drafts" #标题
            - goto: EditInboxSelf
          style:
            top: "0.019"
            left: "0.83"
            height: "0.03"
            width: "0.15"
            fontSize: .Nfont.h15
            color: "0xffffff"
            fontWeight: 400
            textAlign:
              x: center
    - type: view
      style:
        left: "0"
        width: "1"
        top: "0.16"
        height: "0.84"
      children:
        - type: view
          contentType: messageHidden
          style:
            width: "0.5"
            height: "0.5"
            top: "0.16"
            left: "0.25"
            isHidden: "true"
            zIndex: "100"
            textAlign:
              x: center
          children:
            - type: image
              path: noEmail.svg
              style:
                # height: "0.22"
                width: "0.5"
                margin: auto
            - type: label
              text: "No message here…"
              style:
                textAlign:
                  x: center
                left: "0.05"
                top: "0.24"
                width: "0.4"
                height: "0.04"
                color: "0x000058"
                fontSize: ".Nfont.h1"
        - type: list
          contentType: listObject
          listObject: ..apiRequest.email.docQueryResp.doc
          iteratorVar: itemObject
          viewTag: emailList
          style:
            left: "0"
            top: "0"
            width: "1"
            margin: "0"
            height: "0.84"
            overflow: scroll
            backgroundColor: "0xffffff"
          children:
            - type: listItem
              onClick:
                - actionType: updateObject
                  dataKey: Global.email
                  dataObject: itemObject
                - actionType: evalObject
                  object:
                    - ..emailInfo.edge@: =.Global.email
                - actionType: evalObject
                  object:
                    - =..emailInfo.edgeAPI.store: ""
                - actionType: evalObject
                  object:
                    .Global._nonce@:
                      =.builtIn.math.random: ""
                - goto: NewMessage1
              itemObject: ""
              style:
                width: "1"
                height: "auto"
                borderWidth: "1"
                border:
                  style: "2"
                  color: "0xdcdcdc"
                overflow: hidden
              children:
                - type: view
                  style:
                    width: "1"
                    height: "0.01"
                - type: view
                  style:
                    width: "1"
                    height: "auto"
                  children:
                    - type: view
                      style:
                        height: "auto"
                        width: "0.2"
                        display: "inline-block"
                        verticalAlign: middle
                      children:
                        - type: image
                          path: patientImage.svg
                          path=func: =.builtIn.utils.prepareDocToPath
                          dataKey: itemObject.name.data.receiverAvatarId
                          style:
                            marginLeft: "0.05"
                            verticalAlign: middle
                            height: "0.06"
                            borderRadius: "7"
                            width: "6vh"
                    - type: view
                      style:
                        verticalAlign: middle
                        display: "inline-block"
                        height: "auto"
                        width: "auto"
                      children:
                        - type: view
                          style:
                            verticalAlign: middle
                            marginLeft: "0.05"
                            display: "inline-block"
                            height: "auto"
                            width: "0.51"
                          children:
                            - type: label
                              dataKey: itemObject.name.data.receiverName
                              style:
                                width: "0.5"
                                height: "auto"
                                fontSize: .Nfont.h1
                                #
                                color: "0x707070"
                                overflow: hidden
                                text-overflow: ellipsis
                                whiteSpace: nowrap
                            - type: label
                              text: "(No subject)"
                              dataKey: itemObject.name.title
                              style:
                                marginTop: "0.003"
                                width: "0.4"
                                height: "auto"
                                fontSize: .Nfont.h1
                                color: "0x707070"
                                overflow: hidden
                                text-overflow: ellipsis
                                whiteSpace: nowrap
                            - type: label
                              text: "(No content)"
                              dataKey: itemObject.name.data.content
                              style:
                                marginTop: "0.003"
                                width: "0.4"
                                height: "auto"
                                fontSize: .Nfont.h1
                                color: "0x00000099"
                                overflow: hidden
                                text-overflow: ellipsis
                                whiteSpace: nowrap
                    - type: view
                      style:
                        display: "inline-block"
                        width: "0.2"
                        height: "auto"
                        verticalAlign: top
                      children:
                        - type: label
                          text=func: =.builtIn.date.formatData
                          dataKey: itemObject.ctime
                          style:
                            height: "auto"
                            width: "0.2"
                        - type: view
                          style:
                            marginTop: "0.01"
                            width: "0.2"
                            height: "auto"
                          children:
                            - type: image
                              style:
                                height: "0.03"
                                verticalAlign: middle
                              path:
                                emit:
                                  dataKey:
                                    var: itemObject
                                  actions:
                                    - if:
                                        - $var.name.data.haveAttachment
                                        - flatAttachment.svg
                                        - null.png
                - type: view
                  style:
                    width: "1"
                    height: "0.01"
    - type: image
      path: compose.svg
      onClick:
        - goto: NewMessage
      text: Compose
      style:
        left: "0.8"
        top: "0.75"
        height: "0.06"
        zIndex: "100"
