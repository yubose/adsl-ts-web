MobileContacts:
  title: "Schedule An Appointment"
  init:
    - .SignInCheck
    - .Global.optionalForms@: []
    - .Global.formData.patientChart@: ""
    - actionType: evalObject
      object:
        .Global._nonce@:
          =.builtIn.math.random: ""
    - actionType: updateObject
      dataKey: Global.formData.cov19Test
      dataObject: .EmptyObj
    #  清空newPatientForm
    - actionType: updateObject
      dataKey: Global.formData.newPatientForm
      dataObject: .EmptyObj
    - actionType: updateObject
      dataKey: Global.formData.cov19TestNewPatForm
      dataObject: .EmptyObj
    - actionType: updateObject
      dataKey: Global.formData.cov19TestForm
      dataObject: .EmptyObj
    - actionType: updateObject
      dataKey: Global.formData.modernaVaccineFirDoseForm
      dataObject: .EmptyObj
    # 清空modernaVaccineSecDoseForm
    - actionType: updateObject
      dataKey: Global.formData.modernaVaccineSecDoseForm
      dataObject: .EmptyObj
    #  清空pifzerVaccineFirDoseForm
    - actionType: updateObject
      dataKey: Global.formData.pifzerVaccineFirDoseForm
      dataObject: .EmptyObj
    - actionType: updateObject
      dataKey: Global.formData.pifzerVaccineSecDoseForm
      dataObject: .EmptyObj
    - actionType: updateObject
      dataKey: Global.formData.fluVaccinationConsentForm
      dataObject: .EmptyObj
    - actionType: updateObject
      dataKey: Global.formData.patientConsentForm
      dataObject: .EmptyObj
    - actionType: updateObject
      dataKey: Global.formData.back_InsuranceCard
      dataObject: .EmptyObj
    - actionType: updateObject
      dataKey: Global.formData.front_IDCard
      dataObject: .EmptyObj
    - actionType: updateObject
      dataKey: Global.formData.front_InsuranceCard
      dataObject: .EmptyObj
    - actionType: updateObject
      dataKey: Global.formData.visitQuestionnaireDoc
      dataObject: .EmptyObj
    - actionType: updateObject
      dataKey: Global.formData.pifzerBioNTech
      dataObject: .EmptyObj
    - actionType: updateObject
      dataKey: Global.formData.moderna
      dataObject: .EmptyObj
    - actionType: updateObject
      dataKey: Global.formData.signature_moderna
      dataObject: .EmptyObj
    #  重置newPatientFormDM
    - actionType: updateObject
      dataKey: VaccineFormDM.newPatientFormDM
      dataObject: .MobileContacts.newPatientForm
    #  重置pifzerVaccineFirDoseFormDM
    - actionType: updateObject
      dataKey: VaccineFormDM.pifzerVaccineFirDoseFormDM
      dataObject: .MobileContacts.patientChart
    #  重置modernaVaccineSecDoseFormDM
    - actionType: updateObject
      dataKey: VaccineFormDM.modernaVaccineSecDoseFormDM
      dataObject: .MobileContacts.patientChart
    - .Global.formData.patientDoc.status.sharePatientChart@: ""
    - .Global.visitQuestionnaireDoc@: ""
    - .Global.vaccine@: []
    - .Global.vaccineDoc@: []
    - .Global.formData.firstToCov19Test@: true
    - .Global.formData.firstToCov19TestForm@: true
    - .Global.formData.firstToCov19TestNewPatForm@: true
    # 重置firstToNewPatientForm状态
    - .Global.formData.firstToNewPatientForm@: true
    # 重置firstToNewPatientForm状态
    - .Global.formData.firstToPfizerVaccineFirDoseForm@: true
    - .Global.formData.firstToPfizerVaccineSecDose@: true
    # 重置firstToModernaVaccineSecDoseForm状态
    - .Global.formData.firstToModernaVaccineFirDoseForm@: true
    - .Global.formData.firstToModernaVaccineSecDoseForm@: true
    - .Global.formData.firstFluVaccinationConsentForm@: true
    # 重置 firstPatientConsentForm 状态
    - .Global.formData.firstPatientConsentForm@: true
    - .Global.formData.patientDoc.status.sharePatientChart@: ""
    - .Global.visitQuestionnaireDoc@: ""
    - .Global.vaccine@: []
    - .Global.vaccineDoc@: []
    - actionType: evalObject
      object:
        - =.builtIn.date.getMonth:
            dataIn: ""
            dataOut: MobileContacts.calendarDate.month
    - actionType: evalObject
      object:
        - =.builtIn.date.getYear:
            dataIn: ""
            dataOut: MobileContacts.calendarDate.year
    - actionType: evalObject
      object:
        - =.builtIn.date.getDate:
            dataIn: ""
            dataOut: MobileContacts.calendarDate.day
    - actionType: evalObject
      object:
        - =.builtIn.date.transformMonth:
            dataIn:
              month: =..calendarDate.month
            dataOut: MobileContacts.calendarDate.monthName
    - actionType: evalObject
      object:
        - =.builtIn.string.concat:
            dataIn:
              - =..calendarDate.year
              - "-"
              - =..calendarDate.month
              - "-"
              - =..calendarDate.day
            dataOut: MobileContacts.calendarDate.todayDate
    - actionType: evalObject
      object:
        - =.builtIn.date.getTimeStampOfDate:
            dataIn:
              date: =..calendarDate.todayDate
            dataOut: MobileContacts.calendarDate.todayStamp
    - actionType: evalObject
      object:
        - =.builtIn.string.concat:
            dataIn:
              - "(stime<"
              - =..calendarDate.todayStamp.start
              - " AND "
              - "etime>"
              - =..calendarDate.todayStamp.start
              - " OR "
              - "stime>"
              - =..calendarDate.todayStamp.start
              - " AND "
              - "etime<"
              - =..calendarDate.todayStamp.end
              - " OR "
              - "stime<"
              - =..calendarDate.todayStamp.end
              - " AND "
              - "etime>"
              - =..calendarDate.todayStamp.end
              - ")"
              - " AND "
              - "subtype="
              - =..formData.currentSubtype
            dataOut: Global.scheduleScondition
    - actionType: evalObject
      object:
        - =..apiRequest.schedule.get: ""
    - actionType: evalObject
      object:
        - =.builtIn.date.ShowDateByNumber:
            dataIn:
              year: =..calendarDate.year
              month: =..calendarDate.month
              day: =..calendarDate.day
            dataOut: MobileContacts.selectDate
    - actionType: evalObject
      object:
        - =.builtIn.date.miniWeeklyCalendarArray:
            dataIn:
              year: =..calendarDate.year
              month: =..calendarDate.month
              today: =..calendarDate.day
              markDay: =..calendarDate.day
              color: "0x000000"
              backgroundColor: "0x2988E6"
              todayColor: "0xffffff"
              todayBackgroundColor: "0xFFFFFF6f"
            dataOut: MobileContacts.calendarDate.dayLable
    - ..VisitReason.docAPI.get
    #1
    - actionType: evalObject
      object:
        ..VisitReason.document@: =..VisitReason.response.doc.0
    - actionType: evalObject
      object:
        - =.builtIn.array.convertToList:
            dataIn:
              array: =..VisitReason.document.name.data.reasonForVisit
              key: reason
            dataOut: MobileContacts.reasonForVisit
        - =.builtIn.date.splitTime:
            dataIn:
              object2: =..apiRequest.schedule.scheduleList.edge
              timeSlot: =..duration
              year: =..calendarDate.year
              month: =..calendarDate.month
              day: =..calendarDate.day
              isSplitCurrent: true
              delayTime: 1800
            dataOut: MobileContacts.splitTime
    - if:
        - ..checkData.get
        - continue
        - =.builtIn.checkField:
            dataIn:
              contentType: messageHidden
              wait: 100
    - actionType: evalObject
      object:
        - ..reason@: =..reasonForVisit.0
        - .Global.E2Subtype@: 196610
    - =.builtIn.array.getByKey:
        dataIn:
          array: =..VisitReason.document.name.data.reasonForVisit
          key1: reason
          value: =..reason
          key2: duration
        dataOut: MobileContacts.duration
    - =.builtIn.string.retainNumber:
        dataIn:
          value: =..duration
        dataOut: MobileContacts.duration
    - =.builtIn.array.getByKey:
        dataIn:
          array: =..VisitReason.document.name.data.reasonForVisit
          key1: reason
          value: =..reason
          key2: document
        dataOut: MobileContacts.docu
    - actionType: evalObject
      object:
        - =.builtIn.string.retainNumber:
            dataIn:
              value: =..duration
            dataOut: MobileContacts.formData.duration
    - actionType: evalObject
      object:
        - =.builtIn.date.splitTime:
            dataIn:
              object2: =..apiRequest.schedule.scheduleList.edge
              timeSlot: =..duration
              year: =..calendarDate.year
              month: =..calendarDate.month
              day: =..calendarDate.day
              isSplitCurrent: true
              delayTime: 1800
            dataOut: MobileContacts.splitTime
    - =.builtIn.date.getTime:
        dataIn:
        dataOut: MobileContacts.nowTimeStamp
    - ..apiRequest.relation.vertexAPI.get
    - =.builtIn.object.extract:
        dataIn:
          array: =..apiRequest.relation.vertexQueryResp.vertex
          field: id
        dataOut: MobileContacts.formData.locationIdList
  apiRequest:
    relation:
      vertexQueryResp: ""
      vertexQueryReq:
        ObjType: "4"
        id: .Global.currentFacility.bsig
        xfname: E.bvid
        sCondition: E.type=1100 AND V.type=21
      vertexAPI:
        get:
          api: rv
          dataIn: MobileContacts.apiRequest.relation.vertexQueryReq
          dataOut: MobileContacts.apiRequest.relation.vertexQueryResp
    schedule:
      response: ""
      scheduleList: ""
      edge:
        type: 40000
        id:
          - .Global.ActiveProvider.bsig
          - .Global.currentFacility.bsig
        sCondition: =.Global.scheduleScondition
        maxcount: "10000"
        xfname: Evid,Bvid
        obfname: "stime"
        asc: true
        _nonce: =.Global._nonce
      get:
        .EdgeAPI.get: ""
        api: re
        dataIn: apiRequest.schedule.edge
        dataOut: MobileContacts.apiRequest.schedule.scheduleList
  splitTime:
    morning: []
    afternoon: []
  reasonForVisit: []
  reason: ""
  duration: ""
  selectDate: ""
  visitType: "Telemedicine"
  docu: []
  clock: ""
  currentFaci:
    vertexResp: ""
    vertexIn:
      ObjType: 4
      id: ""
      xfname: "E.bvid|E.evid"
      sCondition: "E.type=1100 AND V.type=20"
      _nonce: =.Global._nonce
      maxcount: "1"
    vertexAPI:
      get:
        api: rv
        dataIn: currentFaci.vertexIn
        dataOut: MobileContacts.currentFaci.vertexResp
  VisitReason:
    response: ""
    document:
      type: .DocType.VisitReason
      name:
        data:
          reasonForVisit: []
      eid: .Global.rootNotebookID
    docAPI:
      get:
        .DocAPI.get: ""
        api: rd
        type: .DocType.VisitReason
        id: ..formData.doctorId
        xfname: ovid
        dataKey: MobileContacts.VisitReason.response
        _nonce: =.Global._nonce
  formData:
    doctorId: .Global.ActiveProvider.bsig
    rootnootbookInfo:
    rootnootbookId: ""
    duration: ""
    currentSubtype: "196609"
    locationIdList: []
  checkData:
    check:
      edge: ""
    get:
      edgeAPI.get: ""
      api: re
      dataKey: checkData.check
      id:
        - .Global.ActiveProvider.bsig
        - .Global.ActiveProvider.bsig
      xfname: bvid,evid
      type: 40000
      sCondition: "subtype=196609"
      _nonce: =.Global._nonce
  save:
    - =.MobileContacts.newAppointment.edgeAPI.store: ""
  # get available of current this provider and this facility

  todaySchedule: ""
  calendarDate:
    month: ""
    year: ""
    day: ""
    dayLable: []
    weekLabel:
      - key: SU
      - key: MO
      - key: TU
      - key: WE
      - key: TH
      - key: FR
      - key: SA
    todayDate: "YYYY-MM-DD"
    monthName: ""
    tempDate: ""
    calendarDate:
    Scondition: ""
    todayStamp: ""
  newPatientForm: # New Patient Forms 的数据存储
    classTag:
      name: Patient
      fontColor: "0xf8ae29"
      backgroundColor: "0xfff4e0"
      display: block
    statusTag:
      display: none
    patientInfo:
      firstName: " "
      middleName: " "
      lastName: " "
      dateOfBirth: " "
      gender: " "
      address: " "
      line: " "
      secondLine: " "
      city: " "
      county: " "
      state: " "
      zipCode: " "
      residence: " "
      mainContact: " "
      alternativePhone: " "
      email: " "
      employer: ""
      occupation: " "
      name: " "
      relation: " "
      phoneNumber: " "
      agreement: []
    signatureHippa:
      signatureNewPatForm: ""
      recipientName: ""
      whetherSignature: ""
      signatureTime: ""
    billingInfo:
      medicalInsurance: " "
      indentification:
        membersID: " "
        companyName: " "
        insuredName: " "
        relationship: " "
        securityNumber: " "
  patientChart:
    classTag:
      name: Patient
      fontColor: "0xf8ae29"
      backgroundColor: "0xfff4e0"
      display: block
    statusTag:
      display: none
    patientInfo:
      firstName: " "
      middleName: " "
      lastName: " "
      dateOfBirth: " "
      gender: " "
      address: " "
      city: " "
      state: " "
      zipCode: " "
      residence: " "
      mainContact: " "
      alternativePhone: " "
      email: " "
      employer: " "
      occupation: " "
      name: " "
      relation: " "
      phoneNumber: " "
    symptomProfile:
      experience: []
      remark: " "
      problem1: " "
      problem2: " "
      problem3: " "
      problem4: " "
    billingInfo:
      medicalInsurance: " "
      indentification:
        membersID: " "
        companyName: " "
        insuredName: " "
        relationship: " "
        securityNumber: " "
        front_IDCard: ""
        front_InsuranceCard: ""
        back_InsuranceCard: ""
  nowTimeStamp: ""
  components:
    - .BaseHeader:
    - .HeaderLeftButton:
    - .BaseCheckView:
      viewTag: dateCheck
      message: "Please don't Choose the past time"
      colorChange: "0xd81e06"
      imgPath: popUpWrong.svg
      children:
        - type: view
          style:
            width: "0.8"
            height: "0.3"
            top: "0.3"
            left: "0.1"
            zIndex: "100"
            backgroundColor: "0xffffff"
            borderRadius: "7"
            border:
              style: "3"
            borderColor: "#f4f8fa"
            borderWidth: "3"
          children:
            - .BaseCheckViewImg:
            - .BaseCheckViewLabel:
            - .BaseCheckViewButton:
              onClick:
                - actionType: popUpDismiss
                  popUpView: ____.viewTag
    - type: view
      style:
        top: "0.1"
        left: "0"
        height: "0.25"
        width: "1"
        # backgroundColor: "0xcdcdcd"
      children:
        - .MCLabel:
        - type: select
          dataKey: visitType
          options:
            .SelectINformationDM.VisitType
            # - Telemedicine
            # - Office Visit
          onChange:
            # - emit:
            #     actions:
            - actionType: evalObject
              object:
                - if:
                    - =.builtIn.string.equal:
                        dataIn:
                          string1: =..visitType
                          string2: "Telemedicine"
                    - .MobileContacts.formData.currentSubtype@: "196609"
                    - continue
                - if:
                    - =.builtIn.string.equal:
                        dataIn:
                          string1: =..visitType
                          string2: "Office Visit"
                    - .MobileContacts.formData.currentSubtype@: "131073"
                    - continue
                - if:
                    - =.builtIn.string.equal:
                        dataIn:
                          string1: =..visitType
                          string2: "Telemedicine"
                    - actionType: evalObject
                      object:
                        - .Global.E2Subtype@: 196610
                        - ..apiRequest.schedule.edge.xfname@: evid,bvid
                        - ..apiRequest.schedule.edge.id@: []
                        - =.builtIn.array.add:
                            dataIn:
                              object: =..apiRequest.schedule.edge.id
                              value: =.Global.ActiveProvider.bsig
                        - =.builtIn.array.add:
                            dataIn:
                              object: =..apiRequest.schedule.edge.id
                              value: =.Global.currentFacility.bsig
                    - continue
                - if:
                    - =.builtIn.string.equal:
                        dataIn:
                          string1: =..visitType
                          string2: "Office Visit"
                    - actionType: evalObject
                      object:
                        - .Global.E2Subtype@: 131074
                        - ..apiRequest.schedule.edge.xfname@: evid,Bvid
                        - ..apiRequest.schedule.edge.id@: []
                        - =.builtIn.array.add:
                            dataIn:
                              object: =..apiRequest.schedule.edge.id
                              value: =.Global.ActiveProvider.bsig
                        - =.builtIn.array.concat:
                            dataIn:
                              array1: =..apiRequest.schedule.edge.id
                              array2: =..formData.locationIdList
                            dataOut: MobileContacts.apiRequest.schedule.edge.id
                    - continue
                - =.builtIn.string.concat:
                    dataIn:
                      - "(stime<"
                      - =..calendarDate.todayStamp.start
                      - " AND "
                      - "etime>"
                      - =..calendarDate.todayStamp.start
                      - " OR "
                      - "stime>"
                      - =..calendarDate.todayStamp.start
                      - " AND "
                      - "etime<"
                      - =..calendarDate.todayStamp.end
                      - " OR "
                      - "stime<"
                      - =..calendarDate.todayStamp.end
                      - " AND "
                      - "etime>"
                      - =..calendarDate.todayStamp.end
                      - ")"
                      - " AND "
                      - "subtype="
                      - =..formData.currentSubtype
                    dataOut: Global.scheduleScondition
                - .MobileContacts.splitTime@: []
                - .MobileContacts.splitTime@: []
                - ..apiRequest.schedule.scheduleList.edge@: []
                - .Global._nonce@:
                    =.builtIn.math.random: ""
                - =..apiRequest.schedule.get: ""
                - =.builtIn.string.retainNumber:
                    dataIn:
                      value: =..duration
                    dataOut: MobileContacts.formData.duration
                - =.builtIn.date.splitTime:
                    dataIn:
                      object2: =..apiRequest.schedule.scheduleList.edge
                      timeSlot: =..duration
                      year: =..calendarDate.year
                      month: =..calendarDate.month
                      day: =..calendarDate.day
                      isSplitCurrent: true
                      delayTime: 1800
                    dataOut: MobileContacts.splitTime
            - actionType: builtIn
              funcName: redraw
              viewTag: splitTimeTag
          style:
            top: "0.05"
            left: "0.1"
            height: "0.05"
            width: "0.75"
            textIndent: "10px"
            backgroundColor: "0xffffff"
            fontSize: "14"
            borderWidth: "1"
            box-sizing: "border-box"
            border:
              style: "3"
              color: "0x00000058"
        - .MCLabel:
          text: Reason for Visit
          style:
            top: "0.13"
            left: "0.11"
        - type: select
          dataKey: reason
          #placeHolder: "Select from blow"
          options: ..reasonForVisit
          onChange:
            - actionType: evalObject
              object:
                - =.builtIn.array.getByKey:
                    dataIn:
                      array: =..VisitReason.document.name.data.reasonForVisit
                      key1: reason
                      value: =..reason
                      key2: duration
                    dataOut: MobileContacts.duration
                - =.builtIn.string.retainNumber:
                    dataIn:
                      value: =..duration
                    dataOut: MobileContacts.duration
                - =.builtIn.array.getByKey:
                    dataIn:
                      array: =..VisitReason.document.name.data.reasonForVisit
                      key1: reason
                      value: =..reason
                      key2: document
                    dataOut: MobileContacts.docu
                - =.builtIn.string.retainNumber:
                    dataIn:
                      value: =..duration
                    dataOut: MobileContacts.formData.duration
                - .MobileContacts.splitTime@: []
                - .MobileContacts.splitTime@: []
                - =.builtIn.date.splitTime:
                    dataIn:
                      object2: =..apiRequest.schedule.scheduleList.edge
                      timeSlot: =..duration
                      year: =..calendarDate.year
                      month: =..calendarDate.month
                      day: =..calendarDate.day
                      isSplitCurrent: true
                      delayTime: 1800
                    dataOut: MobileContacts.splitTime
            - actionType: builtIn
              funcName: redraw
              viewTag: durationTag
            - actionType: builtIn
              funcName: redraw
              viewTag: splitTimeTag
          style:
            top: "0.16"
            left: "0.1"
            height: "0.05"
            width: "0.4"
            border:
              style: "3"
              color: "0x00000058"
              width: "1"
            textIndent: "10px"
        - .MCLabel:
          text: Duration
          style:
            top: "0.13"
            left: "0.55"
        - type: label
          dataKey: duration
          viewTag: durationTag
          style:
            top: "0.16"
            left: "0.55"
            width: "0.3"
            boxSizing: "border-box"
            height: "0.05"
            border:
              style: "3"
              color: "0x00000058"
              width: "1px"
            textAlign:
              x: center
              y: center
    - type: view
      viewTag: setSchedule
      style:
        width: "1"
        height: "0.2"
        backgroundColor: "0x2988E6"
        top: "0.35"
        left: "0"
      children:
        - type: view
          style:
            left: "0.2"
            width: "0.3"
            height: "0.08"
          children:
            - type: image
              path: whiteLeft.svg
              onClick:
                - actionType: evalObject
                  object:
                    - =.builtIn.date.loopMonth:
                        dataIn:
                          month: =..calendarDate.month
                          step: -1
                        dataOut: MobileContacts.calendarDate.month
                    - =.builtIn.date.transformMonth:
                        dataIn:
                          month: =..calendarDate.month
                        dataOut: MobileContacts.calendarDate.monthName
                    - =.builtIn.date.miniWeeklyCalendarArray:
                        dataIn:
                          year: =..calendarDate.year
                          month: =..calendarDate.month
                          today: 33
                          markDay: 1
                          color: "0x000000"
                          backgroundColor: "0x2988E6"
                          todayColor: "0xffffff"
                          todayBackgroundColor: "0xFFFFFF6f"
                        dataOut: MobileContacts.calendarDate.dayLable
                - actionType: builtIn
                  funcName: redraw
                  viewTag: setSchedule
              style:
                top: "0.025"
                height: "0.02"
            - type: label
              # text: "1"
              dataKey: calendarDate.monthName
              style:
                width: "0.12"
                # height: "0.08"
                top: "0.02"
                left: "0.028"
                fontSize: "18"
                color: "0xffffff"
                textAlign:
                  x: center
                # backgroundColor: "pink"
            - type: image
              path: whiteRight.svg
              onClick:
                - actionType: evalObject
                  object:
                    - =.builtIn.date.loopMonth:
                        dataIn:
                          month: =..calendarDate.month
                          step: 1
                        dataOut: MobileContacts.calendarDate.month
                    - =.builtIn.date.transformMonth:
                        dataIn:
                          month: =..calendarDate.month
                        dataOut: MobileContacts.calendarDate.monthName
                    - =.builtIn.date.miniWeeklyCalendarArray:
                        dataIn:
                          year: =..calendarDate.year
                          month: =..calendarDate.month
                          today: 33
                          markDay: 1
                          color: "0x000000"
                          backgroundColor: "0x2988E6"
                          todayColor: "0xffffff"
                          todayBackgroundColor: "0xFFFFFF6f"
                        dataOut: MobileContacts.calendarDate.dayLable
                - actionType: builtIn
                  funcName: redraw
                  viewTag: setSchedule
              style:
                left: "0.16"
                top: "0.025"
                height: "0.02"
        - type: view
          style:
            top: "0"
            left: "0.5"
            width: "0.4"
            height: "0.08"
          children:
            - type: image
              path: whiteLeft.svg
              onClick:
                - actionType: evalObject
                  object:
                    - =.builtIn.number.Subtraction:
                        dataIn:
                          num: =..calendarDate.year
                          step: 1
                        dataOut: MobileContacts.calendarDate.year
                    - =.builtIn.date.miniWeeklyCalendarArray:
                        dataIn:
                          year: =..calendarDate.year
                          month: 1
                          today: 33
                          markDay: 1
                          color: "0x000000"
                          backgroundColor: "0x2988E6"
                          todayColor: "0xffffff"
                          todayBackgroundColor: "0xFFFFFF6f"
                        dataOut: MobileContacts.calendarDate.dayLable
                - actionType: evalObject
                  object:
                    - .MobileContacts.calendarDate.month@: 1
                - actionType: evalObject
                  object:
                    - =.builtIn.date.transformMonth:
                        dataIn:
                          month: =..calendarDate.month
                        dataOut: MobileContacts.calendarDate.monthName
                - actionType: builtIn
                  funcName: redraw
                  viewTag: setSchedule
              style:
                top: "0.025"
                height: "0.02"
            - type: label
              # text: "2021"
              dataKey: calendarDate.year
              style:
                width: "0.12"
                # height: "0.08"
                top: "0.02"
                left: "0.058"
                fontSize: "18"
                color: "0xffffff"
                textAlign:
                  x: center
            - type: image
              path: whiteRight.svg
              onClick:
                - actionType: evalObject
                  object:
                    - =.builtIn.number.addition:
                        dataIn:
                          num: =..calendarDate.year
                          step: 1
                        dataOut: MobileContacts.calendarDate.year
                    - =.builtIn.date.miniWeeklyCalendarArray:
                        dataIn:
                          year: =..calendarDate.year
                          month: 1
                          today: 33
                          markDay: 1
                          color: "0x000000"
                          backgroundColor: "0x2988E6"
                          todayColor: "0xffffff"
                          todayBackgroundColor: "0xFFFFFF6f"
                        dataOut: MobileContacts.calendarDate.dayLable
                - actionType: evalObject
                  object:
                    .MobileContacts.calendarDate.month@: 1
                - actionType: evalObject
                  object:
                    - =.builtIn.date.transformMonth:
                        dataIn:
                          month: =..calendarDate.month
                        dataOut: MobileContacts.calendarDate.monthName
                - actionType: builtIn
                  funcName: redraw
                  viewTag: setSchedule
              style:
                left: "0.2"
                top: "0.025"
                height: "0.02"
        - type: view
          style:
            top: "0.06"
            # left: "0.5"
            width: "0.08"
            height: "0.08"
          children:
            - type: image
              path: whiteLeft.svg
              onClick:
                - actionType: evalObject
                  object:
                    - =.builtIn.date.LastWeek:
                        dataIn:
                          year: =..calendarDate.dayLable.0.year
                          month: =..calendarDate.dayLable.0.month
                          day: =..calendarDate.dayLable.0.day
                        dataOut: MobileContacts.calendarDate.tempDate
                    - =.builtIn.date.miniWeeklyCalendarArray:
                        dataIn:
                          year: =..calendarDate.tempDate.year
                          month: =..calendarDate.tempDate.month
                          today: =..calendarDate.day
                          markDay: =..calendarDate.tempDate.day
                          color: "0x000000"
                          backgroundColor: "0x2988E6"
                          todayColor: "0xffffff"
                          todayBackgroundColor: "0xFFFFFF6f"
                        dataOut: MobileContacts.calendarDate.dayLable
                - actionType: evalObject
                  object:
                    - ..calendarDate.year@: =..calendarDate.tempDate.year
                    - ..calendarDate.month@: =..calendarDate.tempDate.month
                    - =.builtIn.date.transformMonth:
                        dataIn:
                          month: =..calendarDate.month
                        dataOut: MobileContacts.calendarDate.monthName
                - actionType: builtIn
                  funcName: redraw
                  viewTag: setSchedule
              style:
                top: "0.03"
                height: "0.04"
                left: "0.03"
        - type: list
          #for Andorid Only
          # no Scrolling
          # with out listType: linearList will be recycler view, scrollable
          scrollable: false #会改变宽度
          contentType: listObject
          listObject: ..calendarDate.dayLable
          iteratorVar: itemObject
          viewTag: calendarColor
          style:
            axis: horizontal
            top: "0.05"
            left: "0.08"
            width: "0.84"
            height: "0.1"
          children:
            - type: listItem
              itemObject: ""
              onClick:
                - emit:
                    dataKey:
                      var: itemObject
                    actions:
                      - =.builtIn.date.miniWeeklyCalendarArray:
                          dataIn:
                            year: $var.year
                            month: $var.month
                            today: $var.day
                            markDay: $var.day
                            color: "0x000000"
                            backgroundColor: "0x2988E6"
                            todayColor: "0xffffff"
                            todayBackgroundColor: "0xFFFFFF6f"
                          dataOut: MobileContacts.calendarDate.dayLable
                      - .MobileContacts.splitTime@: []
                      - .MobileContacts.splitTime@: []
                      - ..calendarDate.year@: $var.year
                      - ..calendarDate.month@: $var.month
                      - ..calendarDate.day@: $var.day
                      - =.builtIn.date.ShowDateByNumber:
                          dataIn:
                            year: =..calendarDate.year
                            month: =..calendarDate.month
                            day: =..calendarDate.day
                          dataOut: MobileContacts.selectDate
                      - =.builtIn.date.transformMonth:
                          dataIn:
                            month: =..calendarDate.month
                          dataOut: MobileContacts.calendarDate.monthName
                      - =.builtIn.string.concat:
                          dataIn:
                            - =..calendarDate.year
                            - "-"
                            - =..calendarDate.month
                            - "-"
                            - $var.day
                          dataOut: MobileContacts.calendarDate.todayDate
                      - =.builtIn.date.getTimeStampOfDate:
                          dataIn:
                            date: =..calendarDate.todayDate
                          dataOut: MobileContacts.calendarDate.todayStamp
                      - =.builtIn.string.concat:
                          dataIn:
                            - "(stime<"
                            - =..calendarDate.todayStamp.start
                            - " AND "
                            - "etime>"
                            - =..calendarDate.todayStamp.start
                            - " OR "
                            - "stime>"
                            - =..calendarDate.todayStamp.start
                            - " AND "
                            - "etime<"
                            - =..calendarDate.todayStamp.end
                            - " OR "
                            - "stime<"
                            - =..calendarDate.todayStamp.end
                            - " AND "
                            - "etime>"
                            - =..calendarDate.todayStamp.end
                            - ")"
                            - " AND "
                            - "subtype="
                            - =..formData.currentSubtype
                          dataOut: Global.scheduleScondition
                - actionType: evalObject
                  object:
                    - if:
                        - =.builtIn.math.greater:
                            dataIn:
                              num1: =.MobileContacts.calendarDate.todayStamp.end
                              num2: =.MobileContacts.nowTimeStamp
                        - continue
                        - actionType: popUp
                          popUpView: dateCheck
                          wait: true
                    - ..apiRequest.schedule.scheduleList.edge@: []
                - actionType: evalObject
                  object:
                    .Global._nonce@:
                      =.builtIn.math.random: ""
                - actionType: evalObject
                  object:
                    - =..apiRequest.schedule.get: ""
                - actionType: evalObject
                  object:
                    - =.builtIn.string.retainNumber:
                        dataIn:
                          value: =..duration
                        dataOut: MobileContacts.formData.duration
                - actionType: evalObject
                  object:
                    - .MobileContacts.splitTime@: []
                    - .MobileContacts.splitTime@: []
                - actionType: evalObject
                  object:
                    - =.builtIn.date.splitTime:
                        dataIn:
                          object2: =..apiRequest.schedule.scheduleList.edge
                          timeSlot: =..duration
                          year: =..calendarDate.year
                          month: =..calendarDate.month
                          day: =..calendarDate.day
                          isSplitCurrent: true
                          delayTime: 1800
                        dataOut: MobileContacts.splitTime
                - actionType: builtIn
                  funcName: redraw
                  viewTag: splitTimeTag
                - actionType: builtIn
                  funcName: redraw
                  viewTag: setSchedule
              style:
                # top: "0"
                width: "0.12"
                height: "0.1"
                # boxSizing: "border-box"
                # border: "none"
                # padding: "0px"
                # display: "inline-block"
                # flex: "auto"
              children:
                - type: label
                  dataKey: itemObject.weekDay
                  style:
                    width: "0.12"
                    color: "0xffffff"
                    textAlign:
                      x: center
                - type: label
                  dataKey: itemObject.day
                  style:
                    top: "0.04"
                    width: "0.1"
                    left: "0.01"
                    height: "0.045"
                    color: "0xffffff"
                    backgroundColor: itemObject.backgroundColor
                    borderRadius: "80"
                    textAlign:
                      x: center
                      y: center
        - type: view
          style:
            top: "0.06"
            left: "0.9"
            width: "0.08"
            height: "0.08"
          children:
            - type: image
              path: whiteRight.svg
              style:
                top: "0.03"
                height: "0.04"
                left: "0.02"
              onClick:
                - actionType: evalObject
                  object:
                    - =.builtIn.date.NextWeek:
                        dataIn:
                          year: =..calendarDate.dayLable.6.year
                          month: =..calendarDate.dayLable.6.month
                          day: =..calendarDate.dayLable.6.day
                        dataOut: MobileContacts.calendarDate.tempDate
                    - =.builtIn.date.miniWeeklyCalendarArray:
                        dataIn:
                          year: =..calendarDate.tempDate.year
                          month: =..calendarDate.tempDate.month
                          today: =..calendarDate.day
                          markDay: =..calendarDate.tempDate.day
                          color: "0x000000"
                          backgroundColor: "0x2988E6"
                          todayColor: "0xffffff"
                          todayBackgroundColor: "0xFFFFFF6f"
                        dataOut: MobileContacts.calendarDate.dayLable
                - actionType: evalObject
                  object:
                    - ..calendarDate.year@: =..calendarDate.tempDate.year
                    - ..calendarDate.month@: =..calendarDate.tempDate.month
                    - =.builtIn.date.transformMonth:
                        dataIn:
                          month: =..calendarDate.month
                        dataOut: MobileContacts.calendarDate.monthName
                - actionType: builtIn
                  funcName: redraw
                  viewTag: setSchedule
        - type: label
          dataKey: MobileContacts.selectDate
          style:
            width: "1"
            top: "0.16"
            fontSize: "15"

            color: "0xffffff"
            fontWeight: "550"
            textAlign:
              x: center
    - type: view
      style:
        top: "0.56"
        left: "0"
        width: "1"
        height: "0.42"
      viewTag: splitTimeTag
      children:
        # - type: label
        #   text: "Morning"
        #   style:
        #     left: "0.4"
        #     top: "0.03"
        #     width: "0.4"
        #     height: "0.04"
        #     color: "#808080"
        #     fontSize: "20"
        - .BaseList:
          androidGrid: true
          listObject: ..splitTime
          style:
            top: "0.03"
            height: "0.38"
            width: "0.9"
            left: "0.05"
            overflow: scroll
          children:
            - type: listItem
              itemObject: ""
              style:
                left: "0"
                # top: "0"
                width: "0.29"
                height: "0.07"
                display: "inline-block"
              children:
                - type: label
                  dataKey: itemObject.showTime
                  onClick:
                    - emit:
                        dataKey:
                          var: itemObject
                        actions:
                          - ..clock@: $var
                          - .Global.clock@: $var
                    - actionType: evalObject
                      object:
                        - .Global.formData.appointment.docu@: []
                        - .Global.formData.appointment.visitType@: =..visitType
                        - .Global.formData.appointment.selectDate@: =..selectDate
                        - .Global.formData.appointment.duration@: =..duration
                        - .Global.formData.appointment.reason@: =..reason
                        - .Global.formData.appointment.docu@: =..docu
                        - ..currentFaci.vertexIn.id@: =..clock.bvid
                        - =..currentFaci.vertexAPI.get: ""
                        - .Global.currentFacility@: =..currentFaci.vertexResp.vertex.0
                    - goto: CreateAppointmentToRoom
                  style:
                    width: "0.25"
                    height: "0.06"
                    # top: "0.01"
                    left: "0.03"
                    color: "#ffffff"
                    fontSize: "20"
                    fontWeight: "400"
                    zIndex: "100"
                    backgroundColor: "0x2988e6ff"
                    borderRadius: "6"
                    textAlign:
                      x: center
                      y: center
    - type: view
      viewTag: tipsView
      style:
        width: "0.8"
        height: "0.3"
        top: "0.3"
        left: "0.1"
        backgroundColor: "0xffffff"
        borderRadius: "7"
        border:
          style: "3"
        borderColor: "#f4f8fa"
        borderWidth: "3"
        zIndex: "1000"
      children:
        - type: label
          text: Tips
          style:
            left: "0.01"
            top: "0.02"
            width: "0.78"
            height: "0.04"
            color: "0x2988e6"
            fontSize: "18"
            fontWeight: "350"
            display: inline
            # fontStyle: "bold"

            textAlign:
              x: center
        - type: view
          style:
            left: "0"
            width: "0.8"
            top: "0.07"
            height: "0.15"
          children:
            - type: label
              text: "1. Choose type of appointment"
              style:
                left: "0.07"
                top: "0"
                width: "0.7"
                height: "0.03"
                color: "0x2988e6"
                fontSize: "16"
                fontWeight: "350"

                textAlign:
                  x: left
            - type: label
              text: "2.  Choose reason for your visit"
              style:
                left: "0.07"
                top: "0.05"
                width: "0.7"
                height: "0.03"
                color: "0x2988e6"
                fontSize: "16"
                fontWeight: "350"

                textAlign:
                  x: left
            - type: label
              text: "3. Select a time"
              style:
                left: "0.07"
                top: "0.1"
                width: "0.7"
                height: "0.03"
                color: "0x2988e6"
                fontSize: "16"
                fontWeight: "350"
                # fontStyle: "bold"

                textAlign:
                  x: left
        - type: button
          text: OK
          onClick:
            - actionType: popUpDismiss
              popUpView: tipsView
          style:
            left: "0.2"
            top: "0.22"
            width: "0.4"
            height: "0.04"
            color: "0xffffff"
            backgroundColor: "0x2988e6"
            fontSize: "18"
            fontWeight: "350"

            border:
              style: "3"
            borderColor: "0x2988e6"
            borderWidth: "1"
            borderRadius: "5"
            textAlign:
              x: center
