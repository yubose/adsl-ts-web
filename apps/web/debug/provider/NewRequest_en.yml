NewRequest:
  title: "New Request"
  pageNumber: "90"
  init:
    - .SignInCheck
    - actionType: evalObject
      object:
        .Global._nonce@:
          =.builtIn.math.random: ""
    - actionType: evalObject
      object:
        - =.builtIn.date.getMonth:
            dataIn: ""
            dataOut: NewRequest.calendarDate.month
    - actionType: evalObject
      object:
        - =.builtIn.date.getYear:
            dataIn: ""
            dataOut: NewRequest.calendarDate.year
    - actionType: evalObject
      object:
        - =.builtIn.date.getDate:
            dataIn: ""
            dataOut: NewRequest.calendarDate.day
    - actionType: evalObject
      object:
        - =.builtIn.string.concat:
            dataIn:
              - =.NewRequest.calendarDate.year
              - "-"
              - =.NewRequest.calendarDate.month
              - "-"
              - =.NewRequest.calendarDate.day
            dataOut: NewRequest.calendarDate.todayDate
    - actionType: evalObject
      object:
        - =.builtIn.date.getTimeStampOfDate:
            dataIn:
              date: =.NewRequest.calendarDate.todayDate
            dataOut: NewRequest.calendarDate.todayStamp
    - actionType: evalObject
      object:
        - actionType: evalObject
          async: true
          object:
            - =..inviteList.get: ""
            - =..requestList.get: ""
    - actionType: evalObject
      object:
        - if:
            - .Global.isGetRoom
            - actionType: evalObject
              object:
                - =..apiRequest.listRoomData.get: ""
                - =.builtIn.array.concatArray:
                    dataIn:
                      array1: =..inviteList.inviteInfo.edge
                      array2: =..apiRequest.listRoomData.response.edge
                      sortby: "stime"
                      orders: "asc"
                    dataOut: NewRequest.inviteList.inviteInfo.edge
            - continue

    - if:
        - ..inviteList.inviteInfo.edge.0
        - continue
        - =.builtIn.checkField:
            dataIn:
              contentType: messageHidden
              wait: 100
    - actionType: evalObject
      object:
        =.builtIn.array.getListLength:
          dataIn:
            object: ..requestList.requestData.edge
          dataOut: NewRequest.appointmentRequestNum
    - if:
        - =.builtIn.string.equal:
            dataIn:
              string1: =..appointmentRequestNum
              string2: "0"
        - ..requestListHidden@: "true"
        - ..requestListHidden@: "false"
  color: "0x000fff"
  lastTop: "0.0"
  selfNumber: "0"
  inviteList:
    inviteInfo:
      edge: ""
    edge:
      type: "40000"
      id: =.Global.ids
      xfname: "E2.evid,E2.Bvid"
      sCondition: "=.Global.queryScondition"
      maxcount: "20000"
      obfname: "stime"
      ObjType: "20"
      asc: true
      _nonce: .Global._nonce
    get:
      api: re
      dataIn: inviteList.edge
      dataOut: inviteList.inviteInfo
  requestList:
    requestData:
      edge: ""
    get:
      .EdgeAPI.get: ""
      api: re
      dataKey: requestList.requestData
      type: 40000
      id: .Global.currentUser.vertex.id
      maxcount: "10000"
      xfname: "evid"
      obfname: "ctime"
      sCondition: "subtype&0xff=2"
      asc: false
      _nonce: =.Global._nonce
  calendarDate:
    year: ""
    month: ""
    day: ""
    todayDate: ""
    todayStamp: ""
  appointmentRequestNum: ""
  requestListHidden: ""
  apiRequest:
    listRoomData:
      response:
        edge: []
      edge:
        .EdgeAPI.get: ""
        ObjType: "4"
        id:
          - =.Global.currentUser.vertex.id
          - =.Global.currentFacility.id
        xfname: "E.evid,E.bvid"
        sCondition: "=.Global.getRoomScondition"
        maxcount: "100"
        obfname: "stime"
        asc: true
        _nonce: =.Global._nonce
      get:
        .EdgeAPI.get: ""
        api: re
        dataIn: apiRequest.listRoomData.edge
        dataOut: apiRequest.listRoomData.response
  components:
    - .BaseHeader:
    - .HeaderLeftBack:
    - type: list
      contentType: listObject
      listObject: ..inviteList.inviteInfo.edge
      iteratorVar: itemObject
      style:
        width: "1"
        margin: "0"
        marginTop: "0.11"
        height: "0.88"
        overflow: scroll
      children:
        - type: listItem
          itemObject:
          style:
            marginTop: "0.015"
            width: "0.9"
            height: "auto"
            left: "0.05"
            border:
              style: 3
            borderColor: "#dededf"
            borderWidth: "1"
            borderRadius: "5"
            backgroundColor: "0xffffff"
            boxShadow: "1px 1px 4px 1px #dededf"
          children:
            - type: view
              style:
                width: "0.85"
                height: "0.04"
                left: "0.025"
              children:
                - type: view
                  style:
                    display: "inline-block"
                    height: "0.04"
                    width: "0.85"
                  children:
                    - type: image
                      path: waitTime.svg
                      style:
                        height: "0.017"
                        display: "inline-block"
                        verticalAlign: middle
                    - type: label
                      text=func: .builtIn.date.ShowTimeSpan
                      dataKey: itemObject
                      style:
                        marginLeft: "0.025"
                        display: "inline-block"
                        fontSize: .Nfont.h1
                        color: "0x4b4b4b"
                        width: "0.35"
                        height: "0.04"
                        lineHeight: "4vh"
                        verticalAlign: middle
                        textAlign:
                          x: left
                    - type: label
                      text=func: .builtIn.string.formatUnixtimeL_en
                      dataKey: itemObject.stime
                      style:
                        display: "inline-block"
                        fontSize: .Nfont.h1
                        color: "0x4b4b4b"
                        width: "0.24"
                        lineHeight: "4vh"
                        verticalAlign: middle
                        textAlign:
                          x: center
                    - type: image
                      style:
                        marginLeft: "0.02"
                        display: "inline-block"
                        height: "0.02"
                        verticalAlign: middle
                      path:
                        emit:
                          dataKey:
                            var: itemObject
                          actions:
                            - if:
                                - =.builtIn.number.typeIsValid:
                                    dataIn:
                                      docType: $var.tage
                                      localArr: [2]
                                      binaryArr: [0]
                                - videoWarn.svg
                                - null.png
                    - type: image
                      style:
                        marginLeft: "0.07"
                        display: "inline-block"
                        height: "0.017"
                        verticalAlign: middle
                      path:
                        emit:
                          dataKey:
                            var: itemObject
                          actions:
                            - if:
                                - =.builtIn.string.equal:
                                    dataIn:
                                      string1: $var.name.visitType
                                      string2: Telemedicine
                                - video.svg
                                - videoTele.svg
            - type: view
              style:
                width: "0.85"
                height: "0.001"
                left: "0.025"
                backgroundColor: "0xf0f0f0"
            - type: view
              style:
                marginTop: "0.01"
                width: "0.9"
                height: "auto"
              children:
                - type: view
                  style:
                    # display: "inline-block"
                    width: "0.7"
                    height: "auto"
                    left: "0.025"
                  children:
                    - type: image
                      path: appLeft.svg
                      style:
                        top: "0"
                        left: "0.75"
                        height: "0.06"
                    - type: label
                      dataKey: itemObject.name.Reason
                      style:
                        # display: "inline-block"
                        fontSize: .Nfont.h2
                        color: "0x4b4b4b"
                        height: "auto"
                        width: "auto"
                        # verticalAlign: middle
                    - type: view
                      style:
                        marginTop: "0.01"
                        height: "auto"
                        width: "0.7"
                      children:
                        - type: label
                          dataKey: itemObject.name.patientName
                          style:
                            fontSize: .Nfont.h15
                            color: "0x4b4b4b"
                            width: "auto"
                            wordWrap: break-word
                # - type: view
                #   style:
                #     display: "inline-block"
                #     height: "auto"
                #     width: "0.2"
                #     overflow: hidden
                #   children:
            - type: view
              style:
                marginTop: "0.01"
                width: "0.9"
                height: "auto"
          onClick:
            - actionType: updateObject # updateObject(dataKey, dataObject, dataObjectKey)
              dataKey: Global.roomInfo.edge
              dataObject: itemObject
            - emit:
                dataKey:
                  var: itemObject
                actions:
                  - actionType: updateObject
                    dataKey: Global.currentMeetingDoc
                    dataObject: []
                  - if:
                      - =.builtIn.number.typeIsValid:
                          dataIn:
                            docType: $var.subtype
                            localArr: [17]
                            binaryArr: [1]
                      - goto: AppointmentLobby
                      - goto: AppointmentLobbyOfficeVisit
