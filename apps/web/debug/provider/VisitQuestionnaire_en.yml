VisitQuestionnaire:
  title: Visit Questionnaire
  pageNumber:
  init: #Page initialization
    - .SignInCheck
    - ..formData@: =.Global.Note

    - =.builtIn.utils.createAuditLog:
        dataIn:
          actionTypeCode: .ActionTypeCode.view
          recordTypeCode: 30721
          eid: =.Global.formData.currentFacility.relationEdge.id
          user: =.Global.MyProfile.name.data.fullName
          userId: =.Global.currentUser.vertex.id
          targetUserId: =.Global.formData.auditLog.patientId
          accessPort: provider
        dataOut: Global.formData.auditLog.result

    - actionType: evalObject
      object:
        .Global._nonce@:
          =.builtIn.math.random: ""

    - actionType: evalObject
      object:
        # 下载pdf的样式控制
        - .Global.formData.downloadPDF.titleName@: "Visit Questionnaire"
        - .Global.formData.downloadPDF.scaleX@: 0.98
        - .Global.formData.downloadPDF.scaleY@: 0.98
        - .Global.formData.downloadPDF.originX@: 0
        - .Global.formData.downloadPDF.originY@: 0

  formData:
    name:
      data:
        newDrug:
          isShow: none
        emergency:
          isShow: none
        problems:
          isShow: none
        familyHistoryChanges:
          isShow: none

  formDataTemp: #Input data temp here, datatemp should not mix with formData
    takeMedTemp:
      - key: isPrescribed
        value: "Yes"
      - key: isPrescribed
        value: "Sometimes"
      - key: isPrescribed
        value: "No"
    proofMedTemp:
      - key: isProblems
        value: "Yes"
      - key: isProblems
        value: "Sometimes"
      - key: isProblems
        value: "No"
    upEmergTemp:
      - key: select
        value: "Yes"
      - key: select
        value: "No"
    upNewcondTemp:
      - key: select
        value: "Yes"
      - key: select
        value: "No"
    upEnvirallTemp:
      - key: select
        value: "Yes"
      - key: select
        value: "No"

  components:
    - .BasePublicHeader:
      children:
        - .BasePublicHeaderLeft:
        - .BasePublicHeaderTitle:
        - .BasePublicHeaderMenu:
    - type: scrollView
      viewTag: mainView
      style:
        width: "1"
        height: "0.94"
        # overflow: scroll
        boxSizing: "border-box"
        paddingBottom: "0.03"

      children:
        - type: label
          text: Today's Visit
          dataKey:
          style:
            height: "auto"
            width: "auto"
            marginTop: "0.022"
            marginLeft: "0.04"
            fontSize: .Nfont.h16
            fontWeight: "600"
            fontColor: "0x333333"
        - type: label
          text: 1. What is the purpose of your visit?
          style:
            marginLeft: "0.04"
            marginTop: "0.0185"
            fontWeight: "600"
            width: "0.92"
            height: "auto"
            color: "0x333333"
            fontSize: .Nfont.h14
        - type: label
          text: "No content"
          dataKey: formData.name.data.purpose
          style:
            marginTop: "0.01"
            marginLeft: "0.04"
            height: "auto"
            width: "0.92"
            boxSizing: border-box
            backgroundColor: "0xf4f4f4"
            padding: "6px 12px"
            border:
              style: 1
            borderRadius: "4"

            fontSize: .Nfont.h14
            color: "0x333333"
            wordWrap: break-word
        - type: label
          text: 2. Description of history of present illness.
          style:
            marginTop: "0.022"
            marginLeft: "0.04"
            fontWeight: "600"
            width: "0.92"
            height: "auto"
            color: "0x333333"
            fontSize: .Nfont.h14
        - type: label
          text: "No content"
          dataKey: formData.name.data.descriptionOfIllness
          style:
            marginTop: "0.01"
            marginLeft: "0.04"

            height: "auto"
            width: "0.92"
            boxSizing: border-box
            backgroundColor: "0xf4f4f4"
            padding: "6px 12px"
            border:
              style: 1
            borderRadius: "4"

            fontSize: .Nfont.h14
            color: "0x333333"
            wordWrap: break-word
        - type: label
          text: 3. Taking medication as prescribed?
          style:
            marginTop: "0.022"
            marginLeft: "0.04"
            fontWeight: "600"
            width: "0.92"
            height: "auto"
            color: "0x333333"
            fontSize: .Nfont.h14
        - type: view
          style:
            height: "auto"
            width: "0.92"
            marginLeft: "0.04"

          children:
            - type: list
              viewTag: takeMedTag
              androidGrid: true
              contentType: listObject
              listObject: ..formDataTemp.takeMedTemp
              iteratorVar: itemObject
              style:
                width: "0.9"
                margin: "0"
                height: "auto"
              children:
                - type: listItem
                  itemObject:
                  style:
                    width: "0.29"
                    height: "auto"
                    display: "inline-block"
                  children:
                    - type: image
                      style:
                        display: "inline-block"
                        marginTop: "0.02"
                        verticalAlign: middle
                        height: "4.5vw"
                        width: "4.5vw"
                      path:
                        emit:
                          dataKey:
                            var: itemObject
                          actions:
                            - if:
                                - =.builtIn.string.equal:
                                    dataIn:
                                      string1: =..formData.name.data.isPrescribed
                                      string2: $var.value
                                - radioOn.svg
                                - radioGray.svg
                    - type: label
                      dataKey: itemObject.value
                      style:
                        marginLeft: "0.02"
                        display: "inline-block"
                        marginTop: "0.02"
                        height: "auto"
                        verticalAlign: middle
                        fontSize: .Nfont.h14
                        textAlign:
                          x: left

        - type: label
          text: 4. Any problems with your medications?
          style:
            marginTop: "0.022"
            marginLeft: "0.04"
            fontWeight: "600"
            width: "0.92"
            height: "auto"
            color: "0x333333"
            fontSize: .Nfont.h14
        - type: view
          style:
            marginLeft: "0.04"
            height: "auto"
            width: "0.92"

          children:
            - type: list
              viewTag: proofMedTag
              androidGrid: true
              contentType: listObject
              listObject: ..formDataTemp.proofMedTemp
              iteratorVar: itemObject
              style:
                width: "0.9"
                margin: "0"
                height: "auto"
              children:
                - type: listItem
                  itemObject:
                  style:
                    width: "0.29"
                    height: "auto"
                    display: "inline-block"
                  children:
                    - type: image
                      style:
                        display: "inline-block"
                        marginTop: "0.02"
                        verticalAlign: middle
                        height: "4.5vw"
                        width: "4.5vw"
                      path:
                        emit:
                          dataKey:
                            var: itemObject
                          actions:
                            - if:
                                - =.builtIn.string.equal:
                                    dataIn:
                                      string1: =..formData.name.data.problems.select
                                      string2: $var.value
                                - radioOn.svg
                                - radioGray.svg
                    - type: label
                      dataKey: itemObject.value
                      style:
                        marginLeft: "0.02"
                        display: "inline-block"
                        marginTop: "0.02"
                        height: "auto"
                        verticalAlign: middle
                        fontSize: .Nfont.h14
                        textAlign:
                          x: left
        - type: label
          viewTag: problemsTag
          text: No content
          dataKey: formData.name.data.problems.content
          style:
            display: ..formData.name.data.problems.isShow
            marginTop: "0.0123"
            marginLeft: "0.04"
            height: "auto"
            width: "0.92"
            boxSizing: border-box
            backgroundColor: "0xf4f4f4"
            padding: "6px 12px"
            border:
              style: 1
            borderRadius: "4"

            fontSize: .Nfont.h14
            color: "0x333333"
            wordWrap: break-word
        - .DocPublicLine:
        - type: label
          text: Update Information
          dataKey:
          style:
            height: "auto"
            width: "auto"
            marginTop: "0.022"
            marginLeft: "0.04"
            fontSize: .Nfont.h16
            fontWeight: "600"
            fontColor: "0x333333"
        - type: label
          text: 1. Have you been to the emergency room, hospital, or another doctor since your last visit?
          style:
            marginLeft: "0.04"
            marginTop: "0.021"
            fontWeight: "600"
            width: "0.92"
            height: "auto"
            color: "0x333333"
            fontSize: .Nfont.h14
        - type: view
          style:
            marginLeft: "0.04"
            height: "auto"
            width: "0.92"

          children:
            - type: list
              viewTag: upEmergTag
              androidGrid: true
              contentType: listObject
              listObject: ..formDataTemp.upEmergTemp
              iteratorVar: itemObject
              style:
                width: "0.9"
                margin: "0"
                height: "auto"
              children:
                - type: listItem
                  itemObject:
                  style:
                    width: "0.3"
                    height: "auto"
                    display: "inline-block"
                  children:
                    - type: image
                      style:
                        display: "inline-block"
                        marginTop: "0.02"
                        verticalAlign: middle
                        height: "4.5vw"
                        width: "4.5vw"
                      path:
                        emit:
                          dataKey:
                            var: itemObject
                          actions:
                            - if:
                                - =.builtIn.string.equal:
                                    dataIn:
                                      string1: =..formData.name.data.emergency.select
                                      string2: $var.value
                                - radioOn.svg
                                - radioGray.svg
                    - type: label
                      dataKey: itemObject.value
                      style:
                        marginLeft: "0.02"
                        display: "inline-block"
                        marginTop: "0.02"
                        height: "auto"
                        verticalAlign: middle
                        fontSize: .Nfont.h14
                        textAlign:
                          x: left
        - type: label
          text: "No content"
          viewTag: emergenTag
          dataKey: formData.name.data.emergency.content
          style:
            display: ..formData.name.data.emergency.isShow
            marginTop: "0.01"
            marginLeft: "0.04"
            height: "auto"
            width: "0.92"
            boxSizing: border-box
            backgroundColor: "0xf4f4f4"
            padding: "6px 12px"
            border:
              style: 1
            borderRadius: "4"

            fontSize: .Nfont.h14
            color: "0x333333"
            wordWrap: break-word
        - type: label
          text: 2. Any changes or new conditions in your family history?
          style:
            marginLeft: "0.04"
            marginTop: "0.022"
            fontWeight: "600"
            width: "0.92"
            height: "auto"
            color: "0x333333"
            fontSize: .Nfont.h14
        - type: view
          style:
            marginLeft: "0.04"
            height: "auto"
            width: "0.92"

          children:
            - type: list
              viewTag: upNewcondTag
              androidGrid: true
              contentType: listObject
              listObject: ..formDataTemp.upNewcondTemp
              iteratorVar: itemObject
              style:
                width: "0.9"
                margin: "0"
                height: "auto"
              children:
                - type: listItem
                  itemObject:
                  style:
                    width: "0.3"
                    height: "auto"
                    display: "inline-block"
                  children:
                    - type: image
                      style:
                        display: "inline-block"
                        marginTop: "0.02"
                        verticalAlign: middle
                        height: "4.5vw"
                        width: "4.5vw"
                      path:
                        emit:
                          dataKey:
                            var: itemObject
                          actions:
                            - if:
                                - =.builtIn.string.equal:
                                    dataIn:
                                      string1: =..formData.name.data.familyHistoryChanges.select
                                      string2: $var.value
                                - radioOn.svg
                                - radioGray.svg
                    - type: label
                      dataKey: itemObject.value
                      style:
                        marginLeft: "0.02"
                        display: "inline-block"
                        marginTop: "0.02"
                        height: "auto"
                        verticalAlign: middle
                        fontSize: .Nfont.h14
                        textAlign:
                          x: left
        - type: label
          text: "No content"
          dataKey: formData.name.data.familyHistoryChanges.content
          viewTag: newcondTag
          style:
            display: ..formData.name.data.familyHistoryChanges.isShow
            marginTop: "0.01"
            marginLeft: "0.04"

            height: "auto"
            width: "0.92"
            boxSizing: border-box
            backgroundColor: "0xf4f4f4"
            padding: "6px 12px"
            border:
              style: 1
            borderRadius: "4"

            fontSize: .Nfont.h14
            color: "0x333333"
            wordWrap: break-word

        - type: label
          text: 3. Any new drug or environmental allergies?
          style:
            marginLeft: "0.04"
            marginTop: "0.022"
            fontWeight: "600"
            width: "0.92"
            height: "auto"
            color: "0x333333"
            fontSize: .Nfont.h14
        - type: view
          style:
            marginLeft: "0.04"
            height: "auto"
            width: "0.92"

          children:
            - type: list
              viewTag: upEnvirallTag
              androidGrid: true
              contentType: listObject
              listObject: ..formDataTemp.upEnvirallTemp
              iteratorVar: itemObject
              style:
                width: "0.9"
                margin: "0"
                height: "auto"
              children:
                - type: listItem
                  itemObject:
                  style:
                    width: "0.3"
                    height: "auto"
                    display: "inline-block"
                  children:
                    - type: image
                      style:
                        display: "inline-block"
                        marginTop: "0.02"
                        verticalAlign: middle
                        height: "4.5vw"
                        width: "4.5vw"
                      path:
                        emit:
                          dataKey:
                            var: itemObject
                          actions:
                            - if:
                                - =.builtIn.string.equal:
                                    dataIn:
                                      string1: =..formData.name.data.newDrug.select
                                      string2: $var.value
                                - radioOn.svg
                                - radioGray.svg
                    - type: label
                      dataKey: itemObject.value
                      style:
                        marginLeft: "0.02"
                        display: "inline-block"
                        marginTop: "0.02"
                        height: "auto"
                        verticalAlign: middle
                        fontSize: .Nfont.h14
                        textAlign:
                          x: left
        - type: view
          viewTag: envirallTag
          style:
            display: ..formData.name.data.newDrug.isShow
            width: "0.92"
            marginLeft: "0.04"
            marginTop: "0.022"
            height: "auto"
          children:
            - type: label
              text: 1) Allergy/Irritant
              dataKey:
              style:
                width: "auto"
                height: "auto"
                # display: "inline-block"
                fontColor: "0x333333"
                fontSize: .Nfont.h14
                verticalAlign: "middle"
            - type: label
              text: "No content"
              dataKey: formData.name.data.newDrug.allergy
              style:
                marginTop: "0.01"
                height: "auto"
                width: "0.92"
                boxSizing: border-box
                backgroundColor: "0xf4f4f4"
                padding: "6px 12px"
                border:
                  style: 1
                borderRadius: "4"

                fontSize: .Nfont.h14
                color: "0x333333"
                wordWrap: break-word

            - type: label
              text: 2) What happens?
              dataKey:
              style:
                width: "auto"
                height: "auto"
                # display: "inline-block"
                fontColor: "0x333333"
                fontSize: .Nfont.h14
                marginTop: "0.022"
                verticalAlign: "middle"
            - type: label
              text: "No content"
              dataKey: formData.name.data.newDrug.happens
              style:
                marginTop: "0.01"

                height: "auto"
                width: "0.92"
                boxSizing: border-box
                backgroundColor: "0xf4f4f4"
                padding: "6px 12px"
                border:
                  style: 1
                borderRadius: "4"

                fontSize: .Nfont.h14
                color: "0x333333"
                wordWrap: break-word

        - type: label
          text: 4. Other notes?
          style:
            marginLeft: "0.04"
            marginTop: "0.0185"
            fontWeight: "600"
            width: "0.92"
            height: "auto"
            color: "0x333333"
            fontSize: .Nfont.h14
        - type: label
          text: "No content"
          dataKey: formData.name.data.notes
          style:
            marginTop: "0.01"
            marginLeft: "0.04"

            height: "auto"
            width: "0.92"
            boxSizing: border-box
            backgroundColor: "0xf4f4f4"
            padding: "6px 12px"
            border:
              style: 1
            borderRadius: "4"

            fontSize: .Nfont.h14
            color: "0x333333"
            wordWrap: break-word
        - .DocPublicLine:
        - type: label
          text: Referring Provider
          dataKey:
          style:
            height: "auto"
            width: "auto"
            marginTop: "0.022"
            marginLeft: "0.04"
            fontSize: .Nfont.h16
            fontWeight: "600"
            fontColor: "0x333333"
        - type: label
          text: Who referred you?
          style:
            marginLeft: "0.04"
            marginTop: "0.0185"
            fontWeight: "600"
            width: "0.92"
            height: "auto"
            color: "0x333333"
            fontSize: .Nfont.h14
        - type: view
          style:
            width: "0.92"
            marginLeft: "0.04"
            height: "auto"
          children:
            - type: view
              style:
                marginTop: "0.015"
                width: "0.92"
                height: "auto"
              children:
                - type: label
                  text: Provider's name
                  dataKey:
                  style:
                    width: "0.28"
                    height: "auto"
                    display: "inline-block"
                    fontColor: "0x333333"
                    fontSize: .Nfont.h14
                    verticalAlign: "top"
                - type: label
                  dataKey: formData.name.data.referProvider.name
                  style:
                    display: "inline-block"
                    marginLeft: "0.03"
                    height: "auto"
                    width: "0.6"
                    borderColor: "0xdedede"

                    fontSize: .Nfont.h14
                    verticalAlign: "top"
                    color: "0x333333"
                    fontWeight: "600"
                    wordWrap: break-word
                    textAlign:
                      x: right

        - type: view
          style:
            width: "0.92"
            marginLeft: "0.04"
            height: "auto"
          children:
            - type: view
              style:
                marginTop: "0.015"
                width: "0.92"
                height: "auto"
              children:
                - type: label
                  text: "Facility main #"
                  dataKey:
                  style:
                    width: "0.27"
                    height: "auto"
                    display: "inline-block"
                    fontColor: "0x333333"
                    fontSize: .Nfont.h14
                    verticalAlign: "middle"
                - type: label
                  dataKey: formData.name.data.referProvider.facilityMain
                  style:
                    display: "inline-block"
                    marginLeft: "0.04"
                    height: "auto"
                    width: "0.6"
                    borderColor: "0xdedede"

                    fontSize: .Nfont.h14
                    verticalAlign: "top"
                    color: "0x333333"
                    fontWeight: "600"
                    wordWrap: break-word
                    textAlign:
                      x: right

        - type: view
          style:
            width: "0.92"
            marginLeft: "0.04"
            height: "auto"
          children:
            - type: view
              style:
                marginTop: "0.015"
                width: "0.92"
                height: "auto"
              children:
                - type: label
                  text: "Facility Fax #"
                  dataKey:
                  style:
                    width: "0.27"
                    height: "auto"
                    display: "inline-block"
                    fontColor: "0x333333"
                    fontSize: .Nfont.h14
                    verticalAlign: "middle"
                - type: label
                  dataKey: formData.name.data.referProvider.facilityFax
                  style:
                    display: "inline-block"
                    marginLeft: "0.04"
                    height: "auto"
                    width: "0.6"
                    borderColor: "0xdedede"

                    fontSize: .Nfont.h14
                    verticalAlign: "top"
                    color: "0x333333"
                    fontWeight: "600"
                    wordWrap: break-word
                    textAlign:
                      x: right

        - type: view
          style:
            width: "0.92"
            marginLeft: "0.04"
            height: "auto"
          children:
            - type: view
              style:
                marginTop: "0.015"
                width: "0.92"
                height: "auto"
              children:
                - type: label
                  text: Facility email
                  dataKey:
                  style:
                    width: "0.27"
                    height: "auto"
                    display: "inline-block"
                    fontColor: "0x333333"
                    fontSize: .Nfont.h14
                    verticalAlign: "middle"
                - type: label
                  dataKey: formData.name.data.referProvider.email
                  style:
                    display: "inline-block"
                    marginLeft: "0.04"
                    height: "auto"
                    width: "0.6"
                    borderColor: "0xdedede"

                    fontSize: .Nfont.h14
                    verticalAlign: "top"
                    color: "0x333333"
                    fontWeight: "600"
                    wordWrap: break-word
                    textAlign:
                      x: right

        - type: view
          style:
            width: "0.92"
            marginLeft: "0.04"
            marginTop: "0.015"
            height: "auto"
          children:
            - type: label
              text: Facility Address
              dataKey:
              style:
                width: "auto"
                height: "auto"
                # display: "inline-block"
                fontColor: "0x333333"
                fontSize: .Nfont.h14
            - type: label
              dataKey: formData.name.data.fullAddress
              style:
                marginTop: "0.01"
                height: "auto"
                width: "0.92"
                borderColor: "0xdedede"

                fontSize: .Nfont.h14
                color: "0x333333"
                fontWeight: "600"
                wordWrap: break-word

        - type: view
          style:
            marginTop: "0.03"
    - .HeaderPopUpMenu:
