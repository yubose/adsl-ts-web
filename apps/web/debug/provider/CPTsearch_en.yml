CPTsearch:
  title: CPT Search
  init:
    - .SignInCheck
    - .Global.cptOrMod@: "CPTList"
    - =.builtIn.object.setProperty:
      dataIn:
        obj: =..formDataTemp.titleData
        label: "title"
        text: ..formDataTemp.tab
        arr: ["fontColor", "fontWeight", "borderColor"]
        valueArr: ["0x2988e6", "500", "0x2988e6"]
        errorArr: ["0x333333", "400", "0xdededf"]
    - if:
        - =.builtIn.string.equal:
            dataIn:
              string1: =..formDataTemp.tab
              string2: "CPT"
        - actionType: evalObject
          object:
            # - ..showList@: =..connection.connectionList.doc
            # - ..searchArray@: =..formDataTemp.searchArray.provider
            # - ..localSearchQ@: =..apiRequest.localSearchProvider.connectionList.get
            - ..formDataTemp.providerDisplayView@: "block"
            - ..formDataTemp.facilityDisplayView@: "none"
        - continue
    - if:
        - =.builtIn.string.equal:
            dataIn:
              string1: =..formDataTemp.tab
              string2: "CPTMod"
        - actionType: evalObject
          object:
            # - ..showList@: =..apiRequest.facilityConnections.connectionList.doc
            # - ..searchArray@: =..formDataTemp.searchArray.Facility
            # - ..localSearchQ@: =..apiRequest.localSearchFacility.connectionList.get
            - ..formDataTemp.providerDisplayView@: "none"
            - ..formDataTemp.facilityDisplayView@: "block"
        - continue 



  formData:
    # connectionList: []
    # test: []
    # connection: ""
    # newConnectionLength: ""
    # facililityList: []
    # allProviders: []
    searchContent: ""
    CPTList: [] # will be used across tabs
  
  formDataTemp:
    searchArray: 
      provider: 
        - name.data.phone
        - name.data.fullName
      Facility: 
        - name.data.basicInfo.medicalFacilityName
        - name.data.basicInfo.businessType
        - name.data.basicInfo.phoneNumber
    providerDisplayView: "block"
    facilityDisplayView: "none"
    tab: "CPT"
    searchCancel: "true"
    titleData:
      - title: "CPT"
        fontColor: "0x2988e6"
        borderColor: "0x2988e6"
        fontWeight: "500"
      - title: "CPT Modifier"
        fontColor: "0x333333"
        borderColor: "0xdededf"
        fontWeight: "400"
    newMedicalLength: ""

  components:
    - .BaseHeader:
    - .HeaderLeftButton:
      onClick:
        - goto: MenuBars
    - type: view
      style:
        marginTop: "0.1"
        width: "1"
        height: "0.08"
        backgroundColor: "0x2988e6"
        textAlign:
          y: center
      children:
        - type: view
          style:
            height: "0.042"
            backgroundColor: "0xffffff"
            width: "0.92"
            marginLeft: "0.04"
            boxSizing: border-box
            borderRadius: 5px
          children:                
            - type: image
              path: search.svg
              style:
                height: "0.018"
                marginLeft: "0.021"
                display: inline-block
                verticalAlign: 'middle'
            - type: textField
              viewTag: "searchContentVT"
              dataKey: formData.searchContent
              placeholder: Search Code...
              style:
                height: "0.042"
                fontSize: ".Nfont.h14"
                width: "0.62"
                border: 
                  style: '1'
                marginLeft: "0.023" 
                verticalAlign: 'middle'
                display: inline-block
              onInput: 
                - actionType: evalObject
                  object:
                    - if:
                      - =.builtIn.string.equal:
                          dataIn:
                            string1: =..formData.searchContent
                            string2: ""
                      - ..formDataTemp.searchCancel@: "true"
                      - ..formDataTemp.searchCancel@: "false"
                - actionType: evalObject
                  object:
                    - if:
                      - =.builtIn.string.equal:
                          dataIn:
                            string1: =..formData.searchContent
                            string2: ""
                      - actionType: builtIn
                        funcName: hide
                        viewTag: searchResultVT  
                      - continue 
                    - if:
                      - =.builtIn.string.equal:
                          dataIn:
                            string1: =..formData.searchContent
                            string2: ""
                      - actionType: builtIn
                        funcName: hide
                        viewTag: cptTag  
                      - continue 
                    - if:
                      - =.builtIn.string.equal:
                          dataIn:
                            string1: =..formData.searchContent
                            string2: ""
                      - actionType: builtIn
                        funcName: hide
                        viewTag: cptModTag  
                      - continue 
                    - if:
                      - =.builtIn.string.equal:
                          dataIn:
                            string1: =..formData.searchContent
                            string2: ""
                      - actionType: builtIn
                        funcName: hide
                        viewTag: emptyTag    
                      - continue                                                 
                - actionType: builtIn
                  funcName: redraw
                  viewTag: searchVT
            - type: image
              viewTag: "searchVT"
              path: searchCancel.svg
              style:
                height: "0.018"
                marginLeft: "0.012"
                isHidden: =..formDataTemp.searchCancel
                display: inline-block
                verticalAlign: 'middle'  
              onClick:
                - actionType: evalObject
                  object:
                    - ..formData.searchContent@: ""     
                    - ..formDataTemp.searchCancel@: "true" 
                - actionType: builtIn
                  funcName: hide
                  viewTag: searchResultVT     
                - actionType: builtIn
                  funcName: hide
                  viewTag: cptTag
                - actionType: builtIn
                  funcName: hide
                  viewTag: cptModTag  
                - actionType: builtIn
                  funcName: hide
                  viewTag: emptyTag                                                                    
                - actionType: builtIn
                  funcName: redraw
                  viewTag: searchContentVT   
                - actionType: builtIn
                  funcName: redraw
                  viewTag: searchVT
            - type: label
              text: Search
              style:
                height: auto
                fontSize: ".Nfont.h14"
                width: auto
                color: "0x2988E6"   
                marginLeft: "0.032" 
                verticalAlign: 'middle'
                display: inline-block       
              onClick:
                - actionType: evalObject
                  object:
                    - if:
                      - =.builtIn.string.equal:
                          dataIn:
                            string1: =..formData.searchContent
                            string2: ""
                      - actionType: popUp
                        popUpView: errorVT
                        wait: true 
                      - continue              
                - actionType: popUp
                  popUpView: searchingTag
                - actionType: evalObject
                  object:
                    - =.builtIn.object.CPTsearch:
                        dataIn:
                          input: =..formData.searchContent
                          # hardcode the tab for now will be controlled by user
                          tab: =..formDataTemp.tab
                        dataOut: CPTsearch.formData.CPTList
              
                - actionType: builtIn
                  funcName: show
                  viewTag: searchResultVT
                - actionType: evalObject
                  object:
                    - if: 
                      - =.builtIn.string.equal:
                          dataIn:
                            string1: =..formDataTemp.tab
                            string2: "CPTMod"                  
                      - actionType: builtIn
                        funcName: redraw
                        viewTag: cptModTag
                      - actionType: builtIn
                        funcName: redraw
                        viewTag: cptTag   
                - actionType: evalObject
                  object:
                    - if: 
                      - =.builtIn.string.equal:
                          dataIn:
                            string1: =..formDataTemp.tab
                            string2: "CPTMod"
                      - actionType: builtIn
                        funcName: show
                        viewTag: cptModTag
                      - actionType: builtIn
                        funcName: hide
                        viewTag: cptModTag     
                - actionType: evalObject
                  object:
                    - if: 
                      - =.builtIn.string.equal:
                          dataIn:
                            string1: =..formDataTemp.tab
                            string2: "CPT"
                      - actionType: builtIn
                        funcName: show
                        viewTag: cptTag
                      - actionType: builtIn
                        funcName: hide
                        viewTag: cptTag                                             
                    - if:
                      - =.builtIn.array.judgeListLength:
                          dataIn:
                            array: =.CPTsearch.formData.CPTList
                            len: 0    
                      - actionType: builtIn
                        funcName: show
                        viewTag: emptyTag
                      - actionType: builtIn
                        funcName: hide
                        viewTag: emptyTag
                - actionType: popUpDismiss
                  popUpView: searchingTag 
    - type: view
      style:
        marginTop: "0"
        left: "0"
        width: "1"
        height: "0.82"
      children:
        - type: view
          style:
            marginTop: "0"
            width: "1"
            height: "auto"
            left: "0"
          children:

            # - type: view
            #   style:
            #     width: "1"
            #     height: "0.6"
            #   children:
            #     - type: view
            #       style:
            #         backgroundColor: "#f0f0f0"
            #         width: "1"
            #         overflow: hidden
            #         height: "0.05"
            #       children:
            #         - type: label
            #           text: "Connections"
            #           style:
            #             marginTop: "0"
            #             marginLeft: "0.04"
            #             width: "1"
            #             height: "0.05"
            #             # textIndent: "15px"
            #             fontSize: .Nfont.h3
            #             backgroundColor: "#f0f0f0"
            #             textAlign:
            #               y: center
            #             zIndex: 10
                - type: view
                  style:
                    width: "1"
                    height: "0.6"
                  children:
                    - type: view
                      viewTag: blockMarginTag
                      style:
                        width: "1"
                        height: "0.05"
                        zIndex: "100"
                        backgroundColor: "0xffffff"
                        border:
                          style: 2
                          color: "0xDEDEDF"
                        borderWidth: "1px"
                      children:
                        - type: list
                          viewTag: profileInfoTag
                          contentType: listObject
                          listObject: ..formDataTemp.titleData
                          iteratorVar: itemObject
                          style:
                            width: "1"
                            margin: "0"
                            axis: horizontal
                            height: "0.05"
                            border:
                              style: "2"
                              color: "0xdededf"
                            borderWidth: "2px"
                            zIndex: 100
                          children:
                            - type: listItem
                              itemObject:
                              style:
                                width: '0.45'
                                height: '0.05'
                                marginTop: '0'
                                marginLeft: "0"
                              onClick:
                                - emit:
                                    dataKey:
                                      var: itemObject
                                    actions:
                                      - =.builtIn.object.setProperty:
                                          dataIn:
                                            obj: =..formDataTemp.titleData
                                            label: "title"
                                            text: $var.title
                                            arr:
                                              [
                                                "fontColor",
                                                "fontWeight",
                                                "borderColor",
                                              ]
                                            valueArr:
                                              ["0x2988e6", "500", "0x2988e6"]
                                            errorArr:
                                              ["0x333333", "400", "0xdededf"]
                                      # - if:
                                      #     - =.builtIn.string.equal:
                                      #         dataIn:
                                      #           string1: $var.title
                                      #           string2: "CPT"
                                      #     - ..showList@: =..connection.connectionList.doc
                                      #     - ..showList@: =..apiRequest.facilityConnections.connectionList.doc       
                                      # - if:
                                      #     - =.builtIn.string.equal:
                                      #         dataIn:
                                      #           string1: $var.title
                                      #           string2: "CPT"   
                                      #     - ..searchArray@: =..formDataTemp.searchArray.provider                                             
                                      #     - ..searchArray@: =..formDataTemp.searchArray.Facility
                                      # - if:
                                      #     - =.builtIn.string.equal:
                                      #         dataIn:
                                      #           string1: $var.title
                                      #           string2: "CPT"   
                                      #     - ..localSearchQ@: =..apiRequest.localSearchProvider.connectionList.get                                             
                                      #     - ..localSearchQ@: =..apiRequest.localSearchFacility.connectionList.get
                                      - if:
                                          - =.builtIn.string.equal:
                                              dataIn:
                                                string1: $var.title
                                                string2: "CPT"
                                          - ..formDataTemp.providerDisplayView@: "block"
                                          - continue
                                      - if:
                                          - =.builtIn.string.equal:
                                              dataIn:
                                                string1: $var.title
                                                string2: "CPT"
                                          - ..formDataTemp.facilityDisplayView@: "none"
                                          - continue

                                      - if:
                                          - =.builtIn.string.equal:
                                              dataIn:
                                                string1: $var.title
                                                string2: "CPT Modifier"
                                          - ..formDataTemp.facilityDisplayView@: "block"
                                          - continue

                                      - if:
                                          - =.builtIn.string.equal:
                                              dataIn:
                                                string1: $var.title
                                                string2: "CPT Modifier"
                                          - ..formDataTemp.providerDisplayView@: "none"
                                          - continue
                                      - if:
                                          - =.builtIn.string.equal:
                                              dataIn:
                                                string1: $var.title
                                                string2: "CPT"
                                          - ..formDataTemp.tab@: "CPT"
                                          - continue
                                      - if:
                                          - =.builtIn.string.equal:
                                              dataIn:
                                                string1: $var.title
                                                string2: "CPT Modifier"
                                          - ..formDataTemp.tab@: "CPTMod"
                                          - continue
                                - actionType: builtIn
                                  funcName: redraw
                                  viewTag: profileInfoTag
                                # - actionType: builtIn
                                #   funcName: redraw
                                #   viewTag: listInfoView
                                # - actionType: builtIn
                                #   funcName: redraw
                                #   viewTag: listInfoView1
                              children:
                                - type: label
                                  dataKey: itemObject.title
                                  style:
                                    color: itemObject.fontColor
                                    lineHeight: "6vh"
                                    height: "0.05"
                                    marginLeft: "0.1"
                                    width: "0.3"
                                    fontWeight: itemObject.fontWeight
                                    border:
                                      style: "2"
                                    borderWidth: "2"
                                    borderColor: itemObject.borderColor
                                    display: "inline-block"
                                    textAlign:
                                      x: center
                                    fontSize: .Nfont.n2
    - type: view
      viewTag: searchResultVT
      style: 
        height: "0.82"
        backgroundColor: "0xffffff"
        display: none
        top: "0.18"
        width: "1"
        zIndex: "100"
      children:
        - type: view
          viewTag: emptyTag 
          style:
            margin: "0"
            height: "auto"
            width: "1"
            display: none
          children:
            - type: image
              path: emptyPage.svg
              style:
                width: "0.8"
                marginLeft: "0.1"
                marginTop: "0.15"
            - type: label
              text: "There is no result now."
              style:
                fontSize: .Nfont.n2
                width: "0.9"
                marginTop: "0.03"
                marginLeft: "0.05"
                height: "0.05"
                textAlign:
                  x: center
                  y: center      
        - type: list
          viewTag: cptModTag
          contentType: listObject
          listObject: ..formData.CPTList
          iteratorVar: itemObject
          style:
            width: "1"
            margin: "0"
            left: "0"
            height: "0.82"
            marginTop: "0"
            overflowY: scroll
            overflowX: hidden
          children:
            - type: listItem
              itemObject: ""
              style:
                width: "1"
                height: "auto"
                marginTop: "0"
                overflow: hidden
              onClick:
                - emit:
                    dataKey:
                      var: itemObject
                    actions:
                      - actionType: updateObject
                        dataKey: Global.CPTObject
                        dataObject: {}
                      - .Global.CPTObject@: $var
                - goto: CPTInfo                   
              children:
                - type: view
                  style:
                    marginTop: "0.0198"
                    marginLeft: "0.04" #16.01px
                    height: "0.05"
                    width: "0.92"
                  children:
                    # - type: image
                    #   path: providerImage.svg
                    #   # path=func: .builtIn.utils.prepareDocToPath
                    #   # dataKey: itemObject.name.data.avatar
                    #   style:
                    #     verticalAlign: middle
                    #     display: "inline-block"
                    #     marginLeft: "0.05"
                    #     width: "12vw"
                    #     height: "12vw"
                    - type: view
                      style:
                        verticalAlign: middle
                        display: "inline-block"
                        marginLeft: "0.02"
                        marginRight: "0.02"
                      children:
                        - type: view
                          style:
                            verticalAlign: middle
                            display: "inline-block"
                          children:
                            - type: label
                              dataKey: itemObject.cptCode
                              style:
                                display: "inline-block"
                                verticalAlign: middle
                                width: "auto"
                                height: "auto"
                                fontWidth: "100"
                                fontSize: .Nfont.h3
                                color: "#666666"
                                fontWeight: 700
                            - type: label
                              text: "&nbsp;-&nbsp;"
                              style:
                                display: "inline-block"
                                verticalAlign: middle
                                width: "auto"
                                height: "auto"
                                fontWidth: "100"
                                fontSize: .Nfont.h2
                                color: "0x4b4b4b"
                            - type: label
                              dataKey: itemObject.cptText
                              style:
                                # display: "inline-block"
                                # verticalAlign: middle
                                width: "0.8"
                                height: "auto"
                                fontWidth: "100"
                                fontSize: .Nfont.h2
                                color: "0x4b4b4b"
                                overflow: hidden
                                textOverflow: ellipsis
                                whiteSpace: nowrap
                            - type: image
                              path: "blackRight.svg"
                              style:
                                display: "inline-block"
                                verticalAlign: middle
                                height: "0.015"
                                width: "0.1"
                                axis: horizontol
                                marginLeft: "0.023" 
                        # - type: label
                        #   dataKey: itemObject.tab
                        #   style:
                        #     verticalAlign: middle
                        #     width: "0.7"
                        #     height: "auto"
                        #     fontWidth: "100"
                        #     fontSize: .Nfont.n3
                        #     color: "0x4b4b4b"
              
                    # - emit:
                    #     dataKey:
                    #       var: itemObject
                    #     actions:
                    #       - ..formData.providerId@: $var._source.vid
                    # - actionType: evalObject
                    #   object:
                    #     - ..formData.providerInfo@: ""
                    #     - =..apiRequest.getProviderPublicProfile.docApi.get: ""
                    #     - ..formData.providerInfo@: =..apiRequest.getProviderPublicProfile.resp.doc.0
                    #     # 存的是 profile 35840的信息
                    #     - .Global.temporaryId@: =..formData.providerInfo
                    # - goto: SearchOutProviderInfo
                - type: view
                  style:
                    height: "0.0198" #16.08px
                    width: "1"
                - type: view
                  style:
                    width: "1"
                    height: "1px"
                    background: "0xdededf"    
        - type: list
          viewTag: cptTag
          contentType: listObject
          listObject: ..formData.CPTList
          iteratorVar: itemObject
          style:
            width: "1"
            margin: "0"
            left: "0"
            height: "0.82"
            marginTop: "0"
            overflowY: scroll
            overflowX: hidden
          children:
            - type: listItem
              itemObject: ""
              style:
                width: "1"
                height: "auto"
                marginTop: "0"
                overflow: hidden
              onClick:
                - emit:
                    dataKey:
                      var: itemObject
                    actions:
                      - actionType: updateObject
                        dataKey: Global.CPTObject
                        dataObject: {}
                      - .Global.CPTObject@: $var
                - goto: CPTInfo                  
              children:
                - type: view
                  style:
                    marginTop: "0.0198"
                    marginLeft: "0.04" #16.01px
                    height: "0.05"
                    width: "0.92"
                  children:
                    # - type: image
                    #   path: providerImage.svg
                    #   # path=func: .builtIn.utils.prepareDocToPath
                    #   # dataKey: itemObject.name.data.avatar
                    #   style:
                    #     verticalAlign: middle
                    #     display: "inline-block"
                    #     marginLeft: "0.05"
                    #     width: "12vw"
                    #     height: "12vw"
                    - type: view
                      style:
                        verticalAlign: middle
                        display: "inline-block"
                        marginLeft: "0.02"
                        marginRight: "0.02"
                      children:
                        - type: view
                          style:
                            verticalAlign: middle
                            display: "inline-block"
                          children:
                            - type: label
                              dataKey: itemObject.cptCode
                              style:
                                display: "inline-block"
                                verticalAlign: middle
                                width: "auto"
                                height: "auto"
                                fontWidth: "100"
                                fontSize: .Nfont.h3
                                color: "#666666"
                                fontWeight: 700
                            - type: label
                              text: "&nbsp;-&nbsp;"
                              style:
                                display: "inline-block"
                                verticalAlign: middle
                                width: "auto"
                                height: "auto"
                                fontWidth: "100"
                                fontSize: .Nfont.h2
                                color: "0x4b4b4b"
                            - type: label
                              dataKey: itemObject.cptText
                              style:
                                # display: "inline-block"
                                # verticalAlign: middle
                                width: "0.8"
                                height: "auto"
                                fontWidth: "100"
                                fontSize: .Nfont.h2
                                color: "0x4b4b4b"
                                overflow: hidden
                                textOverflow: ellipsis
                                whiteSpace: nowrap
                            - type: image
                              path: "blackRight.svg"
                              style:
                                display: "inline-block"
                                verticalAlign: middle
                                height: "0.015"
                                width: "0.1"
                                axis: horizontol
                                marginLeft: "0.023" 
                        # - type: label
                        #   dataKey: itemObject.tab
                        #   style:
                        #     verticalAlign: middle
                        #     width: "0.7"
                        #     height: "auto"
                        #     fontWidth: "100"
                        #     fontSize: .Nfont.n3
                        #     color: "0x4b4b4b"
              
                    # - emit:
                    #     dataKey:
                    #       var: itemObject
                    #     actions:
                    #       - ..formData.providerId@: $var._source.vid
                    # - actionType: evalObject
                    #   object:
                    #     - ..formData.providerInfo@: ""
                    #     - =..apiRequest.getProviderPublicProfile.docApi.get: ""
                    #     - ..formData.providerInfo@: =..apiRequest.getProviderPublicProfile.resp.doc.0
                    #     # 存的是 profile 35840的信息
                    #     - .Global.temporaryId@: =..formData.providerInfo
                    # - goto: SearchOutProviderInfo
                - type: view
                  style:
                    height: "0.0198" #16.08px
                    width: "1"
                - type: view
                  style:
                    width: "1"
                    height: "1px"
                    background: "0xdededf"  
    - type: popUp
      viewTag: searchingTag
      style:
        height: "1"
        width: "1"
        zIndex: "10000"
        backgroundColor: "0x33333366"
        top: "0"
      children:
        - type: view
          style:
            backgroundColor: "0xffffff"
            height: "0.2"
            width: "0.6"
            left: "0.2"
            top: "0.3"
            border:
              style: ""
            borderWidth: "1"
            borderColor: ""
            borderRadius: "10"
          children:
            - type: image
              path: zhuanquan.gif
              style:
                width: "0.4"
                left: "0.1"
    - .SoftTips:
      message: You need to write before search next
      style: 
        zIndex: "100"
      viewTag: errorVT
    
    

