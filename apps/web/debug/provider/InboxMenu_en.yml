InboxMenu:
  pageNumber: "100" # xd page 9
  init:
    - .SignInCheck
    - actionType: evalObject
      object:
        .Global._nonce@:
          =.builtIn.math.random: ""
    - =..apiRequest.folder.docAPI.get: ""
    - actionType: evalObject
      object:
        - =.builtIn.object.setObjectKey:
            dataIn:
              objectArr: =..apiRequest.folder.docGetResp.doc
              key: isSelected
              value: false
            dataOut: InboxMenu.apiRequest.folder.docGetResp.doc
  # folderCircle: 1
  formDataTemp:
    generalInfo:
      value: false
  formData:
    folderTitle: ""
    selectFolders: []
    selectFolderDocList: []
  apiRequest:
    folder:
      docDeleteReq:
        id: ""
      docGetResp: ""
      docReCreateReq:
        type: .DocType.MailFolder
        eid: .Global.rootNotebookID
        name:
          data: ""
          title: ""
      docCreateReq:
        type: .DocType.MailFolder
        eid: .Global.rootNotebookID
        name:
          data: ""
          title: ""
      docGetById:
        type: .DocType.MailFolder
        id: ""
        xfname: id
        _nonce: =.Global._nonce
      docGetReq:
        type: .DocType.MailFolder
        id: .Global.rootNotebookID
        sCondition: type & 0xFF08 = 0xD00
        xfname: eid
        obfname: ctime
        _nonce: =.Global._nonce
        asc: true
      docByIdResp: ""
      docAPI:
        restore:
          api: cd
          dataIn: InboxMenu.apiRequest.folder.docReCreateReq
        store:
          api: cd
          dataIn: InboxMenu.apiRequest.folder.docCreateReq
        reget:
          api: rd
          dataIn: InboxMenu.apiRequest.folder.docGetById
          dataOut: InboxMenu.apiRequest.folder.docByIdResp
        get:
          api: rd
          dataIn: InboxMenu.apiRequest.folder.docGetReq
          dataOut: InboxMenu.apiRequest.folder.docGetResp
        delete:
          api: dx
          dataIn: InboxMenu.apiRequest.folder.docDeleteReq
  components:
    - type: view
      style:
        top: "0"
        left: "0"
        width: "1"
        height: "1"
        position: fixed
      children:
        - .IndexMenuBar:
        - type: view
          style:
            top: "0.101"
            height: "0.89"
            width: "1"
          children:
            - .MenubarInbox:
              onClick:
                - goto: InboxDashboard
              style:
                top: "0"
              children:
                - .MenubarInboxImg:
                  path: inbox2.svg
                - .MenubarInboxTitle:
                  text: Inbox
            - .MenubarInbox:
              onClick:
                - goto: Starred
              style:
                top: "0.061"
              children:
                - .MenubarInboxImg:
                  path: star1.svg
                - .MenubarInboxTitle:
                  text: Starred
            - .MenubarInbox:
              onClick:
                - goto: Drafts
              style:
                top: "0.122"
              children:
                - .MenubarInboxImg:
                  path: draftsGreen.svg
                - .MenubarInboxTitle:
                  text: Drafts
            - .MenubarInbox:
              onClick:
                - goto: Sent
              style:
                top: "0.183"
              children:
                - .MenubarInboxImg:
                  path: sent1.svg
                - .MenubarInboxTitle:
                  text: Sent
            - .MenubarInbox:
              onClick:
                - goto: Trash
              style:
                top: "0.244"
              children:
                - .MenubarInboxImg:
                  path: Trash-inbox.svg
                - .MenubarInboxTitle:
                  text: Trash
            - .MenubarInbox:
              style:
                top: "0.305"
              onClick:
                - actionType: popUp
                  popUpView: feedbackView
              children:
                - .MenubarInboxImg:
                  path: folder.svg
                - .MenubarInboxTitle:
                  text: Virtual Folder
            - type: view
              onClick:
                - actionType: evalObject
                  object:
                    .Global._nonce@:
                      =.builtIn.math.random: ""
                - actionType: evalObject
                  object:
                    - actionType: popUp
                      popUpView: addfolder
              style:
                top: "0.305"
                height: "0.06"
                width: "0.08"
                left: "0.83"
                textAlign:
                  x: "center"
                  y: center
              children:
                - type: image
                  path: addBlue.svg
                  style:
                    zIndex: 10
                    height: "0.02"
                    # top: "0.327"

            - type: view
              style:
                top: "0.385"
                height: "0.435"
                width: "1"
              children:
                - type: view
                  style:
                    width: "1"
                    margin: "0"
                    height: "0.435"
                    overflow: scroll
                  children:
                    - type: list
                      viewTag: listView
                      contentType: listObject
                      listObject: ..apiRequest.folder.docGetResp.doc
                      iteratorVar: itemObject
                      style:
                        width: "1"
                        margin: "0"
                        height: "0.435"
                      children:
                        - type: listItem
                          itemObject:
                          style:
                            width: "1"
                            height: "0.06"
                            # textAlign:
                            #   y: center
                          children:
                            - type: image
                              path: folderShow.svg
                              style:
                                top: "0.017"
                                left: "20vw"
                                height: "0.026"
                            - type: label
                              dataKey: itemObject.name.title
                              style:
                                height: "0.06"
                                color: "0x8d8d8d"
                                fontSize: "4vw"
                                top: "0.4vw"
                                left: "27vw"
                                width: "0.55"
                                textAlign:
                                  y: center
                              onClick:
                                - emit:
                                    dataKey:
                                      var: itemObject
                                    actions:
                                      - .Global.formData.folder@: $var
                                - goto: FolderPage
                            - type: image
                              viewTag: listImageView
                              path:
                                emit:
                                  dataKey:
                                    var: itemObject
                                  actions:
                                    - if:
                                        - =.builtIn.string.equal:
                                            dataIn:
                                              string1: =..formDataTemp.generalInfo.value
                                              string2: $var.isSelected
                                        - folderCircle.svg
                                        - folderCircleTrue.svg
                              onClick:
                                - actionType: evalObject
                                  object:
                                    .Global._nonce@:
                                      =.builtIn.math.random: ""
                                - emit:
                                    dataKey:
                                      var: itemObject
                                    actions:
                                      # - ..apiRequest.folder.docCreateReq@: $var
                                      - if:
                                          - =.builtIn.string.equal:
                                              dataIn:
                                                string1: =..formDataTemp.generalInfo.value
                                                string2: $var.isSelected
                                          - =.builtIn.object.set:
                                              dataIn:
                                                object: $var
                                                key: isSelected
                                                value: true
                                          - =.builtIn.object.set:
                                              dataIn:
                                                object: $var
                                                key: isSelected
                                                value: false
                                      - if:
                                          - =.builtIn.string.equal:
                                              dataIn:
                                                string1: =..formDataTemp.generalInfo.value
                                                string2: $var.isSelected
                                          - =.builtIn.array.removeByValue:
                                              dataIn:
                                                object: =..formData.selectFolders
                                                value: $var.id
                                          - =.builtIn.array.push:
                                              dataIn:
                                                messages: =..formData.selectFolders
                                                newMessage: $var.id

                                      - if:
                                          - =.builtIn.string.equal:
                                              dataIn:
                                                string1: =..formDataTemp.generalInfo.value
                                                string2: $var.isSelected
                                          - =.builtIn.array.removeObjectByValue:
                                              dataIn:
                                                object: =..formData.selectFolderDocList
                                                values: "id"
                                                value: $var.id
                                          - =.builtIn.array.push:
                                              dataIn:
                                                messages: =..formData.selectFolderDocList
                                                newMessage: $var
                                      - ..apiRequest.folder.docCreateReq@: $var
                                - actionType: evalObject
                                  object:
                                    - if:
                                        - =.builtIn.array.isArrayEmpty:
                                            dataIn:
                                              array: =..formData.selectFolders
                                        - actionType: builtIn
                                          funcName: hide
                                          viewTag: selectFolder
                                        - actionType: builtIn
                                          funcName: show
                                          viewTag: selectFolder
                                - actionType: builtIn
                                  funcName: redraw
                                  viewTag: listView
                              style:
                                top: "4.8vw"
                                left: "83vw"
                                width: "4vw"
        - type: view
          viewTag: selectFolder
          style:
            isHidden: true
            height: "0.1"
            top: "0.9"
            width: "1"
            border:
              style: "3"
              width: "1"
              color: "0xf0f0f0"
          children:
            - type: image
              path: trash.svg
              style:
                left: "0.13"
                width: "0.25"
                top: "0.02"
              onClick:
                - actionType: popUp
                  popUpView:
                    deleteFolderPopUpView
                    # - actionType: evalObject
                    #   object:
                    #     - ..apiRequest.folder.docDeleteReq.id@: =..formData.selectFolders
                    #     - =..apiRequest.folder.docAPI.delete: ""
                    # - actionType: evalObject
                    #   object:
                    #     - ..formData.selectFolders@: []
                    #     - =..apiRequest.folder.docAPI.get: ""
                    # - actionType: evalObject
                    #   object:
                    #     - =.builtIn.object.setObjectKey:
                    #         dataIn:
                    #           objectArr: =..apiRequest.folder.docGetResp.doc
                    #           key: isSelected
                    #           value: false
                    #         dataOut: InboxMenu.apiRequest.folder.docGetResp.doc
                    # - actionType: builtIn
                    #   funcName: redraw
                    #   viewTag: listView
                    # - actionType: popUp
                    #   popUpView: delefolder
            - type: image
              path: edit.svg
              style:
                left: "0.62"
                width: "0.25"
                top: "0.02"
              onClick:
                - actionType: evalObject
                  object:
                    - if:
                        - =.builtIn.array.judgeListLength:
                            dataIn:
                              array: =..formData.selectFolders
                              len: 1
                        - actionType: evalObject
                          object:
                            - ..apiRequest.folder.docGetById.id@: =..formData.selectFolders.0
                            - =..apiRequest.folder.docAPI.reget: ""
                            - ..formData.folderTitle@: =..apiRequest.folder.docByIdResp.doc.0.name.title
                            - ..apiRequest.folder.docCreateReq@: =..apiRequest.folder.docByIdResp.doc.0
                        - actionType: popUp
                          popUpView: editfolderErrorPopUp
                          wait: true
                - actionType: builtIn
                  funcName: redraw
                  viewTag: EditTag
                - actionType: popUp
                  popUpView: editfolder
    - type: popUp
      viewTag: addfolder
      style:
        left: "0"
        width: "1"
        top: "0"
        height: "1"
        backgroundColor: "0x00000033"
        zIndex: "1000"
      children:
        - type: view
          style:
            left: "0.15"
            width: "0.7"
            top: "0.32"
            height: "0.18"
            backgroundColor: "0xe5e5e5"
            border:
              style: "5"
            borderWidth: "1"
            borderRadius: "10"
          children:
            - type: label
              text: Add New Folder
              style:
                left: "0.1"
                width: "0.5"
                top: "0.01"
                height: "0.06"
                fontSize: .Nfont.h2
                color: "0x4b4b4b"
                backgroundColor: "0xe5e5e5"
                borderWidth: "1"
                borderColor: "0x3f3f3f66"
                textAlign:
                  x: center
                  y: center
            - type: textField
              viewTag: "AddTag"
              placeholder: Enter name here
              dataKey: apiRequest.folder.docReCreateReq.name.title
              style:
                left: "0.04"
                top: "0.07"
                width: "0.62"
                border:
                  style: "3"
                borderWidth: "1"
                borderColor: "0xc4c4c6"
                height: "0.03"
                backgroundColor: "0xffffff"
                textAlign:
                  x: left
                  y: center
            - type: view
              style:
                left: "0"
                top: "0.128"
                width: "0.7"
                height: "0.001"
                backgroundColor: "0x999999"
                margin: "0"
            - type: view
              style:
                left: "0.35"
                top: "0.128"
                width: "0.002"
                height: "0.052"
                backgroundColor: "0x999999"
                margin: "0"
            - type: label
              text: Cancel
              style:
                left: "0.01"
                width: "0.33"
                top: "0.13"
                height: "0.045"
                fontSize: .Nfont.h2
                backgroundColor: "0xe5e5e5"
                border:
                  style: "1"
                color: "0x007aff"
                textAlign:
                  x: center
                  y: center
              onClick:
                - actionType: evalObject
                  object:
                    - ..apiRequest.folder.docReCreateReq.name.title@: ""
                - actionType: builtIn
                  funcName: redraw
                  viewTag: addfolder
                - actionType: popUpDismiss
                  popUpView: addfolder
            - type: label
              text: Ok
              style:
                left: "0.36"
                width: "0.33"
                top: "0.13"
                height: "0.045"
                fontSize: .Nfont.h2
                backgroundColor: "0xe5e5e5"
                border:
                  style: "1"
                color: "0x007aff"
                textAlign:
                  x: center
                  y: center
              onClick:
                - actionType: evalObject
                  object:
                    .Global._nonce@:
                      =.builtIn.math.random: ""
                - actionType: evalObject
                  object:
                    - if:
                        - =.builtIn.string.equal:
                            dataIn:
                              string1: =..apiRequest.folder.docReCreateReq.name.title
                              string2: ""
                        - actionType: popUp
                          popUpView: folderEmptyPopUp
                          wait: true
                        - continue
                - actionType: evalObject
                  object:
                    - if:
                        - =.builtIn.array.checkElememtExist:
                            dataIn:
                              objArr: =..apiRequest.folder.docGetResp.doc
                              values: =..apiRequest.folder.docReCreateReq.name.title
                        - actionType: evalObject
                          object:
                            - ..apiRequest.folder.docReCreateReq.name.title@: ""
                            - actionType: popUp
                              popUpView: folderUniqueErrorPopUp
                        - actionType: evalObject
                          object:
                            - =..apiRequest.folder.docAPI.restore: ""
                            - ..apiRequest.folder.docReCreateReq.name.title@: ""
                            - ..formData.selectFolders@: []
                            - =..apiRequest.folder.docAPI.get: ""
                            - =.builtIn.object.setObjectKey:
                                dataIn:
                                  objectArr: =..apiRequest.folder.docGetResp.doc
                                  key: isSelected
                                  value: false
                                dataOut: InboxMenu.apiRequest.folder.docGetResp.doc
                - actionType: builtIn
                  funcName: redraw
                  viewTag: listView
                - actionType: popUpDismiss
                  popUpView: addfolder
                - actionType: builtIn
                  funcName: hide
                  viewTag: selectFolder
                - actionType: builtIn
                  funcName: redraw
                  viewTag: AddTag

    - type: popUp
      viewTag: editfolder
      style:
        left: "0"
        width: "1"
        top: "0"
        height: "1"
        backgroundColor: "0x00000033"
        zIndex: "1000"
      children:
        - type: view
          style:
            left: "0.15"
            width: "0.7"
            top: "0.32"
            height: "0.18"
            backgroundColor: "0xe5e5e5"
            border:
              style: "5"
            borderWidth: "1"
            borderRadius: "10"
          children:
            - type: label
              text: Folder Name
              style:
                left: "0.1"
                width: "0.5"
                top: "0.01"
                height: "0.06"
                fontSize: .Nfont.h2
                color: "0x4b4b4b"
                backgroundColor: "0xe5e5e5"
                borderWidth: "1"
                borderColor: "0x3f3f3f66"
                textAlign:
                  x: center
                  y: center
            - type: textField
              viewTag: "EditTag"
              dataKey: formData.folderTitle
              style:
                left: "0.04"
                top: "0.07"
                width: "0.62"
                border:
                  style: "3"
                borderWidth: "1"
                borderColor: "0xc4c4c6"
                height: "0.03"
                backgroundColor: "0xffffff"
                textAlign:
                  x: left
                  y: center
            - type: view
              style:
                left: "0"
                top: "0.128"
                width: "0.7"
                height: "0.001"
                backgroundColor: "0x999999"
                margin: "0"
            - type: view
              style:
                left: "0.35"
                top: "0.128"
                width: "0.002"
                height: "0.052"
                backgroundColor: "0x999999"
                margin: "0"
            - type: label
              text: Cancel
              style:
                left: "0.01"
                width: "0.33"
                top: "0.13"
                height: "0.045"
                fontSize: .Nfont.h2
                backgroundColor: "0xe5e5e5"
                border:
                  style: "1"
                color: "0x007aff"
                textAlign:
                  x: center
                  y: center
              onClick:
                - actionType: popUpDismiss
                  popUpView: editfolder
            - type: label
              text: Ok
              style:
                left: "0.36"
                width: "0.33"
                top: "0.13"
                height: "0.045"
                fontSize: .Nfont.h2
                backgroundColor: "0xe5e5e5"
                border:
                  style: "1"
                color: "0x007aff"
                textAlign:
                  x: center
                  y: center
              onClick:
                - actionType: evalObject
                  object:
                    - if:
                        - =.builtIn.array.checkElememtExist:
                            dataIn:
                              objArr: =..apiRequest.folder.docGetResp.doc
                              values: =..formData.folderTitle
                        - actionType: evalObject
                          object:
                            - actionType: popUp
                              popUpView: folderUniqueErrorPopUp
                              wait: true
                        - continue
                - actionType: evalObject
                  object:
                    - ..apiRequest.folder.docCreateReq.name.title@: =..formData.folderTitle
                    - =..apiRequest.folder.docAPI.store: ""
                - actionType: evalObject
                  object:
                    .Global._nonce@:
                      =.builtIn.math.random: ""
                - actionType: evalObject
                  object:
                    - ..formData.selectFolders@: []
                    - ..formData.selectFolderDocList@: []
                    - =..apiRequest.folder.docAPI.get: ""
                - actionType: evalObject
                  object:
                    - =.builtIn.object.setObjectKey:
                        dataIn:
                          objectArr: =..apiRequest.folder.docGetResp.doc
                          key: isSelected
                          value: false
                        dataOut: InboxMenu.apiRequest.folder.docGetResp.doc
                    - ..apiRequest.folder.docCreateReq.name.title@: ""
                - actionType: builtIn
                  funcName: redraw
                  viewTag: listView
                - actionType: popUpDismiss
                  popUpView: editfolder
                - actionType: builtIn
                  funcName: redraw
                  viewTag: EditTag
                - actionType: builtIn
                  funcName: hide
                  viewTag: selectFolder
    - .BaseMessageWarnPopup:
      message: The folder name is duplicate or empty
      viewTag: folderUniqueErrorPopUp
    - .BaseMessageWarnPopup:
      message: Please select an edit object
      viewTag: editfolderErrorPopUp
    - .BaseMessageWarnPopup:
      message: The folder name is empty and cannot be added
      viewTag: folderEmptyPopUp
    - .BaseMessageWarnPopup:
      viewTag: delefolder
      message: Delete Successful!
      imagePath: deleteTrue.svg
    - .ConfirmWarningPopup:
      viewTag: deleteFolderPopUpView
      message: All the message will move to the trash in this folder
      children:
        - .ConfirmWarningPopupView:
          children:
            - .ConfirmWarningPopupHeader:
            - .ConfirmWarningPopupMessage:
            - .ConfirmWarningPopupSplit1:
            - .ConfirmWarningPopupSplit2:
            - .ConfirmWarningPopupLeftButton:
              onClick:
                - actionType: popUpDismiss
                  popUpView: deleteFolderPopUpView
                - actionType: builtIn
                  funcName: show
                  viewTag: selectFolder
            - .ConfirmWarningPopupRightButton:
              onClick:
                - actionType: evalObject
                  object:
                    - =.builtIn.ecos.updateDocListType:
                        dataIn:
                          sourceDocList: =..formData.selectFolderDocList
                          targetBit: 4
                          targetValue: 1
                    - ..apiRequest.folder.docGetResp.doc@: []
                    - =..apiRequest.folder.docAPI.get: ""
                - actionType: evalObject
                  object:
                    - =.builtIn.object.setObjectKey:
                        dataIn:
                          objectArr: =..apiRequest.folder.docGetResp.doc
                          key: isSelected
                          value: false
                        dataOut: InboxMenu.apiRequest.folder.docGetResp.doc
                    - ..apiRequest.folder.docReCreateReq.name.title@: ""
                    - ..formData.selectFolders@: []
                    - ..formData.selectFolderDocList@: []
                - actionType: popUpDismiss
                  popUpView: deleteFolderPopUpView
                - actionType: builtIn
                  funcName: hide
                  viewTag: selectFolder
                - actionType: builtIn
                  funcName: redraw
                  viewTag: listView
                - actionType: popUp
                  popUpView: delefolder
