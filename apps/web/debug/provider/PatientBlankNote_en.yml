PatientBlankNote:
  title: Patient Note
  init:
    - .SignInCheck
    - if:
        - =.Global.Note.id
        - actionType: evalObject
          object:
            ..newNote.document.name@: =.Global.Note.name
        - continue
  save:
    - =.PatientBlankNote.newNote.docAPI.store: ""
  delete:
    - =.PatientBlankNote.newNote.docAPI.delete: ""
  newSign:
    docRes: ""
    document: #DOC
      .Document: ""
      type: .DocType.DocumentSignature
      name:
        title: ""
        type: ..newSign.document.subtype.mediaType
        data: ""
      eid: .Global.rootNotebookID
      fid: ""
      subtype:
        mediaType: "" # mediaType : "image/jpeg"
    docAPI: # DOCAPI
      .DocAPI: ""
      store:
        api: cd
        dataIn: newSign.document
        dataOut: PatientBlankNote.newSign.docRes
  newNote:
    response: ""
    document:
      .Global.Note: ""
    docAPI:
      .DocAPI: ""
      store:
        api: cd
        dataIn: newNote.document
        dataOut: newNote.response
        subtype:
          mediaType: "text/plain" # mediaType : "image/jpeg"
      delete:
        api: dx
        dataIn: PatientBlankNote.newNote.document
  components:
    - .BaseHeader:
    - .HeaderLeftButton:
      children:
        - type: image
          path: whiteLeft.svg
          style:
            left: "0.02"
            top: "0.04"
            height: "0.02"
            zIndex: 100
        - type: label
          text: Back
          style:
            left: "0.07"
            top: "0.04"
            height: "0.02"
            zIndex: 100
            fontSize: "15"
            color: "0xffffffff"
            textAlign:
              x: left
    - type: scrollView
      style:
        width: "1"
        height: "0.9"
        top: "0.1"
        left: "0"
        overflow: "scroll"
      children:
        - type: view
          style:
            height: "auto"
            width: "1"
            left: "0"
            top: "0"
            #backgroundColor: "0x1aa15f"
          children:
            - type: label
              text: Patient notes
              style:
                left: "0"
                top: "0.01"
                width: "1"
                height: "0.04"
                fontSize: "17"
                textAlign:
                  x: center
            - type: label
              text: "*"
              style:
                left: "0.7"
                top: "0.005"
                width: "0.1"
                height: "0.02"
                fontSize: "17"
                color: "0xd53c42"
            - type: textField
              placeholder: ""
              isEditable: "false"
              dataKey: newNote.document.name.title
              style:
                left: "0.15"
                top: "0.05"
                width: "0.7"
                height: "0.04"
                border:
                  style: "2"
                borderWidth: "1"
                borderColor: "0x000000"
                fontSize: "19"
                textAlign:
                  x: center
            - type: textView
              isEditable: "false"
              placeholder: "Hello this meeting"
              dataKey: newNote.document.name.data.note
              style:
                left: "0.1"
                top: "0.12"
                width: "0.8"
                height: "0.61"
                fontSize: .Nfont.h12
                textIndent: "10px"
                fontFamily: sans-serif
                border:
                  style: "3"
                  width: "1"
                borderColor: "0x787878"
                textAlign:
                  y: top
            - type: view
              style:
                top: "0.75"
                left: "0"
                width: "1"
                height: "0.2"
              children:
                - type: label
                  text: "Signature:"
                  style:
                    left: "0.133"
                    top: "0"
                    width: "0.43"
                    fontSize: .Nfont.h14
                    height: auto
                    color: "0x000000"
                    textAlign:
                      y: center
                - type: view
                  style:
                    width: "0.7"
                    height: "0.12"
                    border:
                      style: "4"
                      width: "1.5"
                      color: "0xacacac"
                    left: "0.15"
                    top: "0.05"
                  children:
                    # 显示暂存的签名
                    - type: image
                      viewTag: signatureShowTag
                      path=func: =.builtIn.utils.prepareDocToPath
                      # 传入签名文档的id
                      dataKey: newNote.document.name.data.signatureId
                      style:
                        # 控制显示
                        display: "block"
                        left: "0"
                        width: "0.7"
                        top: "0"
                        height: "0.12"
                        overflow: scroll
    - type: popUp
      viewTag: noSign
      style:
        left: "0"
        width: "1"
        height: "1"
        top: "0"
        backgroundColor: "0x00000033"
        zIndex: "10"
      children:
        - type: view
          style:
            width: "0.76"
            height: "0.2"
            top: "0.4"
            left: "0.12"
            zIndex: "100"
            backgroundColor: "0xe9e9e9"
            borderRadius: "7"
          children:
            - type: label
              text: You have to sign
              style:
                left: "0.15"
                top: "0.04"
                width: "0.6"
                height: "0.07"
                fontSize: "20"
                fontWeight: "500"
            - type: button
              text: back
              onClick:
                - actionType: popUpDismiss
                  popUpView: noSign
              style:
                top: "0.15"
                left: "0.25"
                width: "0.25"
                height: "0.03"
