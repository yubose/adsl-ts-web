DocumentPrivate:
  title: Add Documents
  pageNumber:
  init:
    - .SignInCheck
    - =.builtIn.date.currentDateTime:
        dataIn:
        dataOut: Global.formData.auditLog.startTime
    - if:
        - =.Global.Note.id
        - actionType: evalObject
          object:
            - ..apiRequest.medicalRecord.docReq@: =.Global.Note
            - ..formData.fileType@: =..apiRequest.medicalRecord.docReq.name.data.fileType
            - ..formData.fileId@: =..apiRequest.medicalRecord.docReq.name.data.fileId
        - continue
    # 判断是否上传文件
    - if:
        - =.builtIn.string.equal:
            dataIn:
              string1: =..formData.fileId
              string2: ""
        - actionType: evalObject
          object:
            - ..formData.uplodImg@: "block"
            - ..formData.showFile@: "none"
        # 判断是否是图片文件
        - actionType: evalObject
          object:
            - if:
                - =.builtIn.array.has:
                    dataIn:
                      object: =..formDataTemp.imgTypeList
                      value: =..apiRequest.medicalRecord.docReq.name.data.fileType
                - actionType: evalObject
                  object:
                    - ..formData.fileId@: =..apiRequest.medicalRecord.docReq.name.data.fileId
                    - ..formData.uplodImg@: "none"
                    - ..formData.showImg@: "block"
                - actionType: evalObject
                  object:
                    - ..formData.uplodImg@: "none"
                    - ..formData.showFile@: "block"

  formData:
    flag: ""
    fileId: ""
    # 上传显示
    uplodImg: "block"
    # 图片显示
    showImg: "none"
    # 非图片文件显示
    showFile: "none"
    # 获取上传文件后缀名
    fileType: ""
  formDataTemp:
    # 允许上传文件类型
    fileTypeList:
      [
        "jpeg",
        "jpg",
        "png",
        "pdf",
        "xlsx",
        "xls",
        "pptx",
        "ppt",
        "docx",
        "doc",
        "numbers",
        "pages",
        "htm",
        "html",
      ]
    # 图片上传类型
    imgTypeList: ["jpeg", "jpg", "png", "pdf"]
    # doc
    docTypeList: ["docx", "doc", "pages"]
    # xls
    xlsTypeList: ["xlsx", "xls", "numbers"]
    # ppt
    pptTypeList: ["pptx", "ppt"]
    # htm
    htmTypeList: ["htm", "html"]
  apiRequest: #Input data request here
    medicalRecord:
      deleteInfo:
        id:
          - =..apiRequest.medicalRecord.docResp.doc.id
      docResp: ""
      docReq:
        eid: .Global.currentRoom.edge.id
        reid: ""
        subtype:
          isEncrypted: "0"
          isOnServer: "0"
          applicationDataType: "1"
        type: .DocType.MedicalUpload
        name:
          data:
            # 文件id
            fileId: ""
            # 上传文件名
            fileName: ""
            # 上传文件大小
            fileSize: ""
            # 上传文件类型
            fileType: ""
            classTag:
              name: Provider
              fontColor: "0x30b354"
              backgroundColor: "0xe4f5e9"
              display: block
            statusTag:
              name: Private
              fontColor: "0x4c5264"
              backgroundColor: "0xececee"
              display: block
          type: "application/json"
          title: ""
          user: .Global.formData.providerTitle
          uploadUserName: .Global.MyProfile.name.data.fullName
      docAPI:
        .DocAPI: ""
        store:
          api: cd
          dataIn: apiRequest.medicalRecord.docReq
          dataOut: apiRequest.medicalRecord.docResp
          subtype:
            mediaType: "application/json" # mediaType : "image/jpeg"
        delet:
          api: dx
          dataIn: apiRequest.medicalRecord.deleteInfo
    uplaodDoc:
      docResp: ""
      deleteInfo:
        id:
          - =..apiRequest.uplaodDoc.docResp.doc.id
      docReq:
        subtype:
          isEncrypted: "0"
          isOnServer: "0"
        type: .DocType.UploadFile
        name:
          type: ..apiRequest.uplaodDoc.docAPI.store.subtype.mediaType
          data: binFile
        deat:
          sig: ""
          url: ""
        eid: .Global.currentRoom.edge.id
        reid: ""
      docAPI:
        .DocAPI: ""
        delet:
          api: dx
          dataIn: apiRequest.uplaodDoc.deleteInfo
        store:
          api: cd
          subtype:
            mediaType: ""
          dataIn: apiRequest.uplaodDoc.docReq
          dataOut: apiRequest.uplaodDoc.docResp

  components:
    - .BasePublicHeader:
        children:
          - .BasePublicHeaderLeft:
          - .BasePublicHeaderTitle:
    - type: scrollView
      style:
        ..style.scrollBox:
      children:
        - type: label
          textBoard:
            - text: "Create Document Name &nbsp;"
            - text: "*"
              color: "#f94f50"
          style:
            ..style.titleLabel:
        - type: textField
          placeholder: Enter here
          dataKey: apiRequest.medicalRecord.docReq.name.title
          style:
            ..style.inputBox:
        - type: label
          textBoard:
            - text: "Upload Your Document &nbsp;"
            - text: "*"
              color: "#f94f50"
          style:
            ..style.titleLabel:
        - type: view
          viewTag: uplodImgTag
          style:
            display: ..formData.uplodImg
          children:
            # upload 区域
            - type: image
              path: uploadIcon.svg
              style:
                ..style.uploadImg:
              onClick:
                - ..event.uploadClick
            - type: label
              textBoard:
                - text: "1."
                - text: "Only the following file types are supported:"
              style:
                ..style.tipsLabel:
            - type: label
              text: "jpeg, jpg, png, pdf, xlsx, xls, pptx, ppt, docx, doc, numbers, pages, htm"
              dataKey:
              style:
                ..style.tipsSecondLabel:
            - type: label
              textBoard:
                - text: "2."
                - text: "File size must be no larger than 5M"
              style:
                ..style.tipsLabel:

        - type: scrollView
          viewTag: showImgTag
          style:
            marginTop: "0.013546"
          children:
            - type: view
              style:
                display: ..formData.showImg
                height: "0.57"
              children:
                - type: image
                  path: null.png
                  viewTag: showFileTag
                  path=func: .builtIn.utils.prepareDocToPath
                  dataKey: DocumentPrivate.formData.fileId
                  style:
                    ..style.imgShow:
                - type: image
                  path: greyDelete.svg
                  style:
                    ..style.deleteImg:
                  onClick:
                    - ..event.deleteClick
            - type: view
              style:
                ..style.otherFileBox:
                display: ..formData.showFile
              children:
                - type: image
                  path:
                    ..event.iconPath:
                  style:
                    ..style.fileIcon:
                - type: view
                  style:
                    ..style.contentBox:
                  children:
                    - type: label
                      dataKey: apiRequest.medicalRecord.docReq.name.data.fileName
                      style:
                        ..style.fileTitle:
                    - type: label
                      text=func: .builtIn.string.bitFormatting
                      dataKey: apiRequest.medicalRecord.docReq.name.data.fileSize
                      style:
                        ..style.fileSize:
            - type: image
              path: greyDelete.svg
              style:
                ..style.deleteImg:
                display: ..formData.showFile
              onClick:
                - ..event.deleteClick
    - type: view
      style:
        ..style.btnBox:
      children:
        - type: view
          style:
            width: auto
          children:
            - .DocButtonPrivate:
              onClick:
                - ..event.privateClick
            - .DocButtonRelease:
              onClick:
                - ..event.releaseClick

    # 弹窗区域
    # Invalid 提示
    - .SoftTips:
      message: "Invalid format"
      viewTag: invalidTag

    # 必填项弹窗
    - .BaseWarningView:
      message: "Please complete required fields"
      viewTag: requiredTag

    # 超出上传显示提示
    - .SoftTips:
      message: "The uploaded file size should not exceed 5M"
      viewTag: exceedTag

    # 删除成功提示
    - .SuccessfulOneLine:
      message: "Delete Successfully!"
      viewTag: deleteSuccessTag

    # 上传成功提示
    - .SuccessfulOneLine:
      message: "Successfully!"
      viewTag: successTag

    # 删除对话弹窗
    - .publicDeleteUP:
      viewTag: BaseDelWarningView
      message: "Delete this file?"
      leftButton:
        - actionType: popUpDismiss
          popUpView: BaseDelWarningView
      rightButton:
        - actionType: evalObject
          object:
            - ..formData.fileId@: ""
            # 判断是否是图片文件
            - if:
                - =.builtIn.array.has:
                    dataIn:
                      object: =..formDataTemp.imgTypeList
                      value: =..formData.fileType
                - actionType: evalObject
                  object:
                    - ..formData.uplodImg@: "block"
                    - ..formData.showImg@: "none"
                - actionType: evalObject
                  object:
                    - ..formData.uplodImg@: "block"
                    - ..formData.showFile@: "none"
        - actionType: popUp
          popUpView: deleteSuccessTag
          popUpDismiss: 2000
        - actionType: builtIn
          funcName: redraw
          viewTag: showFileTag
        - actionType: builtIn
          funcName: redraw
          viewTag: showImgTag
        - actionType: builtIn
          funcName: redraw
          viewTag: uplodImgTag
        - actionType: popUpDismiss
          popUpView: BaseDelWarningView

    - .Normal:
      message: "Do you want the patient to see it?"
      viewTag: dialogueTag
      leftText: "No"
      rightText: "Yes"
      leftButton:
        - actionType: evalObject
          object:
            # 修改tage
            - ..apiRequest.medicalRecord.docReq.tage@: 1
            - =.DocumentPrivate.apiRequest.medicalRecord.docAPI.store: ""
            - =.builtIn.array.add:
                dataIn:
                  object: =.Global.currentMeetingDoc
                  value: =..apiRequest.medicalRecord.docResp.doc
        - actionType: evalObject
          object:
            .Global._nonce@:
              =.builtIn.math.random: ""

        - actionType: popUpDismiss
          popUpView: dialogueTag

        - actionType: popUp
          popUpView: successTag

        - actionType: evalObject
          object:
            - if:
                - =.builtIn.string.equal:
                    dataIn:
                      string1: =.Global.formData.unPageName
                      string2: ""
                - goto: ProviderNotes
                - goto: =.Global.formData.unPageName
      rightButton:
        # 更新文档状态
        - actionType: evalObject
          object:
            - ..apiRequest.medicalRecord.docReq.name.data.statusTag.name@: Released
            - ..apiRequest.medicalRecord.docReq.name.data.statusTag.fontColor@: "0x2988e6"
            - ..apiRequest.medicalRecord.docReq.name.data.statusTag.backgroundColor@: "0xdfedfc"

        - actionType: evalObject
          object:
            # 修改tage
            - ..apiRequest.medicalRecord.docReq.tage@: -1
            - =.DocumentPrivate.apiRequest.medicalRecord.docAPI.store: ""
            - =.builtIn.array.add:
                dataIn:
                  object: =.Global.currentMeetingDoc
                  value: =..apiRequest.medicalRecord.docResp.doc
        - actionType: evalObject
          object:
            .Global._nonce@:
              =.builtIn.math.random: ""

        - actionType: popUpDismiss
          popUpView: dialogueTag

        - actionType: popUp
          popUpView: successTag

        - actionType: evalObject
          object:
            - if:
                - =.builtIn.string.equal:
                    dataIn:
                      string1: =.Global.formData.unPageName
                      string2: ""
                - goto: ProviderNotes
                - goto: =.Global.formData.unPageName

    - type: popUp
      viewTag: selectView
      choice1Text: "Camera"
      choice2Text: "Photo Library"
      choice3Text: "Files"
      lastChoiceText: "Cancel"
      choice1Button:
        - actionType: popUpDismiss
          popUpView: selectView
        - actionType: openCamera
          dataObject: BLOB
          fileType: DocumentPrivate.formData.fileType
          dataKey: DocumentPrivate.apiRequest.uplaodDoc.docReq.name.data
        # 判断是否满足上传文件格式
        - actionType: evalObject
          object:
            - if:
                - =.builtIn.array.has:
                    dataIn:
                      object: =..formDataTemp.fileTypeList
                      value: =..formData.fileType
                - continue
                - actionType: popUp
                  popUpView: invalidTag
                  wait: true
                  popUpDismiss: 2000

        # 获取上传文件大小
        - actionType: evalObject
          object:
            - if:
                - =.builtIn.math.lessthanSize:
                    dataIn:
                      object: =..apiRequest.uplaodDoc.docReq.name.data # obejct
                      key: 5 #mb
                - ..formData.flag@: false
                - ..formData.flag@: true
        - actionType: evalObject
          object:
            - if:
                - =..formData.flag
                - actionType: popUp
                  popUpView: exceedTag
                  wait: true
                - continue
        - actionType: evalObject
          object:
            - =.builtIn.utils.getFileSize:
                dataIn:
                  object: =..apiRequest.uplaodDoc.docReq.name.data
                  units: "b"
                dataOut: DocumentPrivate.apiRequest.medicalRecord.docReq.name.data.fileSize
            - =.builtIn.utils.getFileName:
                dataIn:
                  object: =..apiRequest.uplaodDoc.docReq.name.data
                dataOut: DocumentPrivate.apiRequest.medicalRecord.docReq.name.data.fileName
        - actionType: evalObject
          object:
            # 获取上传文件名
            - ..apiRequest.medicalRecord.docReq.name.data.fileName@: =..apiRequest.uplaodDoc.docReq.name.data.name
            - ..apiRequest.uplaodDoc.docReq.reid@: =..apiRequest.medicalRecord.docReq.id
            - =.DocumentPrivate.apiRequest.uplaodDoc.docAPI.store: ""
            - ..formData.fileId@: =..apiRequest.uplaodDoc.docResp.doc.id
        - actionType: evalObject
          object:
            - if:
                - =.builtIn.string.equal:
                    dataIn:
                      string1: =..formData.fileId
                      string2: ""
                - continue
                - actionType: evalObject
                  object:
                    # 判断是否是图片文件
                    - if:
                        - =.builtIn.array.has:
                            dataIn:
                              object: =..formDataTemp.imgTypeList
                              value: =..formData.fileType
                        - actionType: evalObject
                          object:
                            - ..formData.uplodImg@: "none"
                            - ..formData.showImg@: "block"
                        - actionType: evalObject
                          object:
                            - ..formData.uplodImg@: "none"
                            - ..formData.showFile@: "block"
        - actionType: builtIn
          funcName: redraw
          viewTag: showFileTag
        - actionType: builtIn
          funcName: redraw
          viewTag: showImgTag
        - actionType: builtIn
          funcName: redraw
          viewTag: uplodImgTag
        - actionType: popUp
          popUpView: successTag
          wait: 2000
      choice2Button:
        - actionType: popUpDismiss
          popUpView: selectView
        - actionType: openPhotoLibrary
          dataObject: BLOB
          fileType: DocumentPrivate.formData.fileType
          dataKey: DocumentPrivate.apiRequest.uplaodDoc.docReq.name.data
        # 判断是否满足上传文件格式
        - actionType: evalObject
          object:
            - if:
                - =.builtIn.array.has:
                    dataIn:
                      object: =..formDataTemp.fileTypeList
                      value: =..formData.fileType
                - continue
                - actionType: popUp
                  popUpView: invalidTag
                  wait: true
                  popUpDismiss: 2000

        # 获取上传文件大小
        - actionType: evalObject
          object:
            - if:
                - =.builtIn.math.lessthanSize:
                    dataIn:
                      object: =..apiRequest.uplaodDoc.docReq.name.data # obejct
                      key: 5 #mb
                - ..formData.flag@: false

                - ..formData.flag@: true
        - actionType: evalObject
          object:
            - if:
                - =..formData.flag
                - actionType: popUp
                  popUpView: exceedTag
                  wait: true
                - continue
        - actionType: evalObject
          object:
            - =.builtIn.utils.getFileSize:
                dataIn:
                  object: =..apiRequest.uplaodDoc.docReq.name.data
                  units: "b"
                dataOut: DocumentPrivate.apiRequest.medicalRecord.docReq.name.data.fileSize
            - =.builtIn.utils.getFileName:
                dataIn:
                  object: =..apiRequest.uplaodDoc.docReq.name.data
                dataOut: DocumentPrivate.apiRequest.medicalRecord.docReq.name.data.fileName
        - actionType: evalObject
          object:
            # 获取上传文件名
            - ..apiRequest.medicalRecord.docReq.name.data.fileName@: =..apiRequest.uplaodDoc.docReq.name.data.name
            - ..apiRequest.uplaodDoc.docReq.reid@: =..apiRequest.medicalRecord.docReq.id
            - =.DocumentPrivate.apiRequest.uplaodDoc.docAPI.store: ""
            - ..formData.fileId@: =..apiRequest.uplaodDoc.docResp.doc.id
        - actionType: evalObject
          object:
            - if:
                - =.builtIn.string.equal:
                    dataIn:
                      string1: =..formData.fileId
                      string2: ""
                - continue
                - actionType: evalObject
                  object:
                    # 判断是否是图片文件
                    - if:
                        - =.builtIn.array.has:
                            dataIn:
                              object: =..formDataTemp.imgTypeList
                              value: =..formData.fileType
                        - actionType: evalObject
                          object:
                            - ..formData.uplodImg@: "none"
                            - ..formData.showImg@: "block"
                        - actionType: evalObject
                          object:
                            - ..formData.uplodImg@: "none"
                            - ..formData.showFile@: "block"

        - actionType: builtIn
          funcName: redraw
          viewTag: showFileTag
        - actionType: builtIn
          funcName: redraw
          viewTag: showImgTag
        - actionType: builtIn
          funcName: redraw
          viewTag: uplodImgTag
        - actionType: popUp
          popUpView: successTag
          wait: 2000
      choice3Button:
        - actionType: popUpDismiss
          popUpView: selectView
        - actionType: openDocumentManager
          dataObject: BLOB
          fileType: DocumentPrivate.formData.fileType
          dataKey: DocumentPrivate.apiRequest.uplaodDoc.docReq.name.data
        # 判断是否满足上传文件格式
        - actionType: evalObject
          object:
            - if:
                - =.builtIn.array.has:
                    dataIn:
                      object: =..formDataTemp.fileTypeList
                      value: =..formData.fileType
                - continue
                - actionType: popUp
                  popUpView: invalidTag
                  wait: true
                  popUpDismiss: 2000

        # 获取上传文件大小
        - actionType: evalObject
          object:
            - if:
                - =.builtIn.math.lessthanSize:
                    dataIn:
                      object: =..apiRequest.uplaodDoc.docReq.name.data # obejct
                      key: 5 #mb
                - ..formData.flag@: false
                - ..formData.flag@: true
        - actionType: evalObject
          object:
            - if:
                - =..formData.flag
                - actionType: popUp
                  popUpView: exceedTag
                  wait: true
                - continue
        - actionType: evalObject
          object:
            - =.builtIn.utils.getFileSize:
                dataIn:
                  object: =..apiRequest.uplaodDoc.docReq.name.data
                  units: "b"
                dataOut: DocumentPrivate.apiRequest.medicalRecord.docReq.name.data.fileSize
            - =.builtIn.utils.getFileName:
                dataIn:
                  object: =..apiRequest.uplaodDoc.docReq.name.data
                dataOut: DocumentPrivate.apiRequest.medicalRecord.docReq.name.data.fileName
        - actionType: evalObject
          object:
            # 获取上传文件名
            - ..apiRequest.medicalRecord.docReq.name.data.fileName@: =..apiRequest.uplaodDoc.docReq.name.data.name
            - ..apiRequest.uplaodDoc.docReq.reid@: =..apiRequest.medicalRecord.docReq.id
            - =.DocumentPrivate.apiRequest.uplaodDoc.docAPI.store: ""
            - ..formData.fileId@: =..apiRequest.uplaodDoc.docResp.doc.id
        - actionType: evalObject
          object:
            - if:
                - =.builtIn.string.equal:
                    dataIn:
                      string1: =..formData.fileId
                      string2: ""
                - continue
                - actionType: evalObject
                  object:
                    # 判断是否是图片文件
                    - if:
                        - =.builtIn.array.has:
                            dataIn:
                              object: =..formDataTemp.imgTypeList
                              value: =..formData.fileType
                        - actionType: evalObject
                          object:
                            - ..formData.uplodImg@: "none"
                            - ..formData.showImg@: "block"
                        - actionType: evalObject
                          object:
                            - ..formData.uplodImg@: "none"
                            - ..formData.showFile@: "block"
        - actionType: builtIn
          funcName: redraw
          viewTag: showFileTag
        - actionType: builtIn
          funcName: redraw
          viewTag: showImgTag
        - actionType: builtIn
          funcName: redraw
          viewTag: uplodImgTag
        - actionType: popUp
          popUpView: successTag
          wait: 2000
      lastChoiceButton:
        - actionType: popUpDismiss
          popUpView: selectView
      style:
        top: "0"
        left: "0"
        width: "1"
        height: "1"
        backgroundColor: "0x00000066"
        zIndex: "50"
      children:
        - type: view
          style:
            marginTop: "0.72"
            width: "0.9"
            height: "auto"
            marginLeft: "0.05"
            border:
              style: "1"
            borderRadius: "10"
            backgroundColor: "0xdbdbdb"
          children:
            - type: button
              text: ___.choice1Text
              contentType: file
              style:
                marginTop: "0.001"
                width: "0.9"
                height: "0.06"
                fontSize: .Nfont.h3
                color: "0x1d88fc"
                borderRadius: "10"
                backgroundColor: "0xdbdbdb"
                textAlign:
                  x: center
                border:
                  style: "1"
              onClick: ___.choice1Button
            - type: view
              style:
                width: "0.9"
                height: "0.001"
                zIndex: "100"
                backgroundColor: "#b6b6b6"
            - type: button
              text: ___.choice2Text
              contentType: file
              style:
                marginTop: "0.001"
                width: "0.9"
                height: "0.06"
                fontSize: .Nfont.h3
                color: "0x1d88fc"
                borderRadius: "10"
                backgroundColor: "0xdbdbdb"
                textAlign:
                  x: center
                border:
                  style: "1"
              onClick: ___.choice2Button
            - type: view
              style:
                width: "0.9"
                height: "0.001"
                backgroundColor: "#b6b6b6"
                zIndex: "100"
            - type: button
              text: ___.choice3Text
              contentType: file
              style:
                marginTop: "0.001"
                width: "0.9"
                height: "0.06"
                fontSize: .Nfont.h3
                color: "0x1d88fc"
                borderRadius: "10"
                backgroundColor: "0xdbdbdb"
                textAlign:
                  x: center
                border:
                  style: "1"
              onClick: ___.choice3Button
        - type: view
          style:
            marginTop: "0.01"
            width: "0.9"
            height: "auto"
            marginLeft: "0.05"
            border:
              style: "1"
            borderRadius: "10"
            backgroundColor: "#ffffff"
          children:
            - type: button
              text: ___.lastChoiceText
              style:
                marginTop: "0.001"
                width: "0.9"
                height: "0.06"
                fontSize: .Nfont.h3
                color: "0x1d88fc"
                borderRadius: "10"
                backgroundColor: "#ffffff"
                textAlign:
                  x: center
                border:
                  style: "1"
              onClick: ___.lastChoiceButton
  event:
    uploadClick:
      - actionType: popUp
        popUpView: selectView
    deleteClick:
      - actionType: popUp
        popUpView: BaseDelWarningView
    iconPath:
      emit:
        actions:
          - if:
              - =.builtIn.array.has:
                  dataIn:
                    object: =..formDataTemp.docTypeList
                    value: =..formData.fileType
              - docIco.svg
              - if:
                  - =.builtIn.array.has:
                      dataIn:
                        object: =..formDataTemp.xlsTypeList
                        value: =..formData.fileType
                  - xlsIco.svg
                  - if:
                      - =.builtIn.array.has:
                          dataIn:
                            object: =..formDataTemp.pptTypeList
                            value: =..formData.fileType
                      - pptIco.svg
                      - if:
                          - =.builtIn.array.has:
                              dataIn:
                                object: =..formDataTemp.htmTypeList
                                value: =..formData.fileType
                          - htmIco.svg
                          - pdfIco.svg
    privateClick:
      #  指定 eid 和 reid
      - actionType: evalObject
        object:
          - ..apiRequest.medicalRecord.docReq.eid@: =.Global.currentRoom.edge.id
          - ..apiRequest.medicalRecord.docReq.reid@: =.Global.roomInfo.edge.id
          # 文件类型
          - ..apiRequest.medicalRecord.docReq.name.data.fileType@: =..formData.fileType
          - ..apiRequest.medicalRecord.docReq.name.data.fileId@: =..formData.fileId

      #  修改type
      - actionType: evalObject
        object:
          - =.builtIn.number.inhx:
              dataIn:
                intHex: =..apiRequest.medicalRecord.docReq.type
                index: 1
                hex: 0
              dataOut: DocumentPrivate.apiRequest.medicalRecord.docReq.type

      - actionType: evalObject
        object:
          - =.DocumentPrivate.apiRequest.medicalRecord.docAPI.store: ""
          - =.builtIn.array.add:
              dataIn:
                object: =.Global.currentMeetingDoc
                value: =..apiRequest.medicalRecord.docResp.doc
      - actionType: evalObject
        object:
          .Global._nonce@:
            =.builtIn.math.random: ""

      - actionType: evalObject
        object:
          - if:
              - =..apiRequest.uplaodDoc.docResp.doc.id
              - =.builtIn.utils.createAuditLog:
                  dataIn:
                    actionTypeCode: .ActionTypeCode.upload
                    recordTypeCode: 163841
                    eid: =.Global.formData.currentFacility.relationEdge.id
                    user: =.Global.MyProfile.name.data.fullName
                    userId: =.Global.currentUser.vertex.id
                    targetUserId: =.Global.formData.auditLog.patientId
                    accessPort: provider
                  dataOut: Global.formData.auditLog.result
              - continue
          - =.builtIn.utils.createAuditLog:
              dataIn:
                actionTypeCode: .ActionTypeCode.edit
                recordTypeCode: 163841
                eid: =.Global.formData.currentFacility.relationEdge.id
                date: =.Global.formData.auditLog.startTime
                user: =.Global.MyProfile.name.data.fullName
                userId: =.Global.currentUser.vertex.id
                targetUserId: =.Global.formData.auditLog.patientId
                accessPort: provider
              dataOut: Global.formData.auditLog.result

      - actionType: evalObject
        object:
          - if:
              - =.builtIn.string.equal:
                  dataIn:
                    string1: =.Global.formData.unPageName
                    string2: ""
              - goto: ProviderNotes
              - goto: =.Global.formData.unPageName
    releaseClick:
      - actionType: evalObject
        object:
          # 判断必填项是否完成
          - if:
              - =.builtIn.array.allComplete:
                  dataIn:
                    - =..formData.fileId
                    - =..apiRequest.medicalRecord.docReq.name.title
              - continue
              - actionType: popUp
                popUpView: requiredTag
                wait: true
                popUpDismiss: 2000
      #  指定 eid 和 reid
      - actionType: evalObject
        object:
          - ..apiRequest.medicalRecord.docReq.eid@: =.Global.currentRoom.edge.id
          - ..apiRequest.medicalRecord.docReq.reid@: =.Global.roomInfo.edge.id
            # 文件类型
          - ..apiRequest.medicalRecord.docReq.name.data.fileType@: =..formData.fileType
          - ..apiRequest.medicalRecord.docReq.name.data.fileId@: =..formData.fileId

      #  修改type
      - actionType: evalObject
        object:
          - =.builtIn.number.inhx:
              dataIn:
                intHex: =..apiRequest.medicalRecord.docReq.type
                index: 1
                hex: 1
              dataOut: DocumentPrivate.apiRequest.medicalRecord.docReq.type

      - actionType: evalObject
        object:
          - =.builtIn.utils.createAuditLog:
              dataIn:
                actionTypeCode: .ActionTypeCode.upload
                recordTypeCode: 163841
                eid: =.Global.formData.currentFacility.relationEdge.id
                user: =.Global.MyProfile.name.data.fullName
                userId: =.Global.currentUser.vertex.id
                targetUserId: =.Global.formData.auditLog.patientId
                accessPort: provider
              dataOut: Global.formData.auditLog.result
          - =.builtIn.utils.createAuditLog:
              dataIn:
                actionTypeCode: .ActionTypeCode.edit
                recordTypeCode: 163841
                eid: =.Global.formData.currentFacility.relationEdge.id
                date: =.Global.formData.auditLog.startTime
                user: =.Global.MyProfile.name.data.fullName
                userId: =.Global.currentUser.vertex.id
                targetUserId: =.Global.formData.auditLog.patientId
                accessPort: provider
              dataOut: Global.formData.auditLog.result

      - actionType: popUp
        popUpView: dialogueTag
  style:
    scrollBox:
      marginLeft: "0.04"
      width: "0.92"
      height: "0.84729"
      boxSizing: "border-box"
    btnBox:
      width: "1"
      height: "0.0972"
      boxSizing: "border-box"
      overflow: "scroll"
      backgroundColor: "#ffffff"
      boxShadow: "1px 1px 4px 1px #dededf"
      textAlign:
        x: center
    btn:
      marginTop: "0.0123"
      height: "0.0443"
      width: "0.84"
      border:
        style: 1
      borderRadius: "5"
      backgroundColor: "#2988e6"
      color: "#ffffff"
      fontSize: .Nfont.h14
      boxSizing: border-box
      fontWeight: "600"
      textAlign:
        x: center
    titleLabel:
      marginTop: "0.024630"
      fontSize: .Nfont.h14
      fontWeight: "600"
    inputBox:
      marginTop: "0.013546"
      width: "0.92"
      height: "0.036945"
      boxSizing: border-box
      border: "1.5px solid #dededf"
      borderRadius: "2"
      textIndent: "12px"
      fontSize: .Nfont.h14
    tipsLabel:
      fontSize: .Nfont.h14
      marginTop: "0.019704"
      color: "#666666"
      lineHeight: "2.21674vh"
    tipsSecondLabel:
      paddingLeft: "0.0293333"
      fontSize: .Nfont.h14
      color: "#666666"
      lineHeight: "2.21674vh"
      width: "0.92"
      boxSizing: border-box
    uploadImg:
      marginTop: "0.013546"
      width: "0.92"
      height: "auto"
    imgShow:
      width: "0.9"
      height: "auto"
      margin: auto
    deleteImg:
      top: "0.006157"
      left: "0.864"
      height: "0.02"
      zIndex: "10"
    otherFileBox:
      backgroundColor: "#f8f8f8"
      boxSizing: border-box
      paddingLeft: "0.032"
      paddingRight: "0.064"
      paddingTop: "0.0147783"
      paddingBottom: "0.0147783"
      borderRadius: "4"
    fileIcon:
      display: "inline-block"
      width: "0.056"
      height: "0.032019"
      verticalAlign: middle
    contentBox:
      display: "inline-block"
      verticalAlign: middle
      marginLeft: "0.032"
      width: "0.72"
    fileTitle:
      fontSize: .Nfont.h14
      color: "#333333"
      lineHeight: "2.58vh"
      display: "-webkit-box"
      overflow: hidden
      text-overflow: "ellipsis"
      webkitBoxOrient: vertical
      -webkit-line-clamp: 2
      wordBreak: break-word
    fileSize:
      fontSize: .Nfont.h12
      color: "#999999"
