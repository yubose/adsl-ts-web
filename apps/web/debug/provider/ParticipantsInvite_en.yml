ParticipantsInvite:
  title: "Participants invite"
  pageNumber: ""
  init:
    - .SignInCheck
    - if:
        - .Global.middleInformation.PatientVisitInfo
        - actionType: evalObject
          object:
            - ..formData@: =.Global.middleInformation.PatientVisitInfo
        - continue
  save:
    - =.ParticipantsInvite.inviteInfo.edgeAPI.store: ""
  inviteInfo:
    edge:
      type: .EdgeType.InviteInfo
      refid: .AppointmentLobby.dataObject.id
      bvid: .Global.currentUser.vertex.id
      name:
        phoneNumber: ""
        firstName: ""
        lastName: ""
        name: ""
        hostName: .Global.currentUser.vertex.name.userName
        roomName: .AppointmentLobby.dataObject.name.visitReason
        date: .AppointmentLobby.dataObject.stime
    edgeAPI:
      .EdgeAPI: ""
      store:
        api: ce
        dataKey: inviteInfo.edge
  dataObject: .Global.roomInfo.edge
  formData:
    countryCode: "+1"
    phoneNumber: []
    name: ""
    phone: ""
    showName: ""
    inputPhone: ""
  Participants:
    - key: "Provider"
    - key: "Patient"
  MoreWays:
    # - key: "myConnection.png"
    #   value: "My Connection"
    #   pageName: "ConnectionList"
    - key: "myPatient.svg"
      value: "My Patient"
      pageName: "PatientList"
    # - key: "mobileContacts.svg"
    #   value: "Mobile Contacts"
  components:
    - .BaseHeader:
    - .HeaderLeftButton:
    - type: view
      style:
        top: "0.1"
        # left: "0.05"
        width: "1"
        height: "0.9"
        backgroundColor: "#f0f0f0"
      children:
        - type: label
          text: "Participants"
          style:
            top: "0"
            left: "0.08"
            width: "0.9"
            height: "0.05"
            # backgroundColor: "0xF7F7F7"
            fontSize: .Nfont.h14
            fontWeight: 400
            color: "#4b4b4b"
            textAlign:
              y: center
        - type: view
          style:
            top: "0.05"
            # left: "0.05"
            width: "1"
            # height: "0.3"
            height: "0.12"
            backgroundColor: "#ffffff"
          children:
            - type: list
              contentType: listObject
              listObject: ..Participants
              iteratorVar: itemObject
              style:
                top: "0"
                left: "0"
                width: "1"
                height: "0.3"
                margin: "0"
                overflow: scroll
                # boxShadow: "0px 0px 1px #dededf"
              children:
                - type: listItem
                  itemObject: ""
                  style:
                    left: "0"
                    width: "1"
                    height: "0.05"
                    # border:
                    #   style: "2"
                    # borderColor: "0x00000066"
                    # borderWidth: "1"
                  children:
                    - type: label
                      dataKey: itemObject.key
                      style:
                        top: "0.02"
                        fontSize: .Nfont.h14
                        fontWeight: 350
                        left: "0.08"
            - type: label
              dataKey: dataObject.name.providerName
              style:
                width: "0.6"
                top: "0.02"
                height: "0.03"
                fontSize: .Nfont.h16
                fontWeight: 350
                left: "0.3"
                textAlign:
                  x: right
            - type: label
              dataKey: dataObject.name.patientName
              style:
                width: "0.6"
                top: "0.065"
                height: "0.03"
                fontSize: .Nfont.h16
                fontWeight: 350
                left: "0.3"
                textAlign:
                  x: right
        - type: label
          text: "Quickly Invite"
          style:
            top: "0.17"
            left: "0.08"
            width: "0.9"
            height: "0.05"
            # backgroundColor: "0xF7F7F7"
            fontSize: .Nfont.h14
            fontWeight: 400
            color: "#4b4b4b"
            textAlign:
              y: center
        - type: view
          style:
            top: "0.22"
            # left: "0.05"
            width: "1"
            height: "0.34"
            backgroundColor: "#ffffff"
          children:
            - type: view
              style:
                top: "0.02"
                left: "0.08"
                width: "0.9"
                height: "0.3"
                # border: "1px solid #000000"
                borderWidth: 1
              children:
                - type: label
                  text: "Country"
                  style:
                    left: "0"
                    fontSize: .Nfont.h12
                - type: select
                  dataKey: formData.countryCode
                  options:
                    # - "+1" #US Canada
                    # - "+52" #Mexico
                    # - "+86" #China
                    # - "+965" #Kuwait
                    .SelectINformationDM.CountryCode
                  style:
                    top: "0.03"
                    width: "0.13"
                    height: "0.05"
                    border:
                      style: "3"
                    borderWidth: "1"
                    borderColor: "0xdededf"
                    borderRadius: "5"
                    # paddingLeft: "20px"
                - type: label
                  text: "Phone Number"
                  style:
                    left: "0.22"
                    fontSize: .Nfont.h12
                    top: "0"
                - type: textField
                  placeholder: "000-000-0000"
                  dataKey: formData.inputPhone
                  style:
                    left: "0.22"
                    top: "0.03"
                    width: "0.57"
                    height: "0.05"
                    border:
                      style: "3"
                    borderWidth: "1"
                    borderColor: "0xdededf"
                    borderRadius: "5"
                    paddingLeft: "20px"
                - type: label
                  text: Name
                  style:
                    top: "0.1"
                    # left: "0.25"
                    fontSize: .Nfont.h12
                - type: textField
                  placeholder: "Enter here"
                  dataKey: formData.name.data.fullName
                  style:
                    # left: "0.25"
                    top: "0.13"
                    width: "0.79"
                    height: "0.05"
                    border:
                      style: "3"
                    borderWidth: "1"
                    borderColor: "0xdededf"
                    borderRadius: "5"
                    paddingLeft: "20px"
                # - type: textField
                #   placeholder: "Enter here"
                #   dataKey: inviteInfo.edge.name.lastName
                #   style:
                #     left: "0.44"
                #     top: "0.13"
                #     width: "0.35"
                #     height: "0.05"
                #     border:
                #       style: "3"
                #     borderWidth: "1"
                #     borderColor: "0xdededf"
                #     borderRadius: "5"
                #     paddingLeft: "20px"
                - type: button
                  text: "Invite"
                  onClick:
                    - actionType: evalObject
                      object:
                        - .ParticipantsInvite.inviteInfo.edge.name.phoneNumber@: =.ParticipantsInvite.formData.phoneNumber.1
                        - .ParticipantsInvite.inviteInfo.edge.name.name@: =.ParticipantsInvite.formData.name
                        - .ParticipantsInvite.formData.countryCode@: "+1" #need modify
                    - actionType: evalObject
                      object:
                        - =.builtIn.string.concat:
                            dataIn:
                              - =..formData.countryCode
                              - =..formData.phoneNumber
                            dataOut: ParticipantsInvite.formData.phone
                    - actionType: evalObject
                      object:
                        - =.builtIn.string.concat:
                            dataIn:
                              - =..formData.name.data.fullName
                              - " ("
                              - =..formData.inputPhone
                              - ")"
                            dataOut: ParticipantsInvite.formData.showName
                    - actionType: builtIn
                      funcName: redraw
                      viewTag: confirmView
                    - actionType: popUp
                      popUpView: confirmView
                  style:
                    left: "0"
                    top: "0.23"
                    width: "0.87"
                    height: "0.05"
                    border:
                      style: "3"
                      color: "0x2988e6"
                    borderWidth: "1"
                    borderColor: "0x2988e6"
                    borderRadius: "5"
                    backgroundColor: "0xffffff"
                    color: "#2988e6"
                    fontSize: .Nfont.h14
                    textAlign:
                      x: center
        - type: label
          text: "More Ways to Invite"
          style:
            top: "0.56"
            left: "0.08"
            width: "0.9"
            height: "0.05"
            fontSize: .Nfont.h14
            fontWeight: 400
            color: "#4b4b4b"
            textAlign:
              y: center
        - type: view
          style:
            top: "0.61"
            width: "1"
            height: "0.29"
            backgroundColor: "#ffffff"
          children:
            - type: list
              contentType: listObject
              listObject: ..MoreWays
              iteratorVar: itemObject
              style:
                top: "0"
                left: "0"
                width: "1"
                height: "0.26"
                margin: "0"
              children:
                - type: listItem
                  onClick:
                    emit:
                      dataKey:
                        var: itemObject
                      actions:
                        - if:
                            - true
                            - goto: $var.pageName
                            - goto: $var.pageName
                  itemObject: ""
                  style:
                    left: "0"
                    width: "1"
                    height: "0.08"
                    border:
                      style: "2"
                    borderWidth: "1"
                    borderColor: "0xdededf"
                  children:
                    - type: image
                      path:
                        emit:
                          dataKey:
                            var: itemObject
                          actions:
                            - if:
                                - =$var.key
                                - $var.key
                                - $var.key
                      style:
                        left: "0.08"
                        top: "0.02"
                        width: "0.08"
                        # zIndex: 10
                    - type: label
                      dataKey: itemObject.value
                      style:
                        width: "0.4"
                        top: "0.025"
                        fontSize: .Nfont.h16
                        fontWeight: 350
                        height: "0.03"
                        left: "0.2"
                        textAlign:
                          x: left
    - type: popUp # view
      viewTag: confirmView
      style:
        left: "0"
        top: "0"
        width: "1"
        height: "1"
        backgroundColor: "0x00000066"
      children:
        - type: view
          style:
            left: "0.1"
            top: "0.4"
            width: "0.8"
            height: "0.3"
            backgroundColor: "0xe9e9e9ff"
            border:
              style: "5"
            borderRadius: "15"
          children:
            - type: label
              text: "Send Invite Link"
              style:
                left: "0"
                top: "0.04"
                width: "0.8"
                height: "0.027247"
                color: "0x000000"
                fontSize: "20"
                fontWeight: 500
                display: inline
                textAlign:
                  x: center
            - type: label
              text: "Send invite link to"
              style:
                left: "0"
                top: "0.1"
                width: "0.8"
                height: "0.04"
                color: "0x000000"
                fontSize: .Nfont.h14
                display: inline
                textAlign:
                  x: center
            - type: label
              dataKey: formData.showName
              style:
                left: "0"
                top: "0.15"
                width: "0.8"
                height: "0.027247"
                color: "0x000000"
                fontSize: .Nfont.h14
                display: inline
                textAlign:
                  x: center
            # - type: label
            #   text: "+1 7148397253"
            #   dataKey: formData.phoneNumber.1
            #   style:
            #     left: "0.38"
            #     top: "0.15"
            #     width: "0.3"
            #     # backgroundColor: "0xdfafaf"
            #     height: "0.027247"
            #     color: "0x000000"
            #     fontSize: .Nfont.h14
            #     display: inline
            #     textAlign:
            #       x: left
            - type: view
              style:
                left: "0"
                top: "0.21"
                width: "0.8"
                height: "0.001"
                backgroundColor: "0x00000088"
            - type: button
              onClick:
                - actionType: popUpDismiss
                  popUpView: confirmView
              text: Cancel
              style:
                left: "0.01"
                top: "0.23"
                width: "0.38"
                height: "0.05"
                color: "0x007affff"
                backgroundColor: "0xe9e9e9"
                fontSize: "17"
                display: inline
                textAlign:
                  x: center
                border:
                  style: 1
            - type: button
              onClick:
                - actionType: evalObject
                  object: ..save
                - actionType: evalObject
                  object:
                    .Global._nonce@:
                      =.builtIn.math.random: ""
                - actionType: evalObject
                  object:
                    - .Global.contact.document.name.data.phoneNumber@: =..inviteInfo.edge.name.phoneNumber
                    - .Global.contact.document.name.data.firstName@: =..inviteInfo.edge.name.firstName
                    - .Global.contact.document.name.data.lastName@: =..inviteInfo.edge.name.lastName
                    - .Global.middleInformation.PatientVisitInfo.name@: ""
                    - .Global.middleInformation.PatientVisitInfo.phoneNumber@:
                        []
                - actionType: builtIn
                  funcName: goBack
              text: Confirm
              style:
                left: "0.4"
                top: "0.23"
                width: "0.38"
                height: "0.05"
                color: "0x007affff"
                fontSize: "17"
                display: inline
                backgroundColor: "0xe9e9e9"
                borderRadius: 10
                textAlign:
                  x: center
                border:
                  style: 1
            - type: view
              style:
                left: "0.4"
                top: "0.21"
                width: "0.001"
                height: "0.09"
                backgroundColor: "0x00000088"
