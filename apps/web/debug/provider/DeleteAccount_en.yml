DeleteAccount:
  title: Delete Account
  pageNumber:
  init:

  formData:
    waitroomNum: ""
    # 控制警告信息
    checkShow: "none" #"inline-block"
    # 控制输入框颜色
    checkColor: "#dedede" #"#fb5051"
    # 假数据
    account: ""
    password: ""
    res: ""
  formDataTemp:
    accountTemp:
      - Select
      - Create another account
      - No longer use it
      - Other reason

  apiRequest:
    deleteAccount:
      req:
        id: .Global.currentUser.vertex.id
      resp: ""
      vertexApi:
        delete:
          api: dx
          dataIn: DeleteAccount.apiRequest.deleteAccount.req
          dataOut: DeleteAccount.apiRequest.deleteAccount.resp
    deleteAccountReason:
      docCreateResp: ""
      docCreateReq:
        eid: .Global.rootNotebookID
        type: .DocType.DeleteFeedback
        name:
          data:
            reason: ""
      docAPI:
        store:
          api: cd
          dataIn: DeleteAccount.apiRequest.deleteAccountReason.docCreateReq
          dataOut: DeleteAccount.apiRequest.deleteAccountReason.docCreateResp
  components:
    - .BasePublicHeader:
        children:
          - .BasePublicHeaderLeft:
          - .BasePublicHeaderTitle:

    - type: scrollView
      style:
        ..style.scrollBox:
      children:
        - type: label
          text: When you delete your account, all of your personal information will be permanently removed
          dataKey:
          style:
            ..style.headerLable:
        - type: label
          text: Why do you want to delete your account?
          style:
            ..style.titleLabel:
        - type: view
          style:
            marginLeft: "0.04"
          children:
            - type: select
              dataKey: formData.account
              options: ..formDataTemp.accountTemp
              style:
                ..style.selectBox:

        - type: label
          textBoard:
            - text: "Enter Password &nbsp;"
            - text: "*"
              color: "#fb5051"
          style:
            ..style.titleLabel:
            marginTop: "0.0394088"

        - type: view
          viewTag: checkTag
          style:
            ..style.passwordBox:
            borderColor: ..formData.checkColor
          children:
            - type: textField
              placeholder: Enter here
              contentType: password
              dataKey: formData.password
              style:
                ..style.passwordInput:

        - type: view
          style:
            ..style.blockBox:
          children:
            - type: view
              style:
                ..style.tipsBox:
              children:
                - type: label
                  viewTag: checkTag
                  text: Incorrect password
                  style:
                    ..style.tipsLabel:
                    display: ..formData.checkShow
            # - type: view
            #   style:
            #     ..style.tipsBox:
            #     textAlign:
            #       x: right
            #   children:
            #     - type: label
            #       text: Forgot password?
            #       dataKey:
            #       style:
            #         ..style.tipsLabel:
            #         color: "#666666"
                  # onClick:
                  #   - ..event.forgotClick
    - type: view
      style:
        ..style.btnBox:
      children:
        - type: button
          text: Delete Account
          dataKey:
          style:
            ..style.btn:
          onClick:
            - ..event.deleteClick
    # 弹窗
    - type: popUp
      viewTag: DeleteAccountTag
      message: "Are you sure you want to delete it?"
      leftText: "Cancel"
      rightText: "Confirm"
      DeleteEvent:
        # 删除本账户
        - actionType: evalObject
          object:
            # 保存删除原因
            - =..apiRequest.deleteAccountReason.docAPI.store: ""
            # 删除账号
            - =..apiRequest.deleteAccount.vertexApi.delete: ""
            - =.builtIn.search.updateEsData:
                dataIn:
                  id: =.Global.currentUser.vertex.id
                  type: "35840"
                dataOut: DeleteAccount.formData.res
            - if:
                - true
                - =.builtIn.cleanLocalStorage
                - continue
        - actionType: popUpDismiss
          popUpView: DeleteAccountTag
        - goto: SignIn
      CancelEvent:
        - actionType: popUpDismiss
          popUpView: DeleteAccountTag
      style:
        top: "0"
        left: "0"
        width: "1"
        height: "1"
        backgroundColor: "0x00000066"
        zIndex: "1000"
        textAlign:
          y: center
      children:
        - type: view
          style:
            width: "0.72"
            marginLeft: "0.14"
            backgroundColor: "0xE6E6E6"
            borderRadius: "14"
            overflow: hidden
            textAlign:
              x: center
          children:
            - type: image
              path: warnIcon.svg
              style:
                marginTop: "0.019704"
                width: "0.053333"
                height: "0.022167"
            - type: label
              text: "Delete Account ?"
              dataKey:
              style:
                width: "0.72"
                fontWeight: "700"
                marginTop: "0.01"
                fontSize: .Nfont.h16
                textAlign:
                  x: center
            - type: label
              textBoard:
                - text: "Your information will be permanently deleted, and you will not be allowed to access our&nbsp;"
                - text: "Patient"
                  color: "#2988e6"
                - text: ",&nbsp;"
                  color: "#2988e6"
                - text: "Provider"
                  color: "#2988e6"
                - text: "&nbsp;and&nbsp;"
                - text: "Admin"
                  color: "#2988e6"
              style:
                width: "0.72"
                marginTop: "0.01"
                fontSize: .Nfont.h14
                lineHeight: "2.58vh"
                textAlign:
                  x: center

            - type: button
              text: Delete Account
              onClick: ___.DeleteEvent
              style:
                marginTop: "0.020935"
                height: "0.056650"
                border: "none"
                borderTop: "1px solid #bcbcbc"
                backgroundColor: "0xE6E6E6"
                fontSize: .Nfont.h14
                color: "#fb5051"
                boxSizing: border-box
                width: "0.72"
                textAlign:
                  x: center
                  y: center
            - type: button
              text: Cancel
              onClick: ___.CancelEvent
              style:
                height: "0.056650"
                border: "none"
                borderTop: "1px solid #bcbcbc"
                backgroundColor: "0xE6E6E6"
                fontSize: .Nfont.h14
                width: "0.72"
                color: "#6f7c8d"
                boxSizing: border-box
                textAlign:
                  x: center
                  y: center
  event:
    # forgotClick:
      # - actionType: popUp
        # popUpView: DeleteAccountTag
    # - actionType: evalObject
    #   object:
    #     - =.builtIn.utils.toaster:
    #         dataIn:
    #           toastMessage: 1
    deleteClick:
      - actionType: evalObject
        object:
          - if:
            - =.builtIn.array.allComplete:
                dataIn:
                  - =..formData.account
            - ..apiRequest.deleteAccountReason.docCreateReq.name.data.reason@: =..formData.account
            - ..apiRequest.deleteAccountReason.docCreateReq.name.data.reason@: "/"
      - actionType: evalObject
        object:
          - =.builtIn.eccNaCl.decryptAES:
              dataIn:
                key: =..formData.password
                message: =.Global.currentUser.vertex.esk
              dataOut: DeleteAccount.formData.sk
          - =.builtIn.eccNaCl.skCheck:
              dataIn:
                pk: =.Global.currentUser.vertex.pk
                sk: =..formData.sk
              dataOut: DeleteAccount.formData.pass
      - actionType: evalObject
        object:
          - if:
              - =..formData.pass
              - actionType: evalObject
                object:
                  - ..formData.checkShow@: "none"
                  - ..formData.checkColor@: "#dedede"
              - actionType: evalObject
                object:
                  - ..formData.checkShow@: "inline-block"
                  - ..formData.checkColor@: "#fb5051"
          - if:
              - =..formData.pass
              - actionType: popUp
                popUpView: DeleteAccountTag
              - continue
      - actionType: builtIn
        funcName: redraw
        viewTag: checkTag
  style:
    scrollBox:
      width: "1"
      height: "0.84729"
      boxSizing: "border-box"
    btnBox:
      width: "1"
      height: "0.0972"
      boxSizing: "border-box"
      borderTop: "1px solid #e2e8ed"
      textAlign:
        x: center
    btn:
      marginTop: "0.0123"
      height: "0.0443"
      width: "0.84"
      border:
        style: 1
      borderRadius: "5"
      backgroundColor: "#fb5051"
      color: "#ffffff"
      fontSize: .Nfont.h14
      boxSizing: border-box
      fontWeight: "600"
      textAlign:
        x: center
    headerLable:
      marginTop: "0.024630"
      paddingLeft: "0.04"
      paddingRight: "0.04"
      fontSize: .Nfont.h14
      color: "#666666"
      lineHeight: "2.58vh"
    titleLabel:
      marginTop: "0.025862"
      marginLeft: "0.04"
      width: "0.92"
      color: "#333333"
      fontWeight: "600"
      fontSize: .Nfont.h14
    inputBox:
      boxSizing: border-box
      height: "0.0541871"
      border: "1px solid #dedede"
      fontSize: .Nfont.h14
      color: "#333333"
      borderRadius: "4"
    selectBox:
      ..style.inputBox:
      marginTop: "0.01"
      textIndent: "8px"
      width: "0.92"
    passwordBox:
      marginTop: "0.01"
      marginLeft: "0.04"
      border: "1px solid #dedede"
      borderRadius: "4"
      boxSizing: "border-box"
      width: "0.92"
      overflow: hidden
    blockBox:
      marginTop: "0.01"
      marginLeft: "0.04"
      width: "0.92"
    passwordInput:
      ..style.inputBox:
      width: "0.92"
      border: "none"
      textIndent: "12px"
    tipsBox:
      display: "inline-block"
      width: "0.46"
      verticalAlign: middle
      textAlign:
        x: left
    tipsLabel:
      fontSize: .Nfont.h12
      color: "#fb5051"
      fontWeight: "400"
      width: "auto"