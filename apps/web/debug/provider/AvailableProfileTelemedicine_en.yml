AvailableProfileTelemedicine:
  pageNumber: "170"
  title: "Available Profile"
  init:
    - .SignInCheck
    - actionType: evalObject
      object:
        .Global._nonce@:
          =.builtIn.math.random: ""
    - =.builtIn.utils.setTimer:
        dataIn:
          timeUnix: 1000
    #切换 jwt
    # - .Global.createjwt.edge.bvid@: =.Global.currentFacility.id
    # - =.Global.createjwt.edgeAPI.store: ""
    - ..getSchedule.get
    - actionType: evalObject
      object:
        ..formData@: =..getSchedule.schedule.edge.0
    - .Global.locationId@: .Global.currentFacility.id

    - if:
        - =..getSchedule.schedule.edge.0
        - ..buttonText@: "Update Now"
        - ..buttonText@: "Create Now"

    - actionType: updateObject
      dataKey: Global.currentSchdule
      dataObject: .EmptyObj

    - actionType: evalObject
      object:
        - =.builtIn.array.WeekSchedule:
            dataIn:
              planObject: =..getSchedule.schedule.edge.0.name.setting.day
            dataOut: AvailableProfileTelemedicine.day

    - if:
        - =..getSchedule.schedule.edge.0
        - continue
        - =.builtIn.checkField:
            dataIn:
              contentType: messageHidden
              wait: 100
  getSchedule:
    schedule:
      edge: ""
    get:
      .EdgeAPI.get: ""
      api: re
      dataKey: AvailableProfileTelemedicine.getSchedule.schedule
      type: 40000
      id:
        - .Global.currentFacility.id
        - .Global.currentUser.vertex.id
      sCondition: "subtype=196611"
      xfname: "bvid,evid"
      maxcount: "1"
      obfname: "ctime"
      _nonce: =.Global._nonce
  weekLabel:
    - key: Sunday
    - key: Monday
    - key: Tuesday
    - key: Wednesday
    - key: Thursday
    - key: Friday
    - key: Saturday
  day: []
  formData: ""
  buttonText: ""
  components:
    - .BaseHeader:
    - .HeaderLeftButton:
      # - .HeaderRightImg:
      onClick:
        - goto: ScheduleProfile
    #   path: sideNav.svg
    - type: view
      style:
        left: "0"
        width: "1"
        top: "0.1"
        height: "0.05"
        zIndex: "20"
        backgroundColor: "0xffffff"
      children:
        - type: button
          text: "Telemedicine"
          style:
            width: "0.25"
            backgroundColor: "0xffffff"
            border:
              style: "2"
            borderColor: "#0088e2"
            borderWidth: "1"
            color: "0x000000"
            left: "0.2"
            height: "0.05"
            top: "0"
            textAlign:
              x: center
        - type: button
          text: "Office Visits"
          style:
            width: "0.25"
            backgroundColor: "0xffffff"
            border: "none"
            left: "0.55"
            height: "0.05"
            top: "0"
            textAlign:
              x: center
          onClick:
            - goto: AvailableProfileOffice
    - type: scrollView
      style:
        left: "0"
        top: "0.15"
        width: "1"
        height: "0.7"
        overflow: scroll
      children:
        - type: view
          style:
            marginTop: "0"
            left: "0"
            width: "1"
            height: "auto"
          children:
            - type: view
              style:
                marginTop: "0"
                left: "0"
                width: "1"
                height: "auto"
              children:
                - type: view
                  style:
                    left: "0"
                    marginTop: "0"
                    height: "auto"
                    # border:
                    #   style: "2"
                    # borderWidth: "2"
                    # borderColor: "#bfbfbf"
                  children:
                    - type: view
                      style:
                        width: "1"
                        height: "auto"
                        left: "0"
                        marginTop: "0"
                        # border:
                        #   style: "2"
                        # borderWidth: "2"
                        # borderColor: "#bfbfbf"
                      children:
                        - type: view
                          style:
                            left: "0"
                            marginTop: "0"
                            height: "0.05"
                            width: "1"
                            backgroundColor: "0xf0f0f0"
                          children:
                            - type: label
                              text: "Available Days"
                              style:
                                width: "0.95"
                                height: "0.05"
                                marginTop: "0"
                                left: "0.05"
                                color: "#4B4B4B"
                                textAlign:
                                  y: center
                                fontFamily: "Arial"
                                fontSize: .Nfont.h14
                                fontWeight: "600"
                                backgroundColor: "#F0F0F0"
                                # textIndent: "2em"
                        - type: list
                          scrollable: "false"
                          contentType: listObject
                          listObject: ..day # to dataObject to enumerate the list
                          iteratorVar: itemObject
                          style:
                            marginTop: "0"
                            left: "0"
                            width: "1"
                            height: "auto"
                            margin: "0"
                          children:
                            - type: listItem
                              itemObject: ""
                              style:
                                marginTop: "0"
                                height: "auto"
                                left: "0"
                                width: "1"
                              children:
                                - type: label
                                  dataKey: itemObject.weekDay
                                  style:
                                    left: "0.05"
                                    width: "0.24"
                                    marginTop: "0.01"
                                    height: "0.03"
                                    fontWeight: "500"
                                    fontSize: .Nfont.h16
                                    textAlign:
                                      y: center
                                - type: label
                                  dataKey: itemObject.info
                                  style:
                                    left: "0.05"
                                    width: "0.343"
                                    marginTop: "0"
                                    height: "auto"
                                    fontSize: .Nfont.h14
                                - type: view
                                  style:
                                    height: "0.001"
                                    width: "1"
                                    backgroundColor: "0xDEDEDF6f"
                        - type: view
                          style:
                            left: "0"
                            marginTop: "0"
                            height: "auto"
                            width: "1"
                          children:
                            - type: view
                              style:
                                left: "0"
                                marginTop: "0"
                                height: "0.05"
                                width: "1"
                                backgroundColor: "0xf0f0f0"
                              children:
                                - type: label
                                  text: "Duration"
                                  style:
                                    width: "0.95"
                                    height: "0.05"
                                    marginTop: "0"
                                    left: "0.05"
                                    color: "#4B4B4B"
                                    textAlign:
                                      y: center
                                    fontFamily: "Arial"
                                    fontSize: .Nfont.h14
                                    fontWeight: "600"
                                    backgroundColor: "#F0F0F0"
                            - type: view
                              style:
                                width: "1"
                                height: "0.04"
                                marginTop: "0.01"
                              children:
                                - .PatientChartShowTitle:
                                  style:
                                    width: "0.4"
                                    marginLeft: "0.05"
                                    display: "inline-block"
                                    verticalAlign: middle

                                  text: "Duration(weeks): "
                                - type: label
                                  style:
                                    width: "0.5"
                                    display: "inline-block"
                                    fontSize: .Nfont.h2
                                    verticalAlign: middle
                                    textAlign:
                                      x: right
                                  dataKey: formData.name.setting.forwardRepeatWeeks
                                # - type: label
                                #   text: "Weeks"
                                #   style:
                                #     left: "0.8"
                                #     width: "0.15"
                                #     height: "0.03"
                                #     top: "0"
                                #     textAlign:
                                #       x: right

                            - type: view
                              style:
                                marginTop: "0.01"
                                width: "1"
                                height: "0.04"
                              children:
                                - .PatientChartShowTitle:
                                  text: "Start Day:"
                                  style:
                                    width: "0.55"
                                    marginLeft: "0.05"
                                    verticalAlign: middle
                                    display: "inline-block"
                                - type: label
                                  dataKey: formData.name.setting.startDate
                                  style:
                                    width: "0.35"
                                    verticalAlign: middle
                                    display: "inline-block"
                                    fontSize: .Nfont.h2
                                    # marginTop: "0.015"
                                    textAlign:
                                      x: right
                            # - type: view #暂时注释 请勿删除
                            #   style:
                            #     marginTop: "0.01"
                            #     left: "0.05"
                            #     width: "0.9"
                            #     height: "0.04"
                            #   children:
                            #     - .PatientChartShowTitle:
                            #       text: "End Day:"
                            #       style:
                            #         width: "0.6"
                            #     - type: label
                            #       dataKey: formData.name.setting.endDate
                            #       style:
                            #         top: "0.01"
                            #         left: "0.5"
                            #         width: "0.4"
                            #         height: "0.02"
                            #         textAlign:
                            #           x: right
                    # - type: view
                    #   style:
                    #     width: "0.98"
                    #     # height: "0.2"
                    #     left: "0"
                    #     marginTop: "0.01"
                    #     # border:
                    #     #   style: "2"
                    #     # borderWidth: "2"
                    #     # borderColor: "#bfbfbf"
                    #   children:
                    #     - type: view
                    #       style:
                    #         left: "0"
                    #         marginTop: "0"
                    #         height: "0.05"
                    #         width: "1"
                    #         backgroundColor: "0xf0f0f0"
                    #       children:
                    #         - type: label
                    #           text: Blocked off days
                    #           style:
                    #             width: "0.95"
                    #             height: "0.05"
                    #             top: "0"
                    #             left: "0.05"
                    #             color: "#4B4B4B"
                    #             textAlign:
                    #               y: center
                    #             fontFamily: "Arial"
                    #             fontSize: .Nfont.h14
                    #             fontWeight: "600"
                    #             backgroundColor: "#F0F0F0"
                    #     - type: view
                    #       style:
                    #         marginTop: "0.01"
                    #         left: "0.05"
                    #         width: "0.9"
                    #         height: "0.04"
                    #       children:
                    #         - .PatientChartShowTitle:
                    #           text: "Blocked off days"
                    #           style:
                    #             width: "0.6"
                    #         - type: select
                    #           dataKey: formData.name.setting.blockDays
                    #           options:
                    #             ..formData.name.setting.blockDays
                    #           style:
                    #             top: "0.01"
                    #             left: "0.62"
                    #             width: "0.28"
                    #             height: "0.03"
                    #             textAlign:
                    #               x: right
                    #     # - type: list
                    #     #   contentType: listObject
                    #     #   listObject: ..formData.name.setting.blockDays # to dataObject to enumerate the list
                    #     #   iteratorVar: itemObject
                    #     #   style:
                    #     #     margin: "0"
                    #     #     marginTop: "0.01"
                    #     #     left: "0.3"
                    #     #     width: "0.4"
                    #     #     height: "auto"
                    #     #   children:
                    #     #     - type: listItem
                    #     #       itemObject: ""
                    #     #       style:
                    #     #         width: "0.4"
                    #     #         height: "0.04"
                    #     #       children:
                    #     #         - type: label
                    #     #           dataKey: itemObject
                    #     #           style:
                    #     #             top: "0.005"
                    #     #             fontSize: "15"
                    #     #             height: "0.03"

                    #     - type: view
                    #       style:
                    #         marginTop: "0.02"
                    #         left: "0.05"
                    #         width: "0.9"
                    #         height: "0.04"
                    #       children:
                    #         - .PatientChartShowTitle:
                    #           text: "Block Government holiday"
                    #           style:
                    #             width: "0.6"
                    #         - type: image
                    #           path:
                    #             emit:
                    #               actions:
                    #                 - if:
                    #                   - =.AvailableProfileTelemedicine.formData.name.setting.governmentHolidays
                    #                   - checkbox.svg
                    #                   - dontselect.png
                    #           style:
                    #             top: "0.01"
                    #             left: "0.8"
                    #             height: "0.02"
                    #         # - .PatientChartShowData:
                    #         #   style:
                    #         #     width: "0.2"
                    #         #   dataKey: formData.name.setting.governmentHolidays
                    #     - type: view
                    #       style:
                    #         marginTop: "0.02"
                    #         left: "0.05"
                    #         width: "0.9"
                    #         height: "0.04"
                    #       children:
                    #         - .PatientChartShowTitle:
                    #           text: "Block business holiday"
                    #         # - .PatientChartShowData:
                    #         #   style:
                    #         #     width: "0.1"
                    #         #   dataKey: formData.name.setting.businessHolidays
                    #         - type: image
                    #           path:
                    #             emit:
                    #               actions:
                    #                 - if:
                    #                   - =.AvailableProfileTelemedicine.formData.name.setting.businessHolidays
                    #                   - checkbox.svg
                    #                   - dontselect.png
                    #           style:
                    #             top: "0.01"
                    #             left: "0.8"
                    #             height: "0.02"
    - type: view
      style:
        top: "0.9"
        width: "1"
        height: "0.1"
        backgroundColor: "0xffffff"
      children:
        - type: button
          dataKey: buttonText
          style:
            width: "0.7"
            height: "0.05"
            left: "0.15"
            border: "none"
            FontSize: "18"
            backgroundColor: "0x2988e6"
            color: "0xffffff"
            textAlign:
              x: center
          onClick:
            - actionType: evalObject
              object:
                - .Global.setSchedule.scheduleTypeNumber@: 196611
                - .Global.setSchedule.scheduleType@: "Telemedicine"
                - .Global.currentSchdule@: ""
                - if:
                    - =.AvailableProfileTelemedicine.getSchedule.schedule.edge.0.id
                    - .Global.currentSchdule@: =..getSchedule.schedule.edge.0
                    - continue
            - goto: CreateAvailability
    - type: view
      contentType: messageHidden
      style:
        top: "0.15"
        left: "0"
        width: "1"
        height: "0.84"
        isHidden: "true"
        zIndex: "20"
        backgroundColor: "0xffffff"
      children:
        - type: view
          style:
            left: "0"
            top: "0"
            width: "1"
            height: "0.84"
            backgroundColor: "0xffffffff"
        - type: label
          text: You should create availability settings first, Please click the following button to create availability settings
          style:
            top: "0.05"
            left: "0.1"
            width: "0.8"
            fontSize: .Nfont.h16
            textAlign:
              x: center
        - type: button
          text: Create Now
          style:
            top: "0.23"
            width: "0.7"
            height: "0.05"
            left: "0.15"
            border: "none"
            fontSize: "18"
            backgroundColor: "0x2988e6"
            color: "0xffffff"
            textAlign:
              x: center
          onClick:
            - actionType: evalObject
              object:
                - .Global.setSchedule.scheduleTypeNumber@: 196611
                - .Global.setSchedule.scheduleType@: "Telemedicine"
            - goto: CreateAvailability
