Cov19ResultsAndFluResults:
  title: COVID-19 Results & Flu A&B Results
  pageNumber:
  init: #Page initialization
    - .SignInCheck
    - =.builtIn.utils.createAuditLog:
        dataIn:
          actionTypeCode: .ActionTypeCode.view
          recordTypeCode: 138241
          eid: =.Global.formData.currentFacility.relationEdge.id
          user: =.Global.MyProfile.name.data.fullName
          userId: =.Global.currentUser.vertex.id
          targetUserId: =.Global.formData.auditLog.patientId
          accessPort: provider
        dataOut: Global.formData.auditLog.result
    # 记录下载行为
    - .Global.formData.auditLog.actionTypeCode@: =.ActionTypeCode.download
    - .Global.formData.auditLog.recordTypeCode@: 138241
    - ..formData@: =.Global.Note
    - actionType: evalObject
      object:
        .Global._nonce@:
          =.builtIn.math.random: ""

    - actionType: evalObject
      object:
        - if:
            - =.builtIn.string.equal:
                dataIn:
                  string1: =..formData.name.data.antigen.antigenResults
                  string2: ""
            - continue
            - actionType: evalObject
              object:
                - ..formDataTemp.antigen.flag@: "block"
                - ..formDataTemp.antigen.textFlag@: "none"
        - if:
            - =.builtIn.string.equal:
                dataIn:
                  string1: =..formData.name.data.antibody.antibodylgGResults
                  string2: ""
            - continue
            - actionType: evalObject
              object:
                - ..formDataTemp.antibodyLG.flag@: "block"
                - ..formDataTemp.antibodyLG.textFlag@: "none"
        - if:
            - =.builtIn.string.equal:
                dataIn:
                  string1: =..formData.name.data.antibody.antibodylgMResults
                  string2: ""
            - continue
            - actionType: evalObject
              object:
                - ..formDataTemp.antibodyLM.flag@: "block"
                - ..formDataTemp.antibodyLM.textFlag@: "none"
        - if:
            - =.builtIn.string.equal:
                dataIn:
                  string1: =..formData.name.data.fluResults
                  string2: ""
            - continue
            - actionType: evalObject
              object:
                - ..formDataTemp.fluResults.flag@: "block"
                - ..formDataTemp.fluResults.textFlag@: "none"
    - actionType: evalObject
      object:
        - if:
            - =.builtIn.string.equal:
                dataIn:
                  string1: =..formData.name.data.statusTag.name
                  string2: "Released"
            - continue
            - ..formDataTemp.downFlag@: "none"

    # 判断签名是否存在
    - actionType: evalObject
      object:
        - if:
            - =.Cov19ResultsAndFluResults.formData.name.data.MAsignature
            - ..formData.displaySign@: "block"
            - ..formData.displaySign@: "none"

        # 下载pdf的样式控制
        - .Global.formData.downloadPDF.titleName@: "COVID-19 Results & Flu A&B Results"
        - .Global.formData.downloadPDF.scaleX@: 0.85
        - .Global.formData.downloadPDF.scaleY@: 0.85
        - .Global.formData.downloadPDF.originX@: 0
        - .Global.formData.downloadPDF.originY@: 0
  formData:
    # 控制签名是否显示
    displaySign: "none"

  formDataTemp: #Input data temp here, datatemp should not mix with formData
    downFlag: "inline-block"
    antigen:
      flag: "none"
      textFlag: "block"
    antibodyLG:
      flag: "none"
      textFlag: "block"
    antibodyLM:
      flag: "none"
      textFlag: "block"
    fluResults:
      flag: "none"
      textFlag: "block"
  components:
    - .BasePublicHeader:
      children:
        - .BasePublicHeaderLeft:
        - .BasePublicHeaderTitle:
          style:
            fontSize: .Nfont.h14
        - .BasePublicHeaderMenu:
          style:
            display: ..formDataTemp.downFlag
    - type: scrollView
      viewTag: mainView
      style:
        width: "1"
        height: "0.94"

      children:
        - type: view
          style:
            marginLeft: "0.04"
            marginTop: "0.0246"
            height: "auto"
            width: "0.92"
          children:
            - type: image
              path: office-building.svg
              path=func: .builtIn.utils.prepareDocToPath
              dataKey: formData.name.data.facilityInfo.facilityAvatarID
              style:
                verticalAlign: middle
                display: "inline-block"
                height: "0.0578"
                width: "5.78vh"
            - type: view
              style:
                verticalAlign: middle
                marginLeft: "0.08"
                display: "inline-block"
                height: "auto"
                width: "0.71"
                overflow: hidden
              children:
                - type: label
                  dataKey: formData.name.data.facilityInfo.facilityName
                  style:
                    width: "0.71"
                    height: "auto"
                    fontSize: .Nfont.h20
                    fontWeight: "600"

                    verticalAlign: middle
                    wordWrap: break-word
                - type: label
                  dataKey: formData.name.data.facilityInfo.address
                  style:
                    marginTop: "0.0110"
                    width: "0.71"
                    height: "auto"
                    fontSize: .Nfont.h14
                    color: "0x666666"

                    verticalAlign: middle
                    wordWrap: break-word
        - type: view
          style:
            marginLeft: "0.04"
            marginTop: "0.00738"
            width: "0.92"
            height: "auto"
            overflow: hidden
          children:
            - .DocPublicStyleOneBox:
              children:
                - .DocPublicStyleOneLeft:
                  text: Email
                - .DocPublicStyleOneRight:
                  dataKey: formData.name.data.facilityInfo.email
            - .DocPublicStyleOneBox:
              children:
                - .DocPublicStyleOneLeft:
                  text: Website
                - .DocPublicStyleOneRight:
                  dataKey: formData.name.data.facilityInfo.website
            - .DocPublicStyleOneBox:
              children:
                - .DocPublicStyleOneLeft:
                  text: "Main #"
                - .DocPublicStyleOneRight:
                  dataKey: formData.name.data.facilityInfo.facilityName
            - .DocPublicStyleOneBox:
              children:
                - .DocPublicStyleOneLeft:
                  text: "Fax #"
                - .DocPublicStyleOneRight:
                  dataKey: formData.name.data.facilityInfo.fax

        - .DocPublicLine:
        - type: view
          style:
            marginLeft: "0.04"
            marginTop: "0.00738"
            width: "0.92"
            height: "auto"
            overflow: hidden
          children:
            - type: label
              text: Company Address where test admintered
              style:
                marginTop: "0.0246"
                width: "0.92"
                height: "auto"
                color: "0x333333"
                fontSize: .Nfont.h14
                fontWeight: "600"
            - type: view
              style:
                marginTop: "0.01847"
                width: "0.92"
                height: "auto"
              children:
                - type: image
                  path: selectOnBlue.svg
                  style:
                    display: "inline-block"
                    verticalAlign: top
                    height: "0.0197"
                - type: label
                  dataKey: formData.name.data.companyAddress
                  style:
                    marginLeft: "0.02"
                    display: "inline-block"
                    verticalAlign: top
                    lineHeight: "2.5vh"
                    fontSize: .Nfont.h14
                    height: "auto"
                    width: "0.856"
                    wordWrap: break-word
            - .DocPublicStyleTwoBox:
              style:
                marginTop: "0.0246"
              children:
                - .DocPublicStyleTwoLeft:
                  text: Exam Date
                - .DocPublicStyleTwoRight:
                  text=func: .builtIn.string.formatUnixtime_en
                  dataKey: formData.name.data.patientInfo.examDate
            - .DocPublicStyleTwoBox:
              children:
                - .DocPublicStyleTwoLeft:
                  text: Patient Name
                - .DocPublicStyleTwoRight:
                  dataKey: formData.name.data.patientInfo.patientName
            - .DocPublicStyleTwoBox:
              children:
                - .DocPublicStyleTwoLeft:
                  text: Date of Birth
                - .DocPublicStyleTwoRight:
                  dataKey: formData.name.data.patientInfo.dob
            - .DocPublicStyleTwoBox:
              children:
                - .DocPublicStyleTwoLeft:
                  text: "Phone #"
                - .DocPublicStyleTwoRight:
                  dataKey: formData.name.data.patientInfo.phone
            - .DocPublicStyleTwoBox:
              children:
                - .DocPublicStyleTwoLeft:
                  text: "Email"
                - .DocPublicStyleTwoRight:
                  dataKey: formData.name.data.patientInfo.email
            - .DocPublicStyleTwoBox:
              children:
                - .DocPublicStyleTwoLeft:
                  text: "Patient Address"
            - .DocPublicStyleTwoBox:
              children:
                - .DocPublicStyleTwoLeft:
                  dataKey: formData.name.data.patientInfo.address
                  style:
                    height: "auto"
                    width: "0.92"
                    fontSize: .Nfont.h14
                    wordWrap: break-word
                    color: "0x333333"
                    fontWeight: "600"
        - .DocPublicLine:
        - type: label
          text: "OFFICE USE ONLY"
          dataKey:
          style:
            marginTop: "0.0246"
            marginLeft: "0.04"
            width: "0.92"
            height: "auto"
            fontSize: .Nfont.h14
            fontWeight: "600"
            color: "0x333333"
        - type: view
          style:
            marginTop: "0.0123"
            marginLeft: "0.04"
            height: "auto"
            width: "0.92"
            overflow: hidden
          children:
            - .publicTextBox:
              children:
                - .publicTextTitle:
                  text: Date of Test
                - .publicTextValue:
                  dataKey: formData.name.data.dateOfTest
            - .publicTextBox:
              children:
                - .publicTextTitle:
                  text: Providers name
                  dataKey:
                - .publicTextValue:
                  dataKey: formData.name.data.providerName
        - type: view
          style:
            marginTop: "0.0246"
            marginLeft: "0.04"
            height: "auto"
            width: "0.92"
            border:
              style: 3
            borderColor: "0xdedede"
            borderWidth: "2px"
            boxSizing: border-box
            overflow: hidden
          children:
            - type: label
              text: COVID-19 Rapid Antigen Test Results
              style:
                marginTop: "0.0246"
                fontSize: .Nfont.h14
                fontWeight: "600"
                width: "0.92"
                height: "auto"
                color: "0x333333"
                textAlign:
                  x: center
            - type: label
              text: "Test kit name/Manufacture:"
              style:
                marginTop: "0.01847"
                marginLeft: "0.04"
                fontSize: .Nfont.h14
                width: "0.88"
                height: "auto"
                color: "0x333333"
            - type: label
              text: "Carestart COVID-19 Antigen Test"
              style:
                marginTop: "0.01"
                marginLeft: "0.04"
                fontSize: .Nfont.h14
                fontWeight: "600"
                width: "0.88"
                height: "auto"
                color: "0x333333"
            - type: label
              text: "Rapid COVID-19 Antigen Testing results"
              style:
                marginTop: "0.0246"
                marginLeft: "0.04"
                fontSize: .Nfont.h14
                fontWeight: "600"
                width: "0.88"
                height: "auto"
                color: "0x333333"
            - type: label
              text: "--"
              style:
                display: ..formDataTemp.antigen.textFlag
                marginTop: "0.01"
                marginLeft: "0.04"
                height: "auto"
                width: "0.2"
                boxSizing: border-box
                fontSize: .Nfont.h18
            - type: view
              style:
                display: ..formDataTemp.antigen.flag
                width: "auto"
                height: "auto"
              children:
                - type: label
                  dataKey: formData.name.data.antigen.antigenResults
                  style:
                    marginTop: "0.01"
                    marginLeft: "0.04"
                    border:
                      style: 3
                    borderColor: ..formData.name.data.antigen.antigenResultsColor
                    borderWidth: "2px"
                    color: ..formData.name.data.antigen.antigenResultsColor
                    height: "0.04"
                    width: "0.2"
                    boxSizing: border-box
                    fontSize: .Nfont.h14
                    textAlign:
                      x: "center"
                      y: "center"
            - type: view
              style:
                marginTop: "0.02"
                marginLeft: "0.04"
                width: "0.92"
                height: "auto"
              children:
                - type: view
                  style:
                    display: "inline-block"
                    height: "auto"
                    width: "0.4"
                  children:
                    - type: label
                      text: "LOT #"
                      style:
                        display: "inline-block"
                        fontSize: .Nfont.h12
                        width: "auto"
                        height: "auto"
                        color: "0x666666"
                        verticalAlign: middle
                    - type: label
                      dataKey: formData.name.data.antigen.lot
                      style:
                        marginLeft: "0.02"
                        display: "inline-block"
                        fontSize: .Nfont.h14
                        fontWeight: "600"
                        width: "0.25"
                        height: "auto"
                        color: "0x333333"
                        wordWrap: break-word
                        verticalAlign: middle
                - type: view
                  style:
                    display: "inline-block"
                    height: "auto"
                    width: "0.4"
                  children:
                    - type: label
                      text: "Expiration"
                      style:
                        display: "inline-block"
                        fontSize: .Nfont.h12
                        width: "auto"
                        height: "auto"
                        color: "0x666666"
                        verticalAlign: middle
                    - type: label
                      dataKey: formData.name.data.antigen.expiration
                      style:
                        marginLeft: "0.02"
                        display: "inline-block"
                        fontSize: .Nfont.h14
                        fontWeight: "600"
                        width: "0.2"
                        height: "auto"
                        color: "0x333333"
                        verticalAlign: middle
            - type: view
              style:
                marginTop: "0.02"
        - type: view
          style:
            marginTop: "0.0246"
            marginLeft: "0.04"
            height: "auto"
            width: "0.92"
            border:
              style: 3
            borderColor: "0xdedede"
            borderWidth: "2px"
            boxSizing: border-box
            overflow: hidden
          children:
            - type: label
              text: COVID-19 Rapid Antibody Test Results
              style:
                marginTop: "0.0246"
                fontSize: .Nfont.h14
                fontWeight: "600"
                width: "0.92"
                height: "auto"
                color: "0x333333"
                textAlign:
                  x: center
            - type: label
              text: "Test kit name/Manufacture:"
              style:
                marginTop: "0.01847"
                marginLeft: "0.04"
                fontSize: .Nfont.h14
                width: "0.88"
                height: "auto"
                color: "0x333333"
            - type: label
              text: "Healgen COVID-19 Antibody IgG/IgM Test"
              style:
                marginTop: "0.01"
                marginLeft: "0.04"
                fontSize: .Nfont.h14
                fontWeight: "600"
                width: "0.88"
                height: "auto"
                color: "0x333333"
            - type: label
              text: "Rapid COVID-19 Antibody IgG"
              style:
                marginTop: "0.0246"
                marginLeft: "0.04"
                fontSize: .Nfont.h14
                fontWeight: "600"
                width: "0.88"
                height: "auto"
                color: "0x333333"
            - type: label
              text: "--"
              style:
                display: ..formDataTemp.antibodyLG.textFlag
                marginTop: "0.01"
                marginLeft: "0.04"
                height: "auto"
                width: "0.2"
                boxSizing: border-box
                fontSize: .Nfont.h18
            - type: view
              style:
                display: ..formDataTemp.antibodyLG.flag
                width: "auto"
                height: "auto"
              children:
                - type: label
                  dataKey: formData.name.data.antibody.antibodylgGResults
                  style:
                    marginTop: "0.01"
                    marginLeft: "0.04"
                    border:
                      style: 3
                    borderColor: ..formData.name.data.antibody.antibodylgGResultsColor
                    borderWidth: "2px"
                    color: ..formData.name.data.antibody.antibodylgGResultsColor
                    height: "0.04"
                    width: "0.2"
                    boxSizing: border-box
                    fontSize: .Nfont.h14
                    textAlign:
                      x: "center"
                      y: "center"
            - type: label
              text: "Rapid COVID-19 Antibody IgM"
              style:
                marginTop: "0.02"
                marginLeft: "0.04"
                fontSize: .Nfont.h14
                fontWeight: "600"
                width: "0.88"
                height: "auto"
                color: "0x333333"
            - type: label
              text: "--"
              style:
                display: ..formDataTemp.antibodyLM.textFlag
                marginTop: "0.01"
                marginLeft: "0.04"
                height: "auto"
                width: "0.2"
                boxSizing: border-box
                fontSize: .Nfont.h18
            - type: view
              style:
                display: ..formDataTemp.antibodyLM.flag
                width: "auto"
                height: "auto"
              children:
                - type: label
                  dataKey: formData.name.data.antibody.antibodylgMResults
                  style:
                    marginTop: "0.01"
                    marginLeft: "0.04"
                    border:
                      style: 3
                    borderColor: ..formData.name.data.antibody.antibodylgMResultsColor
                    borderWidth: "2px"
                    color: ..formData.name.data.antibody.antibodylgMResultsColor
                    height: "0.04"
                    width: "0.2"
                    boxSizing: border-box
                    fontSize: .Nfont.h14
                    textAlign:
                      x: "center"
                      y: "center"

            - type: view
              style:
                marginTop: "0.02"
                marginLeft: "0.04"
                width: "0.92"
                height: "auto"
              children:
                - type: view
                  style:
                    display: "inline-block"
                    height: "auto"
                    width: "0.4"
                  children:
                    - type: label
                      text: "LOT #"
                      style:
                        display: "inline-block"
                        fontSize: .Nfont.h12
                        width: "auto"
                        height: "auto"
                        color: "0x666666"
                        verticalAlign: middle
                    - type: label
                      dataKey: formData.name.data.antibody.lot
                      style:
                        marginLeft: "0.02"
                        display: "inline-block"
                        fontSize: .Nfont.h14
                        fontWeight: "600"
                        width: "0.25"
                        height: "auto"
                        color: "0x333333"
                        wordWrap: break-word
                        verticalAlign: middle
                - type: view
                  style:
                    display: "inline-block"
                    height: "auto"
                    width: "0.4"
                  children:
                    - type: label
                      text: "Expiration"
                      style:
                        display: "inline-block"
                        fontSize: .Nfont.h12
                        width: "auto"
                        height: "auto"
                        color: "0x666666"
                    - type: label
                      dataKey: formData.name.data.antibody.expiration
                      style:
                        marginLeft: "0.02"
                        display: "inline-block"
                        fontSize: .Nfont.h14
                        fontWeight: "600"
                        width: "0.2"
                        height: "auto"
                        color: "0x333333"
            - type: view
              style:
                marginTop: "0.02"

        - type: view
          style:
            marginTop: "0.0246"
            marginLeft: "0.04"
            height: "auto"
            width: "0.92"
            border:
              style: 3
            borderColor: "0xdedede"
            borderWidth: "2px"
            boxSizing: border-box
            overflow: hidden
          children:
            - type: label
              text: FLU A&B Results
              style:
                marginTop: "0.0246"
                fontSize: .Nfont.h14
                fontWeight: "600"
                width: "0.92"
                height: "auto"
                color: "0x333333"
                textAlign:
                  x: center
            - type: label
              text: "FLU A&B Test results"
              style:
                marginTop: "0.01847"
                marginLeft: "0.04"
                fontSize: .Nfont.h14
                fontWeight: "600"
                width: "0.88"
                height: "auto"
                color: "0x333333"
            - type: label
              text: "--"
              style:
                display: ..formDataTemp.fluResults.textFlag
                marginTop: "0.01"
                marginLeft: "0.04"
                height: "auto"
                width: "0.2"
                boxSizing: border-box
                fontSize: .Nfont.h18
            - type: view
              style:
                display: ..formDataTemp.fluResults.flag
                width: "auto"
                height: "auto"
              children:
                - type: label
                  dataKey: formData.name.data.fluResults
                  style:
                    marginTop: "0.01"
                    marginLeft: "0.04"
                    border:
                      style: 3
                    borderColor: ..formData.name.data.fluResultsColor
                    borderWidth: "2px"
                    color: ..formData.name.data.fluResultsColor
                    height: "0.04"
                    width: "0.2"
                    boxSizing: border-box
                    fontSize: .Nfont.h14
                    textAlign:
                      x: "center"
                      y: "center"
            - type: view
              style:
                marginTop: "0.02"

        - type: label
          textBoard:
            - text: "The undersigned,&ensp;"
              color: "0x333333"
            - text: "A&C Urgent Care"
              dataKey: formData.name.data.facilityInfo.facilityName
              color: "0x005795"
              fontWeight: "600"
            - text: "&ensp;MA has been"
              color: "0x333333"
            - text: " notified and authorizes release of results."
              color: "0x333333"
          style:
            marginTop: "0.03"
            marginLeft: "0.04"
            height: "auto"
            width: "0.85"
            lineHeight: "2vh"
            fontSize: .Nfont.h14
            wordWrap: break-word
        - .DocPublicLine:
        - .publicTextBox:
          style:
            marginTop: "0.0246"
            marginLeft: "0.04"
            height: "auto"
            width: "0.92"
            overflow: hidden
          children:
            - .publicTextTitle:
              text: MA's Print Name
              style:
                fontSize: .Nfont.h12
              dataKey:
            - .publicTextValue:
              dataKey: formData.name.data.MAname

        - type: view
          style:
            marginLeft: "0.04"
            marginTop: "0.0246"
            width: "0.92"
            height: "auto"
            overflow: hidden
          children:
            - type: view
              style:
                height: "auto"
                width: "0.92"
              children:
                - type: label
                  text: "MA's Signature"
                  style:
                    display: "inline-block"
                    width: "0.816"
                    fontSize: .Nfont.h14
                    height: "auto"
                    color: "0x333333"
                    fontWeight: "600"
                    textAlign:
                      x: left
        - type: view
          style:
            marginLeft: "0.04"
            marginTop: "0.01"
            height: "0.128"
            width: "0.9"
            border:
              style: "4"
              color: "0xa9a9a9"
            borderWidth: "2"
          children:
            - type: label
              text: X
              style:
                .SignLabelStyle:
            # 显示暂存的签名
            - type: image
              viewTag: signatureShowTag
              path=func: .builtIn.utils.prepareDocToPath
              # 传入签名文档的id
              dataKey: formData.name.data.MAsignature
              style:
                left: "0"
                width: "0.88"
                top: "0"
                height: "0.128"
                overflow: scroll
                zIndex: "1000"
                display: ..formData.displaySign

        - type: view
          style:
            marginLeft: "0.04"
            marginTop: "0.0146"
            width: "0.92"
            height: "auto"
            overflow: hidden
            display: ..formData.displaySign
          children:
            - type: view
              viewTag: signatureTimeTag
              style:
                marginTop: "0.01"
                height: "auto"
                width: "0.92"
              children:
                - type: label
                  text=func: .builtIn.string.formatUnixtime_en
                  dataKey: formData.name.data.signatureTime
                  style:
                    display: "inline-block"
                    width: "auto"
                    height: "auto"
                    fontSize: .Nfont.h12
                    color: "0x757575"
                    verticalAlign: middle
                - type: label
                  text: "Digitally Signed"
                  style:
                    marginLeft: "0.02"
                    display: "inline-block"
                    width: "auto"
                    height: "auto"
                    fontSize: .Nfont.h12
                    color: "0x757575"
                    verticalAlign: middle
            - type: view
              style:
                marginTop: "0.01"
                width: "auto"
                height: "auto"
              children:
                - type: label
                  text: Date
                  style:
                    display: "inline-block"
                    width: "auto"
                    height: "auto"
                    color: "0x666666"
                    fontSize: .Nfont.h12
                - type: label
                  text=func: .builtIn.string.formatUnixtimeL_en
                  dataKey: formData.ctime
                  style:
                    marginLeft: "0.0373"
                    display: "inline-block"
                    width: "auto"
                    height: "auto"
                    color: "0x333333"
                    fontSize: .Nfont.h12
                    fontWeight: "600"
        - type: view
          style:
            marginTop: "0.03"
    - .HeaderPopUpMenu:
