MedicalRecommendation:
  title: "Medical Recommendation"
  init:
    - actionType: evalObject
      object:
        .Global._nonce@:
          =.builtIn.math.random: ""
    # 查回superadmin设置的production
    - =..apiRequest.good.docAPI.get: ""
    - .MedicalRecommendation.formData.productionList@: =..apiRequest.good.docQueryResp.doc
    # 获取本地选中的商品
    - ..formData.selectedProductList@: =.Global.formData.productionSelectionList
    - ..formData.selectedProductNameList@: =.Global.formData.goodNameList
  apiRequest:
    good:
      docQueryResp: ""
      docQueryReq:
        ObjType: 8
        id: .Config.superAdminID
        xfname: E.bvid
        type: .DocType.Production
        sCondition: E.type = 10000 && D.tage = 1
        _nonce: .Global._nonce
        maxcount: 1000
        obfname: ctime
      docAPI:
        get:
          api: rd
          dataIn: MedicalRecommendation.apiRequest.good.docQueryReq
          dataOut: MedicalRecommendation.apiRequest.good.docQueryResp
  formData:
    selectedProductList: []
    selectedProductNameList: []
    productionList: []
  components:
    - .BasePublicHeader:
        children:
          - .BasePublicHeaderLeft:
            leftClick:
              - actionType: evalObject
                object:
                  - if:
                      - =.builtIn.string.equal:
                          dataIn:
                            string1: =.Global.formData.entrancePageName
                            string2: "MenuBars"
                      - goto: =.Global.formData.backPageName
                      - actionType: builtIn
                        funcName: goBack
                        reload: true
          - .BasePublicHeaderTitle:
    - type: view
      style:
        ..style.splitBox:
      children:
        - type: label
          text: Recommendations
          style:
            ..style.titleLable:
        - type: label
          text: View Diagnoses
          onClick:
            - ..event.viewDiagnoses
          style:
            ..style.jumpLabel:
    - type: view
      style:
        ..style.searchBox:
      children:
        - type: image
          path: search.svg
          style:
            ..style.searchImg:
        - type: textField
          placeholder: Search
          dataKey:
          style:
            ..style.searchInput:
        - type: label
          text: Search
          style:
            ..style.searchLabel:

    - type: scrollView
      style:
        ..style.scrollBox:
      children:
        - type: list
          contentType: listObject
          listObject: ..formData.productionList
          iteratorVar: itemObject
          style:
            ..style.list:
          children:
            - type: listItem
              itemObject:
              style:
                ..style.item:
              children:
                - type: view
                  style:
                    height: auto
                    width: auto
                  children:
                    - type: view
                      style:
                        ..style.itemInlineBox:
                      onClick:
                        - ..event.itemClick
                      children:
                        - type: view
                          style:
                            ..style.inlineBox:
                          children:
                            - type: image
                              path: good.svg
                              path=func: .builtIn.utils.prepareDocToPath
                              dataKey: itemObject.name.data.coverImgId
                              style:
                                ..style.goodImg:
                            - type: label
                              dataKey: itemObject.name.data.basicInfo.type
                              style:
                                ..style.goodValue:
                                textAlign:
                                  x: center
                                color: itemObject.name.data.basicInfo.typeColor
                        - type: view
                          style:
                            ..style.goodContent:
                          children:
                            - type: label
                              dataKey: itemObject.name.data.basicInfo.title
                              style:
                                ..style.goodTitle:
                            - type: label
                              dataKey: itemObject.name.data.basicInfo.introduction
                              style:
                                ..style.goodDescribe:
                            - type: label
                              textBoard:
                                - text: $
                                - text: "&nbsp;"
                                - text: "0"
                                  dataKey: itemObject.name.data.pricing.price
                              style:
                                ..style.goodPrice:

                    - type: image
                      viewTag: productionListTag
                      path:
                        ..event.selectPath:
                      style:
                        ..style.addImg:
                      onClick:
                        - ..event.addImg

        - type: view
          style:
            marginTop: "0.03"
    - type: view
      style:
        ..style.btnBox:
      children:
        - type: view
          style:
            ..style.auto:
          children:
            - .DocButtonPrivate:
              text: Cancel
              onClick:
                - ..event.cancelClick
            - .DocButtonRelease:
              text: Selection
              onClick:
                - ..event.selectionClcik
  event:
    selectPath:
      emit:
        dataKey:
          var: itemObject
        actions:
          - if:
              - =.builtIn.array.has:
                  dataIn:
                    object: =..formData.selectedProductList
                    value: $var.id
              - cancelGreen.svg
              - addBlue.svg

    addImg:
      - emit:
          dataKey:
            var: itemObject
          actions:
            - if:
                - =.builtIn.array.has:
                    dataIn:
                      object: =..formData.selectedProductList
                      value: $var.id
                - =.builtIn.array.removeByValue:
                    dataIn:
                      object: =..formData.selectedProductList
                      value: $var.id
                - =.builtIn.array.add:
                    dataIn:
                      object: =..formData.selectedProductList
                      value: $var.id
            - if:
                - =.builtIn.array.has:
                    dataIn:
                      object: =..formData.selectedProductNameList
                      value: $var.name.data.basicInfo.title
                - =.builtIn.array.removeByValue:
                    dataIn:
                      object: =..formData.selectedProductNameList
                      value: $var.name.data.basicInfo.title
                - =.builtIn.array.add:
                    dataIn:
                      object: =..formData.selectedProductNameList
                      value: $var.name.data.basicInfo.title
      - actionType: evalObject
        object:
          # 更新本地下的选中的商品列表和商品名称
          - .Global.formData.productionSelectionList@: =..formData.selectedProductList
          - .Global.formData.goodNameList@: =..formData.selectedProductNameList
      - actionType: builtIn
        funcName: redrawCurrent
        viewTag: productionListTag
    viewDiagnoses:
      - actionType: evalObject
        object:
          - goto: DiagnosesView
    itemClick:
      - emit:
          dataKey:
            var: itemObject
          actions:
            - .Global.formData.production@: $var
      - goto: ProductDetails
    selectionClcik:
      - actionType: evalObject
        object:
          # 判断本地Global.formData.providerDoc.recommendationDoc是否存在
          - if:
              - =.Global.formData.providerDoc.recommendationDoc.id
              - actionType: evalObject
                object:
                  - .Global.formData.providerDoc.recommendationDoc.name.data.goodsList@: =.Global.formData.productionSelectionList
                  - .Global.formData.providerDoc.recommendationDoc.name.data.goodNameList@: =.Global.formData.goodNameList
              - continue
          - goto: SelectRecommendation
    cancelClick:
      - actionType: builtIn
        funcName: goBack
        reload: true
  style:
    scrollBox:
      width: "1"
      height: "0.7561576"
      boxSizing: "border-box"
      overflow: "scroll"
    btnBox:
      width: "1"
      height: "0.0972"
      boxSizing: "border-box"
      overflow: "scroll"
      backgroundColor: "#ffffff"
      boxShadow: "1px 1px 4px 1px #dededf"
      textAlign:
        x: center
    splitBox:
      height: "0.0394088"
      width: "1"
      backgroundColor: "#f0f0f0"
      overflow: hidden
    titleLable:
      marginLeft: "0.04"
      color: "#333333"
      width: "0.6933333"
      display: "inline-block"
      fontSize: .Nfont.h14
      fontWeight: "600"
      lineHeight: 3.94088vh
    jumpLabel:
      color: "#2988e6"
      display: "inline-block"
      fontSize: .Nfont.h12
      lineHeight: 3.94088vh
      fontWeight: "600"
      textDecoration: underline
    searchBox:
      marginLeft: "0.04"
      marginTop: "0.01"
      width: "0.92"
      height: "0.04187192"
      overflow: hidden
      border:
        style: 3
      borderColor: "#2988e6"
      borderWidth: "1.5"
      borderRadius: "2.09vh"
      boxSizing: "border-box"
    searchImg:
      marginLeft: "0.032"
      display: "inline-block"
      height: "0.022167"
      verticalAlign: middle
    searchInput:
      display: "inline-block"
      marginLeft: "0.032"
      border: "none"
      height: "0.0369458"
      width: "0.613333"
      boxSizing: "border-box"
      verticalAlign: middle
    searchLabel:
      display: "inline-block"
      marginLeft: "0.032"
      boxSizing: "border-box"
      verticalAlign: middle
      fontSize: .Nfont.h14
      fontWeight: "600"
      color: "#2988e6"
    list:
      width: "1"
      margin: "0"
      marginLeft: "0"
      height: "auto"
    item:
      width: "0.92"
      height: "auto"
      marginTop: "0.0123"
      marginLeft: "0.04"
      borderRadius: "12"
      overflow: hidden
      backgroundColor: "0xffffff"
      boxShadow: "0px 3px 10px #dededf"
      paddingLeft: "0.025"
      # paddingRight: "0.04"
      paddingTop: "0.014778"
      paddingBottom: "0.014778"
      boxSizing: "border-box"
    itemInlineBox:
      display: "inline-block"
      width: "auto"
      height: "auto"
      overflow: hidden
      verticalAlign: middle
    inlineBox:
      display: "inline-block"
      width: "0.186"
      height: "auto"
      overflow: hidden
      textAlign:
        x: center
    goodImg:
      height: "0.086"
    goodValue:
      marginTop: "0.0025"
      fontSize: .Nfont.h12
      color: itemObject.type.color
      fontWeight: "600"
      width: "0.186"
      overflow: hidden
      textAlign:
        x: center
    goodContent:
      marginLeft: "0.02133333"
      display: "inline-block"
      width: "0.605333"
      boxSizing: "border-box"
      height: "auto"
      overflow: hidden
    goodTitle:
      width: "0.605333"
      height: "auto"
      fontSize: .Nfont.h14
      color: "#333333"
      fontWeight: "600"
      boxSizing: "border-box"
      lineHeight: "2.58vh"
      -webkit-line-clamp: 2
      display: -webkit-box
      -webkit-box-orient: vertical
      overflow: hidden
      text-overflow: ellipsis
    goodDescribe:
      width: "0.605333"
      height: "auto"
      color: "#666666"
      fontSize: .Nfont.h12
      boxSizing: "border-box"
      -webkit-line-clamp: 2
      display: -webkit-box
      -webkit-box-orient: vertical
      overflow: hidden
      text-overflow: ellipsis
    goodPrice:
      marginTop: "0.01"
      color: "#fb5051"
      fontSize: .Nfont.h16
      fontWeight: "700"
    addImg:
      marginLeft: "0.005"
      display: "inline-block"
      verticalAlign: middle
      height: "0.022"
    auto:
      width: auto
      height: auto
