VideoChat:
  pageNumber: "190"
  init:
    # - .SignInCheck
    # - if:
    #     - =.Global.roomInfoDoc.document.deat.roomID # 'true', 'false'
    #     - continue
    #     - goto: Dashboard
    - actionType: evalObject
      object:
        .Global._nonce@:
          =.builtIn.math.random: ""
    - actionType: evalObject
      object:
        - ..cameraOn@: =.Global.cameraOn
        - ..micOn@: =.Global.micOn
    - actionType: builtIn
      funcName: videoChat
      roomId: .Global.roomInfoDoc.document.deat.roomID
      accessToken: .Global.roomInfoDoc.document.deat.accessToken
      timerTag: videoTimer
      timer: .Global.timer # timer object is to be removed after web and iOS implemented builtIn
    # auto-disconnect; initialize
    - actionType: builtIn
      funcName: initExtend
      timePerExtendSeconds: 300 # 5 mins
      numberofExtensions: 0
      popUpWaitSeconds: 30
      meetingEndTime: .Global.roomInfo.edge.etime
    - actionType: builtIn
      funcName: initConnectTimeout
      timeoutSeconds: 10
    - if:
        - .builtIn.isAndroid
        - ..isWorkingStethoscope@: block
        - ..isWorkingStethoscope@: none     
  isWorkingStethoscope: ""   
  formData:
    currentTime: ""
  empty: ""
  cameraOn: "true"
  micOn: "true"
  miuAutoMicOffTimespan: "3" # seconds
  miuAutoMicOffThresdhold: "3" # mic volume calibrate between 0 to 9, <= 3 will turn micOff Automatically if user set the mic is on. Mic will not turn on automatically within the minAutoMicOffTimespan even a higher level of volumn detectec.
  apiRequest:
    appointment:
      edgeQueryResp: ""
      edgeQueryReq:
        id: .Global.roomInfo.edge.id
      edgeAPI:
        get:
          api: re
          dataIn: VideoChat.apiRequest.appointment.edgeQueryReq
          dataOut: VideoChat.apiRequest.appointment.edgeQueryResp
    # change meetingTag
    appointmentTag:
      docCreateResp: ""
      docCreateReq:
        name:
          data: ""
        type: .DocType.GroupBitOrTage
        eid: .Global.currentRoom.edge.id
        reid: .Global.roomInfo.edge.id
        tage: "0"
      docAPI:
        store:
          api: cd
          dataIn: VideoChat.apiRequest.appointmentTag.docCreateReq
          dataOut: VideoChat.apiRequest.appointmentTag.docCreateResp
    # newVideoMessage:
    #   response: ""
    #   document:
    #     eid: .Global.currentRoom.edge.id
    #     reid: .Global.currentRoom.edge.id
    #     subtype:
    #       isOnServer: 1
    #       isZipped: 0
    #       isBinary: 0
    #       isEncrypted: 0
    #       isExtraKeyNeeded: 0
    #       isEditable: 0
    #       applicationDataType: 8
    #       # 7 th bit
    #       notification: 1
    #       ringToneNotify: 1
    #       sendtoSelf: 1
    #       # 10 bit
    #       textMessage: 0
    #       mediaType: 8
    #     type: 770
    #     tage: 5
    #     name:
    #       title: textMessage
    #       senderId: .Global.currentUser.vertex.id
    #       senderName: .Global.currentUser.vertex.name.userName
    #       data:
    #         text: ""
    #       notification:
    #         title: New Message From a Doctor
    #         context: click to open the chat page
    #         body: click to open the chat page
    #         onClickLandingPage: ChatPage
    #         targetApp: =.FirebaseToken.response.edge.evid
    #   docAPI:
    #     store:
    #       api: cd
    #       dataIn: apiRequest.newVideoMessage.document
    #       dataOut: apiRequest.newVideoMessage.response
  # N1 only RingTone
  sendNotification:
    document:
      .Document: ""
      eid: ""
      subtype:
        isOnServer: 1
        isZipped: 0
        isBinary: 0
        isEncrypted: 0
        isExtraKeyNeeded: 0
        isEditable: 0
        applicationDataType: 0
        # 7 th bit
        notification: 1
        ringToneNotify: 1
        sendtoSelf: 0
        # 10 bit
        textMessage: 0
        mediaType: 8
      type: .DocType.Notification
      tage: 2
      name:
        data: ""
        #        senderId: ".Global.currentUser.vertex.id"
        #        senderName: ".Global.currentUser.vertex.name.userName"
        #        data:
        #          text: ''
        notification:
          # The content of the notification won't be show since we dont show
          # banner for ringTone notification
          title: A Provider is calling you
          context: Please enter the virutal room
          body: Please enter the virutal room
          landingPage: RingTonePage
          onClickLandingPage: RingTonePage
          targetApp: =.FirebaseToken.response.edge.evid
          caller: =.Global.currentUser.vertex.name.firstName
    docAPI:
      store:
        api: cd
        dataIn: sendNotification.document

  emptyId: ""
  popUpList:
    # - text: "AppointmentLobby"
    #   pageName: "AppointmentLobby2"
    # - text: "Participants/Invite"
    #   pageName: "ParticipantsInvite"
    - text: "Appointment Lobby"
      pageName: "AppointmentLobby"
    - text: "Medical Documents"
      pageName: "ProviderNotes"
    - text: "Invite Participants"
      pageName: "ChooseInvite" # 待修改
    # - text: "Share your screen"
    #   pageName: "ScreenShare"
  popUpListTemp: ""
  components:
    - type: popUp
      viewTag: underconstruction
      style:
        width: "1"
        height: "1"
        top: "0"
        left: "0"
        zIndex: "100"
        backgroundColor: "0x00000033"
      children:
        - type: view
          style:
            left: "0.14"
            top: "0.27"
            width: "0.72"
            height: "0.35"
            backgroundColor: "0xe1e1e1"
            borderRadius: "10"
          children:
            - type: image
              path: aitmedLogoBlack.svg
              style:
                left: "0.25"
                top: "0.02"
                width: "0.18"
            - type: label
              text: Start Screen Share
              style:
                left: "0"
                top: "0.13"
                width: "0.72"
                height: "0.05"
                fontSize: "18"
                fontWeight: "400"
                textAlign:
                  x: center
            - type: label
              text: Everything on your screen will be recorded,including any notifications.Enable Do Not Disturb to avoid notifications being seen.
              style:
                left: "0.08"
                top: "0.175"
                width: "0.56"
                height: "0.1"
                fontSize: "13"
                fontWeight: "400"
                textAlign:
                  x: center
            - type: divider
              style:
                left: "0"
                top: "0.286"
                width: "0.72"
                height: "0.001"
                backgroundColor: "0x8f8f8f"
            - type: divider
              style:
                left: "0.358"
                top: "0.286"
                width: "0.004"
                height: "0.054"
                backgroundColor: "0x8f8f8f"
            - type: button
              text: Cancel
              style:
                width: "0.358"
                left: "0"
                height: "0.052"
                top: "0.296"
                backgroundColor: "0xe1e1e1"
                fontSize: "18"
                color: "0x007bff"
                borderRadius: "10"
                borderWeight: "0"
                textAlign:
                  x: center
                  y: center
              onClick:
                - actionType: popUpDismiss
                  popUpView: underconstruction
            - type: button
              text: Start
              style:
                width: "0.358"
                left: "0.362"
                height: "0.052"
                top: "0.296"
                backgroundColor: "0xe1e1e1"
                fontSize: "18"
                color: "0x007bff"
                borderRadius: "10"
                borderWeight: "0"
                textAlign:
                  x: center
                  y: center
              onClick:
                - actionType: builtIn
                  funcName: screenShare
    - type: register
      onEvent: twilioOnPeopleShowRoom
      actions:
        - actionType: evalObject
          object:
            - ..sendNotification.document.fid@: =.Global.patdAPPID
            - ..sendNotification.document.eid@: =.Global.roomInfo.edge.id
            - =..sendNotification.docAPI.store: ""
    # - type: register
    #   onEvent: onDisconnect
    #   actions:
    #     # dismiss the popup
    #     - actionType: popUpDismiss
    #       popUpView: extendView
    #     - actionType: popUpDismiss
    #       popUpView: minimizeVideoChat
    # leave the meeting
    # - actionType: builtIn
    #   funcName: disconnectMeeting
    # # clear roomDoc
    # - actionType: updateObject # updateObject(dataKey, dataObject, dataObjectKey)
    #   dataKey: Global.roomInfoDoc.document
    #   dataObject: {}
    # - actionType: evalObject
    #   object:
    #     - .Global.timer@: 0
    #     - .Global.micOn@: "true"
    #     - .Global.cameraOn@: "true"
    #   # change roomInfo tage
    # - actionType: evalObject
    #   object:
    #     - =.builtIn.number.inhx:
    #         dataIn:
    #           intHex: =.VideoChat.apiRequest.appointmentTag.docCreateReq.tage
    #           index: 9
    #           hex: 1
    #         dataOut: VideoChat.apiRequest.appointmentTag.docCreateReq.tage
    #     - =.VideoChat.apiRequest.appointmentTag.docAPI.store: ""
    #     - =.VideoChat.apiRequest.appointment.edgeAPI.get: ""
    #     - .Global.roomInfo.edge@: =.VideoChat.apiRequest.appointment.edgeQueryResp.edge.0
    #     - .Global.formData.showBackButton.visitDetail@: "false"
    # - actionType: evalObject
    #   object:
    #     .Global._nonce@:
    #       =.builtIn.math.random: ""
    # - goto: VisitDetial
    - type: register
      onEvent: showExtendView
      actions:
        - actionType: popUp
          popUpView: extendView
    - type: register
      onEvent: showExitWarningView
      actions:
        - actionType: popUp
          popUpView: exitWarningView
          popUpDismiss: 30000
          wait: true
    - type: register
      onEvent: twilioOnPeopleJoin
      actions:
        - actionType: builtIn
          funcName: hide
          viewTag: waitForOtherTag
    # - type: register
    #   onEvent: twilioOnNoParticipant
    #   actions:
    #     - actionType: builtIn
    #       funcName: show
    #       viewTag: waitForOtherTag
    - type: register
      onEvent: onDisconnect
      actions:
        - actionType: builtIn
          funcName: hide
          viewTag: waitForOtherTag
        - actionType: builtIn
          funcName: show
          viewTag: leftTag
    - type: register
      onEvent: showTimeoutPopup
      actions:
        - actionType: popUp
          popUpView: timeoutPopup
          wait: true
    - type: view
      style:
        left: "0"
        top: "0"
        width: "1"
        height: "1"
        zIndex: 10
        backgroundColor: "0xffffff"
      children:
        - type: view
          viewTag: "waitForOtherTag"
          style:
            width: "1"
            top: "0"
            height: "0.8"
            textAlign:
              y: center
          children:
            - type: view
              style:
                width: auto
                height: auto
                textAlign:
                  x: center
              children:
                - type: image
                  path: aitmedLogoBlack.svg
                  style:
                    width: "0.326"
                    height: "auto"
                - type: label
                  text: Connecting...
                  style:
                    width: "1"
                    fontSize: ".Nfont.h16"
                    color: "#333333"
                    fontWeight: "600"
                    marginTop: "0.027"
                    textAlign: 
                      x: center
        - type: view
          viewTag: "leftTag"
          style:
            width: "1"
            top: "0"
            height: "0.8"
            display: "none"
            textAlign:
              y: center
          children:
            - type: view
              style:
                width: auto
                height: auto
                textAlign:
                  x: center
              children:
                - type: image
                  path: aitmedLogoBlack.svg
                  style:
                    width: "0.326"
                    height: "auto"
                - type: label
                  text: Leaving...
                  style:
                    width: "1"
                    fontSize: ".Nfont.h16"
                    color: "#333333"
                    fontWeight: "600"
                    marginTop: "0.027"
                    textAlign: 
                      x: center
        # - type: image
        #   path: aitmedLogoBlack.svg # waitingroom.png
        #   style:
        #     left: "0.25"
        #     top: "0.2"
        #     width: "0.5"
        #     height: "0.8"
        #     position: "fixed"
        #     # objectFit: "none!important"
        - type: view
          viewTag: mainStream
          style:
            left: "0"
            top: "0"
            width: "1"
            height: "1"
            backgroundColor: "0x00000000"
        # - type: view
        #   viewTag: selfStream
        #   style:
        #     left: "0.04"
        #     top: "0.1"
        #     width: "0.2"
        #     height: "0.15"
        #     backgroundColor: "0x00000000"
        # - type: view
        #   style:
        #     left: "0"
        #     top: "0"
        #     width: "1"
        #     height: "0.07"
        #     backgroundColor: "0x000000"
        #     zIndex: 10
        #   children:
        #     - type: label
        #       dataKey: roomInfo.edge.name.roomName
        #       style:
        #         left: "0"
        #         top: "0.02"
        #         width: "1"
        #         fontSize: "20"
        #         fontStyle: bold
        #         color: "0xFFFFFF"
        #         textAlign:
        #           x: center
        #     - type: image
        #       viewTag: switchCamera
        #       path: cameraSwitch.svg
        #       style:
        #         left: "0.87"
        #         top: "0.01"
        #         width: "0.12"
        #         height: "0.05"
        #         lineHeight: "55px"
        #         #height: "0.07"
        #         fontSize: .Nfont.h14
        #         color: "0xFFFFFF"
        #         textAlign:
        #           x: right
        #       onClick:
        #         actionType: builtIn
        #         funcName: switchCamera
        #     - type: image
        #       viewTag: stethoscopeTag
        #       path: cameraSwitch.svg
        #       style:
        #         left: "0.76"
        #         top: "0.03"
        #         width: "0.12"
        #         height: "0.05"
        #         lineHeight: "55px"
        #         #height: "0.07"
        #         fontSize: "14"
        #         color: "0xFFFFFF"
        #         textAlign:
        #           x: right
        #       onClick:
        #         - actionType: evalObject
        #           object:
        #             - if:
        #                 - .builtIn.isAndroid
        #                 - actionType: builtIn
        #                   funcName: handleStethoscope
        #                 - continue
        #onClick:
        # - type: label
        #   contentType: hidden # passwordHidden
        #   viewTag: waitForOtherTag
        #   text: "Waiting for others to join"
        #   #viewTag: needHidden
        #   style:
        #     left: "0"
        #     top: "0.4"
        #     width: "1"
        #     height: "0.04"
        #     fontSize: .Nfont.h16
        #     fontStyle: bold
        #     color: "0x000000"
        #     textAlign:
        #       x: center
        # - type: list # hardcoded listObject
        #   viewTag: videoSubStream
        #   contentType: videoSubStream # listObject
        #   listObject: "" # provide by twilio API ..listData.participants # to dataObject to enumerate the list
        #   iteratorVar: itemObject
        #   #for (itemObject in listObject) do something
        #   #  ..messageDoc@ = itemObject
        #   style:
        #     axis: horizontal
        #     left: "0.04"
        #     top: "0.62"
        #     width: "0.92"
        #     height: "0.15"
        #     zIndex: 20
        #   #for loop through listObject, we got each itemObject
        #   children:
        #     - type: listItem
        #       itemObject: ""
        #       style:
        #         left: "0"
        #         width: "0.18"
        #         height: "0.15"
        #         border:
        #           style: "1"
        #       children:
        #         - type: view
        #           viewTag: subStream
        #           # twilio API(js sdk) provides subStream html element.
        #           style:
        #             left: "0.015"
        #             top: "0"
        #             width: "0.15"
        #             height: "0.15"
        #             border:
        #               style: "5"
        #             borderRadius: "5"
        - type: view
          style:
            width: "0.968"
            textAlign:
              x: right
          children:
            - type: view
              style:
                width: auto
                height: auto
              children:
                # - type: image
                #   viewTag: otoscopeTag
                #   path: otoscope.svg
                #   style:
                #     width: "0.12"
                #     height: "0.05"
                #     marginTop: "0.02"
                #     display: inline-block
                - type: image
                  viewTag: stethoscopeTag
                  path: stethoscope.svg
                  style:
                    width: "0.12"
                    display: ..isWorkingStethoscope
                    height: "0.05"
                    marginTop: "0.02"
                  onClick:
                    - actionType: builtIn
                      funcName: handleStethoscope

                # - type: image
                #   # viewTag: stethoscopeTag
                #   path: videoBlueTooth.svg
                #   style:
                #     width: "0.12"
                #     height: "0.05"
                #     marginTop: "0.02"
                #     display: inline-block
                #   onClick:

        # - type: view
        #   style:
        #     left: "0"
        #     top: "0.9"
        #     width: "1"
        #     height: "0.1"
        #     border:
        #       style: "5"
        #     backgroundColor: "0x000000"
        #     position: "fixed"
        #     zIndex: 10
        #   children:
        #     - type: image
        #       viewTag: camera
        #       path:
        #         emit:
        #           actions:
        #             - if:
        #                 - =.VideoChat.cameraOn
        #                 - cameraOn.svg
        #                 - cameraOff.svg
        #       onClick:
        #         - actionType: builtIn
        #           funcName: toggleFlag
        #           dataKey: VideoChat.cameraOn
        #         - emit:
        #             actions:
        #               - if:
        #                   - =.VideoChat.cameraOn
        #                   - .VideoChat.cameraOn@: false
        #                   - .VideoChat.cameraOn@: true
        #         - actionType: evalObject
        #           object:
        #             - .Global.cameraOn@: =..cameraOn
        #         - actionType: builtIn
        #           funcName: redraw
        #           viewTag: camera
        #       style:
        #         left: "0.1"
        #         top: "0.035"
        #         width: "0.08"
        #         height: "0.03"
        #     - type: image
        #       viewTag: microphone
        #       path:
        #         emit:
        #           actions:
        #             - if:
        #                 - =.VideoChat.micOn
        #                 - micOn.svg
        #                 - micOff.svg
        #       onClick:
        #         # - actionType: builtIn
        #         #  funcName: toggleMicrophoneOnOff
        #         - actionType: builtIn
        #           funcName: toggleFlag
        #           dataKey: VideoChat.micOn
        #         - emit:
        #             actions:
        #               - if:
        #                   - =.VideoChat.micOn
        #                   - .VideoChat.micOn@: false
        #                   - .VideoChat.micOn@: true
        #         - actionType: evalObject
        #           object:
        #             - .Global.micOn@: =..micOn
        #         - actionType: builtIn
        #           funcName: redraw
        #           viewTag: microphone
        #       style:
        #         left: "0.28"
        #         top: "0.03"
        #         width: "0.06"
        #         height: "0.04"
        #     - type: image
        #       path: hangUp.svg
        #       onClick:
        #         - actionType: evalObject
        #           object:
        #             - if:
        #               - =.Global.status.isParticipant
        #               - actionType: updateObject # updateObject(dataKey, dataObject, dataObjectKey)
        #                 dataKey: Global.roomInfoDoc.document
        #                 dataObject: {}
        #               - continue
        #             - if:
        #               - =.Global.status.isParticipant
        #               - actionType: builtIn
        #                 funcName: goBack
        #                 reload: true
        #               - actionType: popUp
        #                 popUpView: confirmView
        #       style:
        #         left: "0.43"
        #         top: "0.0185"
        #         width: "0.12"
        #         backgroundColor: "0xd81e06"
        #         border:
        #           style: "3"
        #           width: "1"
        #         borderRadius: "100"
        #     - type: view
        #       style:
        #         width: "0.2"
        #         height: "0.1"
        #         left: "0.6"
        #         top: "0"
        #       onClick:
        #         - actionType: popUp
        #           popUpView: selectView
        #           dismissOnTouchOutside: true
        #       children:
        #         - type: image
        #           path: navIcMore.svg
        #           style:
        #             left: "0.042"
        #             top: "0.041"
        #             width: "0.06"
        #             height: "0.02"
        #     - type: label
        #       #text: "1:10"
        #       contentType: timer
        #       viewTag: videoTimer
        #       text=func: =.builtIn.string.formatTimer
        #       dataKey: Global.timer # to be remove after implemented builtIn
        #       style:
        #         left: "0.8"
        #         top: "0"
        #         height: "0.1"
        #         width: "0.2"
        #         fontSize: .Nfont.h16
        #         color: "0xffffff"
        #         fontWeight: "500"
        #         textAlign:
        #           y: center
        - type: view
          style:
            width: "1"
            height: "0.312"
            top: "0.688"
            background: "linear-gradient(to top,#545454,#00000000)"
          children:
            - type: view
              viewTag: allParticipants
              style:
                width: "auto"
                marginTop: "0.0123"
                display: none
              children:
                - type: image
                  path: arrowLeftgrey.svg
                  style:
                    width: "0.064"
                    marginLeft: "0.0213"
                    display: inline-block
                    verticalAlign: middle
                  onClick:
                    - actionType: builtIn
                      funcName: hide
                      viewTag: allParticipants
                    - actionType: builtIn
                      funcName: show
                      viewTag: selfView
                - type: view
                  style:
                    display: inline-block
                    verticalAlign: middle
                  children:
                    - type: list # hardcoded listObject
                      viewTag: videoSubStream
                      contentType: videoSubStream # listObject
                      listObject: #..listData.participants # provide by twilio API ..listData.participants # to dataObject to enumerate the list
                      iteratorVar: itemObject
                      #for (itemObject in listObject) do something
                      #  ..messageDoc@ = itemObject
                      style:
                        axis: horizontal
                        marignLeft: "0.04"
                        display: inline-block
                        width: "0.88"
                        height: "0.123"
                        zIndex: 20
                        overflow-x: scroll
                        overflow-y: hidden
                      #for loop through listObject, we got each itemObject
                      children:
                        - type: listItem
                          itemObject: ""
                          style:
                            marginRight: "0.0427"
                            # top: "0"
                            # width: "0.213"
                            # height: "0.123"
                            border:
                              style: "1"
                            borderRadius: "5"
                          children:
                            - type: view
                              viewTag: subStream
                              # twilio API(js sdk) provides subStream html element.
                              style:
                                width: "0.213"
                                height: "0.123"
                                backgroundColor: "0xffffff00"

            - type: view
              viewTag: selfView
              style:
                width: "auto"
                marginTop: "0.0123"
              children:
                - type: view
                  viewTag: selfStream
                  style:
                    width: "0.213"
                    height: "0.123"
                    marginLeft: "0.0907"
                    display: inline-block
                    verticalAlign: middle
                    marginTop: "0"
                    border:
                      style: "5"
                    borderRadius: "5"
                    backgroundColor: "0xffffff00"
                # - type: image
                #   path: arrowRightgrey.svg
                #   style:
                #     width: "0.064"
                #     # marginLeft: "0.0213"
                #     display: inline-block
                #     verticalAlign: middle
                #   onClick:
                #     - actionType: builtIn
                #       funcName: show
                #       viewTag: allParticipants
                #     - actionType: builtIn
                #       funcName: hide
                #       viewTag: selfView

            - type: view
              style:
                width: "1"
                height: auto
                marginTop: "0.0197"
                textAlign:
                  x: center
                  y: center
              children:
                - type: label
                  #text: "1:10"
                  contentType: timer
                  viewTag: "videoTimer"
                  text=func: =.builtIn.string.formatTimer
                  dataKey: Global.timer # to be remove after implemented builtIn
                  style:
                    fontSize: ".Nfont.h18"
                    color: "0xffffff"

                    width: "1"
                    fontWeight: "500"
                    textAlign:
                      x: center
            - type: view
              style:
                width: "0.846"
                heightt: "0.074"
                marginTop: "0.012"
                marginLeft: "0.077"
                textAlign:
                  x: center
              children:
                # 麦克风
                - type: image
                  viewTag: microphone
                  # path: micOn.svg
                  # pathSelected: micOff.svg
                  path:
                    emit:
                      actions:
                        - if:
                            - =.VideoChat.micOn
                            - micOn.svg
                            - micOff.svg
                  onClick:
                    # - actionType: builtIn
                    #  funcName: toggleMicrophoneOnOff
                    - actionType: builtIn
                      funcName: toggleFlag
                      dataKey: VideoChat.micOn
                    - actionType: evalObject
                      object:
                        - if:
                            - =.VideoChat.micOn
                            - .VideoChat.micOn@: false
                            - .VideoChat.micOn@: true
                    - actionType: evalObject
                      object:
                        - .Global.micOn@: =..micOn
                    - actionType: builtIn
                      funcName: redraw
                      viewTag: microphone
                  style:
                    width: "0.117"
                    display: inline-block
                    verticalAlign: middle
                # 摄像头
                - type: image
                  viewTag: camera
                  #path: cameraOn.svg
                  #pathSelected: cameraOff.svg
                  path:
                    emit:
                      actions:
                        - if:
                            - =.VideoChat.cameraOn
                            - cameraOn.svg
                            - cameraOff.svg
                  onClick:
                    # - actionType: builtIn
                    #  funcName: toggleCameraOnOff
                    - actionType: builtIn
                      funcName: toggleFlag
                      dataKey: VideoChat.cameraOn
                    - actionType: evalObject
                      object:
                        - if:
                            - =.VideoChat.cameraOn
                            - .VideoChat.cameraOn@: false
                            - .VideoChat.cameraOn@: true
                    - actionType: evalObject
                      object:
                        - .Global.cameraOn@: =..cameraOn
                    - actionType: builtIn
                      funcName: redraw
                      viewTag: camera
                  style:
                    width: "0.117"
                    marginLeft: "0.053"
                    display: inline-block
                    verticalAlign: middle

                # 挂断
                - type: image
                  path: hangUp.svg
                  onClick:
                    - actionType: popUp
                      popUpView: confirmView
                    #判断当前时间,如果大于etime则直接挂断,否则弹框
                    # - actionType: evalObject
                    #   object:
                    #     - =.builtIn.date.getTime:
                    #         dataIn:
                    #         dataOut: VideoChat.formData.currentTime
                    #     - if:
                    #         - =.builtIn.math.greater:
                    #             dataIn:
                    #               num1: =.VideoChat.formData.currentTime
                    #               num2: =.Global.roomInfo.edge.etime
                    #         - actionType: evalObject
                    #           object:
                    #             - actionType: builtIn
                    #               funcName: disconnectMeeting
                    #             - actionType: updateObject # updateObject(dataKey, dataObject, dataObjectKey)
                    #               dataKey: Global.roomInfoDoc.document
                    #               dataObject: {}
                    #             - actionType: evalObject
                    #               object:
                    #                 - .Global.timer@: 0
                    #                 - .Global.micOn@: "true"
                    #                 - .Global.cameraOn@: "true"
                    #             - actionType: evalObject
                    #               object:
                    #                 - =.builtIn.number.inhx:
                    #                     dataIn:
                    #                       intHex: =..apiRequest.appointmentTag.docCreateReq.tage
                    #                       index: 9
                    #                       hex: 1
                    #                     dataOut: VideoChat.apiRequest.appointmentTag.docCreateReq.tage
                    #                 - =..apiRequest.appointmentTag.docAPI.store: ""
                    #                 - =..apiRequest.appointment.edgeAPI.get: ""
                    #                 - .Global.roomInfo.edge@: =..apiRequest.appointment.edgeQueryResp.edge.0
                    #                 - .Global.formData.showBackButton.visitDetail@: "false"
                    #             - actionType: evalObject
                    #               object:
                    #                 .Global._nonce@:
                    #                   =.builtIn.math.random: ""
                    #             - goto: VisitDetial
                  style:
                    width: "0.16"
                    backgroundColor: "0xd81e06"
                    display: inline-block
                    marginLeft: "0.053"
                    verticalAlign: middle
                    borderRadius: "100"
                # 切换摄像头
                - type: image
                  viewTag: switchCamera
                  path: cameraSwitch.svg
                  style:
                    width: "0.117"
                    marginLeft: "0.053"
                    display: inline-block
                    verticalAlign: middle
                  onClick:
                    actionType: builtIn
                    funcName: switchCamera

                # 功能
                - type: image
                  path: navIcMore.svg
                  style:
                    width: "0.117"
                    marginLeft: "0.053"
                    display: inline-block
                    verticalAlign: middle
                  onClick:
                    - actionType: builtIn
                      funcName: show
                      viewTag: selectView
                    - actionType: builtIn
                      funcName: dismissOnTouchOutside
                      viewTag: selectView
                    # - actionType: popUp
                    #   popUpView: selectView
                    #   dismissOnTouchOutside: true

    - type: popUp
      viewTag: minimizeVideoChat
      global: true
      style:
        left: "0.1"
        top: "0"
        width: "0.2"
        height: "0.15"
        zIndex: 10
      image: chat.png
      audioStream: true
      videoStream: true
      onClick:
        - actionType: popUpDismiss
          popUpView: minimizeVideoChat #wangchen 11/20 2021 Show minizevideochat before goto
        - actionType: evalObject
          object:
            - goto:
                dataIn:
                  destination: VideoChat
                  reload: false

    # close meeting confirm pop up
    - type: popUp
      viewTag: confirmView
      message: "Close this meeting room?"
      # global: true
      style:
        top: "0"
        left: "0"
        width: "1"
        height: "1"
        backgroundColor: "0x00000066"
        zIndex: "50"
        textAlign:
          y: center
      leftButton:
        - actionType: popUpDismiss
          popUpView: confirmView
        # clear roomDoc
        - actionType: updateObject # updateObject(dataKey, dataObject, dataObjectKey)
          dataKey: Global.roomInfoDoc.document
          dataObject: {}
        - actionType: evalObject
          object:
            - .Global.timer@: 0
            - .Global.micOn@: "true"
            - .Global.cameraOn@: "true"
        # TODO add time
        - actionType: builtIn
          funcName: disconnectMeeting #wangchen 11/20 2021 Keep Open Should not disconnect Meeting
        - actionType: evalObject
          object:
            .Global._nonce@:
              =.builtIn.math.random: ""
        - actionType: evalObject
          object:
            - =.VideoChat.apiRequest.appointment.edgeAPI.get: ""
            - .Global.roomInfo.edge@: =.VideoChat.apiRequest.appointment.edgeQueryResp.edge.0
        - actionType: popUpDismiss
          popUpView: minimizeVideoChat
        # - actionType: popUp
        #   popUpView: minimizeVideoChat #wangchen 11/20 2021 Show minizevideochat before goto
        - goto: AppointmentLobby
      rightButton:
        - actionType: popUpDismiss
          popUpView: confirmView
        # leave the meeting
        - actionType: builtIn
          funcName: disconnectMeeting
        # clear roomDoc
        - actionType: updateObject # updateObject(dataKey, dataObject, dataObjectKey)
          dataKey: Global.roomInfoDoc.document
          dataObject: {}
        - actionType: evalObject
          object:
            - .Global.timer@: 0
            - .Global.micOn@: "true"
            - .Global.cameraOn@: "true"
            # finish telemedicine log
            - =.builtIn.utils.createAuditLog:
                dataIn:
                  actionTypeCode: =.ActionTypeCode.finish
                  recordTypeCode: =.EdgeType.scheduleSubtype.Telemedicine
                  eid: =.Global.formData.currentFacility.relationEdge.id
                  user: =.Global.MyProfile.name.data.fullName
                  userId: =.Global.currentUser.vertex.id
                  targetUserId: =.Global.formData.currentMeetingPatientProfile.bsig
                  accessPort: provider
          # change roomInfo tage
        - actionType: evalObject
          object:
            - =.builtIn.number.inhx:
                dataIn:
                  intHex: =.VideoChat.apiRequest.appointmentTag.docCreateReq.tage
                  index: 9
                  hex: 1
                dataOut: VideoChat.apiRequest.appointmentTag.docCreateReq.tage
            - =.VideoChat.apiRequest.appointmentTag.docAPI.store: ""
            - =.VideoChat.apiRequest.appointment.edgeAPI.get: ""
            - .Global.roomInfo.edge@: =.VideoChat.apiRequest.appointment.edgeQueryResp.edge.0
            - .Global.formData.showBackButton.visitDetail@: "false"
        - actionType: evalObject
          object:
            .Global._nonce@:
              =.builtIn.math.random: ""
        - goto: VisitDetial
      onClick:
        - actionType: popUpDismiss
          popUpView: confirmView
      children:
        - type: view
          style:
            width: "0.72"
            marginLeft: "0.14"
            backgroundColor: "0xE6E6E6"
            borderRadius: "14px"
          children:
            - type: label
              text: ___.message
              style:
                width: "0.616"
                marginLeft: "0.052"
                marginTop: "0.029"
                fontWeight: "600"
                fontSize: .Nfont.h16

                color: "0x4B4B4B"
            - type: view
              style:
                marginTop: "0.02"
                width: "0.72"
              children:
                - type: label
                  text: Closing the room will generate a Summary for each participant. If you desire to return to this meeting,keep this room open.
                  style:
                    width: "0.62"
                    marginLeft: "0.052"
                    # marginTop: "0.02"
                    fontWeight: "400"
                    fontSize: .Nfont.h14
                    lineHeight: "2.58vh"

                    color: "0x4B4B4B"
            - type: view
              style:
                height: "0.02"
                border:
                  style: 2
                  color: "0x919192"
                borderWidth: "1"
                width: "0.72"
            - type: view
              style:
                width: "0.72"
              children:
                - type: button
                  text: "Keep open"
                  style:
                    color: "0x007AFF"
                    backgroundColor: "0xE6E6E6"
                    display: inline-block
                    width: "0.359"
                    borderRadius: "0 0 0 14px"
                    fontSize: .Nfont.h14
                    height: "0.054"
                    border:
                      style: "1"
                  onClick: ____.leftButton
                - type: view
                  style:
                    width: "0.002"
                    backgroundColor: "0x919192"
                    display: inline-block
                    height: "0.054"
                    zIndex: "50"
                - type: button
                  text: "Close meeting"
                  style:
                    color: "0x007AFF"
                    backgroundColor: "0xE6E6E6"
                    display: inline-block
                    width: "0.359"
                    fontSize: .Nfont.h14
                    borderRadius: "0 0 14px 0"
                    height: "0.054"
                    border:
                      style: "1"
                  onClick: ____.rightButton
    - type: popUp
      # viewTag: confirmView
      global: true
      style:
        left: "0"
        top: "0"
        width: "1"
        height: "1"
        zIndex: 10
      children:
        - type: view
          style:
            left: "0.1"
            top: "0.325"
            width: "0.8"
            height: "0.35"
            backgroundColor: "0xeeeeeeff"
            border:
              style: "5"
            borderRadius: "15"
          children:
            - type: image
              onClick:
                - actionType: popUpDismiss
                  popUpView: confirmView
              path: cancel.svg
              style:
                .LabelStyle:
                  left: "0.025"
                  top: "0.01"
                  width: "0.03"
                  height: "0.03"
                  color: "0x388eccff"
                  fontSize: "15"
                  display: inline
                  textAlign:
                    x: center
                    y: center
                  border:
                    style: "5"
                  borderRadius: "15"
            - type: label
              text: "LEAVING MEETING..."
              style:
                .LabelStyle:
                  left: "0.05"
                  top: "0.02"
                  width: "0.7"
                  height: "0.04"
                  color: "0x00000088"
                  fontSize: "20"
                  fontWeight: "500"
                  display: inline
                  textAlign:
                    x: center
                    y: center
            - type: label
              text: "Close this meeting room?"
              style:
                .LabelStyle:
                  left: "0.05"
                  top: "0.06"
                  width: "0.7"
                  height: "0.04"
                  color: "0x00000088"
                  fontSize: "20"
                  fontWeight: "500"
                  display: inline
                  textAlign:
                    x: center
                    y: center
            - type: label
              text: "Closing the room will generate a Summary for each participant."
              style:
                left: "0.05"
                top: "0.11"
                width: "0.7"
                height: "0.05"
                color: "0x00000088"
                fontSize: .Nfont.h16
                textAlign:
                  x: center
                  y: center
            - type: label
              text: "If you desire to return to this meeting, keep this room open"
              style:
                left: "0.05"
                top: "0.18"
                width: "0.7"
                height: "0.05"
                color: "0x00000088"
                fontSize: .Nfont.h16
                textAlign:
                  x: center
                  y: center
            - type: divider
              style:
                .DividerStyle:
                  left: "0"
                  top: "0.25436"
                  width: "0.795"
                  height: "0.001"
                  backgroundColor: "0x00000088"
            - type: button
              onClick:
                - actionType: popUpDismiss
                  popUpView: confirmView
                - actionType: builtIn
                  funcName: disconnectMeeting
                # clear roomDoc
                - actionType: updateObject # updateObject(dataKey, dataObject, dataObjectKey)
                  dataKey: Global.roomInfoDoc.document
                  dataObject: {}
                - actionType: evalObject
                  object:
                    - .Global.timer@: 0
                    - .Global.micOn@: "true"
                    - .Global.cameraOn@: "true"
                # TODO add time

                - actionType: evalObject
                  object:
                    .Global._nonce@:
                      =.builtIn.math.random: ""
                - actionType: popUpDismiss
                  popUpView: minimizeVideoChat
                # - actionType: popUp
                #   popUpView: minimizeVideoChat #wangchen 11/20 2021 Show minizevideochat before goto
                - goto: AppointmentLobby
              text: Keep Open
              style:
                .LabelStyle:
                  left: "0"
                  top: "0.275"
                  width: "0.4"
                  height: "0.06812"
                  color: "0x2988e6ff"
                  fontSize: "17"
                  display: inline
                  textAlign:
                    x: center
                    y: center
                  border:
                    style: "5"
                  borderRadius: "15"

            - type: button
              onClick:
                - actionType: popUpDismiss
                  popUpView: confirmView
                - actionType: popUpDismiss
                  popUpView: minimizeVideoChat
                # leave the meeting
                - actionType: builtIn
                  funcName: disconnectMeeting
                # clear roomDoc
                - actionType: updateObject # updateObject(dataKey, dataObject, dataObjectKey)
                  dataKey: Global.roomInfoDoc.document
                  dataObject: {}
                - actionType: evalObject
                  object:
                    - .Global.timer@: 0
                    - .Global.micOn@: "true"
                    - .Global.cameraOn@: "true"
                  # change roomInfo tage
                - actionType: evalObject
                  object:
                    - =.builtIn.number.inhx:
                        dataIn:
                          intHex: =.VideoChat.apiRequest.appointmentTag.docCreateReq.tage
                          index: 9
                          hex: 1
                        dataOut: VideoChat.apiRequest.appointmentTag.docCreateReq.tage
                    - =.VideoChat.apiRequest.appointmentTag.docAPI.store: ""
                    - =.VideoChat.apiRequest.appointment.edgeAPI.get: ""
                    - .Global.roomInfo.edge@: =.VideoChatVideoChat.apiRequest.appointment.edgeQueryResp.edge.0
                    - .Global.formData.showBackButton.visitDetail@: "false"
                - actionType: evalObject
                  object:
                    .Global._nonce@:
                      =.builtIn.math.random: ""
                - goto: VisitDetial
              text: Close Meeting
              style:
                .LabelStyle:
                  left: "0.4"
                  top: "0.275"
                  width: "0.4"
                  height: "0.06812"
                  color: "0x2988e6ff"
                  fontSize: "17"
                  display: inline
                  textAlign:
                    x: center
                    y: center
                  border:
                    style: "5"
                  borderRadius: "15"
            - type: divider
              style:
                .DividerStyle:
                  left: "0.4"
                  top: "0.255"
                  width: "0.001"
                  height: "0.094"
                  backgroundColor: "0x00000088"
    # - type: popUp
    #   viewTag: selectView
    #   style:
    #     left: "0"
    #     width: "1"
    #     height: "1"
    #     top: "0"
    #     zIndex: 10
    #   children:
    #     - type: view
    #       style:
    #         width: "1"
    #         height: "1"
    #         top: "0"
    #         left: "0"
    #       onClick:
    #         - actionType: popUpDismiss
    #           popUpView: selectView
    #       children:
    #         - type: list
    #           contentType: listObject
    #           listObject: ..popUpList
    #           iteratorVar: itemObject
    #           style:
    #             border:
    #               style: "3"
    #             borderColor: "0x00000088"
    #             borderWidth: "1"
    #             borderRadius: "10"
    #             backgroundColor: "0xf4f4f4"
    #             width: "0.45"
    #             height: "0.1"
    #             top: "0.8"
    #             left: "0.5"
    #             overflow: hidden
    #           children:
    #             - type: listItem
    #               itemObject: ""
    #               style:
    #                 width: "0.45"
    #                 height: "0.05"
    #                 border:
    #                   style: "2"
    #                 borderColor: "0x00000066"
    #                 backgroundColor: "0xf4f4f4"
    #                 borderWidth: "1"
    #               children:
    #                 - type: label
    #                   dataKey: itemObject.text
    #                   style:
    #                     width: "0.45"
    #                     height: "0.03"
    #                     top: "0.011"
    #                     fontWeight: "500"
    #                     textAlign:
    #                       x: center
    #                     fontSize: .Nfont.h14
    #                   onClick:
    #                     - actionType: evalObject
    #                       object:
    #                         .Global.rootRoomInfo.edge.name.duration@: =.Global.timer
    #                     - actionType: updateObject # updateObject(dataKey, dataObject, dataObjectKey)
    #                       dataKey: VideoChat.popUpListTemp
    #                       dataObject: itemObject
    #                     - actionType: popUp
    #                       popUpView: minimizeVideoChat
    #                     - actionType: evalObject
    #                       object:
    #                         - if:
    #                             - =.builtIn.string.equal:
    #                                 dataIn:
    #                                   string1: =.VideoChat.popUpListTemp.pageName
    #                                   string2: "ScreenShare"
    #                             - actionType: popUp
    #                               popUpView: underconstruction
    #                             - goto: .VideoChat.popUpListTemp.pageName
    #                     - actionType: popUpDismiss
    #                       popUpView: selectView

    - type: view
      viewTag: selectView
      style:
        display: none
        top: "0.697"
        left: "0.5"
        fontSize: "0"
        zIndex: 10
      children:
        - type: list
          contentType: listObject
          listObject: ..popUpList
          iteratorVar: itemObject
          style:
            border:
              style: "3"
            borderColor: "0xDEDEDE"
            borderWidth: "1"
            borderRadius: "5"
            width: "0.45"
            overflow: hidden
          children:
            - type: listItem
              itemObject: ""
              style:
                width: "0.45"
                height: "0.054"
                # border:
                #   style: "2"
                # borderColor: "0x00000066"
                box-sizing: border-box
                backgroundColor: "0xffffff"
                # borderWidth: "1.5"
              children:
                - type: label
                  dataKey: itemObject.text
                  style:
                    width: "0.45"
                    height: "0.054"
                    fontWeight: "500"
                    textAlign:
                      x: center
                      y: center
                    fontSize: ".Nfont.h14"
                  onClick:
                    - actionType: evalObject
                      object:
                        .Global.rootRoomInfo.edge.name.duration@: =.Global.timer
                    - actionType: updateObject # updateObject(dataKey, dataObject, dataObjectKey)
                      dataKey: VideoChat.popUpListTemp
                      dataObject: itemObject
                    - actionType: popUp
                      popUpView: minimizeVideoChat #wangchen 11/20 2021 Show minizevideochat before goto
                    - actionType: builtIn
                      funcName: hide
                      viewTag: selectView
                    - actionType: evalObject
                      object:
                        - if:
                            - =.builtIn.string.equal:
                                dataIn:
                                  string1: =.VideoChat.popUpListTemp.pageName
                                  string2: "ScreenShare"
                            - actionType: popUp
                              popUpView: underconstruction
                            - goto: .VideoChat.popUpListTemp.pageName
        - type: image
          path: triangleWhite.svg
          style:
            marginLeft: "0.345"
            width: "0.0347"
    # auto disconnect extension confirm view
    # - type: popUp
    #   viewTag: extendView
    #   global: true
    #   style:
    #     top: "0"
    #     left: "0"
    #     width: "1"
    #     height: "1"
    #     zIndex: "50"
    #     textAlign:
    #       y: center
    #   leftButton:
    #     - actionType: popUpDismiss
    #       popUpView: extendView
    #     # extend the time
    #     - actionType: builtIn
    #       funcName: extendMeeting
    #       timePerExtendSeconds: 180 # 3 mins
    #   rightButton:
    #     - actionType: popUpDismiss
    #       popUpView: extendView
    #   onClick:
    #     - actionType: popUpDismiss
    #       popUpView: confirmView
    #   children:
    #     - type: view
    #       style:
    #         width: "0.72"
    #         marginLeft: "0.14"
    #
    #         backgroundColor: "0xf4f3f3"
    #         borderRadius: "14px"
    #       children:
    #         - type: label
    #           text: "Virtual room time's up"
    #           style:
    #               width: "0.72"
    #               color: "0x333333"
    #               fontSize: .Nfont.h16
    #               marginTop: "0.0271"
    #               fontWeight: "600"
    #               textAlign:
    #                 x: center
    #                 y: center
    #         - type: label
    #           text: The appointment is about to end in 30 seconds, and you can extend 5mins.
    #           style:
    #             marginLeft: "0.069"
    #             width: "0.582"
    #             color: "#333333"
    #             fontSize: .Nfont.h14
    #             lineHeight: "2.58vh"
    #             marginTop: "0.0185"
    #         - type: label
    #           text: The upcoming appointment is
    #           style:
    #             marginLeft: "0.069"
    #             width: "0.582"
    #             color: "#333333"
    #             fontSize: .Nfont.h14
    #             lineHeight: "2.58vh"
    #             marginTop: "0.0185"
    #         - type: view
    #           style:
    #             marginLeft: "0.069"
    #             width: "0.582"
    #             color: "#2988E6"
    #             fontSize: .Nfont.h14
    #             lineHeight: "2.58vh"
    #           children:
    #             - type: label
    #               text=func: .builtIn.string.formatUnixtimeL_en
    #               dataKey: Global.roomInfo.edge.stime
    #               style:
    #                 width: auto
    #                 display: "inline-block"
    #                 height: auto
    #             - type: label
    #               text=func: .builtIn.date.ShowTimeSpan
    #               dataKey: Global.roomInfo.edge
    #               style:
    #                 width: auto
    #                 display: "inline-block"
    #                 marginLeft: "0.01"
    #                 height: auto
    #         - type: label
    #           # text: "1:10"
    #           contentType: timerLabelPopUp
    #           viewTag: videoTimer
    #           text=func: =.builtIn.string.formatTimer
    #           #dataKey: Global.timer # to be remove after implemented builtIn
    #           style:
    #             marginLeft: "0.069"
    #             marginTop: "0.02"
    #             width: "0.582"
    #             height: "0.03"
    #             color: "#333333"
    #             fontSize: 2.5vh
    #             lineHeight: "2.58vh"
    #             textAlign:
    #               x: center
    #               y: center
    #         - type: view
    #           style:
    #             height: "0.035"
    #             border:
    #               style: 2
    #               color: "0x919192"
    #             borderWidth: "1"
    #             width: "0.72"
    #         - type: view
    #           style:
    #             width: "0.72"
    #           children:
    #             - type: button
    #               text: "Extend"
    #               style:
    #                 color: "0x007AFF"
    #                 backgroundColor: "0xf4f3f3"
    #                 display: inline-block
    #                 width: "0.359"
    #                 borderRadius: "0 0 0 14px"
    #                 fontSize: .Nfont.h14
    #                 height: "0.054"
    #                 border:
    #                   style: "1"
    #               onClick: ____.leftButton
    #             - type: view
    #               style:
    #                 width: "0.002"
    #                 backgroundColor: "0x919192"
    #                 display: inline-block
    #                 height: "0.054"
    #                 zIndex: "50"
    #             - type: button
    #               text: "No Extend"
    #               style:
    #                 color: "0x007AFF"
    #                 backgroundColor: "0xf4f3f3"
    #                 display: inline-block
    #                 width: "0.359"
    #                 fontSize: .Nfont.h14
    #                 borderRadius: "0 0 14px 0"
    #                 height: "0.054"
    #                 border:
    #                   style: "1"
    #               onClick: ____.rightButton
    # - type: view
    #   viewTag: extendView
    #   global: true
    #   style:
    #     left: "0"
    #     top: "0"
    #     width: "1"
    #     height: "1"
    #     zIndex: 10
    #   children:
    #     - type: view
    #       style:
    #         left: "0.1"
    #         top: "0.325"
    #         width: "0.8"
    #         height: "0.35"
    #         backgroundColor: "0xeeeeeeff"
    #         border:
    #           style: "5"
    #         borderRadius: "15"
    #       children:
    #         - type: label
    #           text: "Virtual room time's up"
    #           style:
    #             .LabelStyle:
    #               width: "0.7"
    #               height: "0.04"
    #               color: "0x00000088"
    #               fontSize: "20"
    #               fontWeight: "500"
    #               display: inline
    #               textAlign:
    #                 x: center
    #                 y: center
    #         - type: label
    #           text: "The appointment is about to end in 30 seconds, and you can extend 5mins."
    #           style:
    #             .LabelStyle:
    #               width: "0.7"
    #               height: "0.04"
    #               color: "0x00000088"
    #               fontSize: "20"
    #               fontWeight: "500"
    #               display: inline
    #               textAlign:
    #                 x: center
    #                 y: center
    #         - type: label
    #           text: "The upcoming appointment is"
    #           style:

    #             width: "0.7"
    #             height: "0.05"
    #             color: "0x00000088"
    #             fontSize: .Nfont.h16
    #             textAlign:
    #               x: center
    #               y: center
    #         - type: label
    #           #text: "1:10"
    #           contentType: timerLabelPopUp
    #           viewTag: videoTimer
    #           text=func: =.builtIn.string.formatTimer
    #           #dataKey: Global.timer # to be remove after implemented builtIn
    #           style:
    #             width: "0.7"
    #             height: "0.03"
    #             color: "0x00000088"
    #             fontSize: .Nfont.h16
    #             textAlign:
    #               x: center
    #               y: center
    #         # - type: label
    #         #   text: "If you desire to keep this room open, please extend it."
    #         #   style:
    #         #     left: "0.05"
    #         #     top: "0.21"
    #         #     width: "0.7"
    #         #     height: "0.05"
    #         #     color: "0x00000088"
    #         #     fontSize: .Nfont.h16
    #         #     textAlign:
    #         #       x: center
    #         #       y: center
    #         - type: divider
    #           style:
    #             .DividerStyle:
    #               left: "0"
    #               top: "0.274"
    #               width: "0.8"
    #               height: "0.001"
    #               backgroundColor: "0x00000088"
    #         - type: button
    #           onClick:
    #             - actionType: popUpDismiss
    #               popUpView: extendView
    #             # extend the time
    #             - actionType: builtIn
    #               funcName: extendMeeting
    #               timePerExtendSeconds: 180 # 3 mins
    #           text: Extend
    #           style:
    #             .LabelStyle:
    #               left: "0"
    #               top: "0.275"
    #               width: "0.4"
    #               height: "0.06812"
    #               color: "0x2988e6ff"
    #               fontSize: "17"
    #               display: inline
    #               textAlign:
    #                 x: center
    #                 y: center
    #               border:
    #                 style: "5"
    #               borderRadius: "15"
    #         - type: button
    #           onClick:
    #             - actionType: popUpDismiss
    #               popUpView: extendView
    #             - actionType: popUpDismiss
    #               popUpView: minimizeVideoChat
    #             # leave the meeting
    #             - actionType: builtIn
    #               funcName: disconnectMeeting
    #             # clear roomDoc
    #             - actionType: updateObject # updateObject(dataKey, dataObject, dataObjectKey)
    #               dataKey: Global.roomInfoDoc.document
    #               dataObject: {}
    #             - actionType: evalObject
    #               object:
    #                 - .Global.timer@: 0
    #                 - .Global.micOn@: "true"
    #                 - .Global.cameraOn@: "true"
    #               # change roomInfo tage
    #             - actionType: evalObject
    #               object:
    #                 - =.builtIn.number.inhx:
    #                     dataIn:
    #                       intHex: =.VideoChat.apiRequest.appointmentTag.docCreateReq.tage
    #                       index: 9
    #                       hex: 1
    #                     dataOut: VideoChat.apiRequest.appointmentTag.docCreateReq.tage
    #                 - =.VideoChat.apiRequest.appointmentTag.docAPI.store: ""
    #                 - =.VideoChat.apiRequest.appointment.edgeAPI.get: ""
    #                 - .Global.roomInfo.edge@: =.VideoChat.apiRequest.appointment.edgeQueryResp.edge.0
    #                 - .Global.formData.showBackButton.visitDetail@: "false"
    #             - actionType: evalObject
    #               object:
    #                 .Global._nonce@:
    #                   =.builtIn.math.random: ""
    #             - goto: VisitDetial
    #           text: Close Meeting
    #           style:
    #             .LabelStyle:
    #               left: "0.4"
    #               top: "0.275"
    #               width: "0.4"
    #               height: "0.06812"
    #               color: "0x2988e6ff"
    #               fontSize: "17"
    #               display: inline
    #               textAlign:
    #                 x: center
    #                 y: center
    #               border:
    #                 style: "5"
    #               borderRadius: "15"
    #         - type: divider
    #           style:
    #             .DividerStyle:
    #               left: "0.4"
    #               top: "0.275"
    #               width: "0.001"
    #               height: "0.07"
    #               backgroundColor: "0x00000088"
    # auto-disconnect last pop up after all extension before exit
    - type: popUp
      viewTag: participantDeclined
      style:
        top: "0"
        left: "0"
        width: "1"
        height: "1"
        zIndex: "50"
        textAlign:
          y: center
      leftButton:
        - actionType: popUpDismiss
          popUpView: participantDeclined
        # clear roomDoc
        - actionType: updateObject # updateObject(dataKey, dataObject, dataObjectKey)
          dataKey: Global.roomInfoDoc.document
          dataObject: {}
        - actionType: builtIn
          funcName: disconnectMeeting #wangchen 11/20 2021 Keep Open Should not disconnect Meeting
        - actionType: evalObject
          object:
            - .Global.timer@: 0
            - .Global.micOn@: "true"
            - .Global.cameraOn@: "true"
        # TODO add time
        - actionType: evalObject
          object:
            .Global._nonce@:
              =.builtIn.math.random: ""
        - actionType: popUpDismiss
          popUpView: minimizeVideoChat
        # - actionType: popUp
        #   popUpView: minimizeVideoChat #wangchen 11/20 2021 Show minizevideochat before goto
        - goto: AppointmentLobby
      children:
        - type: view
          style:
            width: "0.72"
            marginLeft: "0.14"
            backgroundColor: "0xf4f3f3"
            borderRadius: "14px"
          children:
            - type: label
              text: The participant has declined
              style:
                marginLeft: "0.069"
                width: "0.582"
                color: "#333333"
                fontSize: .Nfont.h14
                lineHeight: "2.58vh"
                marginTop: "0.0185"
                textAlign:
                  x: center
            - type: view
              style:
                height: "0.035"
                border:
                  style: 2
                  color: "0x919192"
                borderWidth: "1"
                width: "0.72"
            - type: view
              style:
                width: "0.72"
              children:
                - type: button
                  text: "OK"
                  style:
                    color: "0x007AFF"
                    backgroundColor: "0xf4f3f3"
                    display: inline-block
                    width: "0.72"
                    borderRadius: "0 0 14px 14px"
                    fontSize: .Nfont.h14
                    height: "0.054"
                    border:
                      style: "1"
                  onClick: ____.leftButton
    - type: popUp
      viewTag: participantNotAnswer
      style:
        top: "0"
        left: "0"
        width: "1"
        height: "1"
        zIndex: "50"
        textAlign:
          y: center
      leftButton:
        - actionType: popUpDismiss
          popUpView: participantNotAnswer
        # clear roomDoc
        - actionType: updateObject # updateObject(dataKey, dataObject, dataObjectKey)
          dataKey: Global.roomInfoDoc.document
          dataObject: {}
        - actionType: builtIn
          funcName: disconnectMeeting #wangchen 11/20 2021 Keep Open Should not disconnect Meeting
        - actionType: evalObject
          object:
            - .Global.timer@: 0
            - .Global.micOn@: "true"
            - .Global.cameraOn@: "true"
        # TODO add time
        - actionType: evalObject
          object:
            .Global._nonce@:
              =.builtIn.math.random: ""
        - actionType: popUpDismiss
          popUpView: minimizeVideoChat
        # - actionType: popUp
        #   popUpView: minimizeVideoChat #wangchen 11/20 2021 Show minizevideochat before goto
        - goto: AppointmentLobby
      children:
        - type: view
          style:
            width: "0.72"
            marginLeft: "0.14"
            backgroundColor: "0xf4f3f3"
            borderRadius: "14px"
          children:
            - type: label
              text: The participant did not answer
              style:
                marginLeft: "0.069"
                width: "0.582"
                color: "#333333"
                fontSize: .Nfont.h14
                lineHeight: "2.58vh"
                marginTop: "0.0185"
                textAlign:
                  x: center
            - type: view
              style:
                height: "0.035"
                border:
                  style: 2
                  color: "0x919192"
                borderWidth: "1"
                width: "0.72"
            - type: view
              style:
                width: "0.72"
              children:
                - type: button
                  text: "OK"
                  style:
                    color: "0x007AFF"
                    backgroundColor: "0xf4f3f3"
                    display: inline-block
                    width: "0.72"
                    borderRadius: "0 0 14px 14px"
                    fontSize: .Nfont.h14
                    height: "0.054"
                    border:
                      style: "1"
                  onClick: ____.leftButton

    - type: popUp
      viewTag: exitWarningView
      global: true
      style:
        top: "0"
        left: "0"
        width: "1"
        height: "1"
        zIndex: "50"
        textAlign:
          y: center
      leftButton:
        - actionType: popUpDismiss
          popUpView: exitWarningView
      onClick:
        - actionType: popUpDismiss
          popUpView: exitWarningView
      children:
        - type: view
          style:
            width: "0.72"
            marginLeft: "0.14"

            backgroundColor: "0xf4f3f3"
            borderRadius: "14px"
          children:
            - type: label
              text: "Virtual room time's up"
              style:
                width: "0.72"
                color: "0x333333"
                fontSize: .Nfont.h16
                marginTop: "0.0271"
                fontWeight: "600"
                textAlign:
                  x: center
                  y: center
            - type: label
              text: The appointment is about to end in 30 seconds. You can create a follow-up appointment if you need further treatment.
              style:
                marginLeft: "0.069"
                width: "0.582"
                color: "#333333"
                fontSize: .Nfont.h14
                lineHeight: "2.58vh"
                marginTop: "0.0185"
            - type: label
              # text: "1:10"
              contentType: timerLabelPopUp
              viewTag: videoTimer
              text=func: =.builtIn.string.formatTimer
              #dataKey: Global.timer # to be remove after implemented builtIn
              style:
                marginLeft: "0.069"
                marginTop: "0.02"
                width: "0.582"
                color: "#333333"
                height: "0.03"
                fontSize: 2.5vh
                lineHeight: "2.58vh"
                textAlign:
                  x: center
                  y: center
            - type: view
              style:
                height: "0.035"
                border:
                  style: 2
                  color: "0x919192"
                borderWidth: "1"
                width: "0.72"
            - type: view
              style:
                width: "0.72"
              children:
                - type: button
                  text: "OK"
                  style:
                    color: "0x007AFF"
                    backgroundColor: "0xf4f3f3"
                    display: inline-block
                    width: "0.72"
                    borderRadius: "0 0 14px 14px"
                    fontSize: .Nfont.h14
                    height: "0.054"
                    border:
                      style: "1"
                  onClick:
                    - actionType: popUpDismiss
                      popUpView: exitWarningView
    - .Normal:
      viewTag: timeoutPopup
      message: "This connection took longer than usual, please check your network connection and re-enter the room."
      leftText: "Retry"
      rightText: "Go Back"
      leftButton:
        - actionType: refresh
        - actionType: popUpDismiss
          popUpView: timeoutPopup
      rightButton:
        - actionType: popUpDismiss
          popUpView: timeoutPopup
        - actionType: updateObject # updateObject(dataKey, dataObject, dataObjectKey)
          dataKey: Global.roomInfoDoc.document
          dataObject: { }
        - actionType: evalObject
          object:
            - .Global.timer@: 0
            - .Global.micOn@: "true"
            - .Global.cameraOn@: "true"
        # TODO add time
        - actionType: builtIn
          funcName: disconnectMeeting #wangchen 11/20 2021 Keep Open Should not disconnect Meeting
        - actionType: evalObject
          object:
            .Global._nonce@:
              =.builtIn.math.random: ""
        - actionType: evalObject
          object:
            - =.VideoChat.apiRequest.appointment.edgeAPI.get: ""
            - .Global.roomInfo.edge@: =.VideoChat.apiRequest.appointment.edgeQueryResp.edge.0
        - goto: AppointmentLobby
                # - type: view
                #   style:
                #     width: "0.002"
                #     backgroundColor: "0x919192"
                #     display: inline-block
                #     height: "0.054"
                #     zIndex: "50"
                # - type: button
                #   text: "No Extend"
                #   style:
                #     color: "0x007AFF"
                #     backgroundColor: "0xE6E6E6"
                #     display: inline-block
                #     width: "0.359"
                #     fontSize: .Nfont.h14
                #     borderRadius: "0 0 14px 0"
                #     height: "0.054"
                #     border:
                #       style: "1"
                #   onClick: ____.rightButton
    # - type: popUp
    #   viewTag: exitWarningView
    #   # global: true
    #   style:
    #     left: "0"
    #     top: "0"
    #     width: "1"
    #     height: "1"
    #     zIndex: 10
    #   children:
    #     - type: view
    #       style:
    #         left: "0.1"
    #         top: "0.325"
    #         width: "0.8"
    #         height: "0.35"
    #         backgroundColor: "0xeeeeeeff"
    #         border:
    #           style: "5"
    #         borderRadius: "15"
    #       children:
    #         - type: image
    #           onClick:
    #             - actionType: popUpDismiss
    #               popUpView: exitWarningView
    #           path: cancel.svg
    #           style:
    #             .LabelStyle:
    #               left: "0.025"
    #               top: "0.01"
    #               width: "0.03"
    #               height: "0.03"
    #               color: "0x388eccff"
    #               fontSize: "15"
    #               display: inline
    #               textAlign:
    #                 x: center
    #                 y: center
    #               border:
    #                 style: "5"
    #               borderRadius: "15"
    #         - type: label
    #           text: "TIME'S UP..."
    #           style:
    #             .LabelStyle:
    #               left: "0.05"
    #               top: "0.02"
    #               width: "0.7"
    #               height: "0.04"
    #               color: "0x00000088"
    #               fontSize: "20"
    #               fontWeight: "500"
    #               display: inline
    #               textAlign:
    #                 x: center
    #                 y: center
    #         # - type: label
    #         #   text: "Extend the duration time of this meeting?"
    #         #   style:
    #         #     .LabelStyle:
    #         #       left: "0.05"
    #         #       top: "0.06"
    #         #       width: "0.7"
    #         #       height: "0.04"
    #         #       color: "0x00000088"
    #         #       fontSize: "20"
    #         #       fontWeight: "500"
    #         #       display: inline
    #         #       textAlign:
    #         #         x: center
    #         #         y: center
    #         - type: label
    #           text: "The appointment is about to end. If you need further treatment, the provider can create a follow-up appointment."
    #           style:
    #             left: "0.05"
    #             top: "0.11"
    #             width: "0.7"
    #             height: "0.05"
    #             color: "0x00000088"
    #             fontSize: .Nfont.h16
    #             textAlign:
    #               x: center
    #               y: center
    #         - type: label
    #           #text: "1:10"
    #           contentType: timerLabelPopUp1
    #           viewTag: videoTimer
    #           text=func: =.builtIn.string.formatTimer
    #           #dataKey: Global.timer # to be remove after implemented builtIn
    #           style:
    #             left: "0.05"
    #             top: "0.18"
    #             width: "0.7"
    #             height: "0.03"
    #             color: "0x00000088"
    #             fontSize: .Nfont.h16
    #             textAlign:
    #               x: center
    #               y: center
    #         # - type: label
    #         #   text: "If you desire to keep this room open, please extend it."
    #         #   style:
    #         #     left: "0.05"
    #         #     top: "0.21"
    #         #     width: "0.7"
    #         #     height: "0.05"
    #         #     color: "0x00000088"
    #         #     fontSize: .Nfont.h16
    #         #     textAlign:
    #         #       x: center
    #         #       y: center
    #         - type: divider
    #           style:
    #             .DividerStyle:
    #               left: "0"
    #               top: "0.25436"
    #               width: "0.8"
    #               height: "0.001"
    #               backgroundColor: "0x00000088"
    #         # - type: button
    #         #   onClick:
    #         #     - actionType: popUpDismiss
    #         #       popUpView: exitWarningView
    #         #     # extend the time
    #         #     - actionType: builtIn
    #         #       funcName: extendMeeting
    #         #       timePerExtendSeconds: 180 # 3 mins
    #         #   text: Extend
    #         #   style:
    #         #     .LabelStyle:
    #         #       left: "0"
    #         #       top: "0.275"
    #         #       width: "0.4"
    #         #       height: "0.06812"
    #         #       color: "0x2988e6ff"
    #         #       fontSize: "17"
    #         #       display: inline
    #         #       textAlign:
    #         #         x: center
    #         #         y: center
    #         #       border:
    #         #         style: "5"
    #         #       borderRadius: "15"
    #         - type: button
    #           onClick:
    #             - actionType: popUpDismiss
    #               popUpView: exitWarningView
    #             # Don't need to close and disconnect the meeting here since we have the auto-disconnect when time is up
    #             # # leave the meeting
    #             # - actionType: builtIn
    #             #   funcName: disconnectMeeting
    #             # # clear roomDoc
    #             # - actionType: updateObject # updateObject(dataKey, dataObject, dataObjectKey)
    #             #   dataKey: Global.roomInfoDoc.document
    #             #   dataObject: {}
    #             # - actionType: evalObject
    #             #   object:
    #             #     - .Global.timer@: 0
    #             #     - .Global.micOn@: "true"
    #             #     - .Global.cameraOn@: "true"
    #             #   # change roomInfo tage
    #             # - actionType: evalObject
    #             #   object:
    #             #     - =.builtIn.number.inhx:
    #             #         dataIn:
    #             #           intHex: =..apiRequest.appointmentTag.docCreateReq.tage
    #             #           index: 9
    #             #           hex: 1
    #             #         dataOut: VideoChat.apiRequest.appointmentTag.docCreateReq.tage
    #             #     - =..apiRequest.appointmentTag.docAPI.store: ""
    #             #     - =..apiRequest.appointment.edgeAPI.get: ""
    #             #     - .Global.roomInfo.edge@: =..apiRequest.appointment.edgeQueryResp.edge.0
    #             #     - .Global.formData.showBackButton.visitDetail@: "true"
    #             # - actionType: evalObject
    #             #   object:
    #             #     .Global._nonce@:
    #             #       =.builtIn.math.random: ""
    #             # - goto: VisitDetial
    #           text: OK
    #           style:
    #             .LabelStyle:
    #               left: "0.2"
    #               top: "0.275"
    #               width: "0.4"
    #               height: "0.06812"
    #               color: "0x2988e6ff"
    #               fontSize: "17"
    #               display: inline
    #               textAlign:
    #                 x: center
    #                 y: center
    #               border:
    #                 style: "5"
    #               borderRadius: "15"
    #         # - type: divider
    #         #   style:
    #         #     .DividerStyle:
    #         #       left: "0.4"
    #         #       top: "0.26"
    #         #       width: "0.001"
    #         #       height: "0.07"
    #         #       backgroundColor: "0x00000088"
