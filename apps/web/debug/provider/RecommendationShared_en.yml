RecommendationShared:
  title: Medical Recommendation
  init:
    - .SignInCheck
    - =.builtIn.date.currentDateTime:
        dataIn:
        dataOut: Global.formData.auditLog.startTime
    - ..formData@: =.Global.Note
    - actionType: evalObject
      object:
        .Global._nonce@:
          =.builtIn.math.random: ""
    - if:
        - =.builtIn.string.equal:
            dataIn:
              string1: =.Global.formData.unPageName
              string2: "RecommendationsRecord"
        - actionType: evalObject
          object:
            - .Global.formData.lastPage@: "RecommendationShared"
            - ..formDataTemp.updateShow@: "none"
            - ..formDataTemp.detailShow@: "block"
        - actionType: evalObject
          object:
            - ..formDataTemp.updateShow@: "inline-block"
            - ..formDataTemp.detailShow@: "none"
    - ..apiRequest.productionList.docQueryReq.ids@: =.Global.Note.name.data.goodsList
    - =..apiRequest.productionList.docAPI.get: ""
  formData:

  formDataTemp:
    updateShow: "inline-block"
    detailShow: "none"
  apiRequest:
    productionList:
      docQueryResp: ""
      docQueryReq:
        ids: []
        _nonce: .Global._nonce
      docAPI:
        get:
          api: rd
          dataIn: RecommendationShared.apiRequest.productionList.docQueryReq
          dataOut: RecommendationShared.apiRequest.productionList.docQueryResp
  components:
    - .BasePublicHeader:
        children:
          - .BasePublicHeaderLeft:
            leftClick:
              - actionType: evalObject
                object:
                  - =.builtIn.utils.createAuditLog:
                      dataIn:
                        actionTypeCode: .ActionTypeCode.view
                        recordTypeCode: .DocType.MedicalRecommend
                        eid: =.Global.formData.currentFacility.relationEdge.id
                        date: =.Global.formData.auditLog.startTime
                        user: =.Global.MyProfile.name.data.fullName
                        userId: =.Global.currentUser.vertex.id
                        targetUserId: =.Global.formData.auditLog.patientId
                        accessPort: provider
                      dataOut: Global.formData.auditLog.result
                  - if:
                      - =.builtIn.string.equal:
                          dataIn:
                            string1: =.Global.formData.entrancePageName
                            string2: "MenuBars"
                      - goto: =.Global.formData.backPageName
                      - actionType: builtIn
                        funcName: goBack
                        reload: true
          - .BasePublicHeaderTitle:
    - type: view
      style:
        ..style.splitBox:
      children:
        - type: label
          text: Recommendations
          style:
            ..style.titleLable:
        - type: label
          text: View Diagnoses
          onClick:
            - goto: DiagnosesView
          style:
            ..style.jumpLabel:
    - type: scrollView
      style:
        ..style.scrollBox:
      children:
        - type: list
          contentType: listObject
          listObject: ..apiRequest.productionList.docQueryResp.doc
          iteratorVar: itemObject
          style:
            ..style.list:
          children:
            - type: listItem
              itemObject:
              style:
                ..style.item:
              children:
                - type: view
                  style:
                    ..style.itemInlineBox:
                  children:
                    - type: view
                      style:
                        ..style.inlineBox:
                      children:
                        - type: image
                          path: good.svg
                          path=func: .builtIn.utils.prepareDocToPath
                          dataKey: itemObject.name.data.coverImgId
                          style:
                            ..style.goodImg:
                        - type: label
                          dataKey: itemObject.name.data.basicInfo.type
                          style:
                            ..style.goodValue:
                            color: itemObject.name.data.basicInfo.typeColor
                    - type: view
                      style:
                        ..style.goodContent:
                      children:
                        - type: label
                          dataKey: itemObject.name.data.basicInfo.title
                          style:
                            ..style.goodTitle:
                        - type: label
                          dataKey: itemObject.name.data.basicInfo.introduction
                          style:
                            ..style.goodDescribe:
                        - type: view
                          style:
                            width: auto
                            height: auto
                          children:
                            - type: label
                              textBoard:
                                - text: "0"
                                  dataKey: itemObject.name.data.pricing.price
                              dataKey:
                              style:
                                ..style.goodPrice:
                            # 暂时注释
                            # - type: image
                            #   path: purchased.svg
                            #   style:
                            #     ..style.statusImg:

        - type: view
          style:
            marginTop: "0.03"

    - type: view
      style:
        ..style.btnBox:
      children:
        - type: view
          style:
            ..style.auto:
          children:
            - type: button
              text: Update
              dataKey:
              style:
                ..style.btn:
                display: ..formDataTemp.updateShow
              onClick:
                - ..event.updateClick
            - type: view
              style:
                display: ..formDataTemp.detailShow
              children:
                - .DocButtonPrivate:
                  text: Appt. Details
                  style:
                    backgroundColor: "#2fb355"
                  onClick:
                    - ..event.detailsClick
                - .DocButtonRelease:
                  text: Update
                  onClick:
                    - ..event.updateClick
  event:
    updateClick:
      - actionType: evalObject
        object:
          - .Global.formData.providerDoc.recommendationDoc@: ""
          - .Global.formData.providerDoc.recommendationDoc@: =.Global.Note
          - .Global.formData.productionSelectionList@: []
          - .Global.formData.productionSelectionList@: =.Global.Note.name.data.goodsList
          - .Global.formData.goodNameList@: []
          - .Global.formData.goodNameList@: =.Global.Note.name.data.goodNameList

          - =.builtIn.utils.createAuditLog:
              dataIn:
                actionTypeCode: .ActionTypeCode.edit
                recordTypeCode: .DocType.MedicalRecommend
                eid: =.Global.formData.currentFacility.relationEdge.id
                date: =.Global.formData.auditLog.startTime
                user: =.Global.MyProfile.name.data.fullName
                userId: =.Global.currentUser.vertex.id
                targetUserId: =.Global.formData.auditLog.patientId
                accessPort: provider
              dataOut: Global.formData.auditLog.result
          - goto: SelectRecommendation
    detailsClick:
      - actionType: evalObject
        object:
          - goto: VisitDetial
  style:
    scrollBox:
      width: "1"
      height: "0.8078817"
      boxSizing: "border-box"
      overflow: "scroll"
    btnBox:
      width: "1"
      height: "0.0972"
      boxSizing: "border-box"
      overflow: "scroll"
      backgroundColor: "#ffffff"
      boxShadow: "1px 1px 4px 1px #dededf"
      textAlign:
        x: center
    splitBox:
      height: "0.0394088"
      width: "1"
      backgroundColor: "#f0f0f0"
      overflow: hidden
    titleLable:
      marginLeft: "0.04"
      color: "#333333"
      width: "0.6933333"
      display: "inline-block"
      fontSize: .Nfont.h14
      fontWeight: "600"
      lineHeight: 3.94088vh
    jumpLabel:
      color: "#2988e6"
      display: "inline-block"
      fontSize: .Nfont.h12
      lineHeight: 3.94088vh
      fontWeight: "600"
      textDecoration: underline
    searchBox:
      marginLeft: "0.04"
      marginTop: "0.01"
      width: "0.92"
      height: "0.04187192"
      overflow: hidden
      border:
        style: 3
      borderColor: "#2988e6"
      borderWidth: "1.5"
      borderRadius: "2.09vh"
      boxSizing: "border-box"
    searchImg:
      marginLeft: "0.032"
      display: "inline-block"
      height: "0.022167"
      verticalAlign: middle
    searchInput:
      display: "inline-block"
      marginLeft: "0.032"
      border: "none"
      height: "0.0369458"
      width: "0.613333"
      boxSizing: "border-box"
      verticalAlign: middle
    searchLabel:
      display: "inline-block"
      marginLeft: "0.032"
      boxSizing: "border-box"
      verticalAlign: middle
      fontSize: .Nfont.h14
      fontWeight: "600"
      color: "#2988e6"
    list:
      width: "1"
      margin: "0"
      height: "auto"
    item:
      width: "0.92"
      height: "auto"
      marginLeft: "0.04"
      marginTop: "0.0123"
      borderRadius: "12"
      overflow: hidden
      backgroundColor: "0xffffff"
      boxShadow: "0px 3px 10px #dededf"
      paddingLeft: "0.025"
      paddingTop: "0.014778"
      paddingBottom: "0.014778"
      boxSizing: "border-box"
    itemInlineBox:
      display: "inline-block"
      width: "auto"
      height: "auto"
      overflow: hidden
      verticalAlign: middle
    inlineBox:
      display: "inline-block"
      width: "auto"
      height: "auto"
      overflow: hidden
      textAlign:
        x: center
    goodImg:
      height: "0.086206"
    goodValue:
      marginTop: "0.0025"
      fontSize: .Nfont.h12
      color: itemObject.type.color
      fontWeight: "600"
      width: "0.1866666"
      overflow: hidden
      textAlign:
        x: center
    goodContent:
      marginLeft: "0.02133333"
      display: "inline-block"
      width: "auto"
      boxSizing: "border-box"
      height: "auto"
      overflow: hidden
    goodTitle:
      width: "0.605333"
      height: "auto"
      fontSize: .Nfont.h14
      color: "#333333"
      fontWeight: "600"
      boxSizing: "border-box"
      lineHeight: "2.58vh"
      -webkit-line-clamp: 2
      display: -webkit-box
      -webkit-box-orient: vertical
      overflow: hidden
      text-overflow: ellipsis
    goodDescribe:
      width: "0.605333"
      height: "auto"
      color: "#666666"
      fontSize: .Nfont.h12
      boxSizing: "border-box"
      -webkit-line-clamp: 2
      display: -webkit-box
      -webkit-box-orient: vertical
      overflow: hidden
      text-overflow: ellipsis
    goodPrice:
      marginTop: "0.01"
      color: "#fb5051"
      fontSize: .Nfont.h16
      fontWeight: "700"
      display: "inline-block"
      width: "0.45"
      verticalAlign: middle
    btn:
      marginTop: "0.0123"
      height: "0.0443"
      width: "0.84"
      border:
        style: 1
      borderRadius: "5"
      backgroundColor: "#2988e6"
      color: "#ffffff"
      fontSize: .Nfont.h14
      boxSizing: border-box
      fontWeight: "600"
      textAlign:
        x: center
    statusImg:
      marginTop: "0.01"
      marginLeft: "0.032"
      display: "inline-block"
      height: "0.02463"
      verticalAlign: middle
    auto:
      width: auto
      height: auto
