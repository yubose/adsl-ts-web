LocationsForCov19:
  title: "Choose location"
  init:
    - .SignInCheck

    - actionType: evalObject
      object:
        - =.builtIn.date.getMonth:
            dataIn: ""
            dataOut: LocationsForCov19.calendarDate.month
    - actionType: evalObject
      object:
        - =.builtIn.date.getYear:
            dataIn: ""
            dataOut: LocationsForCov19.calendarDate.year
    - actionType: evalObject
      object:
        - =.builtIn.date.getDate:
            dataIn: ""
            dataOut: LocationsForCov19.calendarDate.day
    - actionType: evalObject
      object:
        - =.builtIn.date.transformMonth:
            dataIn:
              month: =..calendarDate.month
            dataOut: LocationsForCov19.calendarDate.monthName
    - actionType: evalObject
      object:
        - =.builtIn.string.concat:
            dataIn:
              - =..calendarDate.year
              - "-"
              - =..calendarDate.month
              - "-"
              - =..calendarDate.day
            dataOut: LocationsForCov19.calendarDate.todayDate
    - actionType: evalObject
      object:
        - =.builtIn.date.getTimeStampOfDate:
            dataIn:
              date: =..calendarDate.todayDate
            dataOut: LocationsForCov19.calendarDate.todayStamp
        - =.builtIn.string.concat:
            dataIn:
              - =..getLocation.docReq.sCondition
              - =..calendarDate.todayStamp.start
              - " AND E.etime < "
              - =..calendarDate.todayStamp.end
            dataOut: LocationsForCov19.getLocation.docReq.sCondition
    - actionType: evalObject
      object:
        .Global._nonce@:
          =.builtIn.math.random: ""
    - =..getLocation.get: ""
  # get all location profile
  getLocation:
    response:
    docReq:
      id: .Global.currentUser.vertex.id
      ObjType: 12
      xfname: none
      obfname: "ctime"
      sCondition: "E.Type=40000 AND D.type=271361 AND ( E.subtype=655361 OR E.subtype=393217 ) AND E.stime > "
      _nonce: =.Global._nonce
      maxcount: "100"
    get:
      api: rd
      dataIn: getLocation.docReq
      dataOut: getLocation.response

  apiRequest: #Input data request here
    facilityInfo:
      docResp: ""
      docReq:
        ObjType: 12
        id: ""
        xfname: E.evid
        type: .DocType.FacilityProfile
        obfname: "mtime"
        maxcount: "1"
        sCondition: "E.type=1100 AND D.ovid = E.bvid"
        _nonce: =.Global._nonce
      docAPI:
        get:
          api: rd
          dataIn: LocationsForCov19.apiRequest.facilityInfo.docReq
          dataOut: LocationsForCov19.apiRequest.facilityInfo.docResp
  calendarDate:
    month: ""
    year: ""
    day: ""
    daylabel: []
    weekLabel:
      - key: SU
      - key: MO
      - key: TU
      - key: WE
      - key: TH
      - key: FR
      - key: SA
    todayDate: "YYYY-MM-DD"
    monthName: ""
    tempDate: ""
    calendarDate:
    Scondition: ""
    todayStamp: ""
  components:
    - .BaseHeader:
    - .HeaderLeftButton:
      style:
        backgroundColor: "0x2988e6"
    - type: view
      style:
        top: "0.1"
        width: "1"
        height: "0.08"
        backgroundColor: "0x2988e6"
        overflow: hidden
      children:
        - type: view
          style:
            marginTop: "0.01"
            marginLeft: "0.05"
            width: "0.9"
            height: "0.05"
            backgroundColor: "0xffffff"
            borderRadius: "8"
            boxSizing: "border-box"
            overflow: hidden
          children:
            - type: image
              path: search.svg
              style:
                marginLeft: "0.02"
                display: "inline-block"
                height: "0.025"
                verticalAlign: middle
            - type: textField
              placeholder: Search
              dataKey:
              style:
                marginLeft: "0.02"
                verticalAlign: middle
                display: "inline-block"
                border:
                  style: 1
                height: "0.05"
                boxSizing: "border-box"
                width: "0.8"
              onClick:
                - goto: SearchProvider
    - type: view
      style:
        top: "0.18"
        left: "0"
        width: "1"
        height: "0.82"
      children:
        - type: label
          contentType: messageHidden
          text: "No contacts added"
          style:
            left: "0.32"
            top: "0.02"
            width: "0.6"
            height: "0.04"
            fontSize: "18"
            isHidden: "true"
        - type: scrollView
          style:
            top: "0.02"
            left: "0"
            width: "1"
            height: "0.76"
            overflow: "scroll"
            backgroundColor: "#ffffff"
          children:
            - type: list
              contentType: listObject
              listObject: ..getLocation.response.doc
              iteratorVar: itemObject
              style:
                top: "0"
                left: "0"
                width: "1"
                height: "0.76"
                margin: "0"
              children:
                - type: listItem
                  itemObject: ""
                  style:
                    left: "0"
                    width: "1"
                    height: "0.14"
                    border:
                      style: "2"
                    borderWidth: "1"
                    borderColor: "0x00000011"
                  onClick:
                    - emit:
                        dataKey:
                          var: itemObject
                        actions:
                          - ..providerId@: $var.bsig
                    - actionType: updateObject
                      dataKey: Global.ActiveLocation
                      dataObject: itemObject
                    - actionType: evalObject
                      object:
                        - ..apiRequest.facilityInfo.docReq.id@: =.Global.ActiveLocation.bsig
                        - =..apiRequest.facilityInfo.docAPI.get: ""
                    - actionType: evalObject
                      object:
                        - .Global.currentFacility@: =..apiRequest.facilityInfo.docResp.doc.0
                    - goto: ChooseRooms
                  children:
                    - type: view
                      style:
                        top: "0.005"
                        left: "0.05"
                        width: "0.35"
                        backgroundColor: "#ecf8ef"
                      children:
                        - type: label
                          text: "COVID-19 Testing"
                          style:
                            left: "0.06"
                            width: "0.89"
                            color: "#2E8B57"
                            fontSize: "12"
                        - type: image
                          path: checkbox.svg
                          style:
                            height: "0.02"
                            left: "0"
                            top: "0.001"
                            width: "0.06"
                    - type: view
                      style:
                        top: "0.005"
                        left: "0.43"
                        width: "0.35"
                        backgroundColor: "#ecf8ef"
                      children:
                        - type: label
                          text: "COVID-19 Vaccines"
                          style:
                            left: "0.06"
                            width: "0.51"
                            color: "#2E8B57"
                            fontSize: "12"
                        - type: image
                          path: checkbox.svg
                          style:
                            left: "0"
                            top: "0.001"
                            width: "0.06"
                            height: "0.02"
                    - type: label
                      dataKey: itemObject.name.data.basicInfo.medicalFacilityName
                      style:
                        top: "0.026"
                        left: "0.26"
                        height: "0.05"
                        width: "0.74"

                        fontSize: "17"
                    - type: label
                      dataKey: itemObject.name.data.basicInfo.address
                      style:
                        left: "0.26"
                        top: "0.0655"
                        height: "0.05"
                        width: "0.74"

                        fontSize: "12"
                    - type: label
                      text: "Schedule appointment"
                      style:
                        top: "0.106"
                        left: "0.349"
                        width: "0.6"
                        height: "0.04"

                        fontSize: "15"
                        color: "#7bb5ef"
                    - type: image
                      path: calendarBlue.svg
                      style:
                        left: "0.26"
                        top: "0.108"
                        width: "0.05"
                    - type: image
                      path=func: =.builtIn.utils.prepareDocToPath
                      dataKey: itemObject.name.data.basicInfo.businessLogo
                      path: office-building.svg
                      style:
                        top: "0.04"
                        height: "14vw"
                        left: "0.06"
                        width: "14vw"
