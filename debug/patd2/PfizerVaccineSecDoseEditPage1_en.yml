PfizerVaccineSecDoseEditPage1:
  title: "Pfizer-BioNTech Vaccine - Second Dose"

  pageNumber:

  init: #Page initialization
    - .SignInCheck
    - if:
        - =.Global.formData.firstToPfizerVaccineSecDose
        - actionType: evalObject
          object:
            - ..apiRequest.pifzerVaccineSecDoseForm.docReq.name.data@: =.VaccineFormDM.pifzerVaccineSecDoseFormDM
            - ..apiRequest.pifzerVaccineSecDoseForm.docReq.name.data.patientInfo.fullName@: =.Global.Profile.name.data.basicInfo.fullName
            - =..apiRequest.pifzerVaccineSecDoseForm.docAPI.store: ""
            - .Global.formData.pifzerVaccineSecDoseForm@: =..apiRequest.pifzerVaccineSecDoseForm.docResp.doc
        - continue

    #  判断是否选择,选择过则回到此界面复显
    - if:
        - =.Global.formData.pifzerVaccineSecDoseForm.name.data.screeningEligibility
        - .PfizerVaccineSecDoseEditPage1.formData.screeningEligibility@: =.Global.formData.pifzerVaccineSecDoseForm.name.data.screeningEligibility
        - continue
    - if:
        - =.Global.formData.pifzerVaccineSecDoseForm.name.data.patientInfo.fullName
        - ..apiRequest.pifzerVaccineSecDoseForm.docReq.name.data.patientInfo.fullName@: =.Global.formData.pifzerVaccineSecDoseForm.name.data.patientInfo.fullName
        - continue
  formData: #Input data here
    screeningEligibility:
      recevingDose: ""
      ingredient: ""
  formDataTemp: #Input data temp here, datatemp should not mix with formData
    recevingDose:
      - key: recevingDose
        value: "Yes"
      - key: recevingDose
        value: "No"
    ingredient:
      - key: ingredient
        value: "Yes"
      - key: ingredient
        value: "No"
  apiRequest:
    pifzerVaccineSecDoseForm:
      docResp: ""
      docReq:
        id: ""
        eid: .Global.rootNotebookID
        type: .DocType.PfizerVaccineSecDoseForm
        name:
          data: ""
          title: "Pfizer-BioNTech Vaccine - Second Dose"
          user: .Global.Profile.name.data.basicInfo.fullName
          type: "application/json"
      docAPI:
        store:
          api: cd
          dataIn: PfizerVaccineSecDoseEditPage1.apiRequest.pifzerVaccineSecDoseForm.docReq
          dataOut: PfizerVaccineSecDoseEditPage1.apiRequest.pifzerVaccineSecDoseForm.docResp

  components:
    - type: view
      style:
        ..style.formatting:
      children:
        - .BasePublicHeader:
          children:
            - type: view
              style:
                ..style.backLeft:
              children:
                - type: image
                  path: arrowLeftgrey.svg
                  style:
                    ..style.backLeftImg:
                  onClick:
                    - ..event.pubClick
                    - actionType: builtIn
                      funcName: goBack
                      reload: true
            - .BasePublicHeaderTitle:
              style:
                fontSize: .Nfont.h14
        - type: view
          style:
            ..style.bodyBox:
          children:
            - type: view
              style:
                ..style.viewBox:
              children:
                - type: view
                  style:
                    ..style.titleBox:
                  children:
                    - type: label
                      text: Pfizer-BioNTech COVID-19 Vaccine Consent Form
                      dataKey:
                      style:
                        ..style.titlelabel:
                    - type: label
                      text: "1&nbsp;/&nbsp;2"
                      dataKey:
                      style:
                        ..style.pageNum:
            - type: scrollView
              style:
                ..style.scrollBox:
              children:
                - type: view
                  style:
                    width: "0.92"
                    height: "auto"
                    overflow: hidden
                  children:
                    - type: view
                      style:
                        ..style.blockBox:
                        marginTop: "0.02216"
                      children:
                        - type: label
                          text: Patient Name
                          style:
                            ..style.blockBoxLeft:
                        - type: label
                          text:
                          dataKey: apiRequest.pifzerVaccineSecDoseForm.docReq.name.data.patientInfo.fullName
                          style:
                            ..style.blockBoxRight:
                    - type: view
                      style:
                        ..style.blockBox:
                      children:
                        - type: label
                          text: Date
                          style:
                            ..style.blockBoxLeft:
                        - type: label
                          text=func: .builtIn.string.formatUnixtimeL_en
                          dataKey: Global.formData.pifzerVaccineSecDoseForm.ctime
                          style:
                            ..style.blockBoxRight:
                - type: label
                  text: "1.Screening For Vaccine Eligibility"
                  dataKey:
                  style:
                    ..style.secondLabel:
                - type: label
                  text: "Components of the Pfizer-BioNTech COVID-19 vaccine: nucleoside modified messenger RNA (modRNA) encoding the viral spike (S) glycoprotein of SARS-CoV-2, sodium chloride, lipids, polyethylene glycol, potassium chloride, monobasic potassium phosphate, dibasic sodium phosphate dihydrate, and sucrose."
                  style:
                    ..style.text:

                - type: label
                  text: "Please answer the following questions:"
                  dataKey:
                  style:
                    ..style.secondLabel:

                - type: label
                  text: "Have you had a severe allergic reaction after receiving a previous dose of COVID-19 vaccine?"
                  style:
                    ..style.text:

                - type: list
                  viewTag: firstView
                  contentType: listObject
                  listObject: ..formDataTemp.recevingDose
                  iteratorVar: itemObject
                  style:
                    ..style.list:
                  children:
                    - type: listItem
                      itemObject:
                      style:
                        ..style.listItem:
                      children:
                        - type: image
                          path:
                            ..event.recevingDosePath:
                          style:
                            ..style.itemImg:
                          onClick:
                            - ..event.recevingDoseClick
                        - type: label
                          text:
                          dataKey: itemObject.value
                          style:
                            ..style.itemValue:

                - type: label
                  text: "Have you had a severe allergic reaction to any ingredient in the Pfizer-BioNtech COVID-19 vaccine?"
                  style:
                    ..style.text:
                    marginTop: "0.0246"

                - type: list
                  viewTag: secondView
                  contentType: listObject
                  listObject: ..formDataTemp.ingredient
                  iteratorVar: itemObject
                  style:
                    ..style.list:
                  children:
                    - type: listItem
                      itemObject:
                      style:
                        ..style.listItem:
                      children:
                        - type: image
                          path:
                            ..event.ingredientPath:
                          style:
                            ..style.itemImg:
                          onClick:
                            - ..event.ingredientClick
                        - type: label
                          text:
                          dataKey: itemObject.value
                          style:
                            ..style.itemValue:

        - type: view
          style:
            ..style.btnBox:
          children:
            - type: button
              text: Next
              dataKey:
              style:
                ..style.btn:
              onClick:
                - ..event.pubClick
                - goto: PfizerVaccineSecDoseEditPage2
  event:
    recevingDosePath:
      emit:
        dataKey:
          var: itemObject
        actions:
          - if:
              - =.builtIn.string.equal:
                  dataIn:
                    string1: =..formData.screeningEligibility.recevingDose
                    string2: $var.value
              - radioOn.svg
              - radioOff.svg
    recevingDoseClick:
      - emit:
          dataKey:
            var: itemObject
          actions:
            - if:
                - =.builtIn.string.equal:
                    dataIn:
                      string1: =..formData.screeningEligibility.recevingDose
                      string2: $var.value
                - continue
                - =.builtIn.object.set:
                    dataIn:
                      object: =..formData.screeningEligibility
                      key: $var.key
                      value: $var.value
      - actionType: builtIn
        funcName: redraw
        viewTag: firstView

    ingredientPath:
      emit:
        dataKey:
          var: itemObject
        actions:
          - if:
              - =.builtIn.string.equal:
                  dataIn:
                    string1: =..formData.screeningEligibility.ingredient
                    string2: $var.value
              - radioOn.svg
              - radioOff.svg
    ingredientClick:
      - emit:
          dataKey:
            var: itemObject
          actions:
            - if:
                - =.builtIn.string.equal:
                    dataIn:
                      string1: =..formData.screeningEligibility.ingredient
                      string2: $var.value
                - continue
                - =.builtIn.object.set:
                    dataIn:
                      object: =..formData.screeningEligibility
                      key: $var.key
                      value: $var.value
      - actionType: builtIn
        funcName: redraw
        viewTag: secondView
    pubClick:
      - actionType: evalObject
        object:
          # 文档保存到本地存储
          - .Global.formData.pifzerVaccineSecDoseForm@: =..apiRequest.pifzerVaccineSecDoseForm.docResp.doc
          # 保存选择状态
          - .Global.formData.pifzerVaccineSecDoseForm.name.data.screeningEligibility@: =..formData.screeningEligibility
          - .Global.formData.firstToPfizerVaccineSecDose@: false
  style:
    formatting:
      margin: "0"
      padding: "0"
      height: "1"
      width: "1"
      overflow: hidden
      boxSizing: border-box

      color: "#333333"
      fontSize: .Nfont.h16
    backLeft:
      marginLeft: "0.04"
      display: "inline-block"
      verticalAlign: middle
      height: "0.055"
      boxSizing: border-box
    backLeftImg:
      marginTop: "0.012"
      height: "0.0295"
    bodyBox:
      width: "auto"
      height: "0.84852"
    viewBox:
      marginLeft: "0.04"
      height: "auto"
      width: "0.92"
      overflow: hidden

    titleBox:
      marginTop: "0.0270"
      paddingBottom: "1.23vh"
      width: "0.92"
      height: "auto"
      border:
        style: 2
      borderWidth: "1"
      borderColor: "#dedede"
    titlelabel:
      display: "inline-block"
      fontSize: .Nfont.h16
      color: "0x333333"
      width: "0.753125"
      height: "auto"
      fontWeight: "700"
      verticalAlign: top
      lineHeight: "2.95vh"
    pageNum:
      marginLeft: "0.064"
      display: "inline-block"
      height: "0.0221"
      width: "0.1013"
      backgroundColor: "0x2988e6"
      color: "0xffffff"
      fontSize: .Nfont.h14
      fontWeight: "700"
      borderRadius: "3"
      verticalAlign: top
      textAlign:
        x: center
    scrollBox:
      marginLeft: "0.04"
      width: "0.92"
      height: "0.7487"
      boxSizing: border-box
      overflow: scroll
    blockBox:
      marginTop: "0.01"
      height: "auto"
      width: "0.92"
    blockBoxLeft:
      display: "inline-block"
      width: "auto"
      height: "auto"
      color: "0x666666"
      fontSize: .Nfont.h12
      verticalAlign: middle
    blockBoxRight:
      marginLeft: "0.0373"
      display: "inline-block"
      width: "auto"
      height: "auto"
      color: "0x333333"
      fontSize: .Nfont.h14
      fontWeight: "600"
      verticalAlign: middle
    secondLabel:
      width: "0.92"
      fontSize: .Nfont.h14
      fontWeight: "700"
      color: "0x333333"
      marginTop: "0.0197"
      lineHeight: "2.58vh"
    text:
      marginTop: "0.0197"
      height: "auto"
      width: "0.92"
      fontSize: .Nfont.h14
      lineHeight: "2.58vh"
      wordWrap: break-word
      color: "#333333"
    list:
      margin: "0"
      marginTop: "0.01477"
      width: "0.9"
      height: auto
      boxSizing: border-box
      axis: horizontal
      overflow: hidden
    listItem:
      display: "inline-block"
      width: "0.2666"
      height: "auto"
      boxSizing: border-box
    itemImg:
      display: "inline-block"
      width: "0.0442"
      verticalAlign: middle
    itemValue:
      marginLeft: "0.032"
      display: "inline-block"
      fontSize: .Nfont.h14
      color: "#333333"
      width: "auto"
      height: "auto"
      verticalAlign: middle
    btnBox:
      height: "0.0972"
      width: "1"
      backgroundColor: "0xffffff"
      boxSizing: border-box

      boxShadow: "1px 1px 4px 1px #dededf"
      overflow: hidden
      textAlign:
        x: center
    btn:
      marginTop: "0.0123"
      height: "0.0443"
      width: "0.84"
      border:
        style: 1
      borderRadius: "5"
      backgroundColor: "#2988e6"
      color: "#ffffff"
      fontSize: .Nfont.h14
      boxSizing: border-box
      fontWeight: "600"
      textAlign:
        x: center

  #   # 是否第一次创建pifzerVaccineSecDoseForm默认true, 创建 pifzerVaccineSecDoseForm  赋值到 global
  #   - if:
  #       - =.Global.formData.firstToPfizerVaccineSecDose
  #       - actionType: evalObject
  #         object:
  #           - =..apiRequest.pifzerVaccineSecDoseForm.docAPI.store: ""
  #           - .Global.formData.pifzerVaccineSecDoseForm@: =..apiRequest.pifzerVaccineSecDoseForm.docRes.doc
  #       - continue
  #   # 将global中的 单选框信息screeningEligibility 存到页面数据screeningEligibility中
  #   - if:
  #       - =.Global.formData.pifzerVaccineSecDoseForm.name.data.screeningEligibility
  #       - ..formData.screeningEligibility@: =.Global.formData.pifzerVaccineSecDoseForm.name.data.screeningEligibility
  #       - continue

  # formData: #Input data here
  #   screeningEligibility:
  #     # 单选框状态
  #     recevingDose: ""
  #     ingredient: ""
  #   classTag:
  #     name: Patient
  #     fontColor: "0xf8ae29"
  #     backgroundColor: "0xfff4e0"
  #     display: block
  #   statusTag:
  #     display: none
  # formDataTemp: # Input data temp here, datatemp should not mix with formData
  #   recevingDose:
  #     - key: recevingDose
  #       value: "Yes"
  #     - key: recevingDose
  #       value: "No"
  #   ingredient:
  #     - key: ingredient
  #       value: "Yes"
  #     - key: ingredient
  #       value: "No"

  # apiRequest: #Input data request here
  #   # 第一步 文档 pifzerVaccineSecDoseForm
  #   # 第二步 在dataBaseModel的formData中添加 firstToPfizerVaccineSecDose
  #   # 第三步 pifzerVaccineSecDoseForm.docAPI.store:, 并放入global
  #   # 第四步 screeningEligibility存储单选框状态
  #   pifzerVaccineSecDoseForm:
  #     docRes: ""
  #     docReq:
  #       id: ""
  #       eid: .Global.rootNotebookID
  #       type: .DocType.PfizerVaccineSecDoseForm
  #       name:
  #         data: {}
  #         title: "Pifzer-BioNTech Vaccine - Second Dose"
  #         user: .Global.Profile.name.data.basicInfo.fullName
  #         type: "application/json"
  #     docAPI:
  #       store:
  #         api: cd
  #         dataIn: PfizerVaccineSecDoseEditPage1.apiRequest.pifzerVaccineSecDoseForm.docReq
  #         dataOut: PfizerVaccineSecDoseEditPage1.apiRequest.pifzerVaccineSecDoseForm.docRes

  # style: #Input style fragment here

  # components:
  #   - .BaseHeader:
  #   - .HeaderLeftButton:
  #     style:
  #       backgroundColor: "0x2988e6"
  #   - type: scrollView
  #     style:
  #       height: "0.83"
  #       width: "1"
  #       top: "0.1"
  #       left: "0"
  #       overflow: scroll
  #     children:
  #       - type: image
  #         path: secDose2_1.svg
  #         style:
  #           marginTop: "0.02"
  #           left: "10vw"
  #           width: "78vw"
  #       - type: label
  #         text: Pifzer-BioNTech COVID-19 Vaccine Consent Form
  #         style:
  #           left: "0.07"
  #           width: "0.86"
  #           marginTop: "0.03"
  #           height: "0.06"
  #           #
  #           fontSize: "18"
  #           textAlign:
  #             x: center
  #       - type: label
  #         text: "1. Screening for Vaccine Eligibility"
  #         style:
  #           left: "0.07"
  #           width: "0.86"
  #           marginTop: "0.03"
  #           height: "0.045"
  #           #
  #           fontSize: "16"
  #           textAlign:
  #             x: left
  #           border:
  #             style: "2"
  #           borderWidth: "1"
  #           borderColor: "0xdededf"
  #       # PatientName & Date
  #       - .PatNameAndDate:
  #         children:
  #           - .PatName:
  #           - .PatNameValue:
  #             dataKey: Global.formData.pifzerVaccineSecDoseForm.name.user
  #           - .PatDate:
  #           - .PatDateValue:
  #             dataKey: Global.formData.pifzerVaccineSecDoseForm.ctime
  #       - type: label
  #         text: "Components of the Pfizer-BioNTech COVID-19 vaccine: nucleoside modified messenger RNA (modRNA) encoding the viral spike (S) glycoprotein of SARS-CoV-2, sodium chloride, lipids, polyethylene glycol, potassium chloride, monobasic potassium phosphate, dibasic sodium phosphate dihydrate, and sucrose."
  #         style:
  #           left: "0.07"
  #           width: "0.86"
  #           marginTop: "0.02"
  #           height: "auto"
  #           lineHeight: "1.7"
  #           #
  #           fontSize: "12"
  #           textAlign:
  #             x: left
  #       - type: view
  #         style:
  #           left: "0.07"
  #           width: "0.86"
  #           marginTop: "0.03"
  #           height: "0.35"
  #         children:
  #           - type: label
  #             text: "Please answer the following questions:"
  #             style:
  #               left: "0"
  #               width: "0.86"
  #               height: "0.03"
  #               #
  #               fontSize: "14"
  #               textAlign:
  #                 x: left
  #           - type: view
  #             style:
  #               width: "0.86"
  #               marginTop: "0.02"
  #               left: "0"
  #               height: "auto"
  #             children:
  #               - type: label
  #                 text: Have you had a severe allergic reaction after receiving a previous dose of COVID-19 vaccine?
  #                 style:
  #                   marginTop: "0.02"
  #                   width: "90vw"
  #                   height: "auto"
  #                   fontSize: "3.5vw"
  #                   lineHeight: "1.6"
  #               - type: list
  #                 contentType: listObject
  #                 listObject: ..formDataTemp.recevingDose
  #                 iteratorVar: itemObject
  #                 viewTag: screeningView
  #                 style:
  #                   width: "0.86"
  #                   height: "0.05"
  #                   axis: horizontal
  #                   marginTop: "0.02"
  #                 children:
  #                   - type: listItem
  #                     itemObject:
  #                     style:
  #                       width: "0.4"
  #                       height: "0.05"
  #                       left: "0"
  #                       marginTop: "auto"
  #                     children:
  #                       - type: image
  #                         path:
  #                           emit:
  #                             dataKey:
  #                               var: itemObject
  #                             actions:
  #                               - if:
  #                                   - =.builtIn.string.equal:
  #                                       dataIn:
  #                                         string1: =..formData.screeningEligibility.recevingDose
  #                                         string2: $var.value
  #                                   - selectOnBlack.svg
  #                                   - selectOffBlack.svg
  #                         onClick:
  #                           - emit:
  #                               dataKey:
  #                                 var: itemObject
  #                               actions:
  #                                 - if:
  #                                     - =.builtIn.string.equal:
  #                                         dataIn:
  #                                           string1: =..formData.screeningEligibility.recevingDose
  #                                           string2: $var.value
  #                                     - =.builtIn.object.clear:
  #                                         dataIn:
  #                                           object: =..formData.screeningEligibility
  #                                           key: $var.key
  #                                     - =.builtIn.object.set:
  #                                         dataIn:
  #                                           object: =..formData.screeningEligibility
  #                                           key: $var.key
  #                                           value: $var.value
  #                           - actionType: builtIn
  #                             funcName: redraw
  #                             viewTag: screeningView
  #                         style:
  #                           width: "0.05"
  #                           top: "0.003"
  #                       - type: label
  #                         dataKey: itemObject.value
  #                         style:
  #                           fontSize: "12"
  #                           left: "0.07"
  #                           top: "0.004"
  #           - type: view
  #             style:
  #               width: "0.86"
  #               marginTop: "0.01"
  #               left: "0"
  #               height: "auto"
  #             children:
  #               - type: label
  #                 text: "Have you had a severe allergic reaction to any ingredient in the Pfizer-BioNtech COVID-19 vaccine?"
  #                 style:
  #                   marginTop: "0.02"
  #                   width: "90vw"
  #                   left: "0"
  #                   height: "auto"
  #                   fontSize: "3.5vw"
  #                   lineHeight: "1.6"
  #               - type: list
  #                 contentType: listObject
  #                 listObject: ..formDataTemp.ingredient
  #                 iteratorVar: itemObject
  #                 viewTag: screeningView
  #                 style:
  #                   marginTop: "0.02"
  #                   width: "0.86"
  #                   height: "0.05"
  #                   axis: horizontal
  #                 children:
  #                   - type: listItem
  #                     itemObject:
  #                     style:
  #                       width: "0.4"
  #                       height: "0.05"
  #                       left: "0"
  #                       marginTop: "auto"
  #                     children:
  #                       - type: image
  #                         path:
  #                           emit:
  #                             dataKey:
  #                               var: itemObject
  #                             actions:
  #                               - if:
  #                                   - =.builtIn.string.equal:
  #                                       dataIn:
  #                                         string1: =..formData.screeningEligibility.ingredient
  #                                         string2: $var.value
  #                                   - selectOnBlack.svg
  #                                   - selectOffBlack.svg
  #                         onClick:
  #                           - emit:
  #                               dataKey:
  #                                 var: itemObject
  #                               actions:
  #                                 - if:
  #                                     - =.builtIn.string.equal:
  #                                         dataIn:
  #                                           string1: =..formData.screeningEligibility.ingredient
  #                                           string2: $var.value
  #                                     - =.builtIn.object.clear:
  #                                         dataIn:
  #                                           object: =..formData.screeningEligibility
  #                                           key: $var.key
  #                                     - =.builtIn.object.set:
  #                                         dataIn:
  #                                           object: =..formData.screeningEligibility
  #                                           key: $var.key
  #                                           value: $var.value
  #                           - actionType: builtIn
  #                             funcName: redraw
  #                             viewTag: screeningView
  #                         style:
  #                           width: "0.05"
  #                           top: "0.003"
  #                       - type: label
  #                         dataKey: itemObject.value
  #                         style:
  #                           fontSize: "12"
  #                           left: "0.07"
  #                           top: "0.004"
  #   - .NextButtonView:
  #     children:
  #       - .NextButton:
  #         onClick:
  #           - actionType: evalObject
  #             object:
  #               # 将文档状态置为 false, 即已修改
  #               - .Global.formData.firstToPfizerVaccineSecDose@: false
  #               # 保存文档状态
  #               - .Global.formData.pifzerVaccineSecDoseForm.name.data.classTag@: =..formData.classTag
  #               - .Global.formData.pifzerVaccineSecDoseForm.name.data.statusTag@: =..formData.statusTag
  #               # 保存单选框状态
  #               - .Global.formData.pifzerVaccineSecDoseForm.name.data.screeningEligibility@: =..formData.screeningEligibility
  #               - goto: PfizerVaccineSecDoseEditPage2
