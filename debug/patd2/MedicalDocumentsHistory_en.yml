MedicalDocumentsHistory:
  title: "Medical Documents"
  pageNumber: ""
  init:
    - .SignInCheck
    - ..listData.get
    # - ..listData.store
    - =.builtIn.array.transformPage:
        dataIn:
          array: =..listData.sharedDoc.doc
          type: "Review"
          dataKey: "name.title"
        dataOut: MedicalDocumentsHistory.formData.docList
  formData:
    docList: [] # 用于接收处理过的
  listData:
    sharedDoc:
      document: ""
      # doc:
      #   name:
      #     title: "Urgent Care Evaluation Report"
    get:
      .DocAPI.get: ""
      api: rd
      dataKey: listData.sharedDoc
      # type: .DocType.UploadFile
      ids:
        # - .Global.VideoChatObjStore.reference.edge.refid
        - .Global.roomInfo.edge.id
        # - .Global.VideoChatObjStore.reference.edge.id
      xfname: eid
      sCondition: "type in (1025,1537,1793,2305,2049,84480,87040,92161,94721,107521,110081,112641,115201,117761,120321)"
      maxcount: "20"
      _nonce: =.Global._nonce
      obfname: ctime
  dataObject: .Global.roomInfo.edge
  components:
    - .BaseHeader:
    - .HeaderLeftButton:
      style:
        width: "0.2"
    - type: view
      style:
        top: "0.1"
        # left: "0.05"
        width: "1"
        height: "0.75"
        backgroundColor: "#f0f0f0"
      children:
        - type: label
          text: "Medical Documents"
          style:
            marginTop: "0"
            left: "0.08"
            width: "0.92"
            height: "0.05"
            # backgroundColor: "0xF7F7F7"
            fontSize: .Nfont.h3
            color: "#4b4b4b"
            textAlign:
              y: center
        - type: scrollView
          style:
            marginTop: "0"
            # left: "0.05"
            width: "1"
            height: "0.75"
            backgroundColor: "#ffffff"
            overflow: "scroll"
          children:
            - type: list
              contentType: listObject
              listObject: ..formData.docList
              iteratorVar: itemObject
              style:
                top: "0"
                left: "0"
                width: "1"
                height: "0.75"
                margin: "0"
                backgroundColor: "0xffffff"
                boxShadow: "0px 0px 1px #dededf"
                overflow: scroll
              children:
                - type: listItem
                  itemObject: ""
                  onClick:
                    - actionType: updateObject
                      dataObject: itemObject
                      dataKey: Global.DocReference.document
                    - actionType: evalObject
                      object:
                        - if:
                            - =.builtIn.string.equal:
                                dataIn:
                                  string1: =.Global.DocReference.document.type
                                  string2: 1025
                            - goto: DocumentDetail
                            - continue
                        - if:
                            - =.builtIn.string.equal:
                                dataIn:
                                  string1: =.Global.DocReference.document.type
                                  string2: 1537
                            - actionType: evalObject
                              object:
                                - .Global.Note@: =.Global.DocReference.document
                                - goto: BlankNote
                            - continue
                        - if:
                            - =.builtIn.string.equal:
                                dataIn:
                                  string1: =.Global.DocReference.document.type
                                  string2: 1793
                            - actionType: evalObject
                              object:
                                - .Global.Note@: =.Global.DocReference.document
                                - goto: EvaluationNote
                            - continue
                        - if:
                            - =.builtIn.string.equal:
                                dataIn:
                                  string1: =.Global.DocReference.document.type
                                  string2: 2049
                            - actionType: evalObject
                              object:
                                - .Global.Note@: =.Global.DocReference.document
                                - goto: Prescription
                            - continue
                        - if:
                            - =.builtIn.string.equal:
                                dataIn:
                                  string1: =.Global.DocReference.document.type
                                  string2: 2305
                            - actionType: evalObject
                              object:
                                - .Global.Note@: =.Global.DocReference.document
                                - goto: AbsentNote
                            - continue
                    - emit:
                        dataKey:
                          var: itemObject
                        actions:
                          - if:
                              - true
                              - goto: $var.pageName
                              - goto: $var.pageName
                  style:
                    left: "0"
                    # top: "0"
                    width: "1"
                    height: "0.1"
                    border: none
                    borderBottom: "1px solid #dbdbdb"
                    borderWidth: "1"
                  children:
                    - type: label
                      dataKey: itemObject.name.title
                      style:
                        top: "0.02"
                        fontSize: .Nfont.h2
                        fontWeight: 400
                        left: "0.08"
                    - type: label
                      text=func: .builtIn.string.formatUnixtime_en
                      dataKey: itemObject.ctime
                      style:
                        top: "0.055"
                        fontSize: .Nfont.h2
                        fontWeight: 350
                        left: "0.08"
                    - type: label
                      dataKey: itemObject.name.user
                      style:
                        top: "0.055"
                        fontSize: .Nfont.h2
                        fontWeight: 350
                        width: "0.35"
                        left: "0.55"
                        textAlign:
                          x: right
                        # color: "#30b354"
    - type: button
      text: Done
      style:
        fontStyle: "bold"
        fontSize: .Nfont.h2
        top: "0.93"
        backgroundColor: "0x2988e6"
        height: "0.05"
        width: "0.5"
        left: "0.25"
        color: "0xffffff"
        border:
          style: "3"
        borderColor: "0x2988e6"
        borderWidth: "1"
        textAlign:
          x: center
          y: center
      onClick:
        - actionType: builtIn
          funcName: goBack
          # reload: true
      # - type: view
      #   style:
      #     top: "0.8"
      #     width: "1"
      #     height: "0.3"
      #     # backgroundColor: "#80b3ff"
      #   children:
      #     - type: view
      #       style:
      #         left: "0.07"
      #         top: "0.06"
      #         width: "0.85"
      #         height: "0.1"
      #         border:
      #           style: "3"
      #           color: "#2fb355"
      #         borderColor: "#2fb355"
      #         borderWidth: "2"
      #         borderRadius: "10"
      #         boxShadow: "0px 2px 5px 2px #dededf"
      #       onClick:
      #         - goto: UploadMedicalRecord2
      #       children:
      #         - type: image
      #           path: addGreen.svg
      #           style:
      #             left: "0.07"
      #             top: "0.02"
      #             width: "0.13"
      #         - type: label
      #           text: "Upload new document"
      #           style:
      #             left: "0.24"
      #             top: "0.03"
      #             # width: "0.13"
      #             fontSize: "20"
